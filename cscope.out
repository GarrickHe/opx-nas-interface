cscope 15 /neteng/ghe/merge_opx/opx-nas-interface               0000855462
	@inc/opx/hal_interface.h

25 #iâdeà
HAL_INTERFACE_H_


26 
	#HAL_INTERFACE_H_


	)

28 
	~"¡d_”rÜ_codes.h
"

30 #ifdeà
__ılu¥lus


40 
t_¡d_”rÜ
 
h®_š‹rçû_š™
();

42 #ifdeà
__ılu¥lus


51 
t_¡d_”rÜ
 
h®_·ck‘_io_š™
();

	@inc/opx/hal_interface_common.h

26 #iâdeà
__HAL_BASE_INTERFACE_INTERNAL_H


27 
	#__HAL_BASE_INTERFACE_INTERNAL_H


	)

29 
	~"¡d_”rÜ_codes.h
"

30 
	~"ds_commÚ_ty³s.h
"

32 #ifdeà
__ılu¥lus


36 
	~"›tf-š‹rçûs.h
"

37 
	~"Çs_ndi_pÜt.h
"

38 
	~"ıs_­i_ev’ts.h
"

39 
	~"ıs_­i_š‹rçû_ty³s.h
"

40 
	~"ıs_­i_objeù.h
"

50 
	#NAS_LINK_MTU_HDR_SIZE
 32

	)

53 
Åu_lšk_¡©e_A_NPU
=1,

54 
Åu_lšk_¡©e_A_PORT
=2,

55 
Åu_lšk_¡©e_A_STATE
=3,

56 } 
	tÅu_lšk_¡©e_ATTR_t
;

58 
	#MAC_STRING_SZ
 18

59 

	)

60 
	#IF_VLAN_MAX
 (4096)

	)

66 
t_¡d_”rÜ
 
h®_ü—‹_š‹rçûs
();

77 
t_¡d_”rÜ
 
h®_vœtu®_š‹rçû_£nd
(
Åu_id_t
 
Åu
, 
Åu_pÜt_t
 
pÜt
, 
queue
,

78 cÚ¡ * 
d©a
, 
Ën
);

81 (*
h®_vœt_pkt_Œªsm™
)(
	tÅu_id_t
 
	tÅu
, 
	tÅu_pÜt_t
 
	tpÜt
,

82 *
	td©a
, 
	tËn
);

85 (*
h®_vœt_pkt_Œªsm™_to_šg»ss_p–še
)(*
	td©a
, 
	tËn
);

94 
t_¡d_”rÜ
 
h®_vœtu®_š‹rçû_wa™
(
h®_vœt_pkt_Œªsm™
 
tx_fun
,

95 
h®_vœt_pkt_Œªsm™_to_šg»ss_p–še
 
tx_to_šg»ss_fun
,

96 *
buff
, 
Ën
);

104 
h®_š‹rçû_lšk_¡©e_cb
(
Åu_id_t
 
Åu
, 
Åu_pÜt_t
 
pÜt
,

105 
ndi_pÜt_İ”_¡©us_t
 
d©a
);

110 
h®_š‹rçû_lšk_debug_š™
();

117 
h®_š‹rçû_£nd_ev’t
(
ıs_­i_objeù_t
 
obj
);

118 
boŞ
 
Çs_št_ev_hªdËr_cb
(
ıs_­i_objeù_t
 
obj
, *
·¿m
);

119 
t_¡d_”rÜ
 
Çs_if_g‘_assigÃd_mac
(cÚ¡ *
if_ty³
,

120 cÚ¡ *
if_Çme
, 
h®_vÏn_id_t
 
vÏn_id
,

121 *
mac_addr
, 
size_t
 
mac_buf_size
);

123 
t_¡d_”rÜ
 
h®_št_Çme_to_if_šdex
(
h®_ifšdex_t
 *
if_šdex
, cÚ¡ *
Çme
);

131 
Çs_£nd_admš_¡©e_ev’t
(
h®_ifšdex_t
 
if_šdex
, 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_t
 
¡©e
);

133 (*
İ”_¡©e_hªdËr_t
è(
	tÅu_id_t
 
	tÅu
, 
	tÅu_pÜt_t
 
	tpÜt
, 
	tIF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
	tİ”_¡©e
);

135 
Çs_št_İ”_¡©e_»gi¡”_cb
(
İ”_¡©e_hªdËr_t
 
İ”_¡©e_cb
);

136 #ifdeà
__ılu¥lus


	@inc/opx/hal_interface_defaults.h

26 #iâdeà
HAL_INTERFACE_DEFAULTS_H_


27 
	#HAL_INTERFACE_DEFAULTS_H_


	)

30 
	~"ıs_­i_š‹rçû_ty³s.h
"

31 
	~"¡d_”rÜ_codes.h
"

33 
	~<¡ddef.h
>

35 #ifdeà
__ılu¥lus


42 
	#DEFAULT_INTF_ADMINSTATE
 
DB_ADMIN_STATE_DN


	)

43 
	#DEFAULT_INTF_MTU
 1500

	)

44 
	#DEFAULT_VRF
 (0)

	)

46 
	eÇs_pÜt_mode_t
 {

47 
NAS_PORT_UNTAGGED
 = 1,

48 
NAS_PORT_TAGGED
,

49 
NAS_PORT_HYBRID
,

50 
NAS_PORT_NONE


51 } 
	tÇs_pÜt_mode_t
;

53 #ifdeà
__ılu¥lus


	@inc/opx/interface_obj.h

24 #iâdeà
INTERFACE_OBJ_H_


25 
	#INTERFACE_OBJ_H_


	)

28 #ifdeà
__ılu¥lus


31 
	~"h®_if_m­pšg.h
"

33 
ıs_­i_»tuº_code_t
 (*
	tıs_rdâ
è(* 
	tcÚ‹xt
, 
	tıs_­i_g‘_·¿ms_t
 * 
	t·¿m
, 
	tsize_t
 
	tkey_ix
);

35 
ıs_­i_»tuº_code_t
 (*
	tıs_wrâ
è(* 
	tcÚ‹xt
, 
	tıs_­i_Œª§ùiÚ_·¿ms_t
 * 
	t·¿m
,
	tsize_t
 
	tix
);

38 
obj_INTF
,

39 
obj_INTF_STATE
,

40 
obj_INTF_STATISTICS
,

41 
obj_INTF_MAX


42 } 
	tobj_štf_ÿt_t
;

44 
t_¡d_”rÜ
 
š‹rçû_obj_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
);

46 
t_¡d_”rÜ
 
štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_štf_ÿt_t
 
obj_ÿt
, 
Çs_št_ty³_t
 
štf_ty³
, 
ıs_rdâ
 
rd
, 
ıs_wrâ
 
wr
);

48 #ifdeà
__ılu¥lus


	@inc/opx/nas_fc_stats.h

22 #iâdeà
NAS_FC_STATS_H_


23 
	#NAS_FC_STATS_H_


	)

25 
	~"¡d_”rÜ_codes.h
"

26 
	~"ıs_­i_İ”©iÚ.h
"

28 #ifdeà
__ılu¥lus


32 
t_¡d_”rÜ
 
Çs_¡©s_fc_if_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
);

33 
ıs_­i_»tuº_code_t
 
Çs_if_fc_¡©s_ş—r
 (* 
cÚ‹xt
,

34 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,

35 
size_t
 
ix
);

37 #ifdeà
__ılu¥lus


	@inc/opx/nas_int_base_if.h

23 #iâdeà
NAS_INT_BASE_IF_H_


24 
	#NAS_INT_BASE_IF_H_


	)

26 
	~"Çs_št_com_uts.h
"

27 
	~"¡d_rw_lock.h
"

28 
	~"d–l-ba£-š‹rçû-commÚ.h
"

30 
	~<¡dboŞ.h
>

31 
	~<unÜd”ed_m­
>

32 
	~<memÜy
>

33 
	~<li¡
>

34 
	~<ut™y
>

36 
usšg
 
	gma¡”_â_ty³
 = 
¡d
::
funùiÚ
< (
if_ma¡”_šfo_t
)>;

38 şas 
	cÇs_štf_obj
 {

40 
h®_ifšdex_t
 
	mm_if_idx
;

41 
	m¡d
::
¡ršg
 
m_if_Çme
;

42 
	m¡d
::
li¡
<
if_ma¡”_šfo_t
> 
m_li¡
;

44 
	mpublic
:

45 
	$Çs_štf_obj
(
h®_ifšdex_t
 
if_idx
, cÚ¡ * 
if_Çme
):

46 
	`m_if_idx
(
if_idx
), 
	$m_if_Çme
(
if_Çme
) { };

48 
boŞ
 
	`Çs_štf_obj_ma¡”_add
(
if_ma¡”_šfo_t
 
m_šfo
);

50 
boŞ
 
	`Çs_štf_obj_ma¡”_d–‘e
(
if_ma¡”_šfo_t
 
m_šfo
);

52 
	$Çs_štf_obj_fÜ_—ch_ma¡”
(
ma¡”_â_ty³
 
â
) {

53 autØ
ix
: 
m_li¡
è
	`â
(ix);

54 
	}
}

57 
	g¡d
::
li¡
<
if_ma¡”_šfo_t
> 
	$Çs_štf_obj_ma¡”_li¡
() const {

58  
m_li¡
;

59 
	}
}

61 
boŞ
 
	$Çs_štf_obj_is_mli¡_em±y
() const {

62  
m_li¡
.
	`em±y
();

63 
	}
}

66 
usšg
 
	g_if_unique_obj
 = 
¡d
::
unique_±r
<
Çs_štf_obj
>;

67 
usšg
 
	g_if_™”_ty³
 = 
¡d
::
unÜd”ed_m­
<
h®_ifšdex_t
, 
	g_if_unique_obj
>::
™”©Ü
;

69 şas 
	cÇs_štf_cÚš”
 {

72 
¡d_rw_lock_t
 
	mrw_lock
;

74 
	m¡d
::
unÜd”ed_m­
<
h®_ifšdex_t
, 
	m_if_unique_obj
> 
	mif_objeùs
;

76 
	mpublic
:

78 
	$Çs_štf_cÚš”
() {

79 
	`¡d_rw_lock_ü—‹_deçuÉ
(&
rw_lock
);

82 autØ
	`Çs_štf_add_objeù
(
h®_ifšdex_t
 
ifx
è-> 
_if_™”_ty³
;

83 
	`Çs_štf_d–_objeù
(
h®_ifšdex_t
 
ifx
);

85 
boŞ
 
	`Çs_štf_add_ma¡”
(
h®_ifšdex_t
 
ifx
, 
if_ma¡”_šfo_t
 
m_šfo
);

86 
boŞ
 
	`Çs_štf_d–_ma¡”
(
h®_ifšdex_t
 
ifx
, 
if_ma¡”_šfo_t
 
m_šfo
);

87 
	`Çs_štf_ma¡”_ÿÎbk
(
h®_ifšdex_t
 
ifx
, 
ma¡”_â_ty³
 
â
);

88 
¡d
::
li¡
<
if_ma¡”_šfo_t
> 
	`Çs_štf_g‘_ma¡”_li¡
(
h®_ifšdex_t
 
ifx
);

89 
BASE_IF_MODE_t
 
	`Çs_štf_g‘_mode
(
h®_ifšdex_t
 
ifx
);

92 
	$Çs_štf_dump_cÚš”
(
h®_ifšdex_t
 
ifx
=0è
nÛxû±
;

93 
	}
};

	@inc/opx/nas_int_bridge.h

22 #iâdeà
NAS_INTF_BRIDGE_H_


23 
	#NAS_INTF_BRIDGE_H_


	)

25 
	~"ds_commÚ_ty³s.h
"

26 
	~"¡d_”rÜ_codes.h
"

27 
	~"›tf-š‹rçûs.h
"

28 
	~"h®_if_m­pšg.h
"

29 
	~"h®_š‹rçû_commÚ.h
"

30 
	~"h®_š‹rçû_deçuÉs.h
"

31 
	~<unÜd”ed_m­
>

32 
	~<unÜd”ed_£t
>

35 #ifdeà
__ılu¥lus


40 
	~"Çs_št_li¡.h
"

41 
	#SYSTEM_DEFAULT_VLAN
 1

	)

43 
¡d
::
	tunÜd”ed_m­
<
	th®_ifšdex_t
,
	tboŞ
> 
	tÇs_vÏn_pÜt_İ”_¡©us_t
;

45 
	sÇs_bridge_s
{

46 
mac_addr
[
MAC_STRING_SZ
];

47 
Çme
[
HAL_IF_NAME_SZ
];

48 
h®_ifšdex_t
 
ifšdex
;

49 
h®_vÏn_id_t
 
vÏn_id
;

50 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_t
 
admš_¡©us
;

51 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
İ”_¡©us
;

52 
Çs_vÏn_pÜt_İ”_¡©us_t
 
İ”_li¡
;

53 
boŞ
 
Ë¬nšg_di§bË
;

54 
št_sub_ty³
;

55 
Çs_li¡_t
 
uÁagged_li¡
;

56 
Çs_li¡_t
 
gged_li¡
;

57 
Çs_li¡_t
 
uÁagged_Ïg
;

58 
Çs_li¡_t
 
gged_Ïg
;

59 
BASE_IF_MODE_t
 
mode
;

60 
ušt32_t
 
mtu
;

61 }
	tÇs_bridge_t
;

65 
¡d
::
	tunÜd”ed_m­
 <
	th®_ifšdex_t
, 
	tÇs_pÜt_mode_t
> 
	tmem_li¡_t
;

66 
	svÏn_rŞl_bk_s
 {

67 
mem_li¡_t
 
pÜt_d–_li¡
;

68 
mem_li¡_t
 
pÜt_add_li¡
;

69 
mem_li¡_t
 
Ïg_add_li¡
;

70 
mem_li¡_t
 
Ïg_d–_li¡
;

71 } 
	tvÏn_rŞl_bk_t
;

75 
¡d
::
	tunÜd”ed_m­
 <
	th®_ifšdex_t
, 
	tÇs_bridge_t
> 
	tbridge_li¡_t
;

84 
Çs_bridge_t
* 
Çs_ü—‹_š£¹_bridge_node
(
h®_ifšdex_t
 
šdex
, cÚ¡ *
Çme
, 
boŞ
 &
ü—‹
);

93 
t_¡d_”rÜ
 
Çs_d–‘e_bridge
(
h®_ifšdex_t
 
šdex
);

103 
Çs_bridge_t
 *
Çs_g‘_bridge_node
(
h®_ifšdex_t
 
šdex
);

113 
Çs_bridge_t
 *
Çs_g‘_bridge_node_äom_Çme
(cÚ¡ *
vÏn_if_Çme
);

115 
Çs_bridge_t
 *
Çs_g‘_bridge_node_äom_vid
 (
h®_vÏn_id_t
 
vÏn_id
);

119 
Çs_bridge_lock
 ();

124 
Çs_bridge_uÆock
 ();

129 
boŞ
 
Çs_vÏn_id_š_u£
(
h®_vÏn_id_t
 
vÏn_id
);

135 
boŞ
 
Çs_hªdË_vid_to_br
(
h®_vÏn_id_t
 
vÏn_id
, 
h®_ifšdex_t
 
if_šdex
);

142 
t_¡d_”rÜ
 
Çs_ş—nup_bridge
(
Çs_bridge_t
 *
p_bridge_node
);

144 
Çs_pÜt_upd©e_vÏn_İ”_¡©e_cb
(
Åu_id_t
 
Åu
, 
Åu_pÜt_t
 
pÜt
,

145 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©us
);

146 
Çs_Ïg_upd©e_vÏn_İ”_¡©e_cb
(
h®_ifšdex_t
 
if_idx
,

147 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
İ”_¡©e
);

149 
Çs_upd©e_pÜt_to_vÏns_m­
(cÚ¡ 
h®_ifšdex_t
 
pÜt_idx
, cÚ¡ h®_ifšdex_ˆ
vÏn_idx
, 
boŞ
 
add
);

150 #ifdeà
__ılu¥lus


	@inc/opx/nas_int_com_utils.h

22 #iâdeà
NAS_INT_COM_UTILS_H_


23 
	#NAS_INT_COM_UTILS_H_


	)

25 
	~"h®_š‹rçû_deçuÉs.h
"

26 
	~"h®_if_m­pšg.h
"

27 
	~"d–l-ba£-š‹rçû-commÚ.h
"

29 
	~<¡dlib.h
>

30 
	~<¡ršg
>

31 
	~<unÜd”ed_m­
>

32 
	~<unÜd”ed_£t
>

33 
	~<funùiÚ®
>

34 
	~<li¡
>

36 
	g¡d
::
	tunÜd”ed_£t
<
	th®_ifšdex_t
> 
	tÇs_pÜt_li¡_t
;

38 
	s_if_ma¡”_šfo
 {

39 
Çs_št_ty³_t
 
	mty³
;

40 
Çs_pÜt_mode_t
 
	mmode
;

41 
h®_ifšdex_t
 
	mm_if_idx
;

42 }
	tif_ma¡”_šfo_t
;

44 
boŞ
 
Çs_štf_add_ma¡”
(
h®_ifšdex_t
 
ifx
, 
if_ma¡”_šfo_t
 
m_šfo
);

45 
boŞ
 
Çs_štf_d–_ma¡”
(
h®_ifšdex_t
 
ifx
, 
if_ma¡”_šfo_t
 
m_šfo
);

46 
Çs_štf_ma¡”_ÿÎback
(
h®_ifšdex_t
 
ifx
, 
¡d
::
funùiÚ
< (
if_ma¡”_šfo_t
)> 
â
);

47 
	g¡d
::
li¡
<
if_ma¡”_šfo_t
> 
Çs_štf_g‘_ma¡”
(
h®_ifšdex_t
 
ifx
);

48 
BASE_IF_MODE_t
 
Çs_štf_g‘_mode
(
h®_ifšdex_t
 
ifx
);

49 
boŞ
 
Çs_štf_hªdË_štf_mode_chªge
(
h®_ifšdex_t
 
ifx
, 
BASE_IF_MODE_t
 
mode
);

50 
boŞ
 
Çs_štf_hªdË_štf_mode_chªge
 (cÚ¡ *
if_Çme
, 
BASE_IF_MODE_t
 
mode
);

52 
t_¡d_”rÜ
 
Çs_štf_db_obj_g‘
(cÚ¡ * 
štf_Çme
,
ıs_­i_©Œ_id_t
 
id
, 
ıs_­i_qu®if›r_t
 
ÿt
,

53 
ıs_­i_objeù_t
 
obj
);

54 
boŞ
 
Çs_štf_ş—nup_l2mc_cÚfig
 (
h®_ifšdex_t
 
ifx
, 
h®_vÏn_id_t
 
vÏn_id
=0);

	@inc/opx/nas_int_filter_class.h

23 #iâdeà
NAS_INT_FILTER_CLASS_H_


24 
	#NAS_INT_FILTER_CLASS_H_


	)

26 
	~"Çs_·ck‘_f‹r.h
"

27 
	~"Çs_ba£_uts.h
"

28 
	~"Çs_ba£_obj.h
"

30 
	~<io¡»am
>

31 
	~<unÜd”ed_m­
>

32 
	~<funùiÚ®
>

33 
	~<mu‹x
>

36 
	g‹m¶©e
<
ty³Çme
 
	gT
>

37 şas 
	cpf_key_hash
 {

39 
	mpublic
:

40 
¡d
::
size_t
 
	$İ”©Ü
(è(
T
 cÚ¡& 
¤c
ècÚ¡ 
nÛxû±
;

43 
‹m¶©e
<>

44 
¡d
::
size_t
 
pf_key_hash
<
BASE_PACKET_PACKET_MATCH_TYPE_t
>::
	$İ”©Ü
()

45 (
BASE_PACKET_PACKET_MATCH_TYPE_t
 cÚ¡& 
idx
ècÚ¡ 
nÛxû±
{

46  
¡d
::
hash
<>(è(
idx
);

47 
	}
}

49 
	g‹m¶©e
<>

50 
	g¡d
::
size_t
 
pf_key_hash
<
BASE_PACKET_PACKET_ACTION_TYPE_t
>::
	$İ”©Ü
()

51 (
BASE_PACKET_PACKET_ACTION_TYPE_t
 cÚ¡& 
idx
ècÚ¡ 
nÛxû±
{

52  
¡d
::
hash
<>(è(
idx
);

53 
	}
}

56 
	g‹m¶©e
<
ty³Çme
 
	gT
,y³Çm
	gE
>

57 şas 
	cv_ba£_m­
 {

59 
	mpublic
:

60 
	$v_ba£_m­
() { };

62 
	$v_ba£_m­
(cÚ¡ 
T
& 
t
, cÚ¡ 
E
& 
e
) {

63 
m_li¡
.
	`š£¹
(
¡d
::
	`make_·œ
(
t
, 
e
));

64 
	}
}

66 
v_ba£_m­
(cÚ¡ v_ba£_m­<
T
, 
E
>& 
rhs
) = ;

68 
	gv_ba£_m­
<
	gT
,
	gE
>& 
	gİ”©Ü
=(cÚ¡ 
v_ba£_m­
<
T
,E>& 
	grhs
) = ;

70 
v_ba£_m­
(v_ba£_m­<
T
, 
E
>&& 
rhs
è
	gnÛxû±
 {

71 
	gm_li¡
 = 
¡d
::
move
(
rhs
.
m_li¡
);

74 
	gv_ba£_m­
<
	gT
,
	gE
>& 
	gİ”©Ü
=(
v_ba£_m­
<
T
,E>&& 
	grhs
è
	gnÛxû±
 {

75 if(
	gthis
 =ğ&
rhs
è *
this
;

77 
	gm_li¡
.
ş—r
();

78 
	gm_li¡
 = 
¡d
::
move
(
rhs
.
m_li¡
);

79  *
	gthis
;

82 
vœtu®
 
boŞ
 
	$add_’Œy
(
T
& 
t
, 
E
& 
e
) {

83  
m_li¡
.
	`š£¹
(
¡d
::
	`make_·œ
(
t
, 
e
)).
£cÚd
;

84 
	}
}

86 
vœtu®
 
	$d–_’Œy
(
T
& 
t
) {

87  
m_li¡
.
	`”a£
(
t
);

88 
	}
}

90 
vœtu®
 
	$g‘_’Œy
(
T
& 
t
) const {

91 
m_li¡
.
	`©
(
t
);

92 
	}
}

94 
vœtu®
 
g‘_’Œ›s
(
¡d
::
funùiÚ
< (
E
&)> 
â
) const {

95 autØ
ix
:
m_li¡
) {

96 
â
(
ix
.
£cÚd
);

100 
	gvœtu®
 ~
	$v_ba£_m­
(è{
	}
};

102 
	g´iv©e
:

109 
¡d
::
unÜd”ed_m­
<
T
, 
	gE
, 
	gpf_key_hash
<
	gT
>> 
	gm_li¡
;

112 
usšg
 
	gpf_m©ch_‹m¶©e
 = 
v_ba£_m­
<
BASE_PACKET_PACKET_MATCH_TYPE_t
, 
	gpf_m©ch_t
>;

113 
usšg
 
	gpf_aùiÚ_‹m¶©e
 = 
v_ba£_m­
<
BASE_PACKET_PACKET_ACTION_TYPE_t
, 
	gpf_aùiÚ_t
>;

114 
usšg
 
	gpf_pkt_©Œ
 = 
ndi_·ck‘_©Œ_t
;

117 şas 
	cpf_m©ch
 
	mfš®
 : 
public
 
pf_m©ch_‹m¶©e
 {

119 
public
:

120 
	$pf_m©ch
(): 
	$pf_m©ch_‹m¶©e
() {

121 
	`pf_m_š™_åŒ
();

124 
	$pf_m©ch
(cÚ¡ 
BASE_PACKET_PACKET_MATCH_TYPE_t
& 
t
, cÚ¡ 
pf_m©ch_t
& 
e
):

125 
	$pf_m©ch_‹m¶©e
(
t
, 
e
) {

126 
	`pf_m_š™_åŒ
();

127 
	}
};

129 
vœtu®
 
boŞ
 
	$add_’Œy
(
BASE_PACKET_PACKET_MATCH_TYPE_t
& 
t
, 
pf_m©ch_t
& 
e
è
ov”ride
;

131 
vœtu®
 
	$d–_’Œy
(
BASE_PACKET_PACKET_MATCH_TYPE_t
& 
t
è
ov”ride
 {

132 autØ
d_út
 = 
pf_m©ch_‹m¶©e
::
	`d–_’Œy
(
t
);

133 if(
d_út
è--
m_couÁ
;

134  
d_út
;

135 
	}
}

137 
vœtu®
 
g‘_’Œ›s
(
¡d
::
funùiÚ
< (
pf_m©ch_t
&)> 
â
ècÚ¡ 
ov”ride
 {

138 
pf_m©ch_‹m¶©e
::
g‘_’Œ›s
(
â
);

142 
pf_m_š™_åŒ
();

145 
šlše
 
boŞ
 
	$pf_m_šv_åŒ
(
BASE_PACKET_PACKET_MATCH_TYPE_t
 
ix
,

146 
ušt8_t
 *
pkt
, 
ušt32_t
 
Ën
, 
pf_pkt_©Œ
 *
p_©Œ
, 
pf_m©ch_t
& 
m_©Œ
) const {

147  (
this
->*
åŒ
[
ix
])(
pkt
, 
Ën
, 
p_©Œ
, 
m_©Œ
);

148 
	}
}

150 
	g´iv©e
:

152 
m_couÁ
=0;

155 
boŞ
 (
pf_m©ch
::*
åŒ
[
BASE_PACKET_PACKET_MATCH_TYPE_MAX
+1])

156 (
ušt8_t
 *, 
	gušt32_t
, 
	gpf_pkt_©Œ
 *, 
	gpf_m©ch_t
&) const;

159 
boŞ
 
	$pf_m_u¤_Œ­_id
(
ušt8_t
 *, 
ušt32_t
, 
pf_pkt_©Œ
 *, 
pf_m©ch_t
&) const;

160 
boŞ
 
	$pf_m_de¡_mac
(
ušt8_t
 *, 
ušt32_t
, 
pf_pkt_©Œ
 *, 
pf_m©ch_t
&) const;

161 
boŞ
 
	$pf_m_p£udo_â
(
ušt8_t
 *, 
ušt32_t
, 
pf_pkt_©Œ
 *, 
pf_m©ch_t
&) const;

162 
	}
};

165 şas 
	cpf_aùiÚ
 
	mfš®
 : 
public
 
pf_aùiÚ_‹m¶©e
 {

167 
public
:

168 
	$pf_aùiÚ
(): 
	$pf_aùiÚ_‹m¶©e
() {

169 
	`pf_a_š™_åŒ
();

172 
	$pf_aùiÚ
(cÚ¡ 
BASE_PACKET_PACKET_ACTION_TYPE_t
& 
t
, cÚ¡ 
pf_aùiÚ_t
& 
e
):

173 
	$pf_aùiÚ_‹m¶©e
(
t
, 
e
) {

174 
	`pf_a_š™_åŒ
();

175 
	}
};

177 
vœtu®
 
boŞ
 
	$add_’Œy
(
BASE_PACKET_PACKET_ACTION_TYPE_t
& 
t
, 
pf_aùiÚ_t
& 
e
è
ov”ride
;

179 
vœtu®
 
	$d–_’Œy
(
BASE_PACKET_PACKET_ACTION_TYPE_t
& 
t
è
ov”ride
 {

180 autØ
d_út
 = 
pf_aùiÚ_‹m¶©e
::
	`d–_’Œy
(
t
);

181 if(
d_út
è--
m_couÁ
;

182  
d_út
;

183 
	}
}

185 
vœtu®
 
g‘_’Œ›s
(
¡d
::
funùiÚ
< (
pf_aùiÚ_t
&)> 
â
ècÚ¡ 
ov”ride
 {

186 
pf_aùiÚ_‹m¶©e
::
g‘_’Œ›s
(
â
);

190 
pf_a_š™_åŒ
();

193 
šlše
 
boŞ
 
	$Œigg”_aùiÚ
(
ušt8_t
 *
pkt
, 
ušt32_t
 
Ën
, 
pf_pkt_©Œ
 *
p_©Œ
,

194 
pf_aùiÚ_t
& 
a_tv
 ) const {

195  
	`pf_a_šv_åŒ
(
a_tv
.
m_ty³
, 
pkt
, 
Ën
, 
p_©Œ
,‡_tv);

196 
	}
}

199 
šlše
 
boŞ
 
	$pf_a_šv_åŒ
(
BASE_PACKET_PACKET_ACTION_TYPE_t
 
ix
,

200 
ušt8_t
 *
pkt
, 
ušt32_t
 
Ën
, 
pf_pkt_©Œ
 *
p_©Œ
, 
pf_aùiÚ_t
& 
a_tv
) const {

201  (
this
->*
åŒ
[
ix
])(
pkt
, 
Ën
, 
p_©Œ
, 
a_tv
);

202 
	}
}

204 
	g´iv©e
:

206 
m_couÁ
=0;

209 
boŞ
 (
pf_aùiÚ
::*
åŒ
[
BASE_PACKET_PACKET_ACTION_TYPE_MAX
+1])

210 (
ušt8_t
 *, 
	gušt32_t
, 
	gpf_pkt_©Œ
 *, 
	gpf_aùiÚ_t
&) const;

213 
boŞ
 
	$pf_a_»dœeù_sock
(
ušt8_t
 *, 
ušt32_t
, 
pf_pkt_©Œ
 *, 
pf_aùiÚ_t
&) const;

214 
boŞ
 
	$pf_a_»dœeù_if
(
ušt8_t
 *, 
ušt32_t
, 
pf_pkt_©Œ
 *, 
pf_aùiÚ_t
&) const;

215 
boŞ
 
	$pf_a_p£udo_â
(
ušt8_t
 *, 
ušt32_t
, 
pf_pkt_©Œ
 *, 
pf_aùiÚ_t
&) const;

216 
	}
};

218 
usšg
 
	gpf_dœeùiÚ
 = 
BASE_PACKET_PACKET_DIRECTION_TYPE_t
;

221 şas 
	cpf_ruË
 
	mfš®
 {

223 
	mpublic
:

224 
	$pf_ruË
(
idx
 = 0):
	$id_
(
idx
) { };

226 
	$pf_ruË
(
idx
, 
pf_m©ch_t
& 
pfm
, 
pf_aùiÚ_t
& 
pç
):

227 
	`id_
(
idx
), 
	`m©ch_l¡_
(
pfm
.
m_ty³
,…fm), 
	$aùiÚ_l¡_
(
pç
.
m_ty³
,…fa) {

228 
	}
}

230 
šlše
 
	$pf_r_£t_¡İ
 (
boŞ
 
¡
è{ 
¡İ
 = st; 
	}
}

232 
šlše
 
boŞ
 
	$pf_r_g‘_¡İ
 (ècÚ¡ {  
¡İ
; 
	}
}

234 
šlše
 
	$pf_r_£t_dœ
 (
pf_dœeùiÚ
 
dœ
) {

235 
dœeùiÚ
 = 
dœ
;

236 
	}
}

238 
šlše
 
pf_dœeùiÚ
 
	$pf_r_g‘_dœ
 (ècÚ¡ {  
dœeùiÚ
; 
	}
}

241 
boŞ
 
pf_r_add_m©ch_·¿m
(
pf_m©ch_t
& 
æt
);

243 
pf_r_g‘_m©ch_·¿ms
(
¡d
::
funùiÚ
<(
pf_m©ch_t
&)> 
â
) const {

244 
m©ch_l¡_
.
g‘_’Œ›s
(
â
);

248 
boŞ
 
pf_r_add_aùiÚ_·¿m
(
pf_aùiÚ_t
& 
æt
);

250 
pf_r_g‘_aùiÚ_·¿ms
(
¡d
::
funùiÚ
<(
pf_aùiÚ_t
&)> 
â
) const {

251 
aùiÚ_l¡_
.
g‘_’Œ›s
(
â
);

254 
Çs_obj_id_t
 
	$pf_r_g‘_id
(ècÚ¡ {  
id_
; 
	}
}

257 
šlše
 
	$pf_r_£t_id
(
Çs_obj_id_t
 
id
è{ 
id_
 = id; 
	}
}

259 
šlše
 cÚ¡ 
	gpf_m©ch
& 
	$pf_r_g‘_m©ch_li¡
(è{  
m©ch_l¡_
; 
	}
}

261 
šlše
 cÚ¡ 
	gpf_aùiÚ
& 
	$pf_r_g‘_aùiÚ_li¡
(è{  
aùiÚ_l¡_
; 
	}
}

263 
	g´iv©e
:

265 
Çs_obj_id_t
 
id_
;

268 
pf_dœeùiÚ
 
	gdœeùiÚ
 = 
BASE_PACKET_PACKET_DIRECTION_TYPE_DIR_IN
;

271 
pf_m©ch
 
	gm©ch_l¡_
;

274 
pf_aùiÚ
 
	gaùiÚ_l¡_
;

277 
boŞ
 
	g¡İ
 = 
Œue
;

281 şas 
	cpf_bË
 {

283 
	mpublic
:

284 
	$pf_bË
() { };

287 
Çs_obj_id_t
 
	$pf_t_®loc_tid
 (è{ 
pf_tid
.
	`®loc_id
 ();
	}
}

288 
	$pf_t_»£rve_tid
 (
Çs_obj_id_t
 
tid
è{ 
pf_tid
.
	`»£rve_id
 (tid); 
	}
}

289 
	$pf_t_»Ëa£_tid
 (
Çs_obj_id_t
 
tid
è
nÛxû±
 { 
pf_tid
.
	`»Ëa£_id
 (tid); 
	}
}

292 
Çs_obj_id_t
 
pf_t_ü—‹_ruË
(
pf_dœeùiÚ
, 
pf_m©ch_t
&, 
pf_aùiÚ_t
&, 
boŞ
 
¡İ
);

293 
Çs_obj_id_t
 
pf_t_add_ruË
(
pf_dœeùiÚ
 
dœ
, 
pf_ruË
& 
ruË
);

294 
boŞ
 
pf_t_d–_ruË
(
Çs_obj_id_t
);

295 cÚ¡ 
pf_ruË
* 
	$pf_t_g‘_ruË
(
Çs_obj_id_t
è
nÛxû±
;

301 
ušt32_t
 
	$pf_t_g‘_šgr_couÁ
(è{  
šg»ss_ruËs
; 
	}
}

302 
ušt32_t
 
	$pf_t_g‘_egr_couÁ
(è{  
eg»ss_ruËs
; 
	}
}

305 
boŞ
 
pf_t_š_pkt_hndÌ
(
ušt8_t
 *, 
ušt32_t
, 
pf_pkt_©Œ
*);

306 
boŞ
 
pf_t_out_pkt_hndÌ
(
ušt8_t
 *, 
ušt32_t
, 
pf_pkt_©Œ
*);

308 
ä›nd
 
boŞ
 
pf_g’_”a£_id
(
¡d
::
veùÜ
<
pf_ruË
>&, 
Çs_obj_id_t
& );

309 
ä›nd
 cÚ¡ 
pf_ruË
* 
pf_g’_g‘_id
(cÚ¡ 
¡d
::
veùÜ
<pf_ruË>&, 
Çs_obj_id_t
& );

311 
	g´iv©e
:

312 cÚ¡ 
size_t
 
pf_max_id
 = 256;

315 
	g¡d
::
mu‹x
 
pf_mtx
;

318 
	gšg»ss_ruËs
 = 0;

319 
	geg»ss_ruËs
 = 0;

322 
	gÇs
::
id_g’”©Ü_t
 
pf_tid
 {
pf_max_id
};

325 
	g¡d
::
veùÜ
<
pf_ruË
> 
pf_šg»ss_bË
;

326 
	g¡d
::
veùÜ
<
pf_ruË
> 
pf_eg»ss_bË
;

	@inc/opx/nas_int_lag.h

22 #iâdeà
NAS_INT_LAG_H_


23 
	#NAS_INT_LAG_H_


	)

25 
	~"ds_commÚ_ty³s.h
"

26 
	~"Çs_ndi_commÚ.h
"

27 
	~<lim™s.h
>

29 #ifdeà
__ılu¥lus


33 
	#INVALID_LAG_ID
 
UINT_MAX


	)

45 
t_¡d_”rÜ
 
Çs_Ïg_ü—‹
(
Åu_id_t
 
Åu_id
, 
ndi_obj_id_t
 *
ndi_Ïg_id
);

60 
t_¡d_”rÜ
 
Çs_add_pÜt_to_Ïg
(
Åu_id_t
 
Åu_id
, 
ndi_obj_id_t
 
ndi_Ïg_id
,

61 
ndi_pÜt_t
 *
p_ndi_pÜt
,
ndi_obj_id_t
 *
ndi_Ïg_memb”_id
);

72 
t_¡d_”rÜ
 
Çs_d–_pÜt_äom_Ïg
(
Åu_id_t
 
Åu_id
, 
ndi_obj_id_t
 
ndi_Ïg_memb”_id
);

84 
t_¡d_”rÜ
 
Çs_Ïg_d–‘e
(
Åu_id_t
 
Åu_id
, 
ndi_obj_id_t
 
ndi_Ïg_id
);

97 
t_¡d_”rÜ
 
Çs_£t_Ïg_memb”_©Œ
(
Åu_id_t
 
Åu_id
,
ndi_obj_id_t
 
ndi_Ïg_memb”_id
,

98 
boŞ
 
eg»ss_di§bË
);

111 
t_¡d_”rÜ
 
Çs_g‘_Ïg_memb”_©Œ
(
Åu_id_t
 
Åu_id
,
ndi_obj_id_t
 
ndi_Ïg_memb”_id
,

112 
boŞ
 *
eg»ss_di§bË
);

113 #ifdeà
__ılu¥lus


	@inc/opx/nas_int_lag_api.h

22 #iâdeà
NAS_INTF_LAG_API_H_


23 
	#NAS_INTF_LAG_API_H_


	)

25 
	~"ıs_­i_İ”©iÚ.h
"

26 
	~"ds_commÚ_ty³s.h
"

27 
	~"Çs_ndi_commÚ.h
"

28 
	~"¡d_mu‹x_lock.h
"

29 
	~"›tf-š‹rçûs.h
"

30 
	~"d–l-ba£-if-phy.h
"

32 
	~<¡dlib.h
>

33 
	~<¡ršg
>

34 
	~<unÜd”ed_m­
>

35 
	~<unÜd”ed_£t
>

38 
	#NAS_IFF_LAG_SLAVE
 0x800

	)

39 
	#NAS_IFF_LAG_MASTER
 0x400

	)

40 
	#NAS_IFF_UP
 0x1

	)

41 
	#NAS_IFF_RUNNING
 0x40

	)

43 
	#is_ma¡”
(
if_æags
è(if_æags&
NAS_IFF_LAG_MASTER
)

	)

44 
	#is_¦ave
(
if_æags
è(if_æags&
NAS_IFF_LAG_SLAVE
)

	)

45 
	#is_štf_up
(
if_æags
è(if_æags&
NAS_IFF_UP
)

	)

52 
	g¡d
::
	tunÜd”ed_£t
<
	th®_ifšdex_t
> 
	tÇs_Ïg_pÜt_li¡_t
;

54 
	g¡d
::
	tunÜd”ed_m­
<
	th®_ifšdex_t
,
	tboŞ
> 
	tÇs_Ïg_pÜt_İ”_¡©us_t
;

61 
	sÇs_Ïg_s
{

62 
h®_ifšdex_t
 
	mifšdex
;

63 
Çs_Ïg_id_t
 
	mÏg_id
;

64 
	m¡d
::
¡ršg
 
mac_addr
;

65 
Çs_Ïg_pÜt_li¡_t
 
	mpÜt_li¡
;

66 
Çs_Ïg_pÜt_İ”_¡©us_t
 
	mpÜt_İ”_li¡
;

67 
Çs_Ïg_pÜt_li¡_t
 
	mblock_pÜt_li¡
;

73 
ndi_obj_id_t
 
	mndi_Ïg_id
;

74 
boŞ
 
	madmš_¡©us
;

75 
	mÇme
[
HAL_IF_NAME_SZ
];

76 
BASE_IF_PHY_MAC_LEARN_MODE_t
 
	mmac_Ë¬n_mode
;

77 
boŞ
 
	mmac_Ë¬n_mode_£t
 = 
çl£
;

78 
boŞ
 
	mİ”_¡©us
 = 
çl£
;

79 }
	tÇs_Ïg_ma¡”_šfo_t
;

81 
usšg
 
	gma¡”_ifšdex
 = 
h®_ifšdex_t
 ;

87 
usšg
 
	gÇs_Ïg_ma¡”_bË_t
 = 
¡d
::
unÜd”ed_m­
 <
ma¡”_ifšdex
, 
	gÇs_Ïg_ma¡”_šfo_t
> ;

101 
t_¡d_”rÜ
 
Çs_Ïg_ma¡”_add
(
h®_ifšdex_t
 
šdex
,cÚ¡ *
if_Çme
,
Çs_Ïg_id_t
 
Ïg_id
);

111 
t_¡d_”rÜ
 
Çs_Ïg_ma¡”_d–‘e
(
h®_ifšdex_t
 
šdex
);

125 
t_¡d_”rÜ
 
Çs_Ïg_memb”_add
(
h®_ifšdex_t
 
Ïg_ma¡”_id
,h®_ifšdex_ˆ
if_šdex
);

139 
t_¡d_”rÜ
 
Çs_Ïg_memb”_d–‘e
(
h®_ifšdex_t
 
Ïg_ma¡”_id
,h®_ifšdex_ˆ
if_šdex
);

144 
boŞ
 
Çs_Ïg_if_pÜt_is_Ïg_memb”
(
h®_ifšdex_t
 
Ïg_ma¡”_id
, h®_ifšdex_ˆ
ifšdex
);

149 
t_¡d_”rÜ
 
Çs_š™_Ïg
();

157 
¡d_mu‹x_ty³_t
 *
Çs_Ïg_mu‹x_lock
();

160 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_g‘_Ïg_node
(
h®_ifšdex_t
 
šdex
);

161 
	gÇs_Ïg_ma¡”_bË_t
 & 
Çs_g‘_Ïg_bË
();

162 
t_¡d_”rÜ
 
Çs_Ïg_£t_desc
(
h®_ifšdex_t
 
šdex
,cÚ¡ *
desc
);

163 
t_¡d_”rÜ
 
Çs_Ïg_£t_mac
(
h®_ifšdex_t
 
šdex
,cÚ¡ *
Ïg_mac
);

164 
t_¡d_”rÜ
 
Çs_Ïg_£t_admš_¡©us
(
h®_ifšdex_t
 
šdex
, 
boŞ
 
’abË
);

165 
t_¡d_”rÜ
 
Çs_Ïg_block_pÜt
(
Çs_Ïg_ma¡”_šfo_t
 *
p_Ïg_šfo
 ,
h®_ifšdex_t
 
¦ave_ifšdex
,
boŞ
 
block_¡©e
);

166 
t_¡d_”rÜ
 
Çs_Ïg_g‘_pÜt_mode
(
h®_ifšdex_t
 
¦ave_ifšdex
,
boŞ
& 
block_¡©e
);

167 
t_¡d_”rÜ
 
Çs_Ïg_g‘_admš_¡©us
(
h®_ifšdex_t
 
šdex
, 
boŞ
 
’abË
);

168 
t_¡d_”rÜ
 
Çs_Ïg_g‘_İ”_¡©us
(
h®_ifšdex_t
 
šdex
, 
boŞ
 
’abË
);

169 
h®_ifšdex_t
 
Çs_g‘_ma¡”_idx
(h®_ifšdex_ˆ
ifšdex
);

170 
Çs_ıs_hªdË_mac_£t
 (cÚ¡ *
Ïg_Çme
, 
h®_ifšdex_t
 
Ïg_šdex
);

172 
ıs_­i_»tuº_code_t
 
Ïg_objeù_publish
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
,
h®_ifšdex_t
 
Ïg_idx
,

173 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
);

175 
t_¡d_”rÜ
 
Çs_Ïg_g‘_ndi_Ïg_id
(
h®_ifšdex_t
 
Ïg_šdex
, 
ndi_obj_id_t
 *
ndi_Ïg_id
);

178 (*
	tÏg_İ”_¡©e_hªdËr_t
è(
	th®_ifšdex_t
 
	tif_idx
, 
	tIF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
	tİ”_¡©e
);

180 
	`Çs_Ïg_İ”_¡©e_»gi¡”_cb
(
Ïg_İ”_¡©e_hªdËr_t
 
İ”_¡©e_cb
);

181 
	`Çs_Ïg_upd©e_ma¡”_İ”_¡©e
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
, 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
İ”_¡©e
);

	@inc/opx/nas_int_lag_cps.h

23 #iâdeà
NAS_INT_LAG_CPS_H_


24 
	#NAS_INT_LAG_CPS_H_


	)

26 
	~"¡d_”rÜ_codes.h
"

27 
	~"ıs_­i_İ”©iÚ.h
"

28 #ifdeà
__ılu¥lus


38 
t_¡d_”rÜ
 
Çs_ıs_Ïg_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
);

41 #ifdeà
__ılu¥lus


	@inc/opx/nas_int_list.h

22 #iâdeà
NAS_LINK_H_


23 
	#NAS_LINK_H_


	)

25 
	~"¡d_Îi¡.h
"

26 
	~"ds_commÚ_ty³s.h
"

27 
	~"Çs_ndi_commÚ.h
"

29 
	~<¡dlib.h
>

31 #ifdeà
__ılu¥lus


35 
	sÇs_li¡_s
 {

36 
¡d_dÎ_h—d
 
pÜt_li¡
;

37 
pÜt_couÁ
;

38 } 
	tÇs_li¡_t
;

40 
	sÇs_li¡_node_s
 {

41 
¡d_dÎ
 
’Œy
;

42 
h®_ifšdex_t
 
ifšdex
;

43 
ndi_pÜt_t
 
ndi_pÜt
;

44 } 
	tÇs_li¡_node_t
;

47 
Çs_li¡_node_t
 *
Çs_g‘_fœ¡_lšk_node
(
¡d_dÎ_h—d
 *
p_lšk_node_li¡
);

49 
Çs_li¡_node_t
 *
Çs_g‘_Ãxt_lšk_node
(
¡d_dÎ_h—d
 *
p_lšk_node_li¡
,

50 
Çs_li¡_node_t
 *
p_lšk_node
);

52 
Çs_li¡_node_t
 *
Çs_g‘_lšk_node
(
¡d_dÎ_h—d
 *
p_lšk_node_li¡
,

53 
h®_ifšdex_t
 
šdex
);

55 
Çs_š£¹_lšk_node
(
¡d_dÎ_h—d
 *
p_lšk_node_li¡
,

56 
Çs_li¡_node_t
 *
p_lšk_node
);

58 
Çs_d–‘e_lšk_node
(
¡d_dÎ_h—d
 *
p_lšk_node_li¡
,

59 
Çs_li¡_node_t
 *
p_lšk_node
);

61 
Çs_d–‘e_pÜt_li¡
(
Çs_li¡_t
 *
p_lšk_node_li¡
);

63 #ifdeà
__ılu¥lus


	@inc/opx/nas_int_logical.h

23 #iâdeà
NAS_INTERFACE_INC_NAS_INT_LOGICAL_H_


24 
	#NAS_INTERFACE_INC_NAS_INT_LOGICAL_H_


	)

26 
t_¡d_”rÜ
 
Çs_št_logiÿl_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
) ;

	@inc/opx/nas_int_physical_cps.h

23 #iâdeà
NAS_INTERFACE_INC_NAS_INT_CPS_H_


24 
	#NAS_INTERFACE_INC_NAS_INT_CPS_H_


	)

26 
	~"¡d_”rÜ_codes.h
"

27 
	~"ıs_­i_İ”©iÚ.h
"

28 #ifdeà
__ılu¥lus


38 
t_¡d_”rÜ
 
Çs_št_ıs_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
);

41 #ifdeà
__ılu¥lus


	@inc/opx/nas_int_port.h

23 #iâdeà
NAS_INTERFACE_INC_NAS_INT_PORT_H_


24 
	#NAS_INTERFACE_INC_NAS_INT_PORT_H_


	)

26 
	~"Çs_ndi_pÜt.h
"

27 
	~"h®_if_m­pšg.h
"

29 
šlše
 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
	$ndi_to_ıs_İ”_ty³
(
ndi_pÜt_İ”_¡©us_t
 
ndi
) {

31  
ndi
 =ğ
ndi_pÜt_OPER_DOWN
 ?

32 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
 : 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
;

33 
	}
}

35 #ifdeà
__ılu¥lus


38 
t_¡d_”rÜ
 
Çs_št_pÜt_ü—‹_m­³d
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, cÚ¡ *
Çme
, 
Çs_št_ty³_t
 
ty³
);

39 
t_¡d_”rÜ
 
Çs_št_pÜt_ü—‹_unm­³d
(cÚ¡ *
Çme
, 
Çs_št_ty³_t
 
ty³
);

40 
t_¡d_”rÜ
 
Çs_št_pÜt_d–‘e
(cÚ¡ *
Çme
);

42 
Çs_št_pÜt_lšk_chªge
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,

43 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©e
);

45 
boŞ
 
Çs_št_pÜt_id_u£d
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
);

47 
boŞ
 
Çs_št_pÜt_Çme_u£d
(cÚ¡ *
Çme
);

49 
t_¡d_”rÜ
 
Çs_št_pÜt_š™
();

51 
boŞ
 
Çs_št_pÜt_ifšdex
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
h®_ifšdex_t
 *
ifšdex
);

53 
t_¡d_”rÜ
 
Çs_št_upd©e_Åu_pÜt
(cÚ¡ *
Çme
, 
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,

54 
boŞ
 
cÚÃù
);

56 
t_¡d_”rÜ
 
upd©e_if_Œack”
(cÚ¡ *
Çme
, 
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
boŞ
 
cÚÃù
);

58 #ifdeà
__ılu¥lus


	@inc/opx/nas_int_utils.h

22 #iâdeà
NAS_INT_UTILS_H_


23 
	#NAS_INT_UTILS_H_


	)

25 
	~"Çs_ndi_commÚ.h
"

26 
	~"¡d_uts.h
"

27 
	~"h®_if_m­pšg.h
"

28 
	~"¡d_”rÜ_codes.h
"

29 
	~"ds_commÚ_ty³s.h
"

31 
	~<¡ddef.h
>

33 #ifdeà
__ılu¥lus


37 
Çs_št_Çme_to_if_šdex
(
h®_ifšdex_t
 *
if_šdex
, cÚ¡ *
Çme
);

38 
t_¡d_”rÜ
 
Çs_št_g‘_Åu_pÜt
(
h®_ifšdex_t
 
pÜt_šdex
, 
ndi_pÜt_t
 *
ndi_pÜt
);

40 
t_¡d_”rÜ
 
Çs_št_g‘_if_šdex_to_Çme
(
h®_ifšdex_t
 
if_šdex
, * 
Çme
, 
size_t
 
Ën
);

41 
t_¡d_”rÜ
 
Çs_g‘_št_ty³
(
h®_ifšdex_t
 
šdex
, 
Çs_št_ty³_t
 *
ty³
);

42 
t_¡d_”rÜ
 
Çs_št_g‘_if_šdex_äom_Åu_pÜt
(
h®_ifšdex_t
 *
pÜt_šdex
, 
ndi_pÜt_t
 *
ndi_pÜt
);

43 
Çs_štf_to_Åu_pÜt_m­_dump
(
¡d_·r£d_¡ršg_t
 
hªdË
);

44 
Çs_sh–l_commªd_š™
();

45 
t_¡d_”rÜ
 
Çs_št_g‘_phy_¥“d
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
BASE_IF_SPEED_t
* 
¥“d
);

47 
boŞ
 
Çs_is_nÚ_Åu_phy_pÜt
(
h®_ifšdex_t
 
if_šdex
);

48 
t_¡d_”rÜ
 
Çs_g‘_if_ty³_äom_Çme_Ü_ifšdex
 (cÚ¡ *
if_Çme
, 
h®_ifšdex_t
 *
ifšdex
, 
Çs_št_ty³_t
 *
ty³
);

49 #ifdeà
__ılu¥lus


	@inc/opx/nas_int_vlan.h

21 #iâdeà
NAS_INTF_VLAN_H_


22 
	#NAS_INTF_VLAN_H_


	)

24 
	~"ds_commÚ_ty³s.h
"

25 
	~"Çs_ndi_commÚ.h
"

26 
	~"¡d_”rÜ_codes.h
"

27 
	~"ıs_­i_İ”©iÚ.h
"

28 
	~"Çs_št_bridge.h
"

29 
	~"Çs_št_com_uts.h
"

30 
	~<¡dboŞ.h
>

32 
	#MIN_VLAN_ID
 1

	)

33 
	#MAX_VLAN_ID
 4094

	)

35 
t_¡d_”rÜ
 
Çs_vÏn_g‘_deçuÉ_šfo
(
ıs_­i_objeù_li¡_t
 
li¡
);

37 
t_¡d_”rÜ
 
Çs_vÏn_ü—‹
(
Åu_id_t
 
Åu_id
, 
h®_vÏn_id_t
 
vÏn_id
);

39 
t_¡d_”rÜ
 
Çs_add_pÜt_to_vÏn
(
Åu_id_t
 
Åu_id
, 
h®_vÏn_id_t
 
vÏn_id
,

40 
ndi_pÜt_t
 *
p_ndi_pÜt
, 
boŞ
 
gged_pÜt
);

42 
t_¡d_”rÜ
 
Çs_d–_pÜt_äom_vÏn
(
Åu_id_t
 
Åu_id
, 
h®_vÏn_id_t
 
vÏn_id
, \

43 
ndi_pÜt_t
 *
p_ndi_pÜt
, 
Çs_pÜt_mode_t
 
pÜt_mode
);

44 
boŞ
 
Çs_ck_pÜt_exi¡
(
h®_vÏn_id_t
 
vÏn_id
, 
h®_ifšdex_t
 
pÜt_šdex
);

45 
t_¡d_”rÜ
 
Çs_vÏn_d–‘e
(
Åu_id_t
 
Åu_id
, 
h®_vÏn_id_t
 
vÏn_id
);

46 
Çs_·ck_vÏn_if
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
);

48 
t_¡d_”rÜ
 
Çs_d–‘e_Ïg_äom_vÏn_š_Åu
(
h®_ifšdex_t
 
ifšdex
 ,
h®_vÏn_id_t
 
vid
,

49 
Çs_pÜt_mode_t
 
pÜt_mode
);

50 
t_¡d_”rÜ
 
Çs_´oûss_Ïg_fÜ_vÏn_d–
(
Çs_li¡_t
 *
p_li¡
,

51 
h®_ifšdex_t
 
if_šdex
);

52 
ıs_­i_»tuº_code_t
 
Çs_ıs_£t_vÏn_mac
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
);

65 
Çs_´oûss_d–_vÏn_mem_äom_os
(
h®_ifšdex_t
 
br_ifšdex
, 
Çs_pÜt_li¡_t
 &
pÜt_li¡
,

66 
Çs_pÜt_mode_t
 
pÜt_mode
);

81 
Çs_´oûss_add_vÏn_mem_äom_os
(
h®_ifšdex_t
 
bridge_id
, 
Çs_pÜt_li¡_t
 &
pÜt_li¡
,

82 
h®_vÏn_id_t
 
vÏn_id
, 
Çs_pÜt_mode_t
 
pÜt_mode
);

84 
t_¡d_”rÜ
 
Çs_ıs_vÏn_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
);

97 
Çs_li¡_node_t
 *
Çs_ü—‹_vÏn_pÜt_node
(
Çs_bridge_t
 *
p_bridge_node
,

98 
h®_ifšdex_t
 
ifšdex
,

99 
Çs_pÜt_mode_t
 
pÜt_mode
,

100 
boŞ
 *
ü—‹_æag
);

107 
t_¡d_”rÜ
 
Çs_ü—‹_deçuÉ_vÏn
();

116 
t_¡d_”rÜ
 
Çs_vÏn_g‘_®l_šfo
(
ıs_­i_objeù_li¡_t
 
li¡
);

127 
t_¡d_”rÜ
 
Çs_g‘_vÏn_štf
(cÚ¡ *
if_Çme
, 
h®_ifšdex_t
 
ifšdex
, 
ıs_­i_objeù_li¡_t
 
li¡
, 
boŞ
 
g‘_¡©e
);

129 
t_¡d_”rÜ
 
Çs_g‘_vÏn_štf_äom_vid
(
h®_vÏn_id_t
 
vid
, 
ıs_­i_objeù_li¡_t
 
li¡
, 
boŞ
 
g‘_¡©e
);

130 
t_¡d_”rÜ
 
Çs_»gi¡”_vÏn_štf
(
Çs_bridge_t
 *
p_bridge
, 
h®_štf_»g_İ_ty³_t
 
İ
);

131 
ıs_­i_»tuº_code_t
 
Çs_publish_vÏn_objeù
(
Çs_bridge_t
 *
p_bridge_node
, 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
);

133 
t_¡d_”rÜ
 
Çs_add_Ü_d–_pÜt_to_vÏn
(
Åu_id_t
 
Åu_id
, 
h®_vÏn_id_t
 
vÏn_id
,

134 
ndi_pÜt_t
 *
p_ndi_pÜt
, 
Çs_pÜt_mode_t
 
pÜt_mode
,

135 
boŞ
 
add_pÜt
, 
h®_ifšdex_t
 
ifšdex
);

137 
t_¡d_”rÜ
 
Çs_ıs_add_pÜt_to_os
(
h®_ifšdex_t
 
br_šdex
, 
h®_vÏn_id_t
 
vÏn_id
,

138 
Çs_pÜt_mode_t
 
pÜt_mode
, 
h®_ifšdex_t
 
pÜt_idx
,
ušt32_t
 
mtu
,

139 
BASE_IF_MODE_t
 
mode
);

141 
t_¡d_”rÜ
 
Çs_Ïg_add_d–_vÏn_upd©e
(
h®_ifšdex_t
 
Ïg_šdex
, 
h®_vÏn_id_t
,

142 
Çs_pÜt_mode_t
 
pÜt_mode
, 
boŞ
 
add_æag
);

144 
t_¡d_”rÜ
 
Çs_hªdË_Ïg_add_to_vÏn
(
Çs_bridge_t
 *
p_bridge
, 
h®_ifšdex_t
 
Ïg_šdex
,

145 
Çs_pÜt_mode_t
 
pÜt_mode
, 
boŞ
 
ıs_add
, 
vÏn_rŞl_bk_t
 *
rŞl_bk
);

146 
t_¡d_”rÜ
 
Çs_hªdË_Ïg_d–_äom_vÏn
(
Çs_bridge_t
 *
p_bridge
, 
h®_ifšdex_t
 
Ïg_šdex
,

147 
Çs_pÜt_mode_t
 
pÜt_mode
, 
boŞ
 
ıs_d–
 ,
vÏn_rŞl_bk_t
 *
rŞl_bk
);

149 
t_¡d_”rÜ
 
Çs_ıs_d–_pÜt_äom_os
(
h®_vÏn_id_t
 
vÏn_id
, 
h®_ifšdex_t
 
pÜt_šdex
,

150 
Çs_pÜt_mode_t
 
pÜt_mode
, 
BASE_IF_MODE_t
 
vÏn_mode
);

152 
t_¡d_”rÜ
 
Çs_d–_gged_Ïg_štf
(
h®_ifšdex_t
 
Ïg_šdex
, 
h®_vÏn_id_t
 
vÏn_id
);

153 
ıs_­i_»tuº_code_t
 
Çs_publish_vÏn_pÜt_li¡
(
Çs_bridge_t
 *
p_bridge_node
, 
Çs_pÜt_li¡_t
 &
pÜt_li¡
,

154 
Çs_pÜt_mode_t
 
pÜt_mode
, 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
);

155 
Çs_hªdË_bridge_mac
(
Çs_bridge_t
 *
²ode
);

156 
t_¡d_”rÜ
 
Çs_deçuÉ_vÏn_ÿche_š™
();

157 
boŞ
 
Çs_£t_vÏn_memb”_pÜt_mtu
(
h®_ifšdex_t
 
ifšdex
, 
ušt32_t
 
mtu
, 
h®_vÏn_id_t
 
vÏn_id
);

158 
t_¡d_”rÜ
 
Çs_hªdË_Ïg_šdex_š_ıs_£t
(
Çs_bridge_t
 *
p_bridge
, 
Çs_pÜt_li¡_t
 &
pÜt_šdex_li¡
,

159 
Çs_pÜt_mode_t
 
pÜt_mode
, 
vÏn_rŞl_bk_t
 *
rŞl_bk
);

160 
t_¡d_”rÜ
 
Çs_add_Ü_d–_Ïg_š_vÏn
(
h®_ifšdex_t
 
Ïg_šdex
, 
h®_vÏn_id_t
 
vÏn_id
,

161 
Çs_pÜt_mode_t
 
pÜt_mode
, 
boŞ
 
add_æag
, boŞ 
rŞl_bk
);

	@inc/opx/nas_interface_fc.h

22 #iâdeà
NAS_INTF_FC_H_


23 
	#NAS_INTF_FC_H_


	)

25 
	~"Çs_ndi_commÚ.h
"

26 
	~"¡d_”rÜ_codes.h
"

27 
	~"ıs_­i_İ”©iÚ.h
"

28 
	~"Çs_št_com_uts.h
"

32 
ıs_­i_»tuº_code_t
 
Çs_ıs_£t_fc_©Œ
(
Åu_id_t
 
Åu_id
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
, cps_­i_objeù_ˆ
´ev
);

33 
ıs_­i_»tuº_code_t
 
Çs_ıs_g‘_fc_©Œ
(* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 *
·¿m
,

34 
size_t
 
ix
);

35 
ıs_­i_»tuº_code_t
 
Çs_ıs_ü—‹_fc_pÜt
(
Åu_id_t
 
Åu_id
, 
pÜt_t
 
pÜt
, 
BASE_IF_SPEED_t
 
¥“d
,

36 
ušt32_t
 *
hw_pÜt_li¡
, 
size_t
 
couÁ
);

37 
ıs_­i_»tuº_code_t
 
Çs_ıs_d–‘e_fc_pÜt
(
Åu_id_t
 
Åu_id
, 
pÜt_t
 
pÜt
);

40 
Çs_fc_fl_¥“d_autÚeg_¡©e
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
);

41 
Çs_fc_fl_suµÜ‹d_¥“d
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
);

42 
Çs_fc_fl_štf_©Œ
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
);

43 
Çs_fc_fl_misc_¡©e
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
);

	@inc/opx/nas_packet_filter.h

23 #iâdeà
NAS_PACKET_FILTER_H_


24 
	#NAS_PACKET_FILTER_H_


	)

26 
	~"d–l-ba£-·ck‘.h
"

27 
	~"ds_commÚ_ty³s.h
"

28 
	~"¡d_ty³_defs.h
"

29 
	~"¡d_”rÜ_codes.h
"

30 
	~"Çs_ndi_commÚ.h
"

31 
	~"¡d_sock‘_toŞs.h
"

33 #ifdeà
__ılu¥lus


37 
	u_pf_m©ch_v®ue_t
{

38 
h®_mac_addr_t
 
mac
;

39 
h®__addr_t
 

;

40 
ndi_pÜt_t
 
ndi_pÜt
;

41 
ndi_pÜt_li¡_t
 
ndi_pÜi¡
;

42 
ušt64_t
 
u64
;

43 
ušt32_t
 
u32
;

44 } 
	tpf_m©ch_v®ue_t
;

46 
	s_pf_m©ch_t
 {

47 
BASE_PACKET_PACKET_MATCH_TYPE_t
 
m_ty³
;

48 
pf_m©ch_v®ue_t
 
m_v®
;

49 }
	tpf_m©ch_t
;

51 
	u_pf_aù_v®ue_t
{

52 
h®__addr_t
 

;

53 
ndi_pÜt_t
 
ndi_pÜt
;

54 
ušt64_t
 
u64
;

55 
ušt32_t
 
u32
;

56 
¡d_sock‘_add»ss_t
 
sock_addr
;

57 } 
	tpf_aù_v®ue_t
;

59 
	s_pf_aùiÚ_t
 {

60 
BASE_PACKET_PACKET_ACTION_TYPE_t
 
m_ty³
;

61 
pf_aù_v®ue_t
 
m_v®
;

62 }
	tpf_aùiÚ_t
;

69 
Çs_pf_š™Ÿlize
 ();

76 
boŞ
 
Çs_pf_šgr_’abËd
 ();

83 
boŞ
 
Çs_pf_egr_’abËd
 ();

92 
boŞ
 
Çs_pf_š_pkt_hndÌ
(
ušt8_t
 *
pkt
, 
ušt32_t
 
pkt_Ën
, 
ndi_·ck‘_©Œ_t
 *
p_©Œ
);

101 
boŞ
 
Çs_pf_out_pkt_hndÌ
(
ušt8_t
 *
pkt
, 
ušt32_t
 
pkt_Ën
, 
ndi_·ck‘_©Œ_t
 *
p_©Œ
);

108 
t_¡d_”rÜ
 
Çs_pf_ıs_wr™e
(
ıs_­i_objeù_t
 
obj
);

116 
t_¡d_”rÜ
 
Çs_pf_ıs_»ad
(
ıs_­i_objeù_t
 
ft
, cps_­i_objeù_ˆ
obj
);

118 #ifdeà
__ılu¥lus


	@inc/opx/nas_packet_meta.h

25 #iâdeà
_NAS_PACKET_META_H_


26 
	#_NAS_PACKET_META_H_


	)

28 
	~"¡d_v.h
"

29 
	~"¡d_ty³_defs.h
"

31 #ifdeà
__ılu¥lus


39 * 
	tÇs_pkt_m‘a_©Œ_±r_t
;

45 
NAS_PKT_META_RX_PORT
,

47 
NAS_PKT_META_TX_PORT
,

49 
NAS_PKT_META_SAMPLE_COUNT
,

51 
NAS_PKT_META_PKT_LEN
,

53 
NAS_PKT_META_TRAP_ID
,

54 } 
	tÇs_pkt_m‘a_©Œ_ty³_t
;

59 
	s_Çs_pkt_m‘a_©Œ_™_s
 {

60 
Çs_pkt_m‘a_©Œ_±r_t
 
©Œ
;

61 
size_t
 
Ën
;

62 
ušt8_t
* 
¡¬t
;

63 } 
	tÇs_pkt_m‘a_©Œ_™_t
;

89 
boŞ
 
Çs_pkt_m‘a_™_begš
 (
ušt8_t
* 
buf
, 
Çs_pkt_m‘a_©Œ_™_t
* 
™
);

97 
šlše
 
boŞ
 
Çs_pkt_m‘a_™_Ãxt
 (
Çs_pkt_m‘a_©Œ_™_t
* 
™
) {

98 
™
->
©Œ
 = 
¡d_v_Ãxt
 (™->©Œ, &™->
Ën
);

99  
™
->
©Œ
 !ğ
NULL
 && it->
Ën
!=0;

107 
šlše
 
boŞ
 
Çs_pkt_m‘a_™_v®id
 (
Çs_pkt_m‘a_©Œ_™_t
* 
™
) {

108  
¡d_v_v®id
(
™
->
©Œ
,™->
Ën
);

116 
ušt8_t
* 
Çs_pkt_d©a_off£t
 (ušt8_t* 
buf
);

123 
šlše
 
Çs_pkt_m‘a_©Œ_ty³_t
 
Çs_pkt_m‘a_©Œ_ty³
 (
Çs_pkt_m‘a_©Œ_±r_t
 
©Œ
) {

124  (
Çs_pkt_m‘a_©Œ_ty³_t
)
¡d_v_g
 (
©Œ
);

132 
šlše
 
size_t
 
Çs_pkt_m‘a_©Œ_Ën
(
Çs_pkt_m‘a_©Œ_±r_t
 
©Œ
) {

133  (
size_t
)
¡d_v_Ën
(
©Œ
);

141 
ušt_t
 
Çs_pkt_m‘a_©Œ_d©a_ušt
 (
Çs_pkt_m‘a_©Œ_±r_t
 
©Œ
);

148 
šlše
 * 
Çs_pkt_m‘a_©Œ_d©a_bš
 (
Çs_pkt_m‘a_©Œ_±r_t
 
©Œ
) {

149  
¡d_v_d©a
(
©Œ
);

162 
boŞ
 
Çs_pkt_m‘a_buf_š™
 (
ušt8_t
* 
buf
, 
size_t
 
buf_Ën
, 
Çs_pkt_m‘a_©Œ_™_t
* 
pos
);

173 
boŞ
 
Çs_pkt_m‘a_add_u32
 (
Çs_pkt_m‘a_©Œ_™_t
 *
pos
,

174 
Çs_pkt_m‘a_©Œ_ty³_t
 
ty³
, 
ušt32_t
 
v®
);

185 
boŞ
 
Çs_pkt_m‘a_add_u64
 (
Çs_pkt_m‘a_©Œ_™_t
 *
pos
,

186 
Çs_pkt_m‘a_©Œ_ty³_t
 
ty³
, 
ušt64_t
 
v®
);

188 #ifdeà
__ılu¥lus


	@inc/opx/nas_stats.h

22 #iâdeà
NAS_STATS_H_


23 
	#NAS_STATS_H_


	)

25 
	~"¡d_”rÜ_codes.h
"

26 
	~"ıs_­i_İ”©iÚ.h
"

27 
	~"Çs_ndi_¶©_¡©.h
"

30 #ifdeà
__ılu¥lus


34 
t_¡d_”rÜ
 
Çs_¡©s_if_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
);

36 
t_¡d_”rÜ
 
Çs_“e_¡©s_if_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
);

38 
t_¡d_”rÜ
 
Çs_¡©s_vÏn_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
);

40 
boŞ
 
Çs_¡©_g‘_ifšdex_äom_obj
(
ıs_­i_objeù_t
 
obj
,
h®_ifšdex_t
 *
šdex
,boŞ 
ş—r
);

42 
boŞ
 
Çs_¡©_g‘_Çme_äom_obj
(
ıs_­i_objeù_t
 
obj
, *
if_Çme
, 
size_t
 
Çme_sz
);

44 
boŞ
 
g‘_štf_¡©s_äom_os
ĞcÚ¡ *
Çme
, 
ıs_­i_objeù_li¡_t
 
li¡
);

46 
t_¡d_”rÜ
 
g‘_¡©_ids_Ën
(
Çs_¡©_ty³_t
 
ty³
, * 
Ën
);

47 
t_¡d_”rÜ
 
pÜt_¡©_li¡_g‘
(
ušt64_t
 * 
li¡
, *
Ën
);

48 
t_¡d_”rÜ
 
vÏn_¡©_li¡_g‘
(
ušt64_t
 *
li¡
, *
Ën
);

50 #ifdeà
__ılu¥lus


	@inc/opx/nas_vrf.h

22 #iâdeà
NAS_VRF_H_


23 
	#NAS_VRF_H_


	)

25 
	~"¡d_”rÜ_codes.h
"

26 
	~"ıs_­i_İ”©iÚ.h
"

28 
	#NAS_VRF_LOG_ERR
(
ID
, ...è
	`EV_LOGGING
(
VRF
, 
ERR
, ID, 
__VA_ARGS__
)

	)

29 
	#NAS_VRF_LOG_INFO
(
ID
, ...è
	`EV_LOGGING
(
VRF
, 
INFO
, ID, 
__VA_ARGS__
)

	)

30 
	#NAS_VRF_LOG_DEBUG
(
ID
, ...è
	`EV_LOGGING
(
VRF
, 
DEBUG
, ID, 
__VA_ARGS__
)

	)

32 
t_¡d_”rÜ
 
Çs_vrf_objeù_vrf_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
Çs_vrf_ıs_hªdË
 );

33 
t_¡d_”rÜ
 
Çs_vrf_objeù_vrf_štf_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
Çs_vrf_ıs_hªdË
 );

35 
t_¡d_”rÜ
 
Çs_vrf_´oûss_ıs_vrf_msg
(
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
, 
size_t
 
ix
);

36 
t_¡d_”rÜ
 
Çs_vrf_´oûss_ıs_vrf_štf_msg
(
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
, 
size_t
 
ix
);

37 
ıs_­i_»tuº_code_t
 
Çs_štf_bšd_vrf_½c_hªdËr
 (* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
, 
size_t
 
ix
);

38 
boŞ
 
Çs_vrf_upd©e_vrf_id
(cÚ¡ *
vrf_Çme
, boŞ 
is_add
);

39 
ıs_­i_»tuº_code_t
 
Çs_vrf_g‘_štf_šfo
(
ıs_­i_objeù_li¡_t
 
li¡
, cÚ¡ *
vrf_Çme
,

40 cÚ¡ *
if_Çme
);

41 
ıs_­i_»tuº_code_t
 
Çs_vrf_g‘_rou‹r_štf_šfo
(
ıs_­i_objeù_li¡_t
 
li¡
, cÚ¡ *
if_Çme
);

42 
t_¡d_”rÜ
 
Çs_vrf_ü—‹_publish_hªdË
();

	@inc/opx/nas_vrf_extn.h

21 #iâdeà
__NAS_VRF_EXTN_H


22 
	#__NAS_VRF_EXTN_H


	)

24 
	~"¡d_”rÜ_codes.h
"

26 #ifdeà
__ılu¥lus


38 
t_¡d_”rÜ
 
Çs_vrf_š™
();

40 #ifdeà
__ılu¥lus


	@inc/opx/plugins/interface_object_cache.h

21 #iâdeà
INTERFACE_OBJECT_CACHE_H_


22 
	#INTERFACE_OBJECT_CACHE_H_


	)

24 
	~"¡d_”rÜ_codes.h
"

25 
	~"ıs_­i_objeù.h
"

28 
	mif_obj_ÿche_T_PHY
=0,

29 
	mif_obj_ÿche_T_VLAN
=1,

30 
	mif_obj_ÿche_T_LAG
=2,

31 
	mif_obj_ÿche_T_OS
=3,

32 
	mif_obj_ÿche_T_MAX
=3,

33 } 
	tif_obj_ÿche_ty³s_t
;

35 
t_¡d_”rÜ
 
if_obj_ÿche_g‘
(
if_obj_ÿche_ty³s_t
 
ty³
,
ifšdex
, 
ıs_­i_objeù_t
 
obj
, 
boŞ
 
m”ge
);

36 
t_¡d_”rÜ
 
if_obj_ÿche_£t
(
if_obj_ÿche_ty³s_t
 
ty³
,
ifšdex
, 
ıs_­i_objeù_t
 
obj
);

37 
t_¡d_”rÜ
 
if_obj_ÿche_d–‘e
(
if_obj_ÿche_ty³s_t
 
ty³
,
ifšdex
, 
ıs_­i_objeù_t
 
obj
);

39 
t_¡d_”rÜ
 
if_obj_ÿche_w®k
(
if_obj_ÿche_ty³s_t
 
ty³
,
ifšdex
, 
ıs_­i_objeù_t
 
obj
);

41 
t_¡d_”rÜ
 
if_obj_ÿche_š™
();

	@inc/opx/plugins/interface_plugin_front_panel_port.h

21 #iâdeà
INTERFACE_PLUGIN_FRONT_PANEL_PORT_H_


22 
	#INTERFACE_PLUGIN_FRONT_PANEL_PORT_H_


	)

24 
	~"¶ugšs/š‹rçû_¶ugšs.h
"

26 şas 
	cFrÚtPª–PÜtD‘as
 : 
public
 
IÁ”çûPlugšExŠ
 {

27 
public
:

28 
vœtu®
 
t_¡d_”rÜ
 
š™
(
IÁ”çûPlugšSequ’ûr
 *
£q
);

29 
vœtu®
 
ıs_­i_»tuº_code_t
 
hªdË_£t
(
IÁ”çûPlugšSequ’ûr
::
£qu’ûr_»que¡_t
 &
»q
);

30 
vœtu®
 
ıs_­i_»tuº_code_t
 
hªdË_g‘
(
IÁ”çûPlugšSequ’ûr
::
£qu’ûr_»que¡_t
 &
»q
);

32 
	mvœtu®
 ~
FrÚtPª–PÜtD‘as
();

	@inc/opx/plugins/interface_plugin_linux.h

21 #iâdeà
INTERFACE_PLUGIN_LINUX_H_


22 
	#INTERFACE_PLUGIN_LINUX_H_


	)

25 
	~"¶ugšs/š‹rçû_¶ugšs.h
"

27 şas 
	cLšuxIÁ”çûPlugšExŠ
 : 
public
 
IÁ”çûPlugšExŠ
 {

28 
public
:

29 
vœtu®
 
t_¡d_”rÜ
 
š™
(
IÁ”çûPlugšSequ’ûr
 *
£q
);

30 
vœtu®
 
ıs_­i_»tuº_code_t
 
hªdË_£t
(
IÁ”çûPlugšSequ’ûr
::
£qu’ûr_»que¡_t
 &
»q
);

31 
vœtu®
 
ıs_­i_»tuº_code_t
 
hªdË_g‘
(
IÁ”çûPlugšSequ’ûr
::
£qu’ûr_»que¡_t
 &
»q
);

34 
	mvœtu®
 ~
LšuxIÁ”çûPlugšExŠ
();

	@inc/opx/plugins/interface_plugins.h

21 #iâdeà
INTERFACE_PLUGINS_H_


22 
	#INTERFACE_PLUGINS_H_


	)

24 
	~"ıs_­i_İ”©iÚ.h
"

26 
	~"¡d_rw_lock.h
"

27 
	~"¡d_mu‹x_lock.h
"

29 
	~"¡d_as£¹.h
"

32 
	~<unÜd”ed_m­
>

33 
	~<veùÜ
>

34 
	~<ut™y
>

36 
şass
 
	gIÁ”çûPlugšExŠ
;

38 şas 
	cIÁ”çûPlugšSequ’ûr
 {

39 
	mpublic
:

40 
Üd”s_t
 : { 
FIRST
=0,
	mHIGH
=1,
	mMED
=2,
	mLOW
=3,
	mORDER_MAX
=4 };

41 
	gİ”©iÚ_t
: { 
GET
=0, 
	gSET
=1, 
	gOPERATION_MAX
=2 };

43 
	s£qu’ûr_»que¡_t
 {

44 
ıs_­i_©Œ_id_t
 
	g_id
;

45 
size_t
 
	g_ix
;

46 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
	g_Œª
;

47 
ıs_­i_g‘_·¿ms_t
 *
	g_g‘
;

50 
IÁ”çûPlugšSequ’ûr
(cÚ¡ 
¡d
::
veùÜ
<
IÁ”çûPlugšExŠ
*> &
l
);

52 
t_¡d_”rÜ
 
š™
();

53 
t_¡d_”rÜ
 
£qu’û
(
İ”©iÚ_t
 
İ”
, 
£qu’ûr_»que¡_t
 &
»q
);

55 
boŞ
 
»g
(
İ”©iÚ_t
 
wh’
, 
Üd”s_t
 
wh”e_to_š£¹
, 
IÁ”çûPlugšExŠ
 *
wh©_to_š£¹
);

57 
	g´Ùeùed
:

58 
¡d_rw_lock_t
 
_lock
;

59 cÚ¡ 
	g¡d
::
veùÜ
<
IÁ”çûPlugšExŠ
*> &
_»gs
;

60 
	g¡d
::
veùÜ
<
IÁ”çûPlugšExŠ
*> 
_İ_m­
[
OPERATION_MAX
][
ORDER_MAX
];

64 şas 
	cIÁ”çûPlugšExŠ
 {

65 
	m´Ùeùed
:

66 
¡d
::
unÜd”ed_m­
<
ıs_­i_©Œ_id_t
,
	m¡d
::unÜd”ed_m­<,
	mıs_­i_objeù_t
>> 
	m_obj_m­
;

67 
¡d_mu‹x_ty³_t
 
	m_lock
;

68 
	mpublic
:

69 
IÁ”çûPlugšExŠ
();

70 
vœtu®
 
t_¡d_”rÜ
 
š™
(
IÁ”çûPlugšSequ’ûr
 *
£q
);

71 
vœtu®
 
ıs_­i_»tuº_code_t
 
hªdË_£t
(
IÁ”çûPlugšSequ’ûr
::
£qu’ûr_»que¡_t
 &
»q
);

72 
vœtu®
 
ıs_­i_»tuº_code_t
 
hªdË_g‘
(
IÁ”çûPlugšSequ’ûr
::
£qu’ûr_»que¡_t
 &
»q
);

74 
	mvœtu®
 ~
IÁ”çûPlugšExŠ
();

	@inc/opx/plugins/interface_utils.h

21 #iâdeà
INTERFACE_UTILS_H_


22 
	#INTERFACE_UTILS_H_


	)

25 
š‹rçû_ut_g‘_f‹r_d‘as
(
ıs_­i_objeù_t
 
obj
, cÚ¡ *&
Çme
,&
ifix
);

27 * 
š‹rçû_ut_g‘_©Œ
(
ıs_­i_objeù_t
 
obj
, 
ıs_­i_©Œ_id_t
 
id
);

30 
t_¡d_”rÜ
 
š‹rçû_lßd_ıs_objeù
(
ıs_­i_©Œ_id_t
 
id
, 
ıs_­i_objeù_li¡_t
 &
l¡
, 
»Œy
=0);

31 
t_¡d_”rÜ
 
š‹rçû_lßd_ıs_objeù
(
ıs_­i_objeù_t
 
obj
, 
ıs_­i_objeù_li¡_t
 &
l¡
, 
»Œy
=0);

33 
boŞ
 
š‹rçû_ut_obj_g‘_ušt32
(
ıs_­i_objeù_t
 
obj
,
ıs_­i_©Œ_id_t
 
id
, 
ušt32_t
 &
v®
);

	@inc/opx/swp_util_tap.h

22 #iâdeà
_SWP_UTIL_TAP_H


23 
	#_SWP_UTIL_TAP_H


	)

25 #ifdeà
__ılu¥lus


29 
	~<sys/£Ëù.h
>

31 
	~"ev’t_log.h
"

32 
	~"¡d_”rÜ_codes.h
"

33 
	~"ds_commÚ_ty³s.h
"

35 
	~<¡dboŞ.h
>

37 
	#SWP_UTIL_INV_FD
 (-1)

	)

38 
	#SWP_UTIL_TYPE_UNDEF
 0

	)

39 
	#SWP_UTIL_TYPE_TAP
 1

	)

40 
	#SWP_UTIL_TYPE_TUN
 2

	)

43 
_swp_ut_p_desü
 *
	tswp_ut_p_desü
;

49 
swp_ut_p_desü
 
swp_ut_®loc_desü
();

51 cÚ¡ * 
swp_ut_p_desü_g‘_Çme
(
swp_ut_p_desü
 
p
);

53 
swp_ut_p_desü_g‘_queue
(
swp_ut_p_desü
 
p
,
queue
);

55 
h®_ifšdex_t
 
swp_š™_p_ifšdex
(
swp_ut_p_desü
 
p
);

61 
swp_ut_ä“_desüs
(
swp_ut_p_desü
 
ps
);

70 
t_¡d_”rÜ
 
swp_ut_p_İ”©iÚ
(cÚ¡ * 
Çme
, 
ty³
, 
boŞ
 
ü—‹
);

79 
swp_ut_p_desü_š™_wÇme
(
swp_ut_p_desü
 
p
,

80 cÚ¡ *
n
,*
chas
, *
š¡
, 
pÜt_t
 *
pÜt
,…Üt_ˆ* 
subi
, 
queues
);

89 
t_¡d_”rÜ
 
swp_ut_®loc_p
(
swp_ut_p_desü
 
p
, 
ty³
);

97 
swp_ut_şo£_fds
(
swp_ut_p_desü
 
p
);

103 
swp_ut_´št_p
(
swp_ut_p_desü
 
p
);

109 
swp_ut_p_desü_š™
(
swp_ut_p_desü
 
p
);

116 
swp_ut_p_fd_£t_add
(
swp_ut_p_desü
 *
p
, 
desüs
, 
fd_£t
 *
£t
);

123 
swp_ut_p_fd_loÿ‹_äom_£t
(
swp_ut_p_desü
 
p
, 
fd_£t
 *
£t
);

124 
boŞ
 
swp_ut_p_is_fd_š_p_fd_£t
(
swp_ut_p_desü
 
p
, 
fd
);

126 #ifdeà
__ılu¥lus


	@src/lag/nas_int_lag.c

22 
	~"Çs_ndi_Ïg.h
"

23 
	~"Çs_št_Ïg.h
"

24 
	~"ev’t_log.h
"

25 
	~"¡d_”rÜ_codes.h
"

26 
	~<š‰y³s.h
>

28 
t_¡d_”rÜ
 
	$Çs_Ïg_ü—‹
(
Åu_id_t
 
Åu_id
,
ndi_obj_id_t
 *
ndi_Ïg_id
) {

29 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG","Creating‚di_lag_id in‚pu %d",

30 
Åu_id
);

31  
	`ndi_ü—‹_Ïg
(
Åu_id
, 
ndi_Ïg_id
);

32 
	}
}

34 
t_¡d_”rÜ
 
	$Çs_add_pÜt_to_Ïg
(
Åu_id_t
 
Åu_id
, 
ndi_obj_id_t
 
ndi_Ïg_id
,

35 
ndi_pÜt_t
 *
p_ndi_pÜt
,
ndi_obj_id_t
 *
ndi_Ïg_memb”_id
) {

36 
ndi_pÜt_li¡_t
 
ndi_pÜt_li¡
;

38 
ndi_pÜt_li¡
.
pÜt_couÁ
 = 1;

39 
ndi_pÜt_li¡
.
pÜt_li¡
 =
p_ndi_pÜt
;

41 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG","Addšg NAS…Üˆ<%d %d> %"
PRIx64
" ",

42 
p_ndi_pÜt
->
Åu_id
,…_ndi_pÜt->
Åu_pÜt
, 
ndi_Ïg_id
);

44  
	`ndi_add_pÜts_to_Ïg
(
Åu_id
, 
ndi_Ïg_id
, &
ndi_pÜt_li¡
,
ndi_Ïg_memb”_id
);

45 
	}
}

47 
t_¡d_”rÜ
 
	$Çs_d–_pÜt_äom_Ïg
(
Åu_id_t
 
Åu_id
,
ndi_obj_id_t
 
ndi_Ïg_memb”_id
) {

49 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "D–‘šg NAS Lag memb” ID %"
PRIx64
" ",

50 
ndi_Ïg_memb”_id
);

52  
	`ndi_d–_pÜts_äom_Ïg
(
Åu_id
,
ndi_Ïg_memb”_id
);

53 
	}
}

55 
t_¡d_”rÜ
 
	$Çs_Ïg_d–‘e
(
Åu_id_t
 
Åu_id
, 
ndi_obj_id_t
 
ndi_Ïg_id
) {

57 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "D–‘šg‚di_Ïg_id %"
PRIx64
" in‚pu %d",

58 
ndi_Ïg_id
, 
Åu_id
);

60  
	`ndi_d–‘e_Ïg
(
Åu_id
, 
ndi_Ïg_id
);

61 
	}
}

63 
t_¡d_”rÜ
 
	$Çs_£t_Ïg_memb”_©Œ
(
Åu_id_t
 
Åu_id
,
ndi_obj_id_t
 
ndi_Ïg_memb”_id
,

64 
boŞ
 
eg»ss_di§bË
) {

66 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG",

67 "Block/Unblock NAS…Üˆ<%d > %"
PRIx64
"ƒgress_disable %d ",

68 
Åu_id
, 
ndi_Ïg_memb”_id
, 
eg»ss_di§bË
);

70  
	`ndi_£t_Ïg_memb”_©Œ
(
Åu_id
,
ndi_Ïg_memb”_id
,
eg»ss_di§bË
);

71 
	}
}

73 
t_¡d_”rÜ
 
	$Çs_g‘_Ïg_memb”_©Œ
(
Åu_id_t
 
Åu_id
,
ndi_obj_id_t
 
ndi_Ïg_memb”_id
,

74 
boŞ
 *
eg»ss_di§bË
) {

76 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "Block/Unblock NAS…Üˆ<%d > %"
PRIx64
,

77 
Åu_id
,
ndi_Ïg_memb”_id
);

79  
	`ndi_g‘_Ïg_memb”_©Œ
(
Åu_id
,
ndi_Ïg_memb”_id
,
eg»ss_di§bË
);

80 
	}
}

	@src/lag/nas_int_lag_api.cpp

23 
	~"Çs_št_Ïg.h
"

24 
	~"h®_if_m­pšg.h
"

25 
	~"Çs_if_uts.h
"

26 
	~"Çs_št_Ïg_­i.h
"

27 
	~"¡d_mu‹x_lock.h
"

28 
	~"ev’t_log.h
"

29 
	~"¡d_uts.h
"

30 
	~"d–l-ba£-if-Ïg.h
"

31 
	~"d–l-ba£-if.h
"

32 
	~"d–l-š‹rçû.h
"

33 
	~"Çs_ndi_pÜt.h
"

34 
	~<£t
>

42 
h®_ifšdex_t
 
	mifšdex
;

43 
h®_ifšdex_t
 
	mma¡”_idx
;

44 
ndi_obj_id_t
 
	mndi_Ïg_memb”_id
;

45 }
	tÇs_Ïg_¦ave_šfo_t
;

47 
h®_ifšdex_t
 
	t¦ave_ifšdex
;

53 
usšg
 
	gÇs_Ïg_¦ave_bË_t
 = 
¡d
::
unÜd”ed_m­
 <
¦ave_ifšdex
 , 
	gÇs_Ïg_¦ave_šfo_t
> ;

58 autØ
	gÇs_Ïg_¦ave_bË
 = 
Ãw
 
Çs_Ïg_¦ave_bË_t
;

64 autØ
	gÇs_Ïg_ma¡”_bË
 = 
Ãw
 
Çs_Ïg_ma¡”_bË_t
;

67 
¡d_mu‹x_lock_ü—‹_¡©ic_š™_»c
(
Ïg_lock
);

69 
¡d_mu‹x_ty³_t
 *
	$Çs_Ïg_mu‹x_lock
()

71  &
Ïg_lock
;

72 
	}
}

74 autØ
	gÏg_İ”_¡©e_hªdËrs
 = 
Ãw
 
¡d
::
£t
 <
Ïg_İ”_¡©e_hªdËr_t
>;

76 
	$Çs_Ïg_İ”_¡©e_»gi¡”_cb
(
Ïg_İ”_¡©e_hªdËr_t
 
İ”_¡©e_cb
) {

77 ià(
İ”_¡©e_cb
 !ğ
NULL
) {

78 
Ïg_İ”_¡©e_hªdËrs
->
	`š£¹
(
İ”_¡©e_cb
);

80 
	}
}

82 
	$Çs_Ïg_upd©e_ma¡”_İ”_¡©e
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
, 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
İ”_¡©e
) {

84 autØ
cb_func
 : *
Ïg_İ”_¡©e_hªdËrs
) {

85 
	`cb_func
(
Çs_Ïg_’Œy
->
ifšdex
, 
İ”_¡©e
);

87 
	}
}

89 
t_¡d_”rÜ
 
	$Çs_add_¦ave_node
(
h®_ifšdex_t
 
Ïg_ma¡”_id
,h®_ifšdex_ˆ
ifšdex
,

90 
ndi_obj_id_t
 
ndi_Ïg_memb”_id
){

92 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG","LagID %d Ifindex %d,†ag mem id %lu",

93 
Ïg_ma¡”_id
, 
ifšdex
, 
ndi_Ïg_memb”_id
);

95 
Çs_Ïg_¦ave_bË
->
	`š£¹
({
ifšdex
 ,{ ifšdex, 
Ïg_ma¡”_id
 ,
ndi_Ïg_memb”_id
}});

96  
STD_ERR_OK
;

97 
	}
}

100 
t_¡d_”rÜ
 
	$Çs_»move_¦ave_node
(
h®_ifšdex_t
 
ifšdex
)

102 autØ
¦ave_bË_™
 = 
Çs_Ïg_¦ave_bË
->
	`fšd
(
ifšdex
);

103 ià(
¦ave_bË_™
 !ğ
Çs_Ïg_¦ave_bË
->
	`’d
()) {

104 
Çs_Ïg_¦ave_bË
->
	`”a£
(
¦ave_bË_™
);

106  
STD_ERR_OK
;

107 
	}
}

110 
Çs_Ïg_¦ave_šfo_t
 *
	$Çs_g‘_¦ave_node
(
h®_ifšdex_t
 
ifšdex
)

112 autØ
¦ave_bË_™
 = 
Çs_Ïg_¦ave_bË
->
	`fšd
(
ifšdex
);

113 ià(
¦ave_bË_™
 !ğ
Çs_Ïg_¦ave_bË
->
	`’d
()) {

114 
Çs_Ïg_¦ave_šfo_t
 & 
¦ave_’Œy
 = 
¦ave_bË_™
->
£cÚd
;

115  &
¦ave_’Œy
;

117  
NULL
;

118 
	}
}

120 
h®_ifšdex_t
 
	$Çs_g‘_ma¡”_idx
(
h®_ifšdex_t
 
ifšdex
){

122 
Çs_Ïg_¦ave_šfo_t
 *
Çs_¦ave_’Œy
 = 
NULL
;

126 
Çs_¦ave_’Œy
 = 
	`Çs_g‘_¦ave_node
 (
ifšdex
);

127 if(
Çs_¦ave_’Œy
 =ğ
NULL
){

130  (
Çs_¦ave_’Œy
->
ma¡”_idx
);

131 
	}
}

133 
t_¡d_”rÜ
 
	$Çs_»move_®l_¦ave_node
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
)

135 autØ
™
=
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`begš
(); it!òas_Ïg_’Œy->pÜt_li¡.
	`’d
(); ++it) {

136 if(
	`Çs_»move_¦ave_node
(*
™
è!ğ
STD_ERR_OK
){

137  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

140  
STD_ERR_OK
;

141 
	}
}

143 
	$Çs_Ïg_’Œy_š£¹
(
Çs_Ïg_ma¡”_šfo_t
 &
ma¡”_’Œy
)

145 
Çs_Ïg_ma¡”_bË
->
	`š£¹
({
ma¡”_’Œy
.
ifšdex
, master_entry});

146 
	}
}

149 
t_¡d_”rÜ
 
	$Çs_Ïg_’Œy_”a£
(
h®_ifšdex_t
 
ifšdex
)

151 autØ
ma¡”_bË_™
 = 
Çs_Ïg_ma¡”_bË
->
	`fšd
(
ifšdex
);

153 ià(
ma¡”_bË_™
 !ğ
Çs_Ïg_ma¡”_bË
->
	`’d
()) {

154 
Çs_Ïg_ma¡”_bË
->
	`”a£
(
ma¡”_bË_™
);

156 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG","Inv®id Lag Index %d", 
ifšdex
);

157  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

160  
STD_ERR_OK
;

161 
	}
}

164 
Çs_Ïg_ma¡”_šfo_t
 *
	$Çs_g‘_Ïg_node
(
h®_ifšdex_t
 
ifšdex
)

166 autØ
ma¡”_bË_™
 = 
Çs_Ïg_ma¡”_bË
->
	`fšd
(
ifšdex
);

167 ià(
ma¡”_bË_™
 !ğ
Çs_Ïg_ma¡”_bË
->
	`’d
()) {

168 
Çs_Ïg_ma¡”_šfo_t
 & 
ma¡”_’Œy
 = 
ma¡”_bË_™
->
£cÚd
;

169 
	`EV_LOG_INFO
(
ev_log_t_INTERFACE
,3, "NAS-LAG", "%d Lag found ",
ifšdex
);

170  &
ma¡”_’Œy
;

172 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "NØLag Found %d", 
ifšdex
);

173  
NULL
;

174 
	}
}

177 
	gÇs_Ïg_ma¡”_bË_t
 & 
	$Çs_g‘_Ïg_bË
()

179  *
Çs_Ïg_ma¡”_bË
;

180 
	}
}

183 
boŞ
 
	$Çs_Ïg_exi¡
(cÚ¡ *
bÚd_Çme
)

185 
š‹rçû_ù¾_t
 
štf_ù¾
;

186 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

187 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

188 
	`§ã¡ºıy
(
štf_ù¾
.
if_Çme
, 
bÚd_Çme
, (intf_ctrl.if_name));

190 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
è!ğ
STD_ERR_OK
) {

191  
çl£
;

193  
Œue
;

194 
	}
}

197 
boŞ
 
	$Çs_Ïg_štf_to_pÜt
(
h®_ifšdex_t
 
ifšdex
, 
š‹rçû_ù¾_t
 *
štf_ù¾
) {

198 
	`mem£t
(
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

199 
štf_ù¾
->
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

200 
štf_ù¾
->
if_šdex
 = 
ifšdex
;

202 ià(
	`dn_h®_g‘_š‹rçû_šfo
(
štf_ù¾
è!ğ
STD_ERR_OK
) {

203 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,"NAS-LAG","Interface %d has NO slot %d,…ort %d",

204 
štf_ù¾
->
if_šdex
, iÁf_ù¾->
Åu_id
, iÁf_ù¾->
pÜt_id
);

205  
çl£
;

207  
Œue
;

208 
	}
}

210 
boŞ
 
	$Çs_Ïg_if_pÜt_is_Ïg_memb”
(
h®_ifšdex_t
 
Ïg_ma¡”_id
, h®_ifšdex_ˆ
ifšdex
) {

212 
Çs_Ïg_¦ave_šfo_t
 *
¦ave_’Œy
 = 
NULL
;

213 
¦ave_’Œy
 = 
	`Çs_g‘_¦ave_node
 (
ifšdex
);

214 ià(
¦ave_’Œy
 =ğ
NULL
) {

215  
çl£
;

217 ià(
¦ave_’Œy
->
ma¡”_idx
 !ğ
Ïg_ma¡”_id
) {

218 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,"NAS-LAG",

220 
ifšdex
, 
Ïg_ma¡”_id
, 
¦ave_’Œy
->
ma¡”_idx
);

221  
çl£
;

224  
Œue
;

226 
	}
}

229 
t_¡d_”rÜ
 
	$Çs_Ïg_memb”_add
(
h®_ifšdex_t
 
Ïg_ma¡”_id
,h®_ifšdex_ˆ
ifšdex
)

231 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
NULL
;

232 
t_¡d_”rÜ
 
»t
 = 
STD_ERR_OK
;

233 
Çs_obj_id_t
 
ndi_Ïg_memb”_id
;

234 
ndi_pÜt_t
 
Çs_Ïg_ndi_pÜt
;

236 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
Ïg_ma¡”_id
);

237 if(
Çs_Ïg_’Œy
 =ğ
NULL
){

238  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

241 
š‹rçû_ù¾_t
 
štf_ù¾
;

242 ià(!
	`Çs_Ïg_štf_to_pÜt
(
ifšdex
, &
štf_ù¾
)) {

243  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

246 
Çs_Ïg_ndi_pÜt
.
Åu_id
 = 
štf_ù¾
.npu_id;

247 
Çs_Ïg_ndi_pÜt
.
Åu_pÜt
 = 
štf_ù¾
.
pÜt_id
;

250 if(
	`Çs_add_pÜt_to_Ïg
(
Çs_Ïg_ndi_pÜt
.
Åu_id
,
Çs_Ïg_’Œy
->
ndi_Ïg_id
,

251 &
Çs_Ïg_ndi_pÜt
,&
ndi_Ïg_memb”_id
è!ğ
STD_ERR_OK
){

252  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

256 if(
	`Çs_add_¦ave_node
(
Ïg_ma¡”_id
,
ifšdex
,
ndi_Ïg_memb”_id
è!ğ
STD_ERR_OK
){

257  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

261 
ndi_štf_lšk_¡©e_t
 
¡©e
;

262 ià((
	`ndi_pÜt_lšk_¡©e_g‘
(
štf_ù¾
.
Åu_id
,štf_ù¾.
pÜt_id
, &
¡©e
))

263 =ğ
STD_ERR_OK
) {

264 
Çs_Ïg_’Œy
->
pÜt_İ”_li¡
[
ifšdex
]ğ(
¡©e
.
İ”_¡©us
 ==
ndi_pÜt_OPER_UP
è? 
Œue
 : 
çl£
;

265 ià(!
Çs_Ïg_’Œy
->
İ”_¡©us
 &&‚as_Ïg_’Œy->
pÜt_İ”_li¡
[
ifšdex
]) {

266 
Çs_Ïg_’Œy
->
İ”_¡©us
 = 
Œue
;

267 
	`Çs_Ïg_upd©e_ma¡”_İ”_¡©e
(
Çs_Ïg_’Œy
, 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
);

271  
»t
;

272 
	}
}

276 
t_¡d_”rÜ
 
	$Çs_Ïg_memb”_d–‘e
(
h®_ifšdex_t
 
Ïg_ma¡”_id
,h®_ifšdex_ˆ
ifšdex
)

278 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
ğ
NULL
;

279 
Çs_Ïg_¦ave_šfo_t
 *
Çs_¦ave_’Œy
 = 
NULL
;

280 
t_¡d_”rÜ
 
»t
 = 
STD_ERR_OK
;

282 if(
Ïg_ma¡”_id
 < 0)

283  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

287 
Çs_¦ave_’Œy
 = 
	`Çs_g‘_¦ave_node
 (
ifšdex
);

288 if(
Çs_¦ave_’Œy
 =ğ
NULL
){

289  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

292 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
Çs_¦ave_’Œy
->
ma¡”_idx
);

294 if(
Çs_Ïg_’Œy
 =ğ
NULL
){

295  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

298 
ndi_pÜt_t
 
Çs_Ïg_ndi_pÜt
;

300 
š‹rçû_ù¾_t
 
štf_ù¾
;

301 ià(!
	`Çs_Ïg_štf_to_pÜt
(
ifšdex
, &
štf_ù¾
)) {

302  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

305 
Çs_Ïg_ndi_pÜt
.
Åu_id
 = 
štf_ù¾
.npu_id;

306 
Çs_Ïg_ndi_pÜt
.
Åu_pÜt
ğ
štf_ù¾
.
pÜt_id
;

308 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Lag", "Deleting LAG MEM ID %lu",

309 
Çs_¦ave_’Œy
->
ndi_Ïg_memb”_id
);

310 if(
	`Çs_d–_pÜt_äom_Ïg
(
Çs_Ïg_ndi_pÜt
.
Åu_id
,

311 
Çs_¦ave_’Œy
->
ndi_Ïg_memb”_id
è!ğ
STD_ERR_OK
){

312  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

315 if(
	`Çs_»move_¦ave_node
(
ifšdex
è!ğ
STD_ERR_OK
){

316  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

319  
»t
;

320 
	}
}

322 
t_¡d_”rÜ
 
	$Çs_»gi¡”_Ïg_štf
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
, 
h®_štf_»g_İ_ty³_t
 
İ
)

324 
š‹rçû_ù¾_t
 
d‘as
;

326 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Lag", "Registering LAG %d %d with ifCntrl",

327 
Çs_Ïg_’Œy
->
ifšdex
,‚as_Ïg_’Œy->
Ïg_id
);

328 
	`mem£t
(&
d‘as
,0,(details));

329 
d‘as
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

330 
d‘as
.
if_šdex
 = 
Çs_Ïg_’Œy
->
ifšdex
;

331 
d‘as
.
Ïg_id
 = 
Çs_Ïg_’Œy
->
ndi_Ïg_id
;

332 
d‘as
.
št_ty³
 = 
Çs_št_ty³_LAG
;

333 
d‘as
.
desc
 = 
nuÎ±r
;

334 
	`¡ºıy
(
d‘as
.
if_Çme
, 
Çs_Ïg_’Œy
->
Çme
, (details.if_name)-1);

336 ià(
	`dn_h®_if_»gi¡”
(
İ
, &
d‘as
)!=
STD_ERR_OK
) {

337 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG",

339 
Çs_Ïg_’Œy
->
ifšdex
,‚as_Ïg_’Œy->
Ïg_id
);

340  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

343  
STD_ERR_OK
;

344 
	}
}

346 
t_¡d_”rÜ
 
	$Çs_Ïg_ma¡”_add
(
h®_ifšdex_t
 
šdex
,cÚ¡ *
if_Çme
,

347 
Çs_Ïg_id_t
 
Ïg_id
)

349 
Çs_Ïg_ma¡”_šfo_t
 
Çs_Ïg_’Œy
;

350 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

351 
Çs_obj_id_t
 
ndi_Ïg_id
;

353 if(
	`Çs_Ïg_exi¡
(
if_Çme
)){

354 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "Lagƒxi¡ šdex %d‚am% ", 
šdex
, 
if_Çme
);

355  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

360 if(
	`Çs_Ïg_ü—‹
(0, &
ndi_Ïg_id
è!ğ
STD_ERR_OK
){

361  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

364 
Çs_Ïg_’Œy
.
ifšdex
 = 
šdex
;

365 
Çs_Ïg_’Œy
.
Ïg_id
 =†ag_id;

366 
Çs_Ïg_’Œy
.
ndi_Ïg_id
 =‚di_lag_id;

367 
	`§ã¡ºıy
(
Çs_Ïg_’Œy
.
Çme
, 
if_Çme
, (nas_lag_entry.name));

368 
Çs_Ïg_’Œy
.
admš_¡©us
 = 
çl£
;

370 
	`Çs_Ïg_’Œy_š£¹
(
Çs_Ïg_’Œy
);

372 if(
	`Çs_»gi¡”_Ïg_štf
(&
Çs_Ïg_’Œy
, 
HAL_INTF_OP_REG
è!ğ
STD_ERR_OK
) {

373  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

376 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "Objeù Publish fÜ index %x",
šdex
);

378 if(
	`Ïg_objeù_publish
(&
Çs_Ïg_’Œy
, 
šdex
, 
ıs_­i_İ”_CREATE
)!ğ
ıs_­i_»t_code_OK
){

379 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

381  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

384  
rc
;

385 
	}
}

387 
t_¡d_”rÜ
 
	$Çs_Ïg_ma¡”_d–‘e
(
h®_ifšdex_t
 
ifšdex
)

389 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
=
NULL
;

390 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

392 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "Lag iÁà%d fÜ d–‘iÚ", 
ifšdex
);

395 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
ifšdex
);

397 if(
Çs_Ïg_’Œy
 =ğ
NULL
){

398 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG", "Lag intf %d Err in deletion",

399 
ifšdex
);

400  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

403 if(
	`Çs_Ïg_d–‘e
(0, 
Çs_Ïg_’Œy
->
ndi_Ïg_id
è!ğ
STD_ERR_OK
){

404  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

407 if(
	`Çs_»gi¡”_Ïg_štf
(
Çs_Ïg_’Œy
, 
HAL_INTF_OP_DEREG
è!ğ
STD_ERR_OK
) {

408  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

411 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "Object Publish for index %x",

412 
ifšdex
);

414 if(
	`Ïg_objeù_publish
(
Çs_Ïg_’Œy
, 
ifšdex
, 
ıs_­i_İ”_DELETE
)!ğ
ıs_­i_»t_code_OK
){

415 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

417  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

421 if(
	`Çs_»move_®l_¦ave_node
(
Çs_Ïg_’Œy
)!ğ
STD_ERR_OK
){

422  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

425 if(
	`Çs_Ïg_’Œy_”a£
(
ifšdex
è!ğ
STD_ERR_OK
){

426  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

431  
rc
;

432 
	}
}

434 
t_¡d_”rÜ
 
	$Çs_Ïg_£t_desc
(
h®_ifšdex_t
 
šdex
, cÚ¡ *
desc
) {

435 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
NULL
;

436 
š‹rçû_ù¾_t
 
štf
;

438 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "Lag iÁà%d fÜ s‘_desc", 
šdex
);

440 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
šdex
);

442 if(
Çs_Ïg_’Œy
 =ğ
NULL
){

443 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG", "Lag intf %d Err in set_desc",

444 
šdex
);

445  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

448 
	`mem£t
(&
štf
, 0, (intf));

450 ià(!
	`Çs_Ïg_štf_to_pÜt
(
Çs_Ïg_’Œy
->
ifšdex
, &
štf
)) {

451 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-LAG", "E¼Ü g‘tšg…ÜˆšfØfÜ LAG %d", 
Çs_Ïg_’Œy
->
ifšdex
);

452  
ıs_­i_»t_code_ERR
;

455 
štf
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

456 ià(
	`dn_h®_upd©e_štf_desc
(&
štf
, 
desc
è!ğ
STD_ERR_OK
) {

457 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-LAG", "Fau» savšg LAG %d desøš iÁàblock", 
Çs_Ïg_’Œy
->
ifšdex
);

458  
ıs_­i_»t_code_ERR
;

461  
STD_ERR_OK
;

462 
	}
}

465 
t_¡d_”rÜ
 
	$Çs_Ïg_£t_mac
(
h®_ifšdex_t
 
šdex
,cÚ¡ *
mac
)

467 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
NULL
;

469 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "Lag iÁà%d fÜ s‘_mac", 
šdex
);

471 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
šdex
);

473 if(
Çs_Ïg_’Œy
 =ğ
NULL
){

474 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG", "Lag intf %d Err in set_mac",

475 
šdex
);

476  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

479 
Çs_Ïg_’Œy
->
mac_addr
 = 
mac
;

480 ià(
	`dn_h®_upd©e_štf_mac
(
šdex
, 
mac
è!ğ
STD_ERR_OK
) {

481 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-LAG", "Fau» savšg LAG %d MAC iÀštàblock", 
šdex
);

482  
ıs_­i_»t_code_ERR
;

485  
STD_ERR_OK
;

486 
	}
}

488 
t_¡d_”rÜ
 
	$Çs_Ïg_£t_admš_¡©us
(
h®_ifšdex_t
 
šdex
, 
boŞ
 
’abË
)

490 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
NULL
;

492 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "Lag intf %d for set_admin_status",

493 
šdex
);

495 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
šdex
);

497 if(
Çs_Ïg_’Œy
 =ğ
NULL
){

498 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG",

499 "Lag iÁà%d E¼ iÀ%s", 
šdex
, 
__FUNCTION__
);

500  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

503 
Çs_Ïg_’Œy
->
admš_¡©us
 = 
’abË
;

504 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "LAG Object Publish for index %x",

505 
šdex
);

506 if(
	`Ïg_objeù_publish
(
Çs_Ïg_’Œy
,
šdex
,
ıs_­i_İ”_SET
)!ğ
ıs_­i_»t_code_OK
){

507 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-CPS-LAG",

509  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

511  
STD_ERR_OK
;

512 
	}
}

514 
t_¡d_”rÜ
 
	$Çs_Ïg_g‘_admš_¡©us
(
h®_ifšdex_t
 
šdex
, 
boŞ
 &
admš_¡©us
)

516 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
NULL
;

518 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "Lag intf %d for set_admin_status",

519 
šdex
);

521 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
šdex
);

523 if(
Çs_Ïg_’Œy
 =ğ
NULL
){

524 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG",

525 "Lag iÁà%d E¼ iÀ%s", 
šdex
, 
__FUNCTION__
);

526  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

529 
admš_¡©us
 = 
Çs_Ïg_’Œy
->admin_status;

530  
STD_ERR_OK
;

531 
	}
}

533 
t_¡d_”rÜ
 
	$Çs_Ïg_g‘_İ”_¡©us
(
h®_ifšdex_t
 
šdex
, 
boŞ
 &
İ”_¡©us
)

535 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
NULL
;

537 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "Lag intf %d for set_admin_status",

538 
šdex
);

540 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
šdex
);

542 if(
Çs_Ïg_’Œy
 =ğ
NULL
){

543 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG",

544 "Lag iÁà%d E¼ iÀ%s", 
šdex
, 
__FUNCTION__
);

545  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

548 
İ”_¡©us
 = 
Çs_Ïg_’Œy
->oper_status;

549  
STD_ERR_OK
;

550 
	}
}

552 
t_¡d_”rÜ
 
	$Çs_Ïg_block_pÜt
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 ,
h®_ifšdex_t
 
¦ave_ifšdex
,

553 
boŞ
 
block_¡©e
)

556 
Çs_Ïg_¦ave_šfo_t
 *
Çs_¦ave_’Œy
 = 
NULL
;

557 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG",

559 
Çs_Ïg_’Œy
->
ifšdex
, 
¦ave_ifšdex
,
block_¡©e
);

560 autØ
™_šdex
 = 
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`fšd
(
¦ave_ifšdex
);

561 ifĞ
™_šdex
 =ğ
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`’d
()){

562 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG", "%d Port does‚otƒxist",

563 
¦ave_ifšdex
);

564  
STD_ERR_OK
;

567 
ndi_pÜt_t
 
Çs_Ïg_ndi_pÜt
;

568 
š‹rçû_ù¾_t
 
štf_ù¾
;

569 ià(!
	`Çs_Ïg_štf_to_pÜt
(
¦ave_ifšdex
, &
štf_ù¾
)) {

570  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

573 
Çs_Ïg_ndi_pÜt
.
Åu_id
 = 
štf_ù¾
.npu_id;

574 
Çs_Ïg_ndi_pÜt
.
Åu_pÜt
ğ
štf_ù¾
.
pÜt_id
;

577 
Çs_¦ave_’Œy
 = 
	`Çs_g‘_¦ave_node
 (
¦ave_ifšdex
);

578 if(
Çs_¦ave_’Œy
 =ğ
NULL
){

579  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

582 if(
	`Çs_£t_Ïg_memb”_©Œ
(
Çs_Ïg_ndi_pÜt
.
Åu_id
,
Çs_¦ave_’Œy
->
ndi_Ïg_memb”_id
,

583 
block_¡©e
è!ğ
STD_ERR_OK
) {

584  (
	`STD_ERR
(
INTERFACE
,
FAIL
,0));

587  
STD_ERR_OK
;

588 
	}
}

590 
t_¡d_”rÜ
 
	$Çs_Ïg_g‘_pÜt_mode
(
h®_ifšdex_t
 
¦ave_ifšdex
, 
boŞ
& 
block_¡©e
)

593 
Çs_Ïg_¦ave_šfo_t
 *
Çs_¦ave_’Œy
 = 
NULL
;

594 
ndi_pÜt_t
 
Çs_Ïg_ndi_pÜt
;

595 
š‹rçû_ù¾_t
 
štf_ù¾
;

596 ià(!
	`Çs_Ïg_štf_to_pÜt
(
¦ave_ifšdex
, &
štf_ù¾
)) {

597  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

600 
Çs_Ïg_ndi_pÜt
.
Åu_id
 = 
štf_ù¾
.npu_id;

601 
Çs_Ïg_ndi_pÜt
.
Åu_pÜt
ğ
štf_ù¾
.
pÜt_id
;

604 
Çs_¦ave_’Œy
 = 
	`Çs_g‘_¦ave_node
 (
¦ave_ifšdex
);

605 if(
Çs_¦ave_’Œy
 =ğ
NULL
){

606  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

609 if(
	`Çs_g‘_Ïg_memb”_©Œ
(
Çs_Ïg_ndi_pÜt
.
Åu_id
,
Çs_¦ave_’Œy
->
ndi_Ïg_memb”_id
,

610 &
block_¡©e
è!ğ
STD_ERR_OK
) {

611  (
	`STD_ERR
(
INTERFACE
,
FAIL
,0));

614  
STD_ERR_OK
;

615 
	}
}

618 
t_¡d_”rÜ
 
	$Çs_Ïg_g‘_ndi_Ïg_id
(
h®_ifšdex_t
 
Ïg_šdex
, 
ndi_obj_id_t
 *
ndi_Ïg_id
)

620 ià(
ndi_Ïg_id
 =ğ
NULL
) {

621  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

624 
Çs_Ïg_ma¡”_šfo_t
 * 
Ïg_node
 = 
	`Çs_g‘_Ïg_node
(
Ïg_šdex
);

625 ià(
Ïg_node
 =ğ
NULL
) {

626  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

628 *
ndi_Ïg_id
 = 
Ïg_node
->ndi_lag_id;

629  
STD_ERR_OK
;

630 
	}
}

	@src/lag/nas_int_lag_cps.cpp

21 
	~"d–l-ba£-if-Ïg.h
"

22 
	~"d–l-ba£-if.h
"

23 
	~"d–l-ba£-š‹rçû-commÚ.h
"

24 
	~"d–l-š‹rçû.h
"

25 
	~"Çs_ndi_Ïg.h
"

26 
	~"Çs_os_Ïg.h
"

27 
	~"Çs_os_š‹rçû.h
"

28 
	~"Çs_št_pÜt.h
"

29 
	~"ıs_­i_ev’ts.h
"

30 
	~"ev’t_log.h
"

31 
	~"ev’t_log_ty³s.h
"

32 
	~"Çs_št_Ïg_­i.h
"

33 
	~"Çs_št_Ïg_ıs.h
"

34 
	~"Çs_št_Ïg.h
"

35 
	~"¡d_mac_uts.h
"

36 
	~"Çs_ndi_obj_id_bË.h
"

37 
	~"š‹rçû_obj.h
"

38 
	~"Çs_št_uts.h
"

39 
	~"h®_š‹rçû_commÚ.h
"

40 
	~"Çs_ndi_pÜt.h
"

41 
	~"Çs_lšux_l2.h
"

42 
	~"ŸÇ-if-ty³.h
"

43 
	~"Çs_if_uts.h
"

44 
	~"Çs_št_com_uts.h
"

46 
	~<¡dio.h
>

48 
	~"ıs_şass_m­.h
"

49 
	~"ıs_­i_ev’ts.h
"

50 
	~"ıs_­i_objeù_key.h
"

51 
	~<unÜd”ed_£t
>

54 cÚ¡ 
	gMAX_CPS_MSG_BUFF
=4096;

56 
	g¡d
::
	tunÜd”ed_£t
 <
	th®_ifšdex_t
> 
	tÇs_pÜt_li¡_t
;

57 
ıs_­i_»tuº_code_t
 
Çs_ıs_£t_Ïg
(
ıs_­i_objeù_t
 
obj
);

58 
ıs_­i_»tuº_code_t
 
Çs_ıs_d–‘e_pÜt_äom_Ïg
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
, 
h®_ifšdex_t
 
ifšdex
);

59 
Çs_ıs_upd©e_İ”_¡©e
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
);

61 
boŞ
 
	$Çs_Ïg_g‘_ifšdex_äom_obj
(
ıs_­i_objeù_t
 
obj
,
h®_ifšdex_t
 *
šdex
){

62 
ıs_­i_objeù_©Œ_t
 
Ïg_Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
);

63 
ıs_­i_objeù_©Œ_t
 
Ïg_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
 );

65 if(
Ïg_©Œ
 =ğ
NULL
 && 
Ïg_Çme_©Œ
 == NULL) {

66 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-CPS-LAG",

68  
çl£
;

71 if(
Ïg_©Œ
){

72 *
šdex
 = (
h®_ifšdex_t
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
Ïg_©Œ
);

74 cÚ¡ * 
Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
Ïg_Çme_©Œ
);

75 
š‹rçû_ù¾_t
 
i
;

76 
	`mem£t
(&
i
,0,(i));

77 
	`¡ºıy
(
i
.
if_Çme
,
Çme
,(i.if_name)-1);

78 
i
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

79 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
i
)!=
STD_ERR_OK
){

80 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

81 "Cª'ˆg‘ iÁ”çû cÚŒŞ infÜm©iÚ fÜ %s",
Çme
);

82  
çl£
;

84 *
šdex
 = 
i
.
if_šdex
;

86  
Œue
;

87 
	}
}

89 
šlše
 
boŞ
 
	$Çs_g‘_Ïg_id_äom_¡r
(cÚ¡ * 
¡r
, 
Çs_Ïg_id_t
 * 
id
){

90 
¡d
::
¡ršg
 
	`fuÎ_¡r
(
¡r
);

91 
¡d
::
size_t
 
pos
 = 
fuÎ_¡r
.
	`fšd_fœ¡_of
("0123456789");

93 ià(
pos
 !ğ
¡d
::
¡ršg
::
Åos
) {

94 
¡d
::
¡ršg
 
id_¡r
 = 
fuÎ_¡r
.
	`sub¡r
(
pos
);

95 *
id
 = 
¡d
::
	`¡oi
(
id_¡r
);

96 ià(*
id
 =ğ
INVALID_LAG_ID
) {

97 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "%u i »£rved‡ ª inv®id†ag id", 
INVALID_LAG_ID
);

100 *
id
 = 
INVALID_LAG_ID
;

102  
Œue
;

103 
	}
}

105 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_£t_desc
(cÚ¡ 
ıs_­i_objeù_©Œ_t
 &
desc_©Œ
, cÚ¡ 
h®_ifšdex_t
 
Ïg_šdex
)

108 ià(!
desc_©Œ
) {

109 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "Interface description‡ttribute is‚ull.");

110  
ıs_­i_»t_code_ERR
;

113 cÚ¡ *
desc
 = (cÚ¡ *è
	`ıs_­i_objeù_©Œ_d©a_bš
(
desc_©Œ
);

115 ià((
	`¡¾’
(
desc
è> 
MAX_INTF_DESC_LEN
)) {

116 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "Ïg desøËngthƒxûed maximum (%d)", 
MAX_INTF_DESC_LEN
);

117  
ıs_­i_»t_code_ERR
;

120 if(
	`Çs_Ïg_£t_desc
(
Ïg_šdex
, 
desc
è!ğ
STD_ERR_OK
)

122 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "lag desc failure in NAS");

123  
ıs_­i_»t_code_ERR
;

126  
ıs_­i_»t_code_OK
;

127 
	}
}

129 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_ü—‹_Ïg
(
ıs_­i_objeù_t
 
obj
)

131 
h®_ifšdex_t
 
Ïg_šdex
 = 0;

132 
ıs_­i_»tuº_code_t
 
rc
 =
ıs_­i_»t_code_OK
;

133 
Çs_Ïg_id_t
 
Ïg_id
=0;

134 
ıs_­i_objeù_©Œ_t
 
Ïg_id_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
);

135 
ıs_­i_objeù_©Œ_t
 
Ïg_desc_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_INTERFACE_DESCRIPTION
);

137 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "Create Lag using CPS");

139 if(
Ïg_id_©Œ
 =ğ
NULL
) {

140 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "Missing Lag Name");

141  
ıs_­i_»t_code_ERR
;

144 cÚ¡ * 
Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
Ïg_id_©Œ
);

146 if(
	`Çs_Ïg_g‘_ifšdex_äom_obj
(
obj
,&
Ïg_šdex
)){

147 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG","Lag %s‡lreadyƒxists",

148 
Çme
);

149  
	`Çs_ıs_£t_Ïg
(
obj
);

152 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG","C»©Lag % š k”Ãl", 
Çme
);

155 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`lock_t
(
	`Çs_Ïg_mu‹x_lock
());

157 if((
	`Çs_os_ü—‹_Ïg
(
obj
, &
Ïg_šdex
)è!ğ
STD_ERR_OK
) {

158 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

160  
ıs_­i_»t_code_ERR
;

163 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

164 "K”ÃÈ´og¿mmed, c»©šg†ag w™h index %d", 
Ïg_šdex
);

166 
	`Çs_g‘_Ïg_id_äom_¡r
(
Çme
,&
Ïg_id
);

168 if(
	`Çs_Ïg_ma¡”_add
(
Ïg_šdex
,
Çme
,
Ïg_id
è!ğ
STD_ERR_OK
)

170 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

172 
Ïg_šdex
);

173  
ıs_­i_»t_code_ERR
;

176 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
Ïg_šdex
, 
BASE_IF_MODE_MODE_NONE
è=ğ
çl£
) {

177 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-CPS-LAG",

178 "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
Ïg_šdex
);

181 
	`ıs_­i_£t_key_d©a
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
ıs_­i_objeù_ATTR_T_U32
,

182 &
Ïg_šdex
,(lag_index));

184 if(
	`Çs_ıs_£t_Ïg
(
obj
)!=
ıs_­i_»t_code_OK
)

186 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

188 
Ïg_šdex
);

189  
ıs_­i_»t_code_ERR
;

192 if(
Ïg_desc_©Œ
 && 
	`Çs_ıs_£t_desc
Öag_desc_©Œ, 
Ïg_šdex
è!ğ
ıs_­i_»t_code_OK
) {

193 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

195 
Ïg_šdex
);

196  
ıs_­i_»t_code_ERR
;

199 
	`EV_LOGGING
(
INTERFACE
, 
NOTICE
, "NAS-CPS-LAG", "C»©Lag % sucûssful", 
Çme
);

200  
rc
;

201 
	}
}

203 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_d–‘e_Ïg
(
ıs_­i_objeù_t
 
obj
)

205 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

207 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "CPS Delete LAG");

209 
h®_ifšdex_t
 
Ïg_šdex
 = 0;

210 if(!
	`Çs_Ïg_g‘_ifšdex_äom_obj
(
obj
,&
Ïg_šdex
)){

211 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "CPS Delete LAG or it's Member operation Failed");

212  
ıs_­i_»t_code_ERR
;

215 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "Deleting Lag Intf %d",

216 
Ïg_šdex
);

218 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
Ïg_šdex
);

219 
ıs_­i_objeù_©Œ_t
 
ty³
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
);

220 
ıs_­i_objeù_©Œ_t
 
memb”_pÜt_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS_NAME
);

221 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
Ïg_šdex
);

223 if(
ty³
 || 
memb”_pÜt_©Œ
){

224 
	`EV_LOGGING
(
INTERFACE
, 
INFO
,"NAS-CPS-LAG",

225 "RemovMemb” PÜˆfÜ Lag %d",
Ïg_šdex
);

226  
	`Çs_ıs_£t_Ïg
(
obj
);

229 if(!
Çs_Ïg_’Œy
) {

230 
	`EV_LOGGING
(
INTERFACE
, 
INFO
,"NAS-CPS-LAG",

231 "Cª'ˆfšd LAGƒÁry fÜ Lag %d", 
Ïg_šdex
);

232  
ıs_­i_»t_code_ERR
;

235 autØ
™
 : 
Çs_Ïg_’Œy
->
pÜt_li¡
) {

236 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
™
, 
BASE_IF_MODE_MODE_NONE
è=ğ
çl£
) {

237 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-CPS-LAG",

238 "E¼Ü s‘tšg iÁ”çû modtØNONE oÀštf(%d)", 
Ïg_šdex
);

239  
ıs_­i_»t_code_ERR
;

242 ià(
	`Çs_ıs_d–‘e_pÜt_äom_Ïg
(
Çs_Ïg_’Œy
, 
™
è!ğ
ıs_­i_»t_code_OK
) {

243 
	`EV_LOGGING
(
INTERFACE
, 
INFO
,"NAS-CPS-LAG",

244 "E¼Ü cË¬šg…Üˆ%d from memb”…Üˆli¡", 
™
);

245  
ıs_­i_»t_code_ERR
;

250 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`lock_t
(
	`Çs_Ïg_mu‹x_lock
());

252 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
Ïg_šdex
, 
BASE_IF_MODE_MODE_L2
è=ğ
çl£
) {

253 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-CPS-LAG",

254 "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
Ïg_šdex
);

257 if(
	`Çs_os_d–‘e_Ïg
(
obj
è!ğ
STD_ERR_OK
) {

258 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

260  
ıs_­i_»t_code_ERR
;

263 if(
	`Çs_Ïg_ma¡”_d–‘e
(
Ïg_šdex
è!ğ
STD_ERR_OK
){

264 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

266  
ıs_­i_»t_code_ERR
;

269 
	`EV_LOGGING
(
INTERFACE
, 
NOTICE
, "NAS-CPS-LAG", "Lag IÁà%d d–‘sucûssful", 
Ïg_šdex
);

270  
rc
;

271 
	}
}

273 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_£t_mac
(
ıs_­i_objeù_t
 
obj
,
h®_ifšdex_t
 
Ïg_šdex
)

275 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
);

276 ià(
©Œ
==
NULL
è 
ıs_­i_»t_code_ERR
;

278 
	`ıs_­i_£t_key_d©a
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
ıs_­i_objeù_ATTR_T_U32
,

279 &
Ïg_šdex
,(lag_index));

281 if(
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
è!ğ
STD_ERR_OK
)

283 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "lag MAC set failure OS");

284  
ıs_­i_»t_code_ERR
;

287 if(
	`Çs_Ïg_£t_mac
(
Ïg_šdex
,(cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
©Œ
)è!ğ
STD_ERR_OK
)

289 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "lag MAC failure in NAS");

290  
ıs_­i_»t_code_ERR
;

293  
ıs_­i_»t_code_OK
;

294 
	}
}

296 
	$Çs_ıs_hªdË_mac_£t
 (cÚ¡ *
Ïg_Çme
, 
h®_ifšdex_t
 
Ïg_šdex
) {

298 
mac_¡r
[
MAC_STRING_SZ
];

299 
buff
[
MAX_CPS_MSG_BUFF
];

301 
	`mem£t
(
mac_¡r
, 0, 
MAC_STRING_SZ
);

302 
	`mem£t
(
buff
, 0 , 
MAX_CPS_MSG_BUFF
);

303 ià(
	`Çs_if_g‘_assigÃd_mac
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

304 
Ïg_Çme
, 0, 
mac_¡r
, (mac_¡r)è!ğ
STD_ERR_OK
) {

305 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 , "NAS-LAG",

310 
ıs_­i_objeù_t
 
Çme_obj
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

311 
	`ıs_­i_objeù_©Œ_add_u32
(
Çme_obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
Ïg_šdex
);

312 
	`ıs_­i_objeù_©Œ_add
(
Çme_obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
,

313 
mac_¡r
,
	`¡¾’
(mac_str)+1);

314 
	`Çs_ıs_£t_mac
(
Çme_obj
, 
Ïg_šdex
);

316 
	}
}

318 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_£t_admš_¡©us
(
ıs_­i_objeù_t
 
obj
,
h®_ifšdex_t
 
Ïg_šdex
,

319 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
)

322 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
);

324 ià(
©Œ
 =ğ
NULL
){

325 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG","admin status %d‡ttr is NULL",

326 
Ïg_šdex
);

327  
ıs_­i_»t_code_ERR
;

330 if(
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
è!ğ
STD_ERR_OK
)

332 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

334  
ıs_­i_»t_code_ERR
;

338 
Çs_Ïg_’Œy
->
admš_¡©us
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

340  
ıs_­i_»t_code_OK
;

341 
	}
}

344 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_add_pÜt_to_Ïg
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
, 
h®_ifšdex_t
 
pÜt_idx
)

346 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

347 
BASE_IF_MODE_t
 
štf_mode
 = 
	`Çs_štf_g‘_mode
(
pÜt_idx
);

353 
boŞ
 
block_pÜt
 = 
Œue
;

354 if(
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`fšd
(
pÜt_idx
è=ğÇs_Ïg_’Œy->block_pÜt_li¡.
	`’d
()) {

355 
block_pÜt
 = 
çl£
;

356 
buff
[
MAX_CPS_MSG_BUFF
];

357 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "Add Portso Lag");

359 
ıs_­i_objeù_t
 
Çme_obj
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

360 
	`ıs_­i_objeù_©Œ_add_u32
(
Çme_obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
Çs_Ïg_’Œy
->
ifšdex
);

361 
	`ıs_­i_objeù_©Œ_add_u32
(
Çme_obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
, 
pÜt_idx
);

363 if(
	`Çs_os_add_pÜt_to_Ïg
(
Çme_obj
è!ğ
STD_ERR_OK
) {

364 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

366 
pÜt_idx
,
Çs_Ïg_’Œy
->
ifšdex
);

367  
ıs_­i_»t_code_ERR
;

371 
if_ma¡”_šfo_t
 
ma¡”_šfo
 = { 
Çs_št_ty³_LAG
, 
NAS_PORT_NONE
, 
Çs_Ïg_’Œy
->
ifšdex
};

373 if(!
	`Çs_štf_add_ma¡”
(
pÜt_idx
, 
ma¡”_šfo
)){

374 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-LAG-MASTER","Failedo‡dd master for†ag memeber…ort");

376 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
pÜt_idx
);

377 ià(
Ãw_mode
 !ğ
štf_mode
) {

378 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
pÜt_idx
, 
Ãw_mode
è=ğ
çl£
) {

379 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-LAG-MASTER", "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
pÜt_idx
);

387 if(!
	`Çs_is_vœtu®_pÜt
(
pÜt_idx
)){

388 if(
	`Çs_Ïg_memb”_add
(
Çs_Ïg_’Œy
->
ifšdex
,
pÜt_idx
è!ğ
STD_ERR_OK
)

390 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

391 "E¼Ü in£¹šg index %d iÀli¡", 
pÜt_idx
);

392  
ıs_­i_»t_code_ERR
;

395 ià(
block_pÜt
 && 
	`Çs_Ïg_block_pÜt
(
Çs_Ïg_’Œy
, 
pÜt_idx
, block_pÜtè!ğ
STD_ERR_OK
) {

396 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "E¼Ü Block/unblock PÜˆ%d",
pÜt_idx
);

397  
ıs_­i_»t_code_ERR
;

401 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG","Add Portso Lag Exit");

402  
rc
;

403 
	}
}

405 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_d–‘e_pÜt_äom_Ïg
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
, 
h®_ifšdex_t
 
ifšdex
)

407 
buff
[
MAX_CPS_MSG_BUFF
];

408 
ıs_­i_»tuº_code_t
 
rc
=
ıs_­i_»t_code_OK
;

409 
if_ma¡”_šfo_t
 
ma¡”_šfo
 = { 
Çs_št_ty³_LAG
, 
NAS_PORT_NONE
, 
Çs_Ïg_’Œy
->
ifšdex
};

410 
BASE_IF_MODE_t
 
štf_mode
 = 
	`Çs_štf_g‘_mode
(
ifšdex
);

412 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

413 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
, 
ifšdex
);

416 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

417 "Çs_ıs_d–_pÜt_äom_Ïg %d", 
ifšdex
);

419 if(!
	`Çs_is_vœtu®_pÜt
(
ifšdex
)){

421 if((
	`Çs_Ïg_memb”_d–‘e
(0,
ifšdex
è!ğ
STD_ERR_OK
)){

422 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

423 "E¼Ü d–‘šg iÁ”çû %d from NPU", 
ifšdex
);

424  
ıs_­i_»t_code_ERR
;

428 if(!
	`Çs_štf_d–_ma¡”
(
ifšdex
, 
ma¡”_šfo
)){

429 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-LAG-MASTER","Failedo delete master for†ag memeber…ort");

431 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
ifšdex
);

432 ià(
Ãw_mode
 !ğ
štf_mode
) {

433 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
ifšdex
, 
Ãw_mode
è=ğ
çl£
) {

434 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-LAG-MASTER", "Updateo NAS-L3‡bout interface mode change failed(%d)",

435 
ifšdex
);

446 if(
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`fšd
(
ifšdex
è=ğÇs_Ïg_’Œy->block_pÜt_li¡.
	`’d
()){

447 if(
	`Çs_os_d–‘e_pÜt_äom_Ïg
(
obj
è!ğ
STD_ERR_OK
) {

448 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG","E¼Ü d–‘šg iÁ”çû %d from OS", 
ifšdex
);

449  
ıs_­i_»t_code_ERR
;

453 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

454 "Çs_ıs_d–_pÜt_äom_Ïg Ex™ %d",
ifšdex
);

455  
rc
;

456 
	}
}

458 
boŞ
 
	$Çs_Ïg_g‘_štf_ù¾_šfo
(
h®_ifšdex_t
 
šdex
, 
š‹rçû_ù¾_t
 &
i
){

459 
	`mem£t
(&
i
,0,(i));

460 
i
.
if_šdex
 = 
šdex
;

461 
i
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

462 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
i
)!=
STD_ERR_OK
){

463 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

465 "š‹rçû %d", 
šdex
);

466  
çl£
;

468  
Œue
;

469 
	}
}

471 
boŞ
 
	$Çs_Ïg_g‘_štf_ù¾_šfo
(cÚ¡ * 
Çme
, 
š‹rçû_ù¾_t
 & 
i
){

472 
	`mem£t
(&
i
,0,(i));

473 
	`¡ºıy
(
i
.
if_Çme
,
Çme
,(i.if_name)-1);

474 
i
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

475 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
i
)!=
STD_ERR_OK
){

476 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

478 "š‹rçû %s",
Çme
);

479  
çl£
;

481  
Œue
;

482 
	}
}

484 
ıs_­i_»tuº_code_t
 
	$ıs_Ïg_upd©e_pÜts
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
,

485 
Çs_pÜt_li¡_t
 &
pÜt_šdex_li¡
, 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
)

488 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "cps_lag_update_ports %d",

489 
İ
);

492 ià(
İ
 =ğ
ıs_­i_İ”_SET
) {

493 
h®_ifšdex_t
 
pÜt
;

494 autØ
™
 = 
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`begš
(); iˆ!ğÇs_Ïg_’Œy->pÜt_li¡.
	`’d
();) {

495 ià(
pÜt_šdex_li¡
.
	`fšd
(*
™
è=ğpÜt_šdex_li¡.
	`’d
()) {

496 
pÜt
 = *
™
;

497 
™
++;

498 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

499 "Removšg uÂ“ded memb”pÜˆ%d", 
pÜt
);

501 if(
	`Çs_ıs_d–‘e_pÜt_äom_Ïg
(
Çs_Ïg_’Œy
, 
pÜt
è!ğ
ıs_­i_»t_code_OK
) {

502 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

503 "E¼Ü d–‘šg uÂ“ded memb”pÜˆ%d from OS/NPU", 
pÜt
);

504  
ıs_­i_»t_code_ERR
;

506 
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`”a£
(
pÜt
);

507 
Çs_Ïg_’Œy
->
pÜt_İ”_li¡
.
	`”a£
(
pÜt
);

510 if(
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`fšd
(
pÜt
è!ğÇs_Ïg_’Œy->block_pÜt_li¡.
	`’d
()) {

512 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

513 "D–‘uÃeded memb”pÜˆ%d from Block†i¡", 
pÜt
);

514 
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`”a£
(
pÜt
);

517 
™
++;

522 autØ
™
 = 
pÜt_šdex_li¡
.
	`begš
(è; iˆ!ğpÜt_šdex_li¡.
	`’d
() ; ++it){

524 if(((
İ
 =ğ
ıs_­i_İ”_CREATE
è|| (İ =ğ
ıs_­i_İ”_SET
)) &&

525 (
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`fšd
(*
™
è=ğÇs_Ïg_’Œy->pÜt_li¡.
	`’d
())) {

527 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

528 "Reûived‚ew…Üˆadd %d", *
™
);

530 if(
	`Çs_ıs_add_pÜt_to_Ïg
(
Çs_Ïg_’Œy
, *
™
è!ğ
ıs_­i_»t_code_OK
) {

531 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

532 "E¼Ü‡ddšg…Üˆ%dØOS/NPU", *
™
);

533  
ıs_­i_»t_code_ERR
;

535 
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`š£¹
(*
™
);

537 ià((
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`fšd
(*
™
è!ğÇs_Ïg_’Œy->block_pÜt_li¡.
	`’d
()) &&

538 (
	`Çs_Ïg_block_pÜt
(
Çs_Ïg_’Œy
,*
™
, 
Œue
è!ğ
STD_ERR_OK
)) {

539 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

540 "Wh’‡ddšg sÏvpÜt, E¼Ü iÀblockšg PÜˆ%d ",*
™
);

541  
ıs_­i_»t_code_ERR
;

545 } if((
İ
 =ğ
ıs_­i_İ”_DELETE
) &&

546 (
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`fšd
(*
™
è!ğÇs_Ïg_’Œy->pÜt_li¡.
	`’d
())) {

548 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

549 "Reûived‚ew…Üˆd–‘%d", *
™
);

551 if(
	`Çs_ıs_d–‘e_pÜt_äom_Ïg
(
Çs_Ïg_’Œy
, *
™
è!ğ
ıs_­i_»t_code_OK
) {

552 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

553 "E¼Ü d–‘šg…Üˆ %d from OS/NPU", *
™
);

554  
ıs_­i_»t_code_ERR
;

556 
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`”a£
(*
™
);

557 
Çs_Ïg_’Œy
->
pÜt_İ”_li¡
.
	`”a£
(*
™
);

560 if(
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`fšd
(*
™
è!ğÇs_Ïg_’Œy->block_pÜt_li¡.
	`’d
()) {

562 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

563 "D–‘pÜˆ%d from Block†i¡", *
™
);

564 
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`”a£
(*
™
);

569 
	`EV_LOGGING
(
INTERFACE
, 
NOTICE
, "NAS-CPS-LAG", "CPS %s Port index %do LAG %s operation successful",

570 (
İ
 !ğ
ıs_­i_İ”_DELETE
è? "Add" : "Remove", *
™
, 
Çs_Ïg_’Œy
->
Çme
);

573 
	`Çs_ıs_upd©e_İ”_¡©e
(
Çs_Ïg_’Œy
);

575  
ıs_­i_»t_code_OK
;

576 
	}
}

579 
	$Çs_·ck_Ïg_pÜt_li¡
(
ıs_­i_objeù_t
 
obj
,
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
, 
©Œ_id
,
boŞ
 
g‘
)

581 
boŞ
 
pÜt_mode
, 
block_pÜt_£t
 = 
çl£
, 
unblock_pÜt_£t
 = false;

582 
li¡_id
 =0;

583 autØ
™
=
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`begš
(); it!òas_Ïg_’Œy->pÜt_li¡.
	`’d
(); ++it) {

584 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG-CPS", "pÜˆidx %d", *
™
);

585 
š‹rçû_ù¾_t
 
i
;

586 if(!
	`Çs_Ïg_g‘_štf_ù¾_šfo
(*
™
,
i
)) ;

588 if(
g‘
){

589 
ıs_­i_©Œ_id_t
 
ids
[3] = {
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
,
li¡_id
++,

590 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS_NAME
 };

591 cÚ¡ 
ids_Ën
 = (
ids
)/(ids[0]);

592 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,
i
.
if_Çme
,
	`¡¾’
(i.if_name)+1);

594 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
©Œ_id
, *
™
);

597 ià(
	`Çs_Ïg_g‘_pÜt_mode
(*
™
, 
pÜt_mode
è=ğ
STD_ERR_OK
) {

598 ià(
pÜt_mode
) {

599 if(
g‘
){

600 
	`ıs_­i_objeù_©Œ_add
(
obj
,
BASE_IF_LAG_IF_INTERFACES_INTERFACE_BLOCK_PORT_LIST
,
i
.
if_Çme
,
	`¡¾’
(i.if_name)+1);

602 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_BLOCK_PORT_LIST
, *
™
);

604 
block_pÜt_£t
 = 
Œue
;

606 if(
g‘
){

607 
	`ıs_­i_objeù_©Œ_add
(
obj
,
BASE_IF_LAG_IF_INTERFACES_INTERFACE_UNBLOCK_PORT_LIST
,
i
.
if_Çme
,
	`¡¾’
(i.if_name)+1);

609 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_UNBLOCK_PORT_LIST
, *
™
);

611 
unblock_pÜt_£t
 = 
Œue
;

616 if(
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`size
() == 0) {

617 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
©Œ_id
, 0, 0);

620 ià(!
block_pÜt_£t
) {

621 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_BLOCK_PORT_LIST
, 0, 0);

623 ià(!
unblock_pÜt_£t
) {

624 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_UNBLOCK_PORT_LIST
, 0, 0);

626 
	}
}

628 
ıs_­i_»tuº_code_t
 
	$Ïg_objeù_publish
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
,
h®_ifšdex_t
 
Ïg_idx
,

629 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
)

631 
buff
[
MAX_CPS_MSG_BUFF
];

632 
	`mem£t
(
buff
,0,(buff));

633 
ıs_­i_objeù_t
 
obj_pub
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

634 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj_pub
),
BASE_IF_LAG_IF_INTERFACES_INTERFACE_OBJ
,
ıs_­i_qu®if›r_OBSERVED
);

635 
	`ıs_­i_£t_key_d©a
(
obj_pub
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
ıs_­i_objeù_ATTR_T_U32
,

636 &
Ïg_idx
,(lag_idx));

637 
	`ıs_­i_objeù_£t_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj_pub
),
İ
);

639 if(
İ
 =ğ
ıs_­i_İ”_SET
){

640 
	`Çs_·ck_Ïg_pÜt_li¡
(
obj_pub
,
Çs_Ïg_’Œy
, 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
,
çl£
);

641 
	`ıs_­i_objeù_©Œ_add_u32
(
obj_pub
,
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
,(
Çs_Ïg_’Œy
->
admš_¡©us
 ?

642 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_UP
 : 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_DOWN
) );

644 ià(
	`ıs_­i_ev’t_th»ad_publish
(
obj_pub
)!=
STD_ERR_OK
) {

645 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INTF-EVENT",

647  
ıs_­i_»t_code_ERR
;

649 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-INTF-EVENT",

650 "Published LAG objeù %d", 
Ïg_idx
);

651  
ıs_­i_»t_code_OK
;

652 
	}
}

655 
ıs_­i_»tuº_code_t
 
	$Ïg_¡©e_objeù_publish
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
,
boŞ
 
İ”_¡©us
)

657 
buff
[
MAX_CPS_MSG_BUFF
];

658 
	`mem£t
(
buff
,0,(buff));

659 
ıs_­i_objeù_t
 
obj_pub
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

660 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj_pub
),
BASE_IF_LAG_IF_INTERFACES_STATE_INTERFACE_OBJ
,
ıs_­i_qu®if›r_OBSERVED
);

661 
	`ıs_­i_£t_key_d©a
(
obj_pub
,
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
,
ıs_­i_objeù_ATTR_T_U32
,

662 &(
Çs_Ïg_’Œy
->
ifšdex
),(nas_lag_entry->ifindex));

663 
	`ıs_­i_objeù_£t_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj_pub
),
ıs_­i_İ”_SET
);

664 
	`ıs_­i_objeù_©Œ_add_u32
(
obj_pub
,
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
,(
İ”_¡©us
 ?

665 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
 : 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
) );

667 ià(
	`ıs_­i_ev’t_th»ad_publish
(
obj_pub
)!=
STD_ERR_OK
) {

668 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INTF-EVENT","Failedo sendƒvent. Service issue");

669  
ıs_­i_»t_code_ERR
;

671 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-INTF-EVENT","Published LAG O³¸¡©u fÜ objeù %d", 
Çs_Ïg_’Œy
->
ifšdex
);

672  
ıs_­i_»t_code_OK
;

673 
	}
}

675 
	$Çs_ıs_upd©e_İ”_¡©e
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
) {

676 
boŞ
 
´ev_İ”_¡©us
 = 
Çs_Ïg_’Œy
->
İ”_¡©us
;

677 
Çs_Ïg_’Œy
->
İ”_¡©us
 = 
çl£
;

679 cÚ¡‡utØ&
™
 : 
Çs_Ïg_’Œy
->
pÜt_İ”_li¡
) {

680 ià(
™
.
£cÚd
) {

681 
Çs_Ïg_’Œy
->
İ”_¡©us
 = 
Œue
;

686 ià(
Çs_Ïg_’Œy
->
İ”_¡©us
 !ğ
´ev_İ”_¡©us
) {

687 
	`Ïg_¡©e_objeù_publish
(
Çs_Ïg_’Œy
,‚as_Ïg_’Œy->
İ”_¡©us
);

691 
	}
}

693 
ıs_­i_»tuº_code_t
 
	$Çs_´oûss_Ïg_block_pÜts
(
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
,

694 
Çs_pÜt_li¡_t
 &
pÜt_šdex_li¡
,
boŞ
 
pÜt_¡©e
)

696 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

698 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "Processing†ag block…orts");

700 autØ
™
 = 
pÜt_šdex_li¡
.
	`begš
(è; iˆ!ğpÜt_šdex_li¡.
	`’d
() ; ++it){

704 ià(
pÜt_¡©e
) {

705 
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`š£¹
(*
™
);

706 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

707 "Add…Üˆ%dØBlock†i¡", *
™
);

710 
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`”a£
(*
™
);

711 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

712 "D–‘pÜˆ%d from Block†i¡", *
™
);

715 if(
	`Çs_Ïg_block_pÜt
(
Çs_Ïg_’Œy
,*
™
,
pÜt_¡©e
è!ğ
STD_ERR_OK
)

717 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

718 "E¼Ü Block/unblock PÜˆ%d",*
™
);

719  
ıs_­i_»t_code_ERR
;

727 if(
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`fšd
(*
™
è=ğÇs_Ïg_’Œy->pÜt_li¡.
	`’d
()){

732 
ıs_­i_objeù_t
 
Ïg_obj
 = 
	`ıs_­i_objeù_ü—‹
();

733 if(!
Ïg_obj
){

734 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-LAG","Failedo‡llocate memoryo create objo‡dd/delete"

736  
ıs_­i_»t_code_ERR
;

738 
ıs_­i_objeù_gu¬d
 
	`og
(
Ïg_obj
);

739 
	`ıs_­i_objeù_©Œ_add_u32
(
Ïg_obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

740 
Çs_Ïg_’Œy
->
ifšdex
);

741 
	`ıs_­i_objeù_©Œ_add_u32
(
Ïg_obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
,*
™
);

743 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "Update block/unblock…ort %d,lag %do kernel",

744 *
™
,
Çs_Ïg_’Œy
->
ifšdex
);

746 if(
pÜt_¡©e
) {

747 if(
	`Çs_os_d–‘e_pÜt_äom_Ïg
(
Ïg_obj
è!ğ
STD_ERR_OK
) {

748 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "OS:Error deleting intf %d, mem idx %d",

749 
Çs_Ïg_’Œy
->
ifšdex
, *
™
);

750  
ıs_­i_»t_code_ERR
;

753 if(
	`Çs_os_add_pÜt_to_Ïg
(
Ïg_obj
è!ğ
STD_ERR_OK
) {

754 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "OS:Error‡dding intf %d, mem idx %d",

755 
Çs_Ïg_’Œy
->
ifšdex
, *
™
);

756  
ıs_­i_»t_code_ERR
;

761  
rc
;

762 
	}
}

764 
boŞ
 
	$Çs_Ïg_´oûss_memb”_pÜts
(
ıs_­i_objeù_t
 
obj
,
Çs_pÜt_li¡_t
 & 
li¡
,

765 cÚ¡ 
ıs_­i_objeù_™_t
 & 
™
){

766 
ıs_­i_objeù_™_t
 
™_lvl_1
 = 
™
;

767 
š‹rçû_ù¾_t
 
i
;

768 
ıs_­i_©Œ_id_t
 
ids
[3] = {
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
,0,

769 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS_NAME
 };

770 cÚ¡ 
ids_Ën
 = (
ids
)/(ids[0]);

772 
	`ıs_­i_objeù_™_šside
 (&
™_lvl_1
); 
	`ıs_­i_objeù_™_v®id
 (&it_lvl_1);

773 
	`ıs_­i_objeù_™_Ãxt
 (&
™_lvl_1
)) {

775 
ids
[1] = 
	`ıs_­i_objeù_©Œ_id
 (
™_lvl_1
.
©Œ
);

776 
ıs_­i_objeù_©Œ_t
 
štf
 = 
	`ıs_­i_objeù_e_g‘
(
obj
,
ids
,
ids_Ën
);

778 if(
štf
 =ğ
NULL
){

779 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

781  
çl£
;

784 if(!
	`Çs_Ïg_g‘_štf_ù¾_šfo
((cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
štf
),
i
)){

785  
çl£
;

788 
li¡
.
	`š£¹
(
i
.
if_šdex
);

792  
Œue
;

794 
	}
}

799 
BASE_IF_MAC_LEARN_MODE_t
 
	$Çs_commÚ_Ë¬n_mode
 (
BASE_IF_PHY_MAC_LEARN_MODE_t
 
ndi_fdb_Ë¬n_mode
){

801 cÚ¡‡utØ
Çs_to_commÚ_Ë¬n_mode
 = 
Ãw
 
¡d
::
unÜd”ed_m­
<
BASE_IF_PHY_MAC_LEARN_MODE_t
,

802 
BASE_IF_MAC_LEARN_MODE_t
,
¡d
::
hash
<>>

804 {
BASE_IF_PHY_MAC_LEARN_MODE_DROP
, 
BASE_IF_MAC_LEARN_MODE_DROP
},

805 {
BASE_IF_PHY_MAC_LEARN_MODE_DISABLE
, 
BASE_IF_MAC_LEARN_MODE_DISABLE
},

806 {
BASE_IF_PHY_MAC_LEARN_MODE_HW
, 
BASE_IF_MAC_LEARN_MODE_HW
},

807 {
BASE_IF_PHY_MAC_LEARN_MODE_CPU_TRAP
, 
BASE_IF_MAC_LEARN_MODE_CPU_TRAP
},

808 {
BASE_IF_PHY_MAC_LEARN_MODE_CPU_LOG
, 
BASE_IF_MAC_LEARN_MODE_CPU_LOG
},

811 
BASE_IF_MAC_LEARN_MODE_t
 
mode
;

812 autØ
™
 = 
Çs_to_commÚ_Ë¬n_mode
->
	`fšd
(
ndi_fdb_Ë¬n_mode
);

813 if(
™
 !ğ
Çs_to_commÚ_Ë¬n_mode
->
	`’d
()){

814 
mode
 = 
™
->
£cÚd
;

816 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

818 
mode
 = 
BASE_IF_MAC_LEARN_MODE_HW
;

820  
mode
;

821 
	}
}

823 
t_¡d_”rÜ
 
	$Çs_Ïg_£t_mac_Ë¬n_mode
(
ıs_­i_objeù_t
 
obj
,
Çs_Ïg_ma¡”_šfo_t
 * 
’Œy
){

824 
ıs_­i_objeù_©Œ_t
 
mac_Ë¬n_mode
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

825 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_LEARN_MODE
);

826 if(
mac_Ë¬n_mode
 =ğ
nuÎ±r
è 
	`STD_ERR
(
INTERFACE
,
CFG
,0);

827 
BASE_IF_PHY_MAC_LEARN_MODE_t
 
mode
 = (BASE_IF_PHY_MAC_LEARN_MODE_t)

828 
	`ıs_­i_objeù_©Œ_d©a_u32
(
mac_Ë¬n_mode
);

830 
boŞ
 
’abË
 = 
Œue
;

831 if(
mode
 =ğ
BASE_IF_PHY_MAC_LEARN_MODE_DROP
 || mod=ğ
BASE_IF_PHY_MAC_LEARN_MODE_DISABLE
 ){

832 
’abË
 = 
çl£
;

835 if(
	`Çs_os_mac_chªge_Ë¬nšg
(
’Œy
->
ifšdex
,
’abË
è!ğ
STD_ERR_OK
){

836 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-IF-SET","Failedo update MAC†earn mode in Linux kernel");

837  
	`STD_ERR
(
INTERFACE
,
CFG
,0);

840 
’Œy
->
mac_Ë¬n_mode
 = 
mode
;

841 
’Œy
->
mac_Ë¬n_mode_£t
 = 
Œue
;

843  
	`ndi_£t_Ïg_Ë¬n_mode
(0, 
’Œy
->
ndi_Ïg_id
, 
	`Çs_commÚ_Ë¬n_mode
(
mode
));

845 
	}
}

847 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_£t_Ïg
(
ıs_­i_objeù_t
 
obj
)

849 
h®_ifšdex_t
 
Ïg_šdex
 = 0;

850 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

851 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
;

852 
ıs_­i_objeù_™_t
 
™
;

853 
Çs_pÜt_li¡_t
 
pÜt_li¡
, 
block_pÜt_li¡
, 
unblock_pÜt_li¡
;

855 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "CPS Set LAG");

857 if(!
	`Çs_Ïg_g‘_ifšdex_äom_obj
(
obj
,&
Ïg_šdex
)){

858 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "CPS Set LAG failed");

859  
ıs_­i_»t_code_ERR
;

862 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
Ïg_šdex
);

864 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
Ïg_šdex
);

866 if(
Çs_Ïg_’Œy
 =ğ
NULL
) {

867 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "Lag‚ode is NULL");

868  
ıs_­i_»t_code_ERR
;

871 
ıs_­i_objeù_©Œ_t
 
memb”_pÜt_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS_NAME
);

873 
boŞ
 
pÜt_li¡_©Œ
 = 
çl£
;

874 
š‹rçû_ù¾_t
 
i
;

876 if(
memb”_pÜt_©Œ
 !ğ
NULL
){

877 
š‹rçû_ù¾_t
 
_if
;

878 if(!
	`Çs_Ïg_g‘_štf_ù¾_šfo
((cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
memb”_pÜt_©Œ
),
_if
)){

879 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "Lag s‘ o³¿tiÚ faed fÜ Lag %d", 
Ïg_šdex
);

880  
ıs_­i_»t_code_ERR
;

882 
pÜt_li¡
.
	`š£¹
(
_if
.
if_šdex
);

883 
pÜt_li¡_©Œ
 = 
Œue
;

886 
	`ıs_­i_objeù_™_begš
(
obj
,&
™
);

887  ; 
	`ıs_­i_objeù_™_v®id
(&
™
è; 
	`ıs_­i_objeù_™_Ãxt
(&it) ) {

888 
id
 = (è
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

889 
id
) {

890 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
:

891 
rc
 = 
	`Çs_ıs_£t_mac
(
obj
,
Ïg_šdex
);

893 
DELL_IF_IF_INTERFACES_INTERFACE_MTU
:

894 
rc
ğ
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
);

896 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_LEARN_MODE
:

897 
rc
 = 
	`Çs_Ïg_£t_mac_Ë¬n_mode
(
obj
,
Çs_Ïg_’Œy
);

899 
IF_INTERFACES_INTERFACE_ENABLED
:

900 
rc
 = 
	`Çs_ıs_£t_admš_¡©us
(
obj
,
Ïg_šdex
,
Çs_Ïg_’Œy
);

902 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
:

903 
pÜt_li¡_©Œ
 = 
Œue
;

904 ià(
	`ıs_­i_objeù_©Œ_Ën
(
™
.
©Œ
) != 0) {

905 if(!
	`Çs_Ïg_´oûss_memb”_pÜts
(
obj
,
pÜt_li¡
,
™
)){

906  
ıs_­i_»t_code_ERR
;

910 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_BLOCK_PORT_LIST
:

911 ià(
	`ıs_­i_objeù_©Œ_Ën
(
™
.
©Œ
) != 0) {

912 if(!
	`Çs_Ïg_g‘_štf_ù¾_šfo
((cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
),
i
)){

913 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "CPS block†i¡…roûssšg faed fÜ LAG %d", 
Ïg_šdex
);

914  
ıs_­i_»t_code_ERR
;

916 
block_pÜt_li¡
.
	`š£¹
(
i
.
if_šdex
);

919 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_UNBLOCK_PORT_LIST
:

920 ià(
	`ıs_­i_objeù_©Œ_Ën
(
™
.
©Œ
) != 0) {

921 if(!
	`Çs_Ïg_g‘_štf_ù¾_šfo
((cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
),
i
)){

922 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "CPS unblock†i¡…roûssšg faed fÜ LAG %d", 
Ïg_šdex
);

923  
ıs_­i_»t_code_ERR
;

925 
unblock_pÜt_li¡
.
	`š£¹
(
i
.
if_šdex
);

928 
IF_INTERFACES_INTERFACE_DESCRIPTION
:

929 
rc
 = 
	`Çs_ıs_£t_desc
(
™
.
©Œ
, 
Ïg_šdex
);

932 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

933 "Reûived‡‰rib %d", 
id
);

938 if(
unblock_pÜt_li¡
.
	`size
()) {

939 
rc
 = 
	`Çs_´oûss_Ïg_block_pÜts
(
Çs_Ïg_’Œy
, 
unblock_pÜt_li¡
, 
çl£
);

940 if(
rc
 =ğ
ıs_­i_»t_code_ERR
){

941 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-CPS-LAG", "Failedo…rocess unblocked†ag…orts");

942  
rc
;

946 if(
block_pÜt_li¡
.
	`size
()) {

947 
rc
 = 
	`Çs_´oûss_Ïg_block_pÜts
(
Çs_Ïg_’Œy
, 
block_pÜt_li¡
, 
Œue
);

948 if(
rc
 =ğ
ıs_­i_»t_code_ERR
){

949 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-CPS-LAG", "Failedo…rocess blocked†ag…orts");

950  
rc
;

955 if(
pÜt_li¡_©Œ
) {

956 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

957 "Reûived %lu v®id…Üt ", 
pÜt_li¡
.
	`size
());

958 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

963 if(
	`ıs_Ïg_upd©e_pÜts
(
Çs_Ïg_’Œy
, 
pÜt_li¡
,
İ
è!=
STD_ERR_OK
)

965 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

967  
ıs_­i_»t_code_ERR
;

970 
İ
 = 
ıs_­i_İ”_SET
;

972 if(
	`Ïg_objeù_publish
(
Çs_Ïg_’Œy
,
Ïg_šdex
,
İ
)!ğ
ıs_­i_»t_code_OK
)

974 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

976  
ıs_­i_»t_code_ERR
;

980  
rc
;

981 
	}
}

984 
	$Çs_·ck_Ïg_if
(
ıs_­i_objeù_t
 
obj
, 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
)

986 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),
BASE_IF_LAG_IF_INTERFACES_INTERFACE_OBJ
,

987 
ıs_­i_qu®if›r_TARGET
);

989 
	`ıs_­i_£t_key_d©a
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

990 
ıs_­i_objeù_ATTR_T_U32
,

991 &
Çs_Ïg_’Œy
->
ifšdex
,(nas_lag_entry->ifindex));

992 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,

993 
ıs_­i_objeù_ATTR_T_BIN
,

994 
Çs_Ïg_’Œy
->
Çme
, 
	`¡¾’
(nas_lag_entry->name)+1);

996 ià(
Çs_Ïg_’Œy
->
Ïg_id
 !ğ
INVALID_LAG_ID
)

997 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_ID
, 
Çs_Ïg_’Œy
->
Ïg_id
);

999 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

1000 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

1001 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
)+1);

1003 
	`Çs_·ck_Ïg_pÜt_li¡
(
obj
,
Çs_Ïg_’Œy
,
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
,
Œue
);

1005 if(!
Çs_Ïg_’Œy
->
mac_addr
.
	`em±y
()){

1006 
	`ıs_­i_objeù_©Œ_add
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, 
Çs_Ïg_’Œy
->
mac_addr
.
	`c_¡r
(),

1007 
Çs_Ïg_’Œy
->
mac_addr
.
	`Ëngth
()+1);

1010 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
 ,
Çs_Ïg_’Œy
->
admš_¡©us
);

1014 
	`Çs_os_g‘_š‹rçû_mtu
(
Çs_Ïg_’Œy
->
Çme
, 
obj
);

1016 
Çs
::
ndi_obj_id_bË_t
 
Ïg_İaque_d©a_bË
;

1018 
Ïg_İaque_d©a_bË
[0] = 
Çs_Ïg_’Œy
->
ndi_Ïg_id
;

1019 
ıs_­i_©Œ_id_t
 
©Œ_id_li¡
[] = {
BASE_IF_LAG_IF_INTERFACES_INTERFACE_LAG_OPAQUE_DATA
};

1020 
Çs
::
	`ndi_obj_id_bË_ıs_£rŸlize
 (
Ïg_İaque_d©a_bË
, 
obj
, 
©Œ_id_li¡
,

1021 (
©Œ_id_li¡
)/(attr_id_list[0]));

1022 
š‹rçû_ù¾_t
 
štf_ù¾_blk
;

1024 if(!
	`Çs_Ïg_g‘_štf_ù¾_šfo
(
Çs_Ïg_’Œy
->
ifšdex
, 
štf_ù¾_blk
)) {

1025 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

1027 "š‹rçû %d", 
Çs_Ïg_’Œy
->
ifšdex
);

1031 ià(
štf_ù¾_blk
.
desc
) {

1032 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_DESCRIPTION
,

1033 (cÚ¡ *)
štf_ù¾_blk
.
desc
, 
	`¡¾’
(intf_ctrl_blk.desc) + 1);

1035 
	}
}

1037 
	$Çs_·ck_Ïg_if_¡©e
(
ıs_­i_objeù_t
 
obj
, 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
)

1039 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),
BASE_IF_LAG_IF_INTERFACES_STATE_INTERFACE_OBJ
,

1040 
ıs_­i_qu®if›r_OBSERVED
);

1042 
	`ıs_­i_£t_key_d©a
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

1043 
ıs_­i_objeù_ATTR_T_U32
,

1044 &
Çs_Ïg_’Œy
->
ifšdex
,(nas_lag_entry->ifindex));

1045 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_STATE_INTERFACE_NAME
,

1046 
ıs_­i_objeù_ATTR_T_BIN
,

1047 
Çs_Ïg_’Œy
->
Çme
, 
	`¡¾’
(nas_lag_entry->name)+1);

1049 ià(
Çs_Ïg_’Œy
->
Ïg_id
 !ğ
INVALID_LAG_ID
)

1050 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_ID
, 
Çs_Ïg_’Œy
->
Ïg_id
);

1051 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
, 
Çs_Ïg_’Œy
->
admš_¡©us
 ?

1052 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_UP
 : 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_DOWN
);

1053 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
, 
Çs_Ïg_’Œy
->
İ”_¡©us
 ?

1054 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
 : 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
);

1055 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_LEARN_MODE
,

1056 
Çs_Ïg_’Œy
->
mac_Ë¬n_mode_£t
 ?‚as_Ïg_’Œy->
mac_Ë¬n_mode
 : 
BASE_IF_PHY_MAC_LEARN_MODE_DISABLE
);

1057 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_LAG_IF_INTERFACES_STATE_INTERFACE_NUM_PORTS
, (
Çs_Ïg_’Œy
->
pÜt_li¡
).
	`size
());

1059 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_STATE_INTERFACE_TYPE
,

1060 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

1061 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
)+1);

1063 
	`Çs_·ck_Ïg_pÜt_li¡
(
obj
,
Çs_Ïg_’Œy
,
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
,
Œue
);

1065 if(!
Çs_Ïg_’Œy
->
mac_addr
.
	`em±y
()){

1066 
	`ıs_­i_objeù_©Œ_add
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, 
Çs_Ïg_’Œy
->
mac_addr
.
	`c_¡r
(),

1067 
Çs_Ïg_’Œy
->
mac_addr
.
	`Ëngth
()+1);

1070 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
 ,
Çs_Ïg_’Œy
->
admš_¡©us
);

1074 
	`Çs_os_g‘_š‹rçû_mtu
(
Çs_Ïg_’Œy
->
Çme
, 
obj
);

1076 
Çs
::
ndi_obj_id_bË_t
 
Ïg_İaque_d©a_bË
;

1078 
Ïg_İaque_d©a_bË
[0] = 
Çs_Ïg_’Œy
->
ndi_Ïg_id
;

1079 
ıs_­i_©Œ_id_t
 
©Œ_id_li¡
[] = {
BASE_IF_LAG_IF_INTERFACES_INTERFACE_LAG_OPAQUE_DATA
};

1080 
Çs
::
	`ndi_obj_id_bË_ıs_£rŸlize
 (
Ïg_İaque_d©a_bË
, 
obj
, 
©Œ_id_li¡
,

1081 (
©Œ_id_li¡
)/(attr_id_list[0]));

1082 
	}
}

1084 
t_¡d_”rÜ
 
	$Çs_g‘_Ïg_štf
(
h®_ifšdex_t
 
ifšdex
, 
ıs_­i_objeù_li¡_t
 
li¡
, 
boŞ
 
g‘_štf_¡©e
)

1086 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
NULL
;

1088 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG-CPS",

1089 "G‘†ag % %d", (
g‘_štf_¡©e
 ? "š‹rçû-¡©e" : "š‹rçû"), 
ifšdex
);

1091 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
ifšdex
);

1093 if(
Çs_Ïg_’Œy
 =ğ
NULL
) {

1094 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG-CPS",

1095 "E¼Ü fšdšg†agnod%d fÜ g‘ o³¿tiÚ", 
ifšdex
);

1096 (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

1098 
ıs_­i_objeù_t
 
objeù
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
li¡
);

1100 if(
objeù
 =ğ
NULL
){

1101 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "obj NULL failure");

1102 (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

1105 ià(
g‘_štf_¡©e
) {

1106 
	`Çs_·ck_Ïg_if_¡©e
(
objeù
, 
Çs_Ïg_’Œy
);

1108 
	`Çs_·ck_Ïg_if
(
objeù
, 
Çs_Ïg_’Œy
);

1111  
STD_ERR_OK
;

1112 
	}
}

1114 
t_¡d_”rÜ
 
	$Çs_Ïg_g‘_®l_šfo
(
ıs_­i_objeù_li¡_t
 
li¡
, 
boŞ
 
g‘_štf_¡©e
)

1116 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
NULL
;

1117 
Çs_Ïg_ma¡”_bË_t
 
Çs_Ïg_ma¡”_bË
;

1119 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG-CPS", "G‘tšg‡Î†ag %s", (
g‘_štf_¡©e
 ? "interface-states" : "interfaces"));

1121 
Çs_Ïg_ma¡”_bË
 = 
	`Çs_g‘_Ïg_bË
();

1123 autØ
™
 =
Çs_Ïg_ma¡”_bË
.
	`begš
();™ !ğÇs_Ïg_ma¡”_bË.
	`’d
();++it){

1125 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG-CPS", "Inside Loop");

1126 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
li¡
);

1127 ià(
obj
 =ğ
NULL
) {

1128 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "obj NULL failure");

1129  
	`STD_ERR
(
INTERFACE
, 
NOMEM
, 0);

1132 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
™
->
fœ¡
);

1134 if(
Çs_Ïg_’Œy
 =ğ
NULL
) {

1135 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG-CPS",

1136 "E¼Ü fšdšg†agnod%d fÜ g‘ o³¿tiÚ", 
™
->
fœ¡
);

1137 (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

1140 if(
g‘_štf_¡©e
) {

1141 
	`Çs_·ck_Ïg_if_¡©e
(
obj
, 
Çs_Ïg_’Œy
);

1143 
	`Çs_·ck_Ïg_if
(
obj
, 
Çs_Ïg_’Œy
);

1147  
STD_ERR_OK
;

1148 
	}
}

1150 
t_¡d_”rÜ
 
	$Çs_Ïg_ndi_™_to_obj_fl
(
Çs_obj_id_t
 
ndi_Ïg_id
,
ıs_­i_objeù_li¡_t
 
li¡
, 
boŞ
 
g‘_štf_¡©e
)

1152 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
NULL
;

1153 
Çs_Ïg_ma¡”_bË_t
 
Çs_Ïg_ma¡”_bË
;

1155 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG-CPS", "Fill opaque data....");

1157 if(
ndi_Ïg_id
 == 0)

1158  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

1160 
Çs_Ïg_ma¡”_bË
 = 
	`Çs_g‘_Ïg_bË
();

1161 autØ
™
 =
Çs_Ïg_ma¡”_bË
.
	`begš
();™ !ğÇs_Ïg_ma¡”_bË.
	`’d
();++it){

1164 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
™
->
fœ¡
);

1166 if(
Çs_Ïg_’Œy
 =ğ
NULL
) {

1167 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG-CPS",

1169 
™
->
fœ¡
);

1170 (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

1173 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-LAG-CPS",

1175 
Çs_Ïg_’Œy
->
ndi_Ïg_id
,‚di_lag_id);

1177 if(
Çs_Ïg_’Œy
->
ndi_Ïg_id
 ==‚di_lag_id){

1178 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
li¡
);

1179 if(
obj
 =ğ
NULL
) {

1180 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "obj NULL failure");

1181  
	`STD_ERR
(
INTERFACE
, 
NOMEM
, 0);

1184 if(
g‘_štf_¡©e
) {

1185 
	`Çs_·ck_Ïg_if_¡©e
(
obj
,
Çs_Ïg_’Œy
);

1187 
	`Çs_·ck_Ïg_if
(
obj
,
Çs_Ïg_’Œy
);

1190  
STD_ERR_OK
;

1194  (
	`STD_ERR
(
INTERFACE
,
FAIL
,0));

1195 
	}
}

1197 
ıs_­i_»tuº_code_t
 
	$Çs_´oûss_ıs_Ïg_g‘
(* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

1198 
size_t
 
ix
) {

1199 
h®_ifšdex_t
 
ifšdex
 = 0;

1200 
boŞ
 
İaque_©Œ_d©a
 = 
çl£
;

1201 
Çs_obj_id_t
 
ndi_Ïg_id
=0;

1203 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "cps_nas_lag_get_function");

1205 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
, 
ix
);

1207 
ıs_­i_objeù_©Œ_t
 
ndi_Ïg_id_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1208 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_LAG_OPAQUE_DATA
);

1210 if(
ndi_Ïg_id_©Œ
 !ğ
nuÎ±r
){

1211 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

1213 
	`ıs_­i_objeù_©Œ_d©a_u64
(
ndi_Ïg_id_©Œ
));

1214 
ndi_Ïg_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u64
(
ndi_Ïg_id_©Œ
);

1215 
İaque_©Œ_d©a
=
Œue
;

1218 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`lock_t
(
	`Çs_Ïg_mu‹x_lock
());

1220 if(
	`Çs_Ïg_g‘_ifšdex_äom_obj
(
obj
,&
ifšdex
)){

1221 if(
	`Çs_g‘_Ïg_štf
(
ifšdex
, 
·¿m
->
li¡
, 
çl£
)!ğ
STD_ERR_OK
){

1222  
ıs_­i_»t_code_ERR
;

1224 }if(
İaque_©Œ_d©a
 =ğ
Œue
){

1225 if(
	`Çs_Ïg_ndi_™_to_obj_fl
(
ndi_Ïg_id
,
·¿m
->
li¡
, 
çl£
è!ğ
STD_ERR_OK
)

1226  
ıs_­i_»t_code_ERR
;

1228 if(
	`Çs_Ïg_g‘_®l_šfo
(
·¿m
->
li¡
, 
çl£
è!ğ
STD_ERR_OK
)

1229  
ıs_­i_»t_code_ERR
;

1232  
ıs_­i_»t_code_OK
;

1233 
	}
}

1235 
ıs_­i_»tuº_code_t
 
	$Çs_´oûss_ıs_Ïg_£t
(*
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
,

1236 
size_t
 
ix
)

1238 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

1239 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

1240 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

1242 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "cps_nas_lag_set_function");

1244 
ıs_­i_objeù_t
 
şÚed
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
·¿m
->
´ev
);

1245 if(
şÚed
 =ğ
NULL
){

1246 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG", "obj NULL failure");

1247  
ıs_­i_»t_code_ERR
;

1250 
	`ıs_­i_objeù_şÚe
(
şÚed
,
obj
);

1253 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`lock_t
(
	`Çs_Ïg_mu‹x_lock
());

1255 ifĞ
İ
 =ğ
ıs_­i_İ”_CREATE
){

1256  (
	`Çs_ıs_ü—‹_Ïg
(
obj
));

1258 if(
İ
 =ğ
ıs_­i_İ”_DELETE
){

1259  (
	`Çs_ıs_d–‘e_Ïg
(
obj
));

1261 if(
İ
 =ğ
ıs_­i_İ”_SET
){

1262  (
	`Çs_ıs_£t_Ïg
(
obj
));

1265  
rc
;

1266 
	}
}

1268 
ıs_­i_»tuº_code_t
 
	$Çs_´oûss_ıs_Ïg_¡©e_g‘
(* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

1269 
size_t
 
ix
) {

1270 
h®_ifšdex_t
 
ifšdex
 = 0;

1271 
boŞ
 
İaque_©Œ_d©a
 = 
çl£
;

1272 
Çs_obj_id_t
 
ndi_Ïg_id
=0;

1274 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "cps_nas_lag_state_get_function");

1276 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
, 
ix
);

1278 
ıs_­i_objeù_©Œ_t
 
ndi_Ïg_id_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1279 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_LAG_OPAQUE_DATA
);

1281 if(
ndi_Ïg_id_©Œ
 !ğ
nuÎ±r
){

1282 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

1284 
	`ıs_­i_objeù_©Œ_d©a_u64
(
ndi_Ïg_id_©Œ
));

1285 
ndi_Ïg_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u64
(
ndi_Ïg_id_©Œ
);

1286 
İaque_©Œ_d©a
=
Œue
;

1289 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`lock_t
(
	`Çs_Ïg_mu‹x_lock
());

1291 if(
	`Çs_Ïg_g‘_ifšdex_äom_obj
(
obj
,&
ifšdex
)){

1292 if(
	`Çs_g‘_Ïg_štf
(
ifšdex
, 
·¿m
->
li¡
, 
Œue
)!ğ
STD_ERR_OK
){

1293  
ıs_­i_»t_code_ERR
;

1295 }if(
İaque_©Œ_d©a
 =ğ
Œue
){

1296 if(
	`Çs_Ïg_ndi_™_to_obj_fl
(
ndi_Ïg_id
,
·¿m
->
li¡
, 
Œue
è!ğ
STD_ERR_OK
)

1297  
ıs_­i_»t_code_ERR
;

1299 if(
	`Çs_Ïg_g‘_®l_šfo
(
·¿m
->
li¡
, 
Œue
è!ğ
STD_ERR_OK
)

1300  
ıs_­i_»t_code_ERR
;

1303  
ıs_­i_»t_code_OK
;

1304 
	}
}

1306 
ıs_­i_»tuº_code_t
 
	$Çs_´oûss_ıs_Ïg_¡©e_£t
(*
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
,

1307 
size_t
 
ix
)

1310  
ıs_­i_»t_code_ERR
;

1311 
	}
}

1313 
	$Çs_Ïg_pÜt_İ”_¡©e_cb
(
Åu_id_t
 
Åu
, 
Åu_pÜt_t
 
pÜt
, 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©us
)

1315 
ndi_pÜt_t
 
ndi_pÜt
;

1316 
ndi_pÜt
.
Åu_id
 = 
Åu
;

1317 
ndi_pÜt
.
Åu_pÜt
 = 
pÜt
;

1318 
h®_ifšdex_t
 
¦ave_šdex
, 
ma¡”_šdex
;

1319 
boŞ
 
block_¡©us
 = 
Œue
;

1321 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

1324 ià(
	`Çs_št_g‘_if_šdex_äom_Åu_pÜt
(&
¦ave_šdex
, &
ndi_pÜt
è!ğ
STD_ERR_OK
) {

1327 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`lock_t
(
	`Çs_Ïg_mu‹x_lock
());

1328 iàĞ(
ma¡”_šdex
 = 
	`Çs_g‘_ma¡”_idx
(
¦ave_šdex
)) == -1 ) {

1331 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
ğ
NULL
;

1332 ià((
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
ma¡”_šdex
)è=ğ
NULL
 ) {

1336 
Çs_Ïg_’Œy
->
pÜt_İ”_li¡
[
¦ave_šdex
]=(
¡©us
 =ğ
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
) ?

1337 
Œue
 : 
çl£
;

1340 ià((
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`fšd
(
¦ave_šdex
) ==

1341 
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`’d
()) &&

1342 (
¡©us
 =ğ
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
) ) {

1344 
block_¡©us
 = 
çl£
;

1345 ià(!
Çs_Ïg_’Œy
->
İ”_¡©us
) {

1346 
	`Çs_Ïg_upd©e_ma¡”_İ”_¡©e
(
Çs_Ïg_’Œy
, 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
);

1347 
Çs_Ïg_’Œy
->
İ”_¡©us
 = 
Œue
;

1348 
	`Ïg_¡©e_objeù_publish
(
Çs_Ïg_’Œy
,
Œue
);

1352 ià(
	`Çs_Ïg_block_pÜt
(
Çs_Ïg_’Œy
, 
¦ave_šdex
, 
block_¡©us
è!ğ
STD_ERR_OK
){

1353 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-CPS-LAG",

1354 "E¼Ü Block/unblock PÜˆ%d†ag %d ",
¦ave_šdex
, 
ma¡”_šdex
);

1358 if(
¡©us
 =ğ
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
){

1359 
boŞ
 
publish_İ”_down
 = 
Œue
;

1360 cÚ¡‡utØ&
™
 : 
Çs_Ïg_’Œy
->
pÜt_İ”_li¡
){

1361 if(
™
.
£cÚd
 =ğ
Œue
){

1362 
publish_İ”_down
 = 
çl£
;

1367 if(
publish_İ”_down
){

1368 
Çs_Ïg_’Œy
->
İ”_¡©us
 = 
çl£
;

1369 
	`Çs_Ïg_upd©e_ma¡”_İ”_¡©e
(
Çs_Ïg_’Œy
, 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
);

1370 
	`Ïg_¡©e_objeù_publish
(
Çs_Ïg_’Œy
,
çl£
);

1374 
	}
}

1376 
boŞ
 
	$Çs_Ïg_´oûss_pÜt_assocŸtiÚ
(
h®_ifšdex_t
 
ifšdex
, 
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,
boŞ
 
add
){

1378 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`lock_t
(
	`Çs_Ïg_mu‹x_lock
());

1379 autØ
m_li¡
 = 
	`Çs_štf_g‘_ma¡”
(
ifšdex
);

1380 autØ
™
 : 
m_li¡
){

1381 if(
™
.
ty³
 =ğ
Çs_št_ty³_LAG
){

1383 if(
add
){

1384 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
™
.
m_if_idx
);

1386 if(
Çs_Ïg_’Œy
 =ğ
NULL
){

1387 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-LAG-MAP","No LAGƒntry for ifindex %dƒxist",

1388 
™
.
m_if_idx
);

1392 if(
	`Çs_Ïg_memb”_add
(
Çs_Ïg_’Œy
->
ifšdex
,ifšdexè!ğ
STD_ERR_OK
){

1393 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG-MAP","Error inserting index %d in†ist",

1394 
ifšdex
);

1398 if((
	`Çs_Ïg_memb”_d–‘e
(0,
ifšdex
è!ğ
STD_ERR_OK
)){

1399 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG-MAP","Error deleting†ag"

1400 " iÁ”çû %d from NPU", 
ifšdex
);

1407  
Œue
;

1408 
	}
}

1411 
boŞ
 
	$Çs_Ïg_if_£t_hªdËr
(
ıs_­i_objeù_t
 
obj
, *
cÚ‹xt
)

1413 
Çs_št_pÜt_m­pšg_t
 
pÜt_m­pšg
;

1414 if(!
	`Çs_g‘_phy_pÜt_m­pšg_chªge
Ğ
obj
, &
pÜt_m­pšg
)){

1415 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-LAG-MAP","Interfaceƒvent is‚ot‡n "

1417  
Œue
;

1420 
ıs_­i_objeù_©Œ_t
 
Åu_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1421 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
);

1422 
ıs_­i_objeù_©Œ_t
 
pÜt_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1423 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
);

1424 
ıs_­i_objeù_©Œ_t
 
if_šdex_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
,

1425 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

1427 ià(
Åu_©Œ
 =ğ
nuÎ±r
 || 
pÜt_©Œ
 =ğnuÎ±¸|| 
if_šdex_©Œ
 ==‚ullptr) {

1428 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
, "NAS-LAG-MAP", "Interface object does‚ot have if-index/npu/port");

1429  
Œue
;

1432 
h®_ifšdex_t
 
ifidx
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_šdex_©Œ
);

1433 
Åu_id_t
 
Åu
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
Åu_©Œ
);

1434 
Åu_pÜt_t
 
pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
pÜt_©Œ
);

1436 
boŞ
 
add
 = (
pÜt_m­pšg
 =ğ
Çs_št_phy_pÜt_MAPPED
è? 
Œue
 : 
çl£
;

1438  
	`Çs_Ïg_´oûss_pÜt_assocŸtiÚ
(
ifidx
,
Åu
,
pÜt
,
add
);

1440 
	}
}

1442 
t_¡d_”rÜ
 
	$Çs_ıs_Ïg_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
Ïg_štf_hªdË
) {

1444 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG", "CPS LAG Initialize");

1446 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF
, 
Çs_št_ty³_LAG
, 
Çs_´oûss_ıs_Ïg_g‘
, 
Çs_´oûss_ıs_Ïg_£t
è!ğ
STD_ERR_OK
) {

1447 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG-INIT",

1449  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1452 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF_STATE
, 
Çs_št_ty³_LAG
, 
Çs_´oûss_ıs_Ïg_¡©e_g‘
, 
Çs_´oûss_ıs_Ïg_¡©e_£t
è!ğ
STD_ERR_OK
) {

1453 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-LAG-INIT",

1455  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1458 
	`Çs_št_İ”_¡©e_»gi¡”_cb
(
Çs_Ïg_pÜt_İ”_¡©e_cb
);

1460 ià(
	`ıs_­i_ev’t_£rviû_š™
(è!ğ
ıs_­i_»t_code_OK
) {

1461  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1464 ià(
	`ıs_­i_ev’t_th»ad_š™
(è!ğ
ıs_­i_»t_code_OK
) {

1465  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1468 
ıs_­i_ev’t_»g_t
 
»g
;

1469 
ıs_­i_key_t
 
key
;

1471 
	`mem£t
(&
»g
, 0, (
ıs_­i_ev’t_»g_t
));

1473 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
key
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

1474 
ıs_­i_qu®if›r_OBSERVED
)) {

1475 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VLAN-INIT", "Cannot create‡ key for interfaceƒvent");

1476  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1479 
»g
.
objeùs
 = &
key
;

1480 
»g
.
numb”_of_objeùs
 = 1;

1482 ià(
	`ıs_­i_ev’t_th»ad_»g
(&
»g
, 
Çs_Ïg_if_£t_hªdËr
, 
NULL
)!ğ
ıs_­i_»t_code_OK
) {

1483 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VLAN-INIT", "Cannot„egister interface operationƒvent");

1484  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1486  
STD_ERR_OK
;;

1487 
	}
}

	@src/nas_int_base_if.cpp

23 
	~"ev’t_log.h
"

24 
	~"ev’t_log_ty³s.h
"

25 
	~"Çs_št_ba£_if.h
"

26 
	~"Çs_št_uts.h
"

27 
	~"ıs_­i_İ”©iÚ.h
"

28 
	~"ıs_­i_objeù_key.h
"

29 
	~"ıs_şass_m­.h
"

31 
	~<exû±iÚ
>

33 
	g¡d
::
unique_±r
<
Çs_štf_cÚš”
> 
if_cÚt_š¡
 (
Ãw
‚as_intf_container);

37 
boŞ
 
	$Çs_štf_add_ma¡”
(
h®_ifšdex_t
 
ifx
, 
if_ma¡”_šfo_t
 
m_šfo
)

39 
Œy
 {

40 
if_cÚt_š¡
->
	`Çs_štf_add_ma¡”
(
ifx
, 
m_šfo
);

41 } 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

42 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"IF_CONT", "%s", 
e
.
	`wh©
());

43  
çl£
;

46  
Œue
;

47 
	}
}

49 
boŞ
 
	$Çs_štf_d–_ma¡”
(
h®_ifšdex_t
 
ifx
, 
if_ma¡”_šfo_t
 
m_šfo
)

51  
if_cÚt_š¡
->
	`Çs_štf_d–_ma¡”
(
ifx
, 
m_šfo
);

52 
	}
}

54 
Çs_štf_ma¡”_ÿÎback
(
h®_ifšdex_t
 
ifx
, 
¡d
::
funùiÚ
< (
if_ma¡”_šfo_t
)> 
â
)

56 
if_cÚt_š¡
->
Çs_štf_ma¡”_ÿÎbk
(
ifx
, 
â
);

59 
	g¡d
::
li¡
<
if_ma¡”_šfo_t
> 
	$Çs_štf_g‘_ma¡”
(
h®_ifšdex_t
 
ifx
)

61  
if_cÚt_š¡
->
	`Çs_štf_g‘_ma¡”_li¡
(
ifx
);

62 
	}
}

64 
BASE_IF_MODE_t
 
	$Çs_štf_g‘_mode
(
h®_ifšdex_t
 
ifx
)

66  
if_cÚt_š¡
->
	`Çs_štf_g‘_mode
(
ifx
);

67 
	}
}

69 
	$Çs_štf_dump_cÚš”
(
h®_ifšdex_t
 
ifx
=0) {

70 
if_cÚt_š¡
->
	`Çs_štf_dump_cÚš”
(
ifx
);

71 
	}
}

75 autØ
	gÇs_štf_cÚš”
::
Çs_štf_add_objeù
(
h®_ifšdex_t
 
ifx
è-> 
_if_™”_ty³
 {

77 
Çme
[
HAL_IF_NAME_SZ
] = "\0";

78 
mem£t
(
Çme
,0,(name));

79 ià(
Çs_št_g‘_if_šdex_to_Çme
(
ifx
, 
Çme
, Òame)è!ğ
STD_ERR_OK
)

80 
throw
 
¡d
::
šv®id_¬gum’t
("Conversiono‚ame failed");

82 
_if_unique_obj
 
obj
 (
Ãw
 
Çs_štf_obj
(
ifx
, 
Çme
));

83  (
	gif_objeùs
.
š£¹
(
¡d
::
make_·œ
(
ifx
, std::
move
(
obj
)))).
fœ¡
;

86 
	gÇs_štf_cÚš”
::
	$Çs_štf_d–_objeù
(
h®_ifšdex_t
 
ifx
) {

88 autØ
™r
 = 
if_objeùs
.
	`fšd
(
ifx
);

90 if(
™r
 !ğ
if_objeùs
.
	`’d
()) {

91 
if_objeùs
.
	`”a£
(
™r
);

93 
	}
}

95 
boŞ
 
	gÇs_štf_cÚš”
::
	$Çs_štf_add_ma¡”
(
h®_ifšdex_t
 
ifx
, 
if_ma¡”_šfo_t
 
m_šfo
) {

97 
¡d_rw_lock_wr™e_gu¬d
 
	`lg
(&
rw_lock
);

99 autØ
™r
 = 
if_objeùs
.
	`fšd
(
ifx
);

101 if(
™r
 =ğ
if_objeùs
.
	`’d
()) {

102 
™r
 = 
	`Çs_štf_add_objeù
(
ifx
);

105 auto& 
±r
 = 
™r
->
£cÚd
;

106  
±r
->
	`Çs_štf_obj_ma¡”_add
(
m_šfo
);

107 
	}
}

109 
boŞ
 
	gÇs_štf_cÚš”
::
	$Çs_štf_d–_ma¡”
(
h®_ifšdex_t
 
ifx
, 
if_ma¡”_šfo_t
 
m_šfo
) {

111 
¡d_rw_lock_wr™e_gu¬d
 
	`lg
(&
rw_lock
);

113 autØ
™r
 = 
if_objeùs
.
	`fšd
(
ifx
);

116 if(
™r
 =ğ
if_objeùs
.
	`’d
()) {

117  
çl£
;

120 auto& 
±r
 = 
™r
->
£cÚd
;

121 autØ
rc
 = 
±r
->
	`Çs_štf_obj_ma¡”_d–‘e
(
m_šfo
);

122 if(
±r
->
	`Çs_štf_obj_is_mli¡_em±y
()) {

123 
	`Çs_štf_d–_objeù
(
ifx
);

126  
rc
;

127 
	}
}

129 
	gÇs_štf_cÚš”
::
	$Çs_štf_ma¡”_ÿÎbk
(
h®_ifšdex_t
 
ifx
, 
ma¡”_â_ty³
 
â
) {

131 
¡d_rw_lock_»ad_gu¬d
 
	`lg
(&
rw_lock
);

133 autØ
™r
 = 
if_objeùs
.
	`fšd
(
ifx
);

135 if(
™r
 =ğ
if_objeùs
.
	`’d
()) {

139 auto& 
±r
 = 
™r
->
£cÚd
;

140 
±r
->
	`Çs_štf_obj_fÜ_—ch_ma¡”
(
â
);

141 
	}
}

143 
	g¡d
::
li¡
<
if_ma¡”_šfo_t
> 
Çs_štf_cÚš”
::
	$Çs_štf_g‘_ma¡”_li¡
(
h®_ifšdex_t
 
ifx
) {

145 
¡d
::
li¡
<
if_ma¡”_šfo_t
> 
tmp
;

147 
¡d_rw_lock_»ad_gu¬d
 
	`lg
(&
rw_lock
);

149 autØ
™r
 = 
if_objeùs
.
	`fšd
(
ifx
);

152 if(
™r
 =ğ
if_objeùs
.
	`’d
()) {

153  
tmp
;

156 auto& 
±r
 = 
™r
->
£cÚd
;

157  
±r
->
	`Çs_štf_obj_ma¡”_li¡
();

158 
	}
}

160 
BASE_IF_MODE_t
 
	gÇs_štf_cÚš”
::
	$Çs_štf_g‘_mode
(
h®_ifšdex_t
 
ifx
) {

162 
¡d_rw_lock_»ad_gu¬d
 
	`lg
(&
rw_lock
);

164 autØ
™r
 = 
if_objeùs
.
	`fšd
(
ifx
);

166  ((
™r
 =ğ
if_objeùs
.
	`’d
())

167 ? 
BASE_IF_MODE_MODE_NONE


168 : 
BASE_IF_MODE_MODE_L2
);

169 
	}
}

171 
	gÇs_štf_cÚš”
::
	$Çs_štf_dump_cÚš”
(
h®_ifšdex_t
 
ifx
è
nÛxû±
 {

173 
¡d_rw_lock_»ad_gu¬d
 
	`lg
(&
rw_lock
);

175 autØ
l_â
 = [] (cÚ¡ 
¡d
::
unique_±r
<
Çs_štf_obj
> & 
±r
) {

176 autØ
li¡
 = 
±r
->
	`Çs_štf_obj_ma¡”_li¡
();

177 autØ
iy
 : 
li¡
) {

178 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"IF_CONT", "Master idx %d,ype %d, mode %d",

179 
iy
.
m_if_idx
, iy.
ty³
, iy.
mode
);

183 if(
ifx
) {

184 autØ
™r
 = 
if_objeùs
.
	`fšd
(
ifx
);

185 if(
™r
 =ğ
if_objeùs
.
	`’d
()) {

186 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"IF_CONT", "Objeù dÛ¢'ˆexi¡ %d", 
ifx
);

190 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"IF_CONT", "*****Dumpšg†i¡ fÜ %d*****", 
ifx
);

191 
	`l_â
(
™r
->
£cÚd
);

196 cÚ¡‡uto& 
ix
 : 
if_objeùs
) {

197 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"IF_CONT", "*****Dumpšg†i¡ fÜ %d*****", 
ix
.
fœ¡
);

198 
	`l_â
(
ix
.
£cÚd
);

200 
	}
}

204 
boŞ
 
	gÇs_štf_obj
::
	$Çs_štf_obj_ma¡”_add
(
if_ma¡”_šfo_t
 
m_šfo
) {

206 autØ
™r
 = 
m_li¡
.
	`begš
(); iŒ !ğm_li¡.
	`’d
(); ++itr) {

207 if(
™r
->
m_if_idx
 =ğ
m_šfo
.m_if_idx) {

208  
çl£
;

213 if(
m_šfo
.
ty³
 =ğ
Çs_št_ty³_LAG
){

214 
m_li¡
.
	`push_äÚt
(
m_šfo
);

216 
m_li¡
.
	`push_back
(
m_šfo
);

219  
Œue
;

220 
	}
}

222 
boŞ
 
	gÇs_štf_obj
::
	$Çs_štf_obj_ma¡”_d–‘e
(
if_ma¡”_šfo_t
 
m_šfo
) {

224 autØ
™r
 = 
m_li¡
.
	`begš
(); iŒ !ğm_li¡.
	`’d
(); ++itr) {

225 if(
™r
->
m_if_idx
 =ğ
m_šfo
.m_if_idx) {

226 
™r
 = 
m_li¡
.
	`”a£
(itr);

227  
Œue
;

232  
çl£
;

233 
	}
}

	@src/nas_int_com_utils.cpp

26 
	~"ev’t_log.h
"

27 
	~"ev’t_log_ty³s.h
"

28 
	~"Çs_št_ba£_if.h
"

29 
	~"Çs_št_uts.h
"

30 
	~"¡d_uts.h
"

31 
	~"d–l-ba£-routšg.h
"

32 
	~"ıs_­i_İ”©iÚ.h
"

33 
	~"ıs_­i_objeù_key.h
"

34 
	~"ıs_şass_m­.h
"

35 
	~"l2-muÉiÿ¡.h
"

37 
t_¡d_”rÜ
 
	$Çs_g‘_if_ty³_äom_Çme_Ü_ifšdex
 (cÚ¡ *
if_Çme
, 
h®_ifšdex_t
 *
ifšdex
, 
Çs_št_ty³_t
 *
ty³
) {

38 
š‹rçû_ù¾_t
 
if_šfo
;

39 
	`mem£t
(&
if_šfo
,0,(if_info));

41 ifĞ
if_Çme
 !ğ
nuÎ±r
) {

42 
	`§ã¡ºıy
(
if_šfo
.
if_Çme
,if_name,(if_info.if_name));

43 
if_šfo
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

45 ifĞ
ifšdex
 !ğ
nuÎ±r
) {

46 
if_šfo
.
if_šdex
 = *
ifšdex
;

47 
if_šfo
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

51 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
if_šfo
è!ğ
STD_ERR_OK
) {

52 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,"INTF-C","Failedo get if_info");

53  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

55 *
ifšdex
 = 
if_šfo
.
if_šdex
;

56 *
ty³
 = 
if_šfo
.
št_ty³
;

57  
STD_ERR_OK
;

58 
	}
};

61 
boŞ
 
	$Çs_štf_hªdË_štf_mode_chªge
 (cÚ¡ * 
if_Çme
, 
BASE_IF_MODE_t
 
mode
)

63 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
·¿ms
;

64 
ıs_­i_objeù_t
 
obj
;

65 
ıs_­i_key_t
 
keys
;

66 
boŞ
 
rc
 = 
Œue
;

68 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "IF_CONT", "IÁ”çû modchªgupd©ÿÎed fÜ %s", 
if_Çme
);

70 ià((
obj
 = 
	`ıs_­i_objeù_ü—‹
()è=ğ
NULL
) {

71 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"IF_CONT", "Interface mode change update failed");

72 
rc
 = 
çl£
;

75 
ıs_­i_objeù_gu¬d
 
	`obj_g
 (
obj
);

76 ià(
	`ıs_­i_Œª§ùiÚ_š™
(&
·¿ms
è!ğ
ıs_­i_»t_code_OK
) {

77 
rc
 = 
çl£
;

80 
ıs_­i_Œª§ùiÚ_gu¬d
 
	`tgd
(&
·¿ms
);

81 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
keys
, 
BASE_ROUTE_INTERFACE_MODE_CHANGE_OBJ
,

82 
ıs_­i_qu®if›r_TARGET
);

83 
	`ıs_­i_objeù_£t_key
(
obj
, &
keys
);

85 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
BASE_ROUTE_INTERFACE_MODE_CHANGE_INPUT_IFNAME
,

86 
if_Çme
, 
	`¡¾’
(if_name) + 1);

87 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_ROUTE_INTERFACE_MODE_CHANGE_INPUT_MODE
,

88 
mode
);

90 ià(
	`ıs_­i_aùiÚ
(&
·¿ms
, 
obj
è!ğ
ıs_­i_»t_code_OK
) {

91 
rc
 = 
çl£
;

95 
obj_g
.
	`»Ëa£
();

97 ià(
	`ıs_­i_comm™
(&
·¿ms
è!ğ
ıs_­i_»t_code_OK
) {

98 
rc
 = 
çl£
;

102 } 
çl£
);

104 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "IF_CONT", "Interface mode change update„eturning (%s)",

105 
rc
 =ğ
Œue
 ? "SUCCESS" : "FAILED");

106  
rc
;

107 
	}
}

109 
boŞ
 
	$Çs_štf_hªdË_štf_mode_chªge
 (
h®_ifšdex_t
 
ifx
, 
BASE_IF_MODE_t
 
mode
)

111 
š‹rçû_ù¾_t
 
štf_ù¾
;

112 
	`mem£t
(&
štf_ù¾
, 0, (intf_ctrl));

113 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

114 
štf_ù¾
.
if_šdex
 = 
ifx
;

116 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
è!ğ
STD_ERR_OK
) {

117 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,"IF_CONT", "IÁ”çû (%dènÙ found", 
ifx
);

118  
çl£
;

121  
	`Çs_štf_hªdË_štf_mode_chªge
(
štf_ù¾
.
if_Çme
, 
mode
);

122 
	}
}

125 
boŞ
 
	$Çs_štf_ş—nup_l2mc_cÚfig
 (
h®_ifšdex_t
 
ifx
, 
h®_vÏn_id_t
 
vÏn_id
)

127 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
·¿ms
;

128 
ıs_­i_objeù_t
 
obj
;

129 
ıs_­i_key_t
 
keys
;

130 
boŞ
 
rc
 = 
Œue
;

132 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "IF_CONT", "Interface L2MC clean UP");

134 ià((
obj
 = 
	`ıs_­i_objeù_ü—‹
()è=ğ
NULL
) {

135 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"IF_CONT", "Interface L2MC clean UP failed ");

136 
rc
 = 
çl£
;

139 
ıs_­i_objeù_gu¬d
 
	`obj_g
 (
obj
);

140 ià(
	`ıs_­i_Œª§ùiÚ_š™
(&
·¿ms
è!ğ
ıs_­i_»t_code_OK
) {

141 
rc
 = 
çl£
;

144 
ıs_­i_Œª§ùiÚ_gu¬d
 
	`tgd
(&
·¿ms
);

145 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
keys
, 
BASE_L2_MCAST_CLEANUP_L2MC_MEMBER_OBJ
,

146 
ıs_­i_qu®if›r_TARGET
);

147 
	`ıs_­i_objeù_£t_key
(
obj
, &
keys
);

149 ià(
ifx
 != 0) {

150 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_L2_MCAST_CLEANUP_L2MC_MEMBER_INPUT_IFINDEX
, 
ifx
);

152 ià(
vÏn_id
 != 0) {

153 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_L2_MCAST_CLEANUP_L2MC_MEMBER_INPUT_VLAN_ID
, 
vÏn_id
);

156 ià(
	`ıs_­i_aùiÚ
(&
·¿ms
, 
obj
è!ğ
ıs_­i_»t_code_OK
) {

157 
rc
 = 
çl£
;

161 
obj_g
.
	`»Ëa£
();

163 ià(
	`ıs_­i_comm™
(&
·¿ms
è!ğ
ıs_­i_»t_code_OK
) {

164 
rc
 = 
çl£
;

168 } 
çl£
);

170 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "IF_CONT", "Interface L2MC clean UP (%s)",

171 
rc
 =ğ
Œue
 ? "SUCCESS" : "FAILED");

172  
rc
;

173 
	}
}

	@src/nas_int_common_obj.cpp

23 
	~"d–l-ba£-if.h
"

24 
	~"d–l-ba£-if-vÏn.h
"

25 
	~"ŸÇ-if-ty³.h
"

27 
	~"¡d_”rÜ_codes.h
"

28 
	~"¡d_uts.h
"

29 
	~"ıs_­i_İ”©iÚ.h
"

30 
	~"ıs_­i_objeù_key.h
"

32 
	~"ev’t_log.h
"

33 
	~"ıs_şass_m­.h
"

34 
	~"ıs_­i_db_š‹rçû.h
"

35 
	~<unÜd”ed_m­
>

37 
	~"š‹rçû_obj.h
"

39 
	~"h®_if_m­pšg.h
"

40 
	~"Çs_št_uts.h
"

42 
	s_štf_obj_hªdËr_s
 {

43 
ıs_rdâ
 
	mobj_rd
;

44 
ıs_wrâ
 
	mobj_wr
;

45 } 
	tštf_obj_hªdËr_t
;

47 
	#INTF_TYPE_MAX_LEN
 256

	)

48 
	#NUM_INT_CPS_API_THREAD
 1

	)

50 
ıs_­i_İ”©iÚ_hªdË_t
 
	gÇs_if_¡©_hªdË
;

53 autØ
	g_štf_hªdËrs
 = 
Ãw
 
¡d
::
unÜd”ed_m­
 <
Çs_št_ty³_t
, 
	gštf_obj_hªdËr_t
 *, 
	g¡d
::
hash
<>> [
obj_INTF_MAX
];

55 
t_¡d_”rÜ
 
	$_if_ty³_äom_if_šdex_Ü_Çme
(
obj_štf_ÿt_t
 
obj_ÿt
, 
ıs_­i_objeù_t
 
obj
,

56 
Çs_št_ty³_t
 *
ty³
) {

58 
š‹rçû_ù¾_t
 
if_šfo
;

59 
ıs_­i_objeù_©Œ_t
 
_ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, (
obj_ÿt
 =ğ
obj_INTF
) ?

60 (
ušt
è
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
 :

61 (
ušt
)
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
);

62 
	`mem£t
(&
if_šfo
,0,(if_info));

64 ià(
_ifix
 !ğ
nuÎ±r
) {

65 
if_šfo
.
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_ifix
);

66 
if_šfo
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

68 
ıs_­i_objeù_©Œ_t
 
_Çme
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, (
obj_ÿt
 =ğ
obj_INTF
) ?

69 (
ušt
)
IF_INTERFACES_INTERFACE_NAME
 :

70 (
ušt
)
IF_INTERFACES_STATE_INTERFACE_NAME
);

72 ià(
_Çme
 =ğ
nuÎ±r
è 
	`STD_ERR
(
INTERFACE
,
PARAM
,0);

74 
	`¡ºıy
(
if_šfo
.
if_Çme
,(cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_Çme
),(if_info.if_name)-1);

75 
if_šfo
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

78 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
if_šfo
)!ğ
STD_ERR_OK
è 
	`STD_ERR
(
INTERFACE
,
PARAM
,0);

80 *
ty³
 = 
if_šfo
.
št_ty³
;

81  
STD_ERR_OK
;

82 
	}
}

84 
t_¡d_”rÜ
 
	$Çs_štf_db_obj_g‘
(cÚ¡ * 
štf_Çme
,
ıs_­i_©Œ_id_t
 
id
, 
ıs_­i_qu®if›r_t
 
ÿt
,

85 
ıs_­i_objeù_t
 
obj
){

87 if(
štf_Çme
 =ğ
nuÎ±r
){

88 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-DB-GET","Null intf‚ame…assedo„etreive object from db");

89  
	`STD_ERR
(
INTERFACE
,
PARAM
,0);

92 if(
obj
 =ğ
nuÎ±r
){

93 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-DB-GET","Null object…assedo„etreive from db");

94  
	`STD_ERR
(
INTERFACE
,
PARAM
,0);

97 
ıs_­i_objeù_gu¬d
 
	`_og
(
	`ıs_­i_objeù_ü—‹
());

98 if(
_og
.
	`v®id
()){

99 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
_og
.
	`g‘
()),
id
,
ÿt
);

100 
	`ıs_­i_£t_key_d©a
(
_og
.
	`g‘
(),
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,
štf_Çme
,
	`¡¾’
(intf_name)+1);

101 
ıs_­i_objeù_li¡_gu¬d
 
	`l¡
(
	`ıs_­i_objeù_li¡_ü—‹
());

102 ià(
	`ıs_­i_db_g‘
(
_og
.
	`g‘
(),
l¡
.g‘())==
ıs_­i_»t_code_OK
) {

103 
size_t
 
Ën
 = 
	`ıs_­i_objeù_li¡_size
(
l¡
.
	`g‘
());

105 if(
Ën
){

107 
	`ıs_­i_objeù_şÚe
(
obj
,
	`ıs_­i_objeù_li¡_g‘
(
l¡
.
	`g‘
(),0));

108  
STD_ERR_OK
;

113 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-SET","FaedØg‘ stÜed cÚfig fÜ iÁ”çû %s",
štf_Çme
);

114  
ıs_­i_»t_code_ERR
;

115 
	}
}

117 
	$ıs_­i_objeù_li¡_sw­
(
ıs_­i_objeù_li¡_t
 &
a
, cps_­i_objeù_li¡_ˆ&
b
) {

118 
ıs_­i_objeù_li¡_t
 
t
 = 
a
;

119 
a
 = 
b
;

120 
b
 = 
t
;

121 
	}
}

123 
t_¡d_”rÜ
 
	$_´oûss_g‘_»que¡
(
obj_štf_ÿt_t
 
obj_ÿt
, * 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

124 
size_t
 
key_ix
, 
Çs_št_ty³_t
 
ty³
, 
ıs_­i_objeù_li¡_t
 
li¡
) {

125 
ıs_­i_©Œ_id_t
 
_ty³_©Œ_id
 = (
obj_ÿt
 =ğ
obj_INTF
) ?

126 (
ıs_­i_©Œ_id_t
è
IF_INTERFACES_INTERFACE_TYPE
 :

127 (
ıs_­i_©Œ_id_t
è
IF_INTERFACES_STATE_INTERFACE_TYPE
 ;

128 
ıs_­i_objeù_t
 
ft
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
key_ix
);

130 ià((
_štf_hªdËrs
[
obj_ÿt
][
ty³
] =ğ
NULL
è|| (_štf_hªdËrs[obj_ÿt][ty³]->
obj_rd
 == NULL)) {

131 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-COM-INT-GET","Get„equest handler‚ot…resent");

132  
ıs_­i_»t_code_ERR
;

135 
if_ty³
[
INTF_TYPE_MAX_LEN
];

136 ià(!
	`Çs_to_›tf_if_ty³_g‘
(
ty³
, 
if_ty³
, (if_type))) {

137 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-COM-INT-GET", "FaedØg‘ IETFy³ fÜ NASy³ %d",
ty³
);

138  
ıs_­i_»t_code_ERR
;

140 
ıs_­i_objeù_©Œ_t
 
_›tf_ty³_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
, 
_ty³_©Œ_id
);

141 if(! 
_›tf_ty³_©Œ
è
	`ıs_­i_objeù_©Œ_add
(
ft
, 
_ty³_©Œ_id
, 
if_ty³
, 
	`¡¾’
(if_type) + 1);

143 
	`ıs_­i_objeù_li¡_sw­
(
·¿m
->
li¡
,†ist);

144 
t_¡d_”rÜ
 
»t
 = 
_štf_hªdËrs
[
obj_ÿt
][
ty³
]->
	`obj_rd
(
cÚ‹xt
, 
·¿m
, 
key_ix
);

145 
	`ıs_­i_objeù_li¡_sw­
(
·¿m
->
li¡
,†ist);

147 if(
»t
 =ğ
STD_ERR_OK
) {

149 
	`ıs_­i_objeù_li¡_m”ge
(
·¿m
->
li¡
,†ist);

151 
	`ıs_­i_objeù_©Œ_d–‘e
(
ft
, 
_ty³_©Œ_id
);

152 
	`ıs_­i_objeù_li¡_ş—r
(
li¡
, 
Œue
);

153  
»t
;

154 
	}
};

156 
ıs_­i_»tuº_code_t
 
	$_if_g’_š‹rçû_g‘
(
obj_štf_ÿt_t
 
obj_ÿt
, * 
cÚ‹xt
,

157 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
, 
size_t
 
key_ix
) {

159 
ıs_­i_objeù_t
 
ft
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
key_ix
);

160 
ıs_­i_©Œ_id_t
 
_ty³_©Œ_id
 = (
obj_ÿt
 =ğ
obj_INTF
) ?

161 (
ıs_­i_©Œ_id_t
è
IF_INTERFACES_INTERFACE_TYPE
 :

162 (
ıs_­i_©Œ_id_t
è
IF_INTERFACES_STATE_INTERFACE_TYPE
 ;

164 
ıs_­i_objeù_li¡_gu¬d
 
	`li¡
(
	`ıs_­i_objeù_li¡_ü—‹
());

166 if(
li¡
.
	`g‘
(è=ğ
NULL
) {

167 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-COM-INT-GET","Can't create CPS Object output†ist");

168  
ıs_­i_»t_code_ERR
;

171 
ıs_­i_objeù_©Œ_t
 
ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
, (
obj_ÿt
 =ğ
obj_INTF
) ?

172 (
ıs_­i_©Œ_id_t
)
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
:

173 (
ıs_­i_©Œ_id_t
)
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
);

174 
ıs_­i_objeù_©Œ_t
 
_Çme
 = 
	`ıs_­i_g‘_key_d©a
(
ft
, (
obj_ÿt
 =ğ
obj_INTF
) ?

175 (
ıs_­i_©Œ_id_t
)
IF_INTERFACES_INTERFACE_NAME
 :

176 (
ıs_­i_©Œ_id_t
)
IF_INTERFACES_STATE_INTERFACE_NAME
);

177 
ıs_­i_objeù_©Œ_t
 
_›tf_ty³_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
,

178 
_ty³_©Œ_id
);

179 
Çs_št_ty³_t
 
šput_ty³
, 
ty³
;

180 ià(
_›tf_ty³_©Œ
 !ğ
nuÎ±r
) {

181 cÚ¡ *
›tf_štf_ty³
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_›tf_ty³_©Œ
);

182 if(!
	`›tf_to_Çs_if_ty³_g‘
(
›tf_štf_ty³
, &
šput_ty³
)) {

183 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-COM-INT-GET","Could‚Ù cÚv”ˆth% ty³ØÇ iàty³",
›tf_štf_ty³
);

184  
ıs_­i_»t_code_ERR
;

188 
boŞ
 
is_g‘_Ãxt
 = 
	`ıs_­i_f‹r_is_g‘Ãxt
(
ft
);

189 
h®_ifšdex_t
 
šdex
 = 0, *
cu¼’t_ifšdex
 = 
nuÎ±r
, 
Ãxt_ifšdex
;

190 
size_t
 
couÁ
 = 0;

192 if(
ifix
 !ğ
nuÎ±r
 || 
_Çme
 !=‚ullptr) {

193 cÚ¡ *
Çme
 = 
nuÎ±r
;

194 if(
ifix
è
šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(ifix);

195 if(
_Çme
è
Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(_name);

196 
	`Çs_g‘_if_ty³_äom_Çme_Ü_ifšdex
(
Çme
, &
šdex
, &
ty³
);

197 
couÁ
 = 1 ;

201 ià(
_›tf_ty³_©Œ
 !ğ
nuÎ±r
 && 
šput_ty³
 =ğ
Çs_št_ty³_VLAN
) {

202 
ıs_­i_objeù_©Œ_t
 
vÏn_id_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
,

203 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
);

204 if(
vÏn_id_©Œ
) {

205 
couÁ
 = 1;

206 
ty³
 = 
šput_ty³
;

212 
	`ıs_­i_f‹r_g‘_couÁ
(
ft
, &
couÁ
);

213 
t_¡d_”rÜ
 
»t
, 
»s
;

216 if(
couÁ
 =ğ1 && !
is_g‘_Ãxt
) {

217 
»s
 = 
	`_´oûss_g‘_»que¡
(
obj_ÿt
, 
cÚ‹xt
, 
·¿m
, 
key_ix
, 
ty³
, 
li¡
.
	`g‘
());

218  
»s
;

221 if(
is_g‘_Ãxt
 && (
ifix
 !ğ
nuÎ±r
 || 
_Çme
 !ğnuÎ±r)è
cu¼’t_ifšdex
 = &
šdex
;

223 
»t
 = 
	`dn_h®_g‘_Ãxt_ifšdex
(
cu¼’t_ifšdex
, &
Ãxt_ifšdex
);

224 if(
»t
 =ğ
STD_ERR_OK
 && (
	`Çs_g‘_if_ty³_äom_Çme_Ü_ifšdex
(
nuÎ±r
, &
Ãxt_ifšdex
, &
ty³
) == STD_ERR_OK)) {

225 if(
_›tf_ty³_©Œ
 =ğ
nuÎ±r
 || 
ty³
 =ğ
šput_ty³
) {

226 if(
obj_ÿt
 =ğ
obj_INTF
) {

227 
	`ıs_­i_objeù_©Œ_d–‘e
(
ft
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

228 
	`ıs_­i_objeù_©Œ_add_u32
(
ft
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
Ãxt_ifšdex
);

230 
	`ıs_­i_objeù_©Œ_d–‘e
(
ft
, 
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
);

231 
	`ıs_­i_objeù_©Œ_d–‘e
(
ft
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

232 
	`ıs_­i_objeù_©Œ_add_u32
(
ft
,
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
, 
Ãxt_ifšdex
);

234 
»s
 = 
	`_´oûss_g‘_»que¡
(
obj_ÿt
, 
cÚ‹xt
, 
·¿m
, 
key_ix
, 
ty³
, 
li¡
.
	`g‘
());

235 if(
»s
 =ğ
STD_ERR_OK
) {

237 if(
ifix
 =ğ
nuÎ±r
 && 
_Çme
 =ğnuÎ±¸&& 
is_g‘_Ãxt
) ;

239 if(
couÁ
 != 0) {

240 --
couÁ
;

241 if(!
couÁ
) ;

247 
cu¼’t_ifšdex
 = &
Ãxt_ifšdex
;

248 } 
»t
 =ğ
STD_ERR_OK
);

250  
ıs_­i_»t_code_OK
;

251 
	}
}

253 
ıs_­i_»tuº_code_t
 
	$_if_g’_š‹rçû_£t
 (
obj_štf_ÿt_t
 
obj_ÿt
, * 
cÚ‹xt
,

254 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,
size_t
 
ix
) {

255 
Çs_št_ty³_t
 
_ty³
;

257 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

258 ià(
obj
==
nuÎ±r
è 
ıs_­i_»t_code_ERR
;

260 
ıs_­i_objeù_©Œ_t
 
_›tf_ty³_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

261 
IF_INTERFACES_INTERFACE_TYPE
);

262 ià(
_›tf_ty³_©Œ
 !ğ
nuÎ±r
) {

263 cÚ¡ *
›tf_štf_ty³
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_›tf_ty³_©Œ
);

264 if(
	`›tf_to_Çs_if_ty³_g‘
(
›tf_štf_ty³
, &
_ty³
è=ğ
çl£
) {

265 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-COM-INT-SET","Could‚Ù cÚv”ˆth% ty³ØÇ iàty³",
›tf_štf_ty³
);

266  
ıs_­i_»t_code_ERR
;

270 ià(
	`_if_ty³_äom_if_šdex_Ü_Çme
(
obj_ÿt
, 
obj
, &
_ty³
è!ğ
STD_ERR_OK
) {

271 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-COM-INT-SET","No interface‚ame or index…assedo…rocess "

273  
ıs_­i_»t_code_ERR
;

276 autØ
™”
 = 
_štf_hªdËrs
[
obj_ÿt
].
	`fšd
(
_ty³
);

277 ià(
™”
 =ğ
_štf_hªdËrs
[
obj_ÿt
].
	`’d
()) {

278 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-COM-INT-SET","Set„equest handler was‚ot„egistered for obj "

279 "C©egÜy %d‡ndy³ %d", 
obj_ÿt
, 
_ty³
);

280  
ıs_­i_»t_code_ERR
;

282 ià((
_štf_hªdËrs
[
obj_ÿt
][
_ty³
] =ğ
NULL
è|| (_štf_hªdËrs[obj_ÿt][_ty³]->
obj_wr
 == NULL)) {

283 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-COM-INT-SET","NØCPS S‘ hªdË¸fÜ iÁ”çû c© %d‡ndy³ %d",
obj_ÿt
,
_ty³
);

284  
ıs_­i_»t_code_ERR
;

287 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-COM-INT-SET","IÁ”çû S‘„eque¡„eûived fÜ obj c©egÜy %dy³ %d.",
obj_ÿt
, 
_ty³
);

288 (
_štf_hªdËrs
[
obj_ÿt
][
_ty³
]->
	`obj_wr
(
cÚ‹xt
, 
·¿m
,
ix
));

290 
	}
}

293 
ıs_­i_»tuº_code_t
 
	$_if_š‹rçû_g‘
(* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
, 
size_t
 
key_ix
) {

294 (
	`_if_g’_š‹rçû_g‘
(
obj_INTF
, 
cÚ‹xt
, 
·¿m
, 
key_ix
));

295 
	}
}

297 
ıs_­i_»tuº_code_t
 
	$_if_š‹rçû_£t
 (* 
cÚ‹xt
,

298 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,
size_t
 
ix
) {

299 (
	`_if_g’_š‹rçû_£t
 (
obj_INTF
, 
cÚ‹xt
, 
·¿m
, 
ix
));

300 
	}
}

303 
ıs_­i_»tuº_code_t
 
	$_if_š‹rçû_¡©e_g‘
(* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

304 
size_t
 
key_ix
) {

305 (
	`_if_g’_š‹rçû_g‘
(
obj_INTF_STATE
, 
cÚ‹xt
, 
·¿m
, 
key_ix
));

306 
	}
}

308 
ıs_­i_»tuº_code_t
 
	$_if_š‹rçû_¡©e_£t
 (* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,
size_t
 
ix
) {

309 (
	`_if_g’_š‹rçû_£t
 (
obj_INTF_STATE
, 
cÚ‹xt
, 
·¿m
, 
ix
));

310 
	}
}

313 
ıs_­i_»tuº_code_t
 
	$_if_š‹rçû_¡©e_¡©i¡ics_g‘
(* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

314 
size_t
 
key_ix
) {

315 (
	`_if_g’_š‹rçû_g‘
(
obj_INTF_STATISTICS
, 
cÚ‹xt
, 
·¿m
, 
key_ix
));

316 
	}
}

318 
ıs_­i_»tuº_code_t
 
	$_if_š‹rçû_¡©e_¡©i¡ics_£t
 (* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,
size_t
 
ix
) {

319 (
	`_if_g’_š‹rçû_£t
 (
obj_INTF_STATISTICS
, 
cÚ‹xt
, 
·¿m
, 
ix
));

320 
	}
}

323 
t_¡d_”rÜ
 
	$štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_štf_ÿt_t
 
obj_ÿt
, 
Çs_št_ty³_t
 
štf_ty³
, 
ıs_rdâ
 
rd
, 
ıs_wrâ
 
wr
) {

324 
	`STD_ASSERT
(
rd
); STD_ASSERT(
wr
);

326 
štf_obj_hªdËr_t
 *
h
 = 
Ãw
 intf_obj_handler_t ;

327 ià(
h
 =ğ
NULL
è 
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

328 
h
->
obj_rd
 = 
rd
;

329 
h
->
obj_wr
 = 
wr
;

331 
_štf_hªdËrs
[
obj_ÿt
][
štf_ty³
] = 
h
;

332  
STD_ERR_OK
;

333 
	}
}

335 
t_¡d_”rÜ
 
	$_»g_moduË
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
, 
ıs_­i_©Œ_id_t
 
id
,

336 
ıs_­i_qu®if›r_t
 
qu®
, 
ıs_rdâ
 
rd
, 
ıs_wrâ
 
wr
) {

337 
ıs_­i_»gi¡¿tiÚ_funùiÚs_t
 
f
;

338 
	`mem£t
(&
f
,0,(f));

340 
buff
[
CPS_API_KEY_STR_MAX
];

341 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
f
.
key
,
id
,
qu®
)) {

342 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Could‚otranslate %do key %s",

343 ()(
id
),
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

344  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

347 
f
.
hªdË
 = handle;

348 
f
.
_»ad_funùiÚ
 = 
rd
;

349 
f
.
_wr™e_funùiÚ
 = 
wr
;

351 ià(
	`ıs_­i_»gi¡”
(&
f
)!=
ıs_­i_»t_code_OK
) {

352  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

355  
STD_ERR_OK
;

356 
	}
}

358 
t_¡d_”rÜ
 
	$š‹rçû_obj_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
) {

360 
t_¡d_”rÜ
 
rc
;

361 ià((
rc
=
	`_»g_moduË
(
hªdË
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
,

362 
_if_š‹rçû_g‘
,
_if_š‹rçû_£t
))!=
STD_ERR_OK
) {

363  
rc
;

366 ià((
rc
=
	`_»g_moduË
(
hªdË
,
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_OBSERVED
,

367 
_if_š‹rçû_¡©e_g‘
,
_if_š‹rçû_¡©e_£t
))!=
STD_ERR_OK
) {

368  
rc
;

372 ià(
	`ıs_­i_İ”©iÚ_subsy¡em_š™
(&
Çs_if_¡©_hªdË
,
NUM_INT_CPS_API_THREAD
)!=
ıs_­i_»t_code_OK
) {

373  
	`STD_ERR
(
CPSNAS
,
FAIL
,0);

376 ià((
rc
=
	`_»g_moduË
(
Çs_if_¡©_hªdË
,
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_STATISTICS_OBJ
,
ıs_­i_qu®if›r_OBSERVED
,

377 
_if_š‹rçû_¡©e_¡©i¡ics_g‘
,
_if_š‹rçû_¡©e_¡©i¡ics_£t
))!=
STD_ERR_OK
) {

378  
rc
;

381  
STD_ERR_OK
;

382 
	}
}

	@src/nas_int_ev_handlers.cpp

23 
	~"ev’t_log.h
"

24 
	~"¡d_as£¹.h
"

25 
	~"h®_š‹rçû_commÚ.h
"

26 
	~"h®_if_m­pšg.h
"

27 
	~"Çs_št_uts.h
"

28 
	~"Çs_št_vÏn.h
"

29 
	~"Çs_os_š‹rçû.h
"

30 
	~"Çs_št_bridge.h
"

31 
	~"Çs_št_Ïg.h
"

32 
	~"Çs_št_Ïg_­i.h
"

33 
	~"Çs_št_com_uts.h
"

34 
	~"¡d_”rÜ_codes.h
"

35 
	~"ıs_­i_objeù_ÿ‹gÜy.h
"

36 
	~"ıs_­i_š‹rçû_ty³s.h
"

37 
	~"d–l-ba£-if-lšux.h
"

38 
	~"d–l-ba£-if-vÏn.h
"

39 
	~"d–l-ba£-if.h
"

40 
	~"d–l-š‹rçû.h
"

41 
	~"›tf-š‹rçûs.h
"

42 
	~"d–l-ba£-commÚ.h
"

43 
	~"Çs_if_uts.h
"

44 
	~"vrf-mgmt.h
"

46 
	~"ıs_­i_objeù_key.h
"

47 
	~"ıs_­i_İ”©iÚ.h
"

48 
	~"ds_commÚ_ty³s.h
"

49 
	~"ıs_şass_m­.h
"

50 
	~"¡d_mac_uts.h
"

52 
	~<unÜd”ed_m­
>

53 
	~<¡ršg.h
>

58 
t_¡d_”rÜ
 
	$g‘_pÜt_li¡_by_ifšdex
(
Çs_pÜt_li¡_t
 &
pÜt_li¡
, 
ıs_­i_objeù_t
 
obj
, 
ıs_­i_©Œ_id_t
 
©Œ_id
)

60 
ıs_­i_objeù_™_t
 
™
;

61 
	`ıs_­i_objeù_™_begš
(
obj
, &
™
);

62 ;
	`ıs_­i_objeù_™_v®id
(&
™
è; 
	`ıs_­i_objeù_™_Ãxt
(&it) ) {

63 
ıs_­i_©Œ_id_t
 
id
 = 
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

64 ià(
id
 =ğ
©Œ_id
 ) {

65 
h®_ifšdex_t
 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

66 if(!
	`Çs_is_vœtu®_pÜt
(
ifšdex
)){

67 
pÜt_li¡
.
	`š£¹
(
ifšdex
);

71  
STD_ERR_OK
;

72 
	}
}

75 
	$Çs_vÏn_ev_hªdËr
(
ıs_­i_objeù_t
 
obj
) {

77 
Çs_pÜt_li¡_t
 
g_pÜt_li¡
;

78 
Çs_pÜt_li¡_t
 
uÁag_pÜt_li¡
;

79 
ıs_­i_objeù_©Œ_t
 
_br_idx_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
BASE_IF_LINUX_IF_INTERFACES_INTERFACE_IF_MASTER
);

81 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

83 ià(
_br_idx_©Œ
 =ğ
nuÎ±r
) {

84 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "NAS-Vlan", "VLANƒvent„eceived without bridge‡nd…ort info");

87 
h®_ifšdex_t
 
br_ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_br_idx_©Œ
);

89 
	`g‘_pÜt_li¡_by_ifšdex
(
g_pÜt_li¡
, 
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
);

90 
	`g‘_pÜt_li¡_by_ifšdex
(
uÁag_pÜt_li¡
, 
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
);

91 ià(
g_pÜt_li¡
.
	`em±y
(è&& 
uÁag_pÜt_li¡
.empty()) {

92 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "NAS-Vlan", "VLANƒvent„eceived without bridge‡nd…ort info");

95 ià(
İ
 =ğ
ıs_­i_İ”_DELETE
) {

97 
	`EV_LOGGING
(
INTERFACE
,
INFO
, "NAS-Vlan",

98 "D–‘š‹rçû†i¡ from bridgIÁ”çû %d\n", 
br_ifšdex
);

99 if(!
uÁag_pÜt_li¡
.
	`em±y
()) {

100 
	`Çs_´oûss_d–_vÏn_mem_äom_os
(
br_ifšdex
, 
uÁag_pÜt_li¡
, 
NAS_PORT_UNTAGGED
);

102 if(!
g_pÜt_li¡
.
	`em±y
()) {

103 
	`Çs_´oûss_d–_vÏn_mem_äom_os
(
br_ifšdex
, 
g_pÜt_li¡
, 
NAS_PORT_TAGGED
);

106 } ià(
İ
 =ğ
ıs_­i_İ”_CREATE
) {

107 
h®_vÏn_id_t
 
vÏn_id
 = 0;

109 
ıs_­i_objeù_©Œ_t
 
vÏn_id_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
);

110 ià(
vÏn_id_©Œ
 !ğ
nuÎ±r
) {

111 
vÏn_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_id_©Œ
);

113 ià(
vÏn_id
 >
IF_VLAN_MAX
) {

114 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "NAS-Vlan",

116 
vÏn_id
, 
br_ifšdex
);

120 
	`Çs_´oûss_add_vÏn_mem_äom_os
(
br_ifšdex
, 
uÁag_pÜt_li¡
, 0, 
NAS_PORT_UNTAGGED
);

121 
	`Çs_´oûss_add_vÏn_mem_äom_os
(
br_ifšdex
, 
g_pÜt_li¡
, 
vÏn_id
, 
NAS_PORT_TAGGED
);

124 
	}
}

126 
	$Çs_Ïg_ev_hªdËr
(
ıs_­i_objeù_t
 
obj
) {

128 
Çs_Ïg_id_t
 
Ïg_id
 = 0;

129 
h®_ifšdex_t
 
mem_idx
;

130 
boŞ
 
ü—‹
 = 
çl£
;

131 
boŞ
 
block_¡©us
 = 
Œue
;

132 cÚ¡ *
mem_Çme
 = 
NULL
;

133 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
=
NULL
;

134 
ıs_­i_İ”©iÚ_ty³s_t
 
memb”_İ
 = 
ıs_­i_İ”_NULL
;

136 
ıs_­i_objeù_©Œ_t
 
_idx_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

137 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

138 
ıs_­i_objeù_©Œ_t
 
_mem_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

139 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS_NAME
);

140 
ıs_­i_objeù_©Œ_t
 
_Çme_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
);

141 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

143 ià(
_idx_©Œ
 =ğ
nuÎ±r
) {

144 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "NAS-LAG", " LAG IF_index‚ot…resent inhe OS EVENT");

147 
h®_ifšdex_t
 
bÚd_idx
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_idx_©Œ
);

148 ià(
_mem_©Œ
 !ğ
nuÎ±r
) {

149 
mem_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_mem_©Œ
);

150 ià(
	`Çs_št_Çme_to_if_šdex
(&
mem_idx
, 
mem_Çme
è!ğ
STD_ERR_OK
) {

151 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "NAS-LAG",

152 " Faed fÜ g‘ memb” % if_šdex ", 
mem_Çme
);

156 
if_ma¡”_šfo_t
 
ma¡”_šfo
 = { 
Çs_št_ty³_LAG
, 
NAS_PORT_NONE
, 
bÚd_idx
};

157 
BASE_IF_MODE_t
 
štf_mode
 = 
	`Çs_štf_g‘_mode
(
mem_idx
);

158 ià(
İ
 =ğ
ıs_­i_İ”_CREATE
) {

159 if(!
	`Çs_štf_add_ma¡”
(
mem_idx
, 
ma¡”_šfo
)){

160 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-LAG","Failedo‡dd master for†ag memeber…ort");

162 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
mem_idx
);

163 ià(
Ãw_mode
 !ğ
štf_mode
) {

164 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
mem_idx
, 
Ãw_mode
è=ğ
çl£
) {

165 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-LAG",

166 "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
mem_idx
);

170 } ià(
İ
 =ğ
ıs_­i_İ”_DELETE
) {

171 
Çs_Ïg_ma¡”_šfo_t
 * 
Ïg_’Œy
 =
NULL
;

173 
Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
bÚd_idx
);

174 if(
Ïg_’Œy
 =ğ
nuÎ±r
){

175 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-LAG","Failedo find†agƒntry with %d"

176 "ifšdex fÜ d–‘İ”©iÚ",
bÚd_idx
);

187 if(
Ïg_’Œy
->
block_pÜt_li¡
.
	`fšd
(
mem_idx
è!ğÏg_’Œy->block_pÜt_li¡.
	`’d
()){

191 if(!
	`Çs_štf_d–_ma¡”
(
mem_idx
, 
ma¡”_šfo
)){

192 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-LAG",

195 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
mem_idx
);

196 ià(
Ãw_mode
 !ğ
štf_mode
) {

197 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
mem_idx
, 
Ãw_mode
è=ğ
çl£
) {

198 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-LAG",

199 "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
mem_idx
);

205 if(
	`Çs_is_vœtu®_pÜt
(
mem_idx
)){

206 
	`EV_LOGGING
(
INTERFACE
,
INFO
, "NAS-LAG",

207 " Memb”…Üˆ% i vœtu®‚ØÃedØdØªythšg", 
mem_Çme
);

213 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`lock_t
(
	`Çs_Ïg_mu‹x_lock
());

215 ià(
İ
 =ğ
ıs_­i_İ”_CREATE
) {

216 ià(
_Çme_©Œ
 =ğ
nuÎ±r
) {

217 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "NAS-LAG", " Bond‚ame is‚ot…resent inhe createƒvent");

220 cÚ¡ *
bÚd_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_Çme_©Œ
);

221 ià((
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
bÚd_idx
)è=ğ
NULL
) {

223 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-LAG","C»©Lag iÁ”çû idx %d w™h†ag ID %d ", 
bÚd_idx
,
Ïg_id
);

225 ià((
	`Çs_Ïg_ma¡”_add
(
bÚd_idx
,
bÚd_Çme
,
Ïg_id
)è!ğ
STD_ERR_OK
) {

226 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "NAS-LAG",

227 "LAG c»©iÚ Faed fÜ bÚd iÁ”çû % šdex %d",
bÚd_Çme
, 
bÚd_idx
);

230 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
bÚd_idx
, 
BASE_IF_MODE_MODE_NONE
è=ğ
çl£
) {

231 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-LAG",

232 "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
bÚd_idx
);

235 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
bÚd_idx
);

236 if(
Çs_Ïg_’Œy
 !ğ
NULL
){

237 
	`Çs_ıs_hªdË_mac_£t
 (
bÚd_Çme
, 
Çs_Ïg_’Œy
->
ifšdex
);

238 
ü—‹
 = 
Œue
;

243 ià(
_mem_©Œ
 !ğ
nuÎ±r
) {

245 ià(
	`Çs_Ïg_if_pÜt_is_Ïg_memb”
(
bÚd_idx
, 
mem_idx
)) {

246 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-LAG", "Slave…ort %d‡lready‡ member of†ag %d",

247 
mem_idx
, 
bÚd_idx
);

250 if(
	`Çs_Ïg_memb”_add
(
bÚd_idx
,
mem_idx
è!ğ
STD_ERR_OK
) {

251 
	`EV_LOGGING
(
INTERFACE
,
INFO
, "NAS-LAG",

252 "FaedØAdd memb” % tØthLag %s", 
mem_Çme
, 
bÚd_Çme
);

255 
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`š£¹
(
mem_idx
);

256 
memb”_İ
 = 
ıs_­i_İ”_SET
;

257 
ndi_pÜt_t
 
ndi_pÜt
;

258 ià(
	`Çs_št_g‘_Åu_pÜt
(
mem_idx
, &
ndi_pÜt
è!ğ
STD_ERR_OK
) {

259 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "NAS-LAG",

260 "E¼Ü iÀfšdšg memb”' % Åu…Üˆšfo", 
mem_Çme
);

263 
ndi_štf_lšk_¡©e_t
 
¡©e
;

264 ià((
	`ndi_pÜt_lšk_¡©e_g‘
(
ndi_pÜt
.
Åu_id
,‚di_pÜt.
Åu_pÜt
, &
¡©e
))

265 =ğ
STD_ERR_OK
) {

268 ià((
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`fšd
(
mem_idx
) ==

269 
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`’d
()) &&

270 (
¡©e
.
İ”_¡©us
 =ğ
ndi_pÜt_OPER_UP
)) {

272 
block_¡©us
 = 
çl£
;

275 ià(
	`Çs_Ïg_block_pÜt
(
Çs_Ïg_’Œy
,
mem_idx
,
block_¡©us
è!ğ
STD_ERR_OK
){

277 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "NAS-CPS-LAG",

278 "E¼Ü Block/unblock PÜˆ% Ïg % ",
mem_Çme
, 
bÚd_Çme
);

284 
ıs_­i_objeù_©Œ_t
 
_mac
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

285 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
);

286 ià(
_mac
 !ğ
nuÎ±r
 && 
ü—‹
 =ğ
çl£
) {

287 
	`Çs_Ïg_£t_mac
(
bÚd_idx
, (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_mac
));

289 
ıs_­i_objeù_©Œ_t
 
_’abËd
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_INTERFACE_ENABLED
);

290 ià(
_’abËd
 !ğ
nuÎ±r
) {

291 
	`Çs_Ïg_£t_admš_¡©us
(
bÚd_idx
, (
boŞ
)
	`ıs_­i_objeù_©Œ_d©a_u32
(
_’abËd
));

293 } ià(
İ
 =ğ
ıs_­i_İ”_DELETE
) {

294 ià(
_mem_©Œ
 !ğ
nuÎ±r
) {

296 
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
bÚd_idx
);

297 if(
Çs_Ïg_’Œy
 =ğ
nuÎ±r
){

298 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-LAG","Failedo find†agƒntry with %d"

299 "ifšdex fÜ d–‘İ”©iÚ",
bÚd_idx
);

309 if(
Çs_Ïg_’Œy
->
block_pÜt_li¡
.
	`fšd
(
mem_idx
è!ğÇs_Ïg_’Œy->block_pÜt_li¡.
	`’d
()){

313 if(
	`Çs_Ïg_memb”_d–‘e
(
bÚd_idx
, 
mem_idx
è!ğ
STD_ERR_OK
) {

314 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-LAG",

315 "FaedØD–‘memb” % tØthLag %d", 
mem_Çme
, 
bÚd_idx
);

318 
Çs_Ïg_’Œy
->
pÜt_li¡
.
	`”a£
(
mem_idx
);

319 
memb”_İ
 = 
ıs_­i_İ”_SET
;

321 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
bÚd_idx
, 
BASE_IF_MODE_MODE_L2
è=ğ
çl£
) {

322 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-LAG",

323 "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
bÚd_idx
);

326 if((
	`Çs_Ïg_ma¡”_d–‘e
(
bÚd_idx
è!ğ
STD_ERR_OK
))

330 ià(
memb”_İ
 =ğ
ıs_­i_İ”_SET
) {

332 ià((
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
bÚd_idx
)è=ğ
NULL
) {

335 if(
	`Ïg_objeù_publish
(
Çs_Ïg_’Œy
, 
bÚd_idx
, 
memb”_İ
)!ğ
ıs_­i_»t_code_OK
){

336 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "NAS-CPS-LAG",

341 
	}
}

345 
	$Çs_bridge_ev_hªdËr
(
ıs_­i_objeù_t
 
obj
)

347 
boŞ
 
ü—‹
ğ
çl£
;

348 
Çs_bridge_t
 *
b_node
 = 
NULL
;

350 
ıs_­i_objeù_©Œ_t
 
_idx_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

351 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

352 
ıs_­i_objeù_©Œ_t
 
_Çme_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
);

354 ià((
_idx_©Œ
 =ğ
nuÎ±r
è|| (
_Çme_©Œ
 ==‚ullptr)) {

357 
h®_ifšdex_t
 
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_idx_©Œ
);

358 cÚ¡ *
Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_Çme_©Œ
);

360 
	`EV_LOGGING
(
INTERFACE
,
INFO
, "NAS-Br", "Bridge Interface %d,‚ame %s, operation %d",

361 
if_šdex
, 
Çme
, 
İ
);

363 ià(
İ
 =ğ
ıs_­i_İ”_DELETE
) {

364 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
Çme
, 
BASE_IF_MODE_MODE_L2
è=ğ
çl£
) {

365 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-BR",

366 "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
if_šdex
);

368 if(
	`Çs_d–‘e_bridge
(
if_šdex
è!ğ
STD_ERR_OK
)

374 
	`Çs_bridge_lock
();

375 
b_node
 = 
	`Çs_ü—‹_š£¹_bridge_node
(
if_šdex
, 
Çme
, 
ü—‹
);

376 ià(
b_node
 =ğ
NULL
) {

377 
	`Çs_bridge_uÆock
();

380 ià(
ü—‹
 =ğ
Œue
) {

381 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
Çme
, 
BASE_IF_MODE_MODE_NONE
è=ğ
çl£
) {

382 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-BR",

383 "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
if_šdex
);

386 
	`Çs_bridge_uÆock
();

389 
	}
}

391 
	$Çs_£nd_admš_¡©e_ev’t
(
h®_ifšdex_t
 
if_šdex
, 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_t
 
¡©e
)

394 
buff
[
CPS_API_MIN_OBJ_LEN
];

395 
if_Çme
[
HAL_IF_NAME_SZ
];

396 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_š™
(
buff
,(buff));

397 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

398 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
,

399 
ıs_­i_qu®if›r_OBSERVED
)) {

400 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Could‚otranslateo†ogical interface key ");

403 ià(
	`Çs_št_g‘_if_šdex_to_Çme
(
if_šdex
, 
if_Çme
, (if_Çme)è!ğ
STD_ERR_OK
) {

404 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT","Could‚Ù fšd iÁ”çû‚amfÜ if_šdex %d", 
if_šdex
);

407 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_NAME
, 
if_Çme
, 
	`¡¾’
(if_name) + 1);

408 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
, 
if_šdex
);

409 
	`ıs_­i_objeù_©Œ_add_u32
((
obj
), 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
, 
¡©e
);

410 
	`h®_š‹rçû_£nd_ev’t
(
obj
);

411 
	}
}

413 
	$£nd_Íbk_štf_İ”_ev’t
(
ıs_­i_objeù_t
 
obj
)

415 
ıs_­i_objeù_©Œ_t
 
_’abËd_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_INTERFACE_ENABLED
);

416 ià(
_’abËd_©Œ
 =ğ
nuÎ±r
) ;

418 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

419 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
,

420 
ıs_­i_qu®if›r_OBSERVED
)) {

421 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF","Could‚otranslateo†ogical interface key ");

424 
boŞ
 
_’abËd
 = (boŞè
	`ıs_­i_objeù_©Œ_d©a_u32
(
_’abËd_©Œ
);

425 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
_İ”_¡©e
 = (
_’abËd
) ?

426 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
 : 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
;

428 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
,
_İ”_¡©e
);

429 
	`h®_š‹rçû_£nd_ev’t
(
obj
);

431 
	}
}

433 
	$Çs_loİback_ev_hªdËr
(
ıs_­i_objeù_t
 
obj
)

435 
š‹rçû_ù¾_t
 
d‘as
;

436 
h®_štf_»g_İ_ty³_t
 
»g_İ
;

438 
	`mem£t
(&
d‘as
,0,(details));

439 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

440 
ıs_­i_objeù_©Œ_t
 
if_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

441 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

442 
ıs_­i_objeù_©Œ_t
 
if_Çme_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

443 
IF_INTERFACES_INTERFACE_NAME
);

444 ià(
if_©Œ
 =ğ
nuÎ±r
 || 
if_Çme_©Œ
 ==‚ullptr) {

445 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT",

450 cÚ¡ *
Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
if_Çme_©Œ
);

451 
	`§ã¡ºıy
(
d‘as
.
if_Çme
,
Çme
,(details.if_name));

452 
d‘as
.
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_©Œ
);

453 
d‘as
.
št_ty³
 = 
Çs_št_ty³_LPBK
;

454 
d‘as
.
desc
 = 
nuÎ±r
;

456 
if_Çme_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_NAME
);

457 ià(
if_Çme_©Œ
 =ğ
nuÎ±r
) {

458 
	`ıs_­i_objeù_©Œ_d–‘e
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
);

459 
Çme
 = 
d‘as
.
if_Çme
;

460 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_NAME
,

461 
Çme
, 
	`¡¾’
(name) + 1);

464 ià(
İ
 =ğ
ıs_­i_İ”_CREATE
) {

465 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT", "š‹rçû„egi¡”ƒv’ˆfÜ %s",
Çme
);

466 
»g_İ
 = 
HAL_INTF_OP_REG
;

467 } ià(
İ
 =ğ
ıs_­i_İ”_DELETE
) {

468 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT", "š‹rçû de-»gi¡”ƒv’ˆfÜ %s",
Çme
);

469 
»g_İ
 = 
HAL_INTF_OP_DEREG
;

473 ià(
	`dn_h®_if_»gi¡”
(
»g_İ
,&
d‘as
)!=
STD_ERR_OK
) {

474 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT",

475 "š‹rçû„egi¡” E¼Ü % - m­pšgƒ¼Ü o¸loİback iÁ”çû‡Ì—dy…»£Á",
Çme
);

477 
	`£nd_Íbk_štf_İ”_ev’t
(
obj
);

479 
	}
}

481 
	$Çs_macvÏn_ev_hªdËr
(
ıs_­i_objeù_t
 
obj
) {

484 
š‹rçû_ù¾_t
 
d‘as
;

485 
h®_štf_»g_İ_ty³_t
 
»g_İ
;

487 
	`mem£t
(&
d‘as
,0,(details));

488 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

489 
ıs_­i_objeù_©Œ_t
 
if_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

490 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

491 
ıs_­i_objeù_©Œ_t
 
_addr
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
);

493 
ıs_­i_objeù_©Œ_t
 
if_Çme_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

494 
IF_INTERFACES_INTERFACE_NAME
);

496 ià(
if_©Œ
 =ğ
nuÎ±r
 || 
if_Çme_©Œ
 ==nullptr) {

497 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT",

502 cÚ¡ *
Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
if_Çme_©Œ
);

503 ià(
İ
 =ğ
ıs_­i_İ”_DELETE
) {

504 
š‹rçû_ù¾_t
 
šfo
;

505 
	`mem£t
(&
šfo
, 0, (info));

506 
	`§ã¡ºıy
(
šfo
.
if_Çme
, 
Çme
, 
	`¡¾’
(info.if_name)+1);

507 
šfo
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

508 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
šfo
è=ğ
STD_ERR_OK
) {

509 ià(
šfo
.
vrf_id
 !ğ
NAS_DEFAULT_VRF_ID
) {

516 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT", "Intf:%s delete ignored since "

517 "thš‹rçû i assocŸ‹d w™h VRF:%d", 
Çme
, 
šfo
.
vrf_id
);

523 
	`§ã¡ºıy
(
d‘as
.
if_Çme
,
Çme
,(details.if_name));

524 
d‘as
.
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_©Œ
);

525 
d‘as
.
št_ty³
 = 
Çs_št_ty³_MACVLAN
;

526 ià(
_addr
 !ğ
nuÎ±r
) {

527 cÚ¡ *
mac_addr
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_addr
);

528 
	`§ã¡ºıy
(
d‘as
.
mac_addr
,mac_addr,(details.mac_addr));

532 ià(
İ
 =ğ
ıs_­i_İ”_CREATE
) {

533 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT", "interface„egisterƒvent for %s",

534 
d‘as
.
if_Çme
);

535 
»g_İ
 = 
HAL_INTF_OP_REG
;

536 } ià(
İ
 =ğ
ıs_­i_İ”_DELETE
) {

537 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT", "interface de-registerƒvent for %s",

538 
d‘as
.
if_Çme
);

539 
»g_İ
 = 
HAL_INTF_OP_DEREG
;

543 ià(
	`dn_h®_if_»gi¡”
(
»g_İ
,&
d‘as
è!ğ
STD_ERR_OK
) {

544 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT",

545 "š‹rçû„egi¡” E¼Ü % - m­pšgƒ¼Ü o¸macvÏÀ iÁ”çû‡Ì—dy…»£Á",
Çme
);

548 
	}
}

550 
	$Çs_št_ev_hªdËr
(
ıs_­i_objeù_t
 
obj
) {

552 
h®_ifšdex_t
 
if_šdex
;

553 
ndi_pÜt_t
 
ndi_pÜt
;

555 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

556 ià(
©Œ
==
nuÎ±r
)  ;

557 
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

558 ià(
	`Çs_is_vœtu®_pÜt
(
if_šdex
)) {

559 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-INT", "By·s vœtu® iÁ”çû, ifšdex=%d", 
if_šdex
);

562 ià(
	`Çs_št_g‘_Åu_pÜt
(
if_šdex
, &
ndi_pÜt
è!ğ
STD_ERR_OK
) {

563 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-INT","if_šdex %d i wrÚg o¸IÁ”çû ha NO slÙ…Üˆ", 
if_šdex
);

570 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
);

571 ià(
©Œ
!=
nuÎ±r
) {

572 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_t
 
¡©e
, 
cu¼’t_¡©e
;

573 
¡©e
 = (
boŞ
)
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
) ?

574 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_UP
 : 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_DOWN
;

575 ià(
	`ndi_pÜt_admš_¡©e_g‘
(
ndi_pÜt
.
Åu_id
,‚di_pÜt.
Åu_pÜt
,&
cu¼’t_¡©e
)==
STD_ERR_OK
) {

576 ià(
cu¼’t_¡©e
 !ğ
¡©e
) {

577 ià(
	`ndi_pÜt_admš_¡©e_£t
(
ndi_pÜt
.
Åu_id
,‚di_pÜt.
Åu_pÜt
,

578 (
¡©e
 =ğ
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_UP
è? 
Œue
: 
çl£
è!ğ
STD_ERR_OK
) {

579 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INTF-NPU","Error Setting Admin Stateo %s for %d:%d ifindex %d",

580 
¡©e
 =ğ
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_UP
 ? "UP" : "DOWN",

581 
ndi_pÜt
.
Åu_id
,‚di_pÜt.
Åu_pÜt
, 
if_šdex
);

583 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"INTF-NPU","Admin state change on %d:%do %d",

584 
ndi_pÜt
.
Åu_id
,‚di_pÜt.
Åu_pÜt
,
¡©e
);

586 
	`Çs_£nd_admš_¡©e_ev’t
(
if_šdex
, 
¡©e
);

590 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INTF-NPU","Admin state Get failed on %d:%d ",

591 
ndi_pÜt
.
Åu_id
,‚di_pÜt.
Åu_pÜt
);

597 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
);

598 ià(
©Œ
!=
NULL
) {

599 
ušt_t
 
mtu
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

600 autØ
Åu
 = 
ndi_pÜt
.
Åu_id
;

601 autØ
pÜt
 = 
ndi_pÜt
.
Åu_pÜt
;

603 ià(
	`ndi_pÜt_mtu_£t
(
Åu
,
pÜt
, 
mtu
)!=
STD_ERR_OK
) {

606 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INTF-NPU","Error setting MTU %d for NPU %d PORT %d ifindex %d",

607 
mtu
, 
Åu
, 
pÜt
, 
if_šdex
);

608 ià(
	`ndi_pÜt_mtu_g‘
(
Åu
,
pÜt
,&
mtu
)==
STD_ERR_OK
) {

609 
	`ıs_­i_£t_key_d©a
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
ıs_­i_objeù_ATTR_T_U32
,

610 &
if_šdex
, (if_index));

611 
	`ıs_­i_objeù_©Œ_d–‘e
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
);

612 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
,
mtu
);

613 
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
);

617 
	}
}

619 autØ
	g_št_ev_hªdËrs
 = 
Ãw
 
¡d
::
unÜd”ed_m­
<
BASE_CMN_INTERFACE_TYPE_t
, (*)

620 (
ıs_­i_objeù_t
), 
¡d
::
hash
<>>

622 { 
BASE_CMN_INTERFACE_TYPE_L3_PORT
, 
Çs_št_ev_hªdËr
},

623 { 
BASE_CMN_INTERFACE_TYPE_L2_PORT
, 
Çs_bridge_ev_hªdËr
},

624 { 
BASE_CMN_INTERFACE_TYPE_VLAN
, 
Çs_vÏn_ev_hªdËr
},

625 { 
BASE_CMN_INTERFACE_TYPE_LAG
, 
Çs_Ïg_ev_hªdËr
},

626 { 
BASE_CMN_INTERFACE_TYPE_MACVLAN
, 
Çs_macvÏn_ev_hªdËr
},

627 { 
BASE_CMN_INTERFACE_TYPE_LOOPBACK
, 
Çs_loİback_ev_hªdËr
},

628 
	}
};

630 
boŞ
 
	$Çs_št_ev_hªdËr_cb
(
ıs_­i_objeù_t
 
obj
, *
·¿m
) {

632 
ıs_­i_objeù_©Œ_t
 
_ty³
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
BASE_IF_LINUX_IF_INTERFACES_INTERFACE_DELL_TYPE
);

633 ià(
_ty³
==
nuÎ±r
) {

634 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INTF-EV","Unknown Event or interfaceype‚ot…resent");

635  
çl£
;

637 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"INTF-EV","OSƒvent„eceived for interface state change.");

638 
BASE_CMN_INTERFACE_TYPE_t
 
if_ty³
 = (BASE_CMN_INTERFACE_TYPE_tè
	`ıs_­i_objeù_©Œ_d©a_u32
(
_ty³
);

639 
ıs_­i_objeù_©Œ_t
 
_vrf_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
VRF_MGMT_NI_IF_INTERFACES_INTERFACE_VRF_ID
);

640 ià(
_vrf_©Œ
 && (
	`ıs_­i_objeù_©Œ_d©a_u32
(_vrf_©Œè!ğ
NAS_DEFAULT_VRF_ID
)) {

642  
Œue
;

644 autØ
func
 = 
_št_ev_hªdËrs
->
	`fšd
(
if_ty³
);

645 ià(
func
 !ğ
_št_ev_hªdËrs
->
	`’d
()) {

646 
func
->
	`£cÚd
(
obj
);

647  
Œue
;

649 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INTF-EV","Unknown interfaceype");

650  
çl£
;

652 
	}
}

	@src/nas_int_list.c

21 
	~"Çs_št_li¡.h
"

22 
	~"ev’t_log.h
"

24 
Çs_li¡_node_t
 *
	$Çs_g‘_fœ¡_lšk_node
(
¡d_dÎ_h—d
 *
p_lšk_node_li¡
)

26  (
Çs_li¡_node_t
 *)
	`¡d_dÎ_g‘fœ¡
(
p_lšk_node_li¡
);

27 
	}
}

29 
Çs_li¡_node_t
 *
	$Çs_g‘_Ãxt_lšk_node
(
¡d_dÎ_h—d
 *
p_lšk_node_li¡
, 
Çs_li¡_node_t
 *
p_lšk_node
)

31  (
Çs_li¡_node_t
 *)
	`¡d_dÎ_g‘Ãxt
(
p_lšk_node_li¡
, (
¡d_dÎ
 *)
p_lšk_node
);

32 
	}
}

34 
Çs_li¡_node_t
 *
	$Çs_g‘_lšk_node
(
¡d_dÎ_h—d
 *
p_lšk_node_li¡
, 
h®_ifšdex_t
 
šdex
)

36 
Çs_li¡_node_t
 *
p_lšk_node
 = (Çs_li¡_node_ˆ*)
	`¡d_dÎ_g‘fœ¡
(
p_lšk_node_li¡
);

38 
p_lšk_node
 !ğ
NULL
) {

39 if(
p_lšk_node
->
ifšdex
 =ğ
šdex
)

41  
p_lšk_node
;

44 
p_lšk_node
 = (
Çs_li¡_node_t
 *)
	`¡d_dÎ_g‘Ãxt
(
p_lšk_node_li¡
, (
¡d_dÎ
 *)p_link_node);

47  
p_lšk_node
;

48 
	}
}

50 
	$Çs_š£¹_lšk_node
(
¡d_dÎ_h—d
 *
p_lšk_node_li¡
, 
Çs_li¡_node_t
 *
p_lšk_node
)

52 
	`¡d_dÎ_š£¹
(
p_lšk_node_li¡
, (
¡d_dÎ
 *)
p_lšk_node
);

53 
	}
}

55 
	$Çs_d–‘e_lšk_node
(
¡d_dÎ_h—d
 *
p_lšk_node_li¡
, 
Çs_li¡_node_t
 *
p_lšk_node
)

57 
	`¡d_dÎ_»move
(
p_lšk_node_li¡
, (
¡d_dÎ
 *)
p_lšk_node
);

58 
	`ä“
(
p_lšk_node
);

59 
	}
}

61 
	$Çs_d–‘e_pÜt_li¡
(
Çs_li¡_t
 *
p_lšk_node_li¡
)

63 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
, *
‹mp_node
 = NULL;

65 
p_lšk_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&
p_lšk_node_li¡
->
pÜt_li¡
);

66 if(
p_lšk_node
 !ğ
NULL
) {

67 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
, "NAS-Link",

68 "Found iÁà%d fÜ d–‘iÚ", 
p_lšk_node
->
ifšdex
);

70 
p_lšk_node
 !ğ
NULL
) {

71 
‹mp_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_lšk_node_li¡
->
pÜt_li¡
, 
p_lšk_node
);

73 
	`Çs_d–‘e_lšk_node
(&
p_lšk_node_li¡
->
pÜt_li¡
, 
p_lšk_node
);

74 
p_lšk_node
 = 
‹mp_node
;

76 
p_lšk_node_li¡
->
pÜt_couÁ
--;

79 
	}
}

	@src/nas_int_main.cpp

22 
	~"ds_commÚ_ty³s.h
"

23 
	~"ıs_­i_ev’ts.h
"

24 
	~"ıs_­i_İ”©iÚ.h
"

25 
	~"ıs_­i_objeù_key.h
"

26 
	~"ıs_şass_m­.h
"

27 
	~"Çs_št_bridge.h
"

28 
	~"Çs_št_physiÿl_ıs.h
"

29 
	~"d–l-ba£-if-lšux.h
"

30 
	~"d–l-ba£-if.h
"

31 
	~"d–l-ba£-if-vÏn.h
"

32 
	~"d–l-ba£-if-mgmt.h
"

33 
	~"d–l-š‹rçû.h
"

34 
	~"Çs_št_Ïg_ıs.h
"

35 
	~"š‹rçû_obj.h
"

36 
	~"ŸÇ-if-ty³.h
"

38 
	~"h®_š‹rçû.h
"

39 
	~"h®_if_m­pšg.h
"

40 
	~"Çs_sw™ch.h
"

41 
	~"¡d_mac_uts.h
"

42 
	~"h®_š‹rçû_deçuÉs.h
"

43 
	~"h®_š‹rçû_commÚ.h
"

44 
	~"ev’t_log_ty³s.h
"

45 
	~"ev’t_log.h
"

46 
	~"Çs_ndi_pÜt.h
"

47 
	~"¡d_as£¹.h
"

49 
	~"¡d_cÚfig_fe.h
"

50 
	~"Çs_št_vÏn.h
"

51 
	~"Çs_št_pÜt.h
"

52 
	~"Çs_¡©s.h
"

53 
	~"Çs_fc_¡©s.h
"

54 
	~"Çs_št_uts.h
"

55 
	~"¡d_uts.h
"

56 
	~"Çs_vrf.h
"

57 
	~"Çs_vrf_uts.h
"

59 
	~"Çs_ndi_pÜt.h
"

60 
	~<¡ršg.h
>

61 
	~<¡dlib.h
>

62 
	~<¡dio.h
>

63 
	~<uni¡d.h
>

64 
	~<£t
>

66 
	#NUM_INT_CPS_API_THREAD
 1

	)

68 
ıs_­i_İ”©iÚ_hªdË_t
 
	gÇs_if_hªdË
;

70 
	$h®_š‹rçû_£nd_ev’t
(
ıs_­i_objeù_t
 
obj
) {

71 ià(
	`ıs_­i_ev’t_th»ad_publish
(
obj
)!=
STD_ERR_OK
) {

72 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INTF-EVENT","Failedo sendƒvent. Service issue");

74 
	}
}

76 autØ
	gİ”_¡©e_hªdËrs
 = 
Ãw
 
¡d
::
£t
 <
İ”_¡©e_hªdËr_t
> ;

78 
	$Çs_št_İ”_¡©e_»gi¡”_cb
(
İ”_¡©e_hªdËr_t
 
İ”_¡©e_cb
) {

79 ià(
İ”_¡©e_cb
 !ğ
NULL
) {

80 
İ”_¡©e_hªdËrs
->
	`š£¹
(
İ”_¡©e_cb
);

82 
	}
}

84 
	$hw_lšk_¡©e_cb
(
Åu_id_t
 
Åu
, 
Åu_pÜt_t
 
pÜt
,

85 
ndi_štf_lšk_¡©e_t
 *
d©a
) {

87 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©us
 = 
	`ndi_to_ıs_İ”_ty³
(
d©a
->
İ”_¡©us
);

88 autØ
™
 = 
İ”_¡©e_hªdËrs
->
	`begš
(); iˆ!ğİ”_¡©e_hªdËrs->
	`’d
(); ++it) {

89 (*
™
)(
Åu
, 
pÜt
, 
¡©us
);

91 
	}
}

93 
t_¡d_”rÜ
 
	$Çs_if_g‘_assigÃd_mac
(cÚ¡ *
if_ty³
,

94 cÚ¡ *
if_Çme
,

95 
h®_vÏn_id_t
 
vÏn_id
,

96 *
mac_addr
, 
size_t
 
mac_buf_size
)

98 ià(
mac_buf_size
 == 0) {

99  
STD_ERR_OK
;

101 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

102 ià(
obj
 =ğ
NULL
) {

103  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

105 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

106 
DELL_BASE_IF_CMN_GET_MAC_ADDRESS_OBJ
,

107 
ıs_­i_qu®if›r_TARGET
)) {

108 
	`ıs_­i_objeù_d–‘e
(
obj
);

109  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

111 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_TYPE
, 
if_ty³
, 
	`¡¾’
(if_type) + 1);

113 ià(
	`¡ºcmp
(
if_ty³
,

114 
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

115 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
)) == 0) {

116 ià(
vÏn_id
 == 0) {

117  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

119 
	`ıs_­i_objeù_©Œ_add_u16
(
obj
, 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
, 
vÏn_id
);

121 ià(
if_Çme
 =ğ
NULL
) {

122  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

124 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
if_Çme
, 
	`¡¾’
(if_name) + 1);

127 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

128 ià(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
è!ğ
ıs_­i_»t_code_OK
) {

129 
	`ıs_­i_objeù_d–‘e
(
obj
);

130  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

132 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

133 
t_¡d_”rÜ
 
rc
 = 
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

135 ià(
	`ıs_­i_comm™
(&
Œ
è!ğ
ıs_­i_»t_code_OK
) {

136 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INTF-MAC", "Failedo commit");

139 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
Œ
.
chªge_li¡
);

140 ià(
mx
 == 0) {

141 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INTF-MAC", "No object„eturned");

144 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
Œ
.
chªge_li¡
, 0);

145 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

146 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
);

147 ià(
©Œ
 =ğ
NULL
) {

148 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INTF-MAC", "No mac‡ddress in„eturned object");

151 *
addr_¡r
 = (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
©Œ
);

152 ià(
	`¡¾’
(
addr_¡r
è> 
MAC_STRING_SZ
) {

153 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INTF-MAC", "Invalid mac‡ddress format: %s",

154 
addr_¡r
);

157 
	`§ã¡ºıy
(
mac_addr
, 
addr_¡r
, 
mac_buf_size
);

158 
rc
 = 
STD_ERR_OK
;

160 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

162  
rc
;

163 
	}
}

165 
boŞ
 
	$mgmt_štf_ev’t_hªdËr
 (
ıs_­i_objeù_t
 
obj
, * 
cÚ‹xt
)

168 
š‹rçû_ù¾_t
 
d‘as
;

169 
ıs_­i_objeù_©Œ_t
 
if_Çme_©Œ
, 
if_©Œ
, 
vrf_Çme_©Œ
;

171 
	`mem£t
(&
d‘as
, 0, (details));

172 
if_Çme_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
);

173 
vrf_Çme_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
NI_IF_INTERFACES_INTERFACE_BIND_NI_NAME
);

174 
if_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

176 ià(
if_Çme_©Œ
 =ğ
NULL
)

177  
Œue
;

179 ià(
if_©Œ
) {

180 
d‘as
.
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_©Œ
);

182 
	`§ã¡ºıy
(
d‘as
.
if_Çme
, (*è
	`ıs_­i_objeù_©Œ_d©a_bš
(
if_Çme_©Œ
),

183 
	`ıs_­i_objeù_©Œ_Ën
(
if_Çme_©Œ
));

185 
š‹rçû_ù¾_t
 
štf_ù¾
;

186 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

187 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

188 
	`§ã¡ºıy
(
štf_ù¾
.
if_Çme
, (cÚ¡ *)
d‘as
.if_name, (intf_ctrl.if_name));

189 ià(
vrf_Çme_©Œ
) {

190 
vrf_Çme
[
NAS_VRF_NAME_SZ
+1];

192 
	`mem£t
 (
vrf_Çme
,0,(vrf_name));

193 
	`§ã¡ºıy
(
vrf_Çme
, (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
vrf_Çme_©Œ
),

194 (
vrf_Çme
));

195 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-SYS-MGMT-INTF",

196 "New iÁ”çû VRF:% štf:% if-šdex:%d", 
vrf_Çme
, 
štf_ù¾
.
if_Çme
,

197 
d‘as
.
if_šdex
);

198 ià(
	`¡ºcmp
(
vrf_Çme
, 
NAS_DEFAULT_VRF_NAME
, (vrf_name)) == 0) {

199 
d‘as
.
vrf_id
 = 
NAS_DEFAULT_VRF_ID
;

200 } ià(
	`¡ºcmp
(
vrf_Çme
, 
NAS_MGMT_VRF_NAME
, (vrf_name)) == 0) {

201 
d‘as
.
vrf_id
 = 
NAS_MGMT_VRF_ID
;

204  
Œue
;

208 ià((
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è=ğ
STD_ERR_OK
) {

209 ià(
if_©Œ
 =ğ
NULL
) {

210 
d‘as
.
if_šdex
 = 
štf_ù¾
.if_index;

212 ià((
štf_ù¾
.
vrf_id
 !ğ
d‘as
.vrf_id) ||

213 (
štf_ù¾
.
if_šdex
 !ğ
d‘as
.if_index)) {

214 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-SYS-MGMT-INTF",

216 
štf_ù¾
.
if_Çme
, 
d‘as
.
vrf_id
, d‘as.
if_šdex
,

217 
štf_ù¾
.
vrf_id
, iÁf_ù¾.
if_šdex
);

218 ià(
	`dn_h®_if_»gi¡”
(
HAL_INTF_OP_DEREG
,&
štf_ù¾
)!=
STD_ERR_OK
) {

219 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-SYS-MGMT-INTF",

220 "š‹rçû d”egi¡” E¼Ü % ", 
štf_ù¾
.
if_Çme
);

223  
Œue
;

226 
d‘as
.
št_ty³
 = 
Çs_št_ty³_MGMT
;

227 ià(
	`dn_h®_if_»gi¡”
(
HAL_INTF_OP_REG
,&
d‘as
)!=
STD_ERR_OK
) {

228 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-SYS-MGMT-INTF",

229 "š‹rçû„egi¡” E¼Ü % -‡Ì—dy…»£Á", 
d‘as
.
if_Çme
);

231  
Œue
;

232 
	}
}

234 
t_¡d_”rÜ
 
	$Çs_sys_mgmt_štf_»gi¡”
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
)

236 
ıs_­i_ev’t_»g_t
 
»g
;

237 
ıs_­i_key_t
 
keys
;

238 
š‹rçû_ù¾_t
 
d‘as
;

239 
ıs_­i_g‘_·¿ms_t
 
g‘_»q
;

240 
ıs_­i_objeù_t
 
»c
, 
f‹r
;

241 
ıs_­i_objeù_©Œ_t
 
if_Çme_©Œ
, 
if_©Œ
;

242 
h®_štf_»g_İ_ty³_t
 
»g_İ
 = 
HAL_INTF_OP_REG
;

244 
	`mem£t
(&
»g
, 0, (
ıs_­i_ev’t_»g_t
));

245 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
keys
,

246 
BASE_IF_MGMT_IF_INTERFACES_INTERFACE_OBJ
,

247 
ıs_­i_qu®if›r_OBSERVED
);

249 
»g
.
objeùs
 = &
keys
;

250 
»g
.
numb”_of_objeùs
 = 1;

252 ià(
	`ıs_­i_ev’t_th»ad_»g
(&
»g
, 
mgmt_štf_ev’t_hªdËr
, 
NULL
)

253 !ğ
ıs_­i_»t_code_OK
) {

254 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-SYS-MGMT-INTF", "MGMT intfƒvent„egistration failed.");

257 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
keys
,

258 
BASE_IF_MGMT_IF_INTERFACES_INTERFACE_OBJ
,

259 
ıs_­i_qu®if›r_TARGET
);

261 ià(
	`ıs_­i_g‘_»que¡_š™
(&
g‘_»q
è!ğ
ıs_­i_»t_code_OK
) {

262 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-SYS-MGMT-INTF", "MGMT intf get„equest init failed.");

263  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

267 
f‹r
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
g‘_»q
.
f‹rs
);

268 
	`ıs_­i_objeù_£t_key
(
f‹r
, &
keys
);

269 ià(
	`ıs_­i_g‘
(&
g‘_»q
è!ğ
ıs_­i_»t_code_OK
) {

270 
	`EV_LOGGING
(
INTERFACE
, 
INFO
,"NAS-SYS-MGMT-INTF", "MGMT intf cps get failed.");

274 
ušt_t
 
couÁ
 = 
	`ıs_­i_objeù_li¡_size
(
g‘_»q
.
li¡
);

275 
ušt_t
 
idx
 = 0; idx < 
couÁ
; idx++) {

276 
	`mem£t
(&
d‘as
, 0, (details));

278 
»c
 = 
	`ıs_­i_objeù_li¡_g‘
(
g‘_»q
.
li¡
, 
idx
);

279 ià(
»c
 =ğ
nuÎ±r
) {

280 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-SYS-MGMT-INTF",

281 "MGMT objeù g‘ from†i¡ faed, index %d.", 
idx
);

285 
if_Çme_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»c
, 
IF_INTERFACES_INTERFACE_NAME
);

286 
if_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»c
,

287 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

289 ià(
if_Çme_©Œ
 !ğ
NULL
) {

290 
	`¡ºıy
(
d‘as
.
if_Çme
, (*è
	`ıs_­i_objeù_©Œ_d©a_bš
(
if_Çme_©Œ
),

291 
	`ıs_­i_objeù_©Œ_Ën
(
if_Çme_©Œ
));

293 ià(
if_©Œ
 !ğ
NULL
) {

294 
d‘as
.
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_©Œ
);

296 ià(
d‘as
.
if_šdex
 == 0) ;

297 
d‘as
.
št_ty³
 = 
Çs_št_ty³_MGMT
;

298 ià(
	`dn_h®_if_»gi¡”
(
»g_İ
,&
d‘as
)!=
STD_ERR_OK
) {

299 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT",

300 "š‹rçû„egi¡” E¼Ü % -‡Ì—dy…»£Á", 
d‘as
.
if_Çme
);

305 
	`ıs_­i_g‘_»que¡_şo£
(&
g‘_»q
);

306  
STD_ERR_OK
;

307 
	}
}

312 
t_¡d_”rÜ
 
	$h®_š‹rçû_š™
() {

313 
t_¡d_”rÜ
 
rc
;

316 
ıs_­i_ev’t_»g_t
 
»g
;

317 
	`mem£t
(&
»g
,0,(reg));

318 cÚ¡ 
ušt_t
 
NUM_EVENTS
=1;

320 
ıs_­i_key_t
 
keys
[
NUM_EVENTS
];

322 
buff
[
CPS_API_KEY_STR_MAX
];

324 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
keys
[0],

325 
BASE_IF_LINUX_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_OBSERVED
)) {

326 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Could‚otranslate %do key %s",

327 ()(
BASE_IF_LINUX_IF_INTERFACES_INTERFACE_OBJ
),
	`ıs_­i_key_´št
(&
keys
[0],
buff
,(buff)-1));

328  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

330 
	`EV_LOG
(
INFO
, 
INTERFACE
,0,"NAS-IF-REG", "Registered for interfaceƒvents with key %s",

331 
	`ıs_­i_key_´št
(&
keys
[0],
buff
,(buff)-1));

333 
»g
.
numb”_of_objeùs
 = 
NUM_EVENTS
;

334 
»g
.
objeùs
 = 
keys
;

336 ià(
	`ıs_­i_ev’t_th»ad_»g
(&
»g
,
Çs_št_ev_hªdËr_cb
,
NULL
)!=
ıs_­i_»t_code_OK
) {

337  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

341 ià(
	`ıs_­i_İ”©iÚ_subsy¡em_š™
(&
Çs_if_hªdË
,
NUM_INT_CPS_API_THREAD
)!=
ıs_­i_»t_code_OK
) {

342  
	`STD_ERR
(
CPSNAS
,
FAIL
,0);

345 ià(
	`ndi_pÜt_İ”_¡©e_nÙify_»gi¡”
(
hw_lšk_¡©e_cb
)!=
STD_ERR_OK
) {

346 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,"NAS-INT-INIT","Initializing Interface callback failed");

347  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

349 iàĞ(
rc
=
	`Çs_št_ıs_š™
(
Çs_if_hªdË
))!ğ
STD_ERR_OK
) {

350 
	`EV_LOG_ERR
(
ev_log_t_INTERFACE
, 3,"NAS-INT-SWERR", "Initializing interface management failed");

351  
rc
;

354 ià((
rc
 = 
	`Çs_sys_mgmt_štf_»gi¡”
(
Çs_if_hªdË
)è!ğ
STD_ERR_OK
) {

355 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-SYS-MGMT-INTF", "Initializing system mgmt interface failed");

356  
rc
;

359 if((
rc
 = 
	`Çs_ıs_Ïg_š™
(
Çs_if_hªdË
)è!ğ
STD_ERR_OK
) {

360 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INTF-CPS-LAG-SWERR", "Initializing CPS for LAG failed");

361  
rc
;

364 if((
rc
 = 
	`Çs_ıs_vÏn_š™
(
Çs_if_hªdË
)è!ğ
STD_ERR_OK
) {

365 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INTF-CPS-VLAN-SWERR", "Initializing CPS for VLAN failed");

366  
rc
;

369 iàĞ(
rc
=
	`Çs_¡©s_if_š™
(
Çs_if_hªdË
))!ğ
STD_ERR_OK
) {

370 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-SWERR", "Initializing interface statistic failed");

371  
rc
;

374 ià(
	`Çs_sw™ch_g‘_fc_suµÜ‹d
()) {

375 iàĞ(
rc
=
	`Çs_¡©s_fc_if_š™
(
Çs_if_hªdË
))!ğ
STD_ERR_OK
) {

376 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-FC-INT-SWERR", "Initializing interface FC statistics failed");

377  
rc
;

381 iàĞ(
rc
=
	`Çs_¡©s_vÏn_š™
(
Çs_if_hªdË
))!ğ
STD_ERR_OK
) {

382 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-SWERR", "Initializing vlan statistics failed");

383  
rc
;

386 ià((
rc
=
	`Çs_“e_¡©s_if_š™
(
Çs_if_hªdË
)è!ğ
STD_ERR_OK
) {

387 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-EEE-INT-SWERR",

389  
rc
;

392 iàĞ(
rc
=
	`š‹rçû_obj_š™
(
Çs_if_hªdË
))!=
STD_ERR_OK
) {

393 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-INIT-IF", "Failedo initialize common interface handler");

394  
rc
;

397 
	`Çs_deçuÉ_vÏn_ÿche_š™
();

398 
	`Çs_sh–l_commªd_š™
();

399  (
rc
);

400 
	}
}

	@src/packet/nas_packet_filter.cpp

22 
	~"ev’t_log.h
"

23 
	~"ev’t_log_ty³s.h
"

24 
	~"Çs_št_f‹r_şass.h
"

25 
	~"ıs_­i_İ”©iÚ.h
"

26 
	~"Çs_·ck‘_m‘a.h
"

27 
	~"h®_if_m­pšg.h
"

28 
	~"Çs_št_pÜt.h
"

29 
	~"Çs_št_uts.h
"

31 
	~<io¡»am
>

32 
	~<memÜy
>

33 
	~<funùiÚ®
>

34 
	~<exû±iÚ
>

37 
	g¡d
::
unique_±r
<
pf_bË
> 
pf_bË_š¡
(
nuÎ±r
);

39 
	gpf_sock_fd
 = -1;

42 
Çs_obj_id_t
 
	gpf_bË
::
	$pf_t_ü—‹_ruË
(
pf_dœeùiÚ
 
dœ
, 
pf_m©ch_t
& 
m©
, 
pf_aùiÚ_t
& 
aù
,

43 
boŞ
 
¡İ
) {

45 
Çs_obj_id_t
 
id
 = 
	`pf_t_®loc_tid
();

46 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","New id g’”©ed %lu", 
id
);

48 
pf_ruË
 
	`ruË
 (
id
, 
m©
, 
aù
);

49 
ruË
.
	`pf_r_£t_¡İ
(
¡İ
);

51  
	`pf_t_add_ruË
(
dœ
, 
ruË
);

52 
	}
}

54 
Çs_obj_id_t
 
	gpf_bË
::
	$pf_t_add_ruË
(
pf_dœeùiÚ
 
dœ
, 
pf_ruË
& 
ruË
) {

56 if(!
ruË
.
	`pf_r_g‘_id
()) {

57 
Çs_obj_id_t
 
id
 = 
	`pf_t_®loc_tid
();

58 
ruË
.
	`pf_r_£t_id
(
id
);

61 
¡d
::
lock_gu¬d
<¡d::
mu‹x
> 
pf_ock
 {
pf_mtx
};

63 ifĞ
dœ
 =ğ
BASE_PACKET_PACKET_DIRECTION_TYPE_DIR_IN
) {

64 ++
šg»ss_ruËs
;

65 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Ingress„ule %lu‡dded - Total count %d",

66 
ruË
.
	`pf_r_g‘_id
(),
šg»ss_ruËs
);

67 
pf_šg»ss_bË
.
	`em¶aû_back
(
ruË
);

69 ++
eg»ss_ruËs
;

70 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Egress„ule %lu‡dded - Total count %d",

71 
ruË
.
	`pf_r_g‘_id
(), 
eg»ss_ruËs
);

72 
pf_eg»ss_bË
.
	`em¶aû_back
(
ruË
);

75  
ruË
.
	`pf_r_g‘_id
();

76 
	}
}

78 cÚ¡ 
pf_ruË
* 
pf_g’_g‘_id
(cÚ¡ 
¡d
::
veùÜ
<pf_ruË>& 
vec
, 
Çs_obj_id_t
& 
id
) {

79 autØ
	g™r
 = 
vec
.
begš
(); iŒ !ğvec.
’d
(); ++itr) {

80 if((*
	g™r
).
pf_r_g‘_id
(è=ğ
id
) {

81  &(*
™r
);

84  
	gnuÎ±r
;

87 
boŞ
 
pf_g’_”a£_id
(
¡d
::
veùÜ
<
pf_ruË
>& 
vec
, 
Çs_obj_id_t
& 
id
) {

88 autØ
	g™r
 = 
vec
.
begš
(); iŒ !ğvec.
’d
(); ++itr) {

89 if((*
	g™r
).
pf_r_g‘_id
(è=ğ
id
) {

90 
vec
.
”a£
(
™r
);

91  
	gŒue
;

94  
	gçl£
;

97 cÚ¡ 
pf_ruË
* 
	gpf_bË
::
	$pf_t_g‘_ruË
(
Çs_obj_id_t
 
id
è
nÛxû±
 {

99 cÚ¡ 
pf_ruË
* 
p_pä
 = 
nuÎ±r
;

101 
¡d
::
lock_gu¬d
<¡d::
mu‹x
> 
pf_ock
 {
pf_mtx
};

103 if((
p_pä
 = 
	`pf_g’_g‘_id
(
pf_šg»ss_bË
, 
id
)è=ğ
nuÎ±r
)

104 
p_pä
 = 
	`pf_g’_g‘_id
(
pf_eg»ss_bË
, 
id
);

106  
p_pä
;

107 
	}
}

109 
boŞ
 
	gpf_bË
::
	$pf_t_d–_ruË
(
Çs_obj_id_t
 
id
) {

111 
boŞ
 
d–
=
çl£
;

113 
¡d
::
lock_gu¬d
<¡d::
mu‹x
> 
pf_ock
 {
pf_mtx
};

115 if((
d–
 = 
	`pf_g’_”a£_id
(
pf_šg»ss_bË
, 
id
))) {

116 --
šg»ss_ruËs
;

117 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Ing»s ruË %lu d–‘ed,„em %d", 
id
, 
šg»ss_ruËs
);

118 } if((
d–
 = 
	`pf_g’_”a£_id
(
pf_eg»ss_bË
, 
id
))) {

119 --
eg»ss_ruËs
;

120 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Eg»s ruË %lu d–‘ed,„em %d", 
id
, 
eg»ss_ruËs
);

123 if(!
d–
è
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","RuË‚Ù found id %lu", 
id
);

124 
	`pf_t_»Ëa£_tid
(
id
);

126  
d–
;

127 
	}
}

132 
boŞ
 
	gpf_bË
::
	$pf_t_š_pkt_hndÌ
(
ušt8_t
 *
pkt
, 
ušt32_t
 
pkt_Ën
, 
pf_pkt_©Œ
 *
p_©Œ
) {

134 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","In_Pkt handler -†en %d,…ort %d,rap id %d",

135 
pkt_Ën
, 
p_©Œ
->
rx_pÜt
,…_©Œ->
Œ­_id
);

137 
¡d
::
lock_gu¬d
<¡d::
mu‹x
> 
pf_ock
 {
pf_mtx
};

139 autØ
pä
 : 
pf_šg»ss_bË
) {

140 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","SÿÂšg„uË id %lu", 
pä
.
	`pf_r_g‘_id
());

141 
boŞ
 
m©ch
 = 
Œue
, 
aùiÚ
 =rue;

144 
pä
.
	`pf_r_g‘_m©ch_·¿ms
([&](
pf_m©ch_t
& 
m_tv
) {

145 cÚ¡ 
pf_m©ch
 
»f
 = 
pä
.
	`pf_r_g‘_m©ch_li¡
();

146 
m©ch
 &ğ
»f
.
	`pf_m_šv_åŒ
(
m_tv
.
m_ty³
, 
pkt
, 
pkt_Ën
, 
p_©Œ
, m_tv);

148 if(
m©ch
) {

149 
pä
.
	`pf_r_g‘_aùiÚ_·¿ms
([&](
pf_aùiÚ_t
& 
a_tv
) {

150 cÚ¡ 
pf_aùiÚ
 
»f
 = 
pä
.
	`pf_r_g‘_aùiÚ_li¡
();

151 
aùiÚ
 &ğ
»f
.
	`Œigg”_aùiÚ
(
pkt
, 
pkt_Ën
, 
p_©Œ
, 
a_tv
);

153 if(
pä
.
	`pf_r_g‘_¡İ
()è 
Œue
;

157  
çl£
;

158 
	}
}

160 
boŞ
 
	gpf_bË
::
	$pf_t_out_pkt_hndÌ
(
ušt8_t
 *
pkt
, 
ušt32_t
 
pkt_Ën
, 
pf_pkt_©Œ
 *
p_©Œ
) {

162 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Out_Pkt handler -†en %d,…ort %d",

163 
pkt_Ën
, 
p_©Œ
->
tx_pÜt
);

165 
¡d
::
lock_gu¬d
<¡d::
mu‹x
> 
pf_ock
 {
pf_mtx
};

167 autØ
pä
 : 
pf_eg»ss_bË
) {

168 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","SÿÂšg„uË id %lu", 
pä
.
	`pf_r_g‘_id
());

169 
boŞ
 
m©ch
 = 
Œue
, 
aùiÚ
 =rue;

172 
pä
.
	`pf_r_g‘_m©ch_·¿ms
([&](
pf_m©ch_t
& 
m_tv
) {

173 cÚ¡ 
pf_m©ch
 
»f
 = 
pä
.
	`pf_r_g‘_m©ch_li¡
();

174 
m©ch
 &ğ
»f
.
	`pf_m_šv_åŒ
(
m_tv
.
m_ty³
, 
pkt
, 
pkt_Ën
, 
p_©Œ
, m_tv);

176 if(
m©ch
) {

177 
pä
.
	`pf_r_g‘_aùiÚ_·¿ms
([&](
pf_aùiÚ_t
& 
a_tv
) {

178 cÚ¡ 
pf_aùiÚ
 
»f
 = 
pä
.
	`pf_r_g‘_aùiÚ_li¡
();

179 
aùiÚ
 &ğ
»f
.
	`Œigg”_aùiÚ
(
pkt
, 
pkt_Ën
, 
p_©Œ
, 
a_tv
);

181 if(
pä
.
	`pf_r_g‘_¡İ
()è 
Œue
;

185  
çl£
;

186 
	}
}

192 
	gpf_m©ch
::
	$pf_m_š™_åŒ
() {

193 autØ
ix
 = 0; ix < 
BASE_PACKET_PACKET_MATCH_TYPE_MAX
; ++ix) {

194 
åŒ
[
ix
] = &
pf_m©ch
::
pf_m_p£udo_â
;

197 
åŒ
[
BASE_PACKET_PACKET_MATCH_TYPE_HOSTIF_USER_TRAP_ID
] = &
pf_m©ch
::
pf_m_u¤_Œ­_id
;

198 
åŒ
[
BASE_PACKET_PACKET_MATCH_TYPE_DST_MAC
] = &
pf_m©ch
::
pf_m_de¡_mac
;

199 
	}
}

201 
boŞ
 
	gpf_m©ch
::
	$pf_m_u¤_Œ­_id
(
ušt8_t
 *
pkt
, 
ušt32_t
 
Ën
, 
pf_pkt_©Œ
 *
p_©Œ
,

202 
pf_m©ch_t
& 
m_tv
) const {

203 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","PKT T¿pID: %d, FILTER TRAPID: %lu", 
p_©Œ
->
Œ­_id
, 
m_tv
.
m_v®
.
u64
);

204 if(
m_tv
.
m_v®
.
u64
 =ğ
p_©Œ
->
Œ­_id
è 
Œue
;

205  
çl£
;

206 
	}
}

208 
boŞ
 
	gpf_m©ch
::
	$pf_m_de¡_mac
(
ušt8_t
 *
pkt
, 
ušt32_t
 
Ën
, 
pf_pkt_©Œ
 *
p_©Œ
,

209 
pf_m©ch_t
& 
m_tv
) const {

210 if(!
	`memcmp
(
pkt
, &
m_tv
.
m_v®
.
mac
, 
HAL_MAC_ADDR_LEN
)è 
Œue
;

211  
çl£
;

212 
	}
}

214 
boŞ
 
	gpf_m©ch
::
	$pf_m_p£udo_â
(
ušt8_t
 *
pkt
, 
ušt32_t
 
Ën
, 
pf_pkt_©Œ
 *
p_©Œ
,

215 
pf_m©ch_t
& 
m_tv
) const {

216 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Executšg…£udo-m©ch fÜy³ %d", 
m_tv
.
m_ty³
);

217  
çl£
;

218 
	}
}

220 
boŞ
 
	gpf_m©ch
::
	$add_’Œy
(
BASE_PACKET_PACKET_MATCH_TYPE_t
& 
t
, 
pf_m©ch_t
& 
e
) {

221 if(
t
 > 
BASE_PACKET_PACKET_MATCH_TYPE_MAX
 )

222 
throw
 
¡d
::
	`šv®id_¬gum’t
("Inv®id v®ufÜy³ " + 
t
);

223 if(!
pf_m©ch_‹m¶©e
::
	`add_’Œy
(
t
, 
e
))

224 
throw
 
¡d
::
	`ruÁime_”rÜ
("Entry‡lreadyƒxists");

226 ++
m_couÁ
;

227  
Œue
;

228 
	}
}

230 
	gpf_aùiÚ
::
	$pf_a_š™_åŒ
() {

231 autØ
ix
 = 0; ix < 
BASE_PACKET_PACKET_ACTION_TYPE_MAX
; ++ix) {

232 
åŒ
[
ix
] = &
pf_aùiÚ
::
pf_a_p£udo_â
;

235 
åŒ
[
BASE_PACKET_PACKET_ACTION_TYPE_REDIRECT_SOCK
] = &
pf_aùiÚ
::
pf_a_»dœeù_sock
;

236 
åŒ
[
BASE_PACKET_PACKET_ACTION_TYPE_COPY_TO_SOCK
] = &
pf_aùiÚ
::
pf_a_»dœeù_sock
;

237 
åŒ
[
BASE_PACKET_PACKET_ACTION_TYPE_REDIRECT_IF
] = &
pf_aùiÚ
::
pf_a_»dœeù_if
;

238 
	}
}

240 
boŞ
 
	gpf_aùiÚ
::
	$add_’Œy
(
BASE_PACKET_PACKET_ACTION_TYPE_t
& 
t
, 
pf_aùiÚ_t
& 
e
) {

241 if(
t
 > 
BASE_PACKET_PACKET_ACTION_TYPE_MAX
 )

242 
throw
 
¡d
::
	`šv®id_¬gum’t
("Inv®id v®ufÜy³ " + 
t
);

243 if(!
pf_aùiÚ_‹m¶©e
::
	`add_’Œy
(
t
, 
e
))

244 
throw
 
¡d
::
	`ruÁime_”rÜ
("Entry‡lreadyƒxists");

246 ++
m_couÁ
;

247  
Œue
;

248 
	}
}

250 
boŞ
 
	gpf_aùiÚ
::
	$pf_a_»dœeù_sock
(
ušt8_t
 *
pkt
, 
ušt32_t
 
pkt_Ën
, 
pf_pkt_©Œ
 *
p_©Œ
,

251 
pf_aùiÚ_t
& 
a_tv
) const {

253 
h®_ifšdex_t
 
rx_ifšdex
=0;

255 ià(!
	`Çs_št_pÜt_ifšdex
 (
p_©Œ
->
Åu_id
,…_©Œ->
rx_pÜt
, &
rx_ifšdex
)) {

256 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Matching index‚ot found for %d:%d",

257 
p_©Œ
->
Åu_id
,…_©Œ->
rx_pÜt
);

260 
dn_v4_addr_t
 

;

261 

.
s_addr
 = 
	`htÚl
(
a_tv
.
m_v®
.
sock_addr
.
add»ss
.
š‘4addr
.
sš_addr
.s_addr);

262 
pÜt
 = 
	`htÚs
(
a_tv
.
m_v®
.
sock_addr
.
add»ss
.
š‘4addr
.
sš_pÜt
);

264 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Pkt†en %d,„x_port %d, if_index %d, "

265 "sockadd¸0x%x, udp-pÜˆ%d", 
pkt_Ën
, 
p_©Œ
->
rx_pÜt
, 
rx_ifšdex
, 

.
s_addr
, 
pÜt
);

267 cÚ¡ 
ušt32_t
 
META_BUF_SIZE
=1024;

268 
ušt8_t
 
m‘a_buf
 [
META_BUF_SIZE
];

270 
Çs_pkt_m‘a_©Œ_™_t
 
™
;

271 
	`Çs_pkt_m‘a_buf_š™
 (
m‘a_buf
, (m‘a_buf), &
™
);

272 
	`Çs_pkt_m‘a_add_u32
 (&
™
, 
NAS_PKT_META_RX_PORT
, 
rx_ifšdex
);

273 
	`Çs_pkt_m‘a_add_u32
 (&
™
, 
NAS_PKT_META_PKT_LEN
, 
pkt_Ën
);

274 
	`Çs_pkt_m‘a_add_u64
 (&
™
, 
NAS_PKT_META_TRAP_ID
, 
p_©Œ
->
Œ­_id
);

276 
size_t
 
m‘a_Ën
 = (
m‘a_buf
è- 
™
.
Ën
;

277 
iovec
 
sock_d©a
[] = {{(*)
m‘a_buf
, 
m‘a_Ën
}, {
pkt
, 
pkt_Ën
} };

279 
¡d_sock‘_msg_t
 
sock_msg
 = { &
a_tv
.
m_v®
.
sock_addr
.
add»ss
.
š‘4addr
,

280  (
a_tv
.
m_v®
.
sock_addr
.
add»ss
.
š‘4addr
),

281 
sock_d©a
,  (sock_d©a)/ (sock_d©a[0]), 
NULL
, 0, 0};

283 
t_¡d_”rÜ
 
rc
;

284 
n
 = 
	`¡d_sock‘_İ
 (
¡d_sock‘_Œªs™_o_WRITE
, 
pf_sock_fd
, &
sock_msg
,

285 
¡d_sock‘_Œªs™_f_NONE
, 0, &
rc
);

286 ià(
n
 < 0) {

287 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"PKT-FIL","Failedo fwdo UDP socket %d - Error code (%d)\r\n",

288 
pf_sock_fd
, 
	`STD_ERR_EXT_PRIV
(
rc
));

289  
çl£
;

292  
Œue
;

293 
	}
}

295 
boŞ
 
	gpf_aùiÚ
::
	$pf_a_»dœeù_if
(
ušt8_t
 *
pkt
, 
ušt32_t
 
pkt_Ën
, 
pf_pkt_©Œ
 *
p_©Œ
,

296 
pf_aùiÚ_t
& 
a_tv
) const {

297 
ndi_pÜt_t
 
ndi_pÜt
;

299 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Pkt†en %d,„x_port %d, if_index %d",

300 
pkt_Ën
, 
p_©Œ
->
rx_pÜt
, 
a_tv
.
m_v®
.
u32
);

302 if(
	`Çs_št_g‘_Åu_pÜt
(
a_tv
.
m_v®
.
u32
, &
ndi_pÜt
è!ğ
STD_ERR_OK
) {

303 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"PKT-FIL","CªnÙ fšd‚pu/pÜˆfÜ ifšdx %d", 
a_tv
.
m_v®
.
u32
);

304  
çl£
;

307 
p_©Œ
->
Åu_id
 = 
ndi_pÜt
.npu_id;

308 
p_©Œ
->
rx_pÜt
 = 
ndi_pÜt
.
Åu_pÜt
;

309 
p_©Œ
->
tx_pÜt
 = 
ndi_pÜt
.
Åu_pÜt
;

311  
Œue
;

312 
	}
}

314 
boŞ
 
	gpf_aùiÚ
::
	$pf_a_p£udo_â
(
ušt8_t
 *
pkt
, 
ušt32_t
 
pkt_Ën
, 
pf_pkt_©Œ
 *
p_©Œ
,

315 
pf_aùiÚ_t
& 
a_tv
) const {

316 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Executšg…£udo-aùiÚ fÜy³ %d", 
a_tv
.
m_ty³
);

317  
çl£
;

318 
	}
}

320 
boŞ
 
	gpf_ruË
::
	$pf_r_add_m©ch_·¿m
(
pf_m©ch_t
& 
æt
) {

321 
Œy
 {

322 
m©ch_l¡_
.
	`add_’Œy
(
æt
.
m_ty³
, flt);

323 } 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

324 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"PKT-FIL","Addšg m©chƒÁry faed %s", 
e
.
	`wh©
());

325  
çl£
;

327  
Œue
;

328 
	}
}

330 
boŞ
 
	gpf_ruË
::
	$pf_r_add_aùiÚ_·¿m
(
pf_aùiÚ_t
& 
æt
) {

331 
Œy
 {

332 
aùiÚ_l¡_
.
	`add_’Œy
(
æt
.
m_ty³
, flt);

333 } 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

334 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"PKT-FIL","Addšg‡ùiÚƒÁry faed %s", 
e
.
	`wh©
());

335  
çl£
;

337  
Œue
;

338 
	}
}

344 
	$Çs_pf_š™Ÿlize
 ()

346 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-FIL","Initializing Packet Filtering!");

347 
Œy
 {

348 
pf_bË_š¡
.
	`»£t
(
	`Ãw
 (
pf_bË
));

349 
t_¡d_”rÜ
 
rc
 = 
	`¡d_sock‘_ü—‹
 (
e_¡d_sock_INET4
, 
e_¡d_sock_ty³_DGRAM
,

350 0, 
NULL
, &
pf_sock_fd
);

351 ià(
rc
 !ğ
STD_ERR_OK
) {

352 
throw
 
¡d
::
	`ruÁime_”rÜ
("Socket create failed");

354 } 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

355 
pf_bË_š¡
.
	`»£t
();

356 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"PKT-FIL","In™Ÿliz©iÚ faed %s", 
e
.
	`wh©
());

358 
	}
}

360 
boŞ
 
	$Çs_pf_šgr_’abËd
 () {

361  (
pf_bË_š¡
 && (pf_bË_š¡->
	`pf_t_g‘_šgr_couÁ
() > 0));

362 
	}
}

364 
boŞ
 
	$Çs_pf_egr_’abËd
 () {

365  (
pf_bË_š¡
 && (pf_bË_š¡->
	`pf_t_g‘_egr_couÁ
() > 0));

366 
	}
}

368 
boŞ
 
	$Çs_pf_š_pkt_hndÌ
(
ušt8_t
 *
pkt
, 
ušt32_t
 
pkt_Ën
, 
ndi_·ck‘_©Œ_t
 *
p_©Œ
) {

369  
pf_bË_š¡
->
	`pf_t_š_pkt_hndÌ
(
pkt
, 
pkt_Ën
, 
p_©Œ
);

370 
	}
}

372 
boŞ
 
	$Çs_pf_out_pkt_hndÌ
(
ušt8_t
 *
pkt
, 
ušt32_t
 
pkt_Ën
, 
ndi_·ck‘_©Œ_t
 *
p_©Œ
) {

373  
pf_bË_š¡
->
	`pf_t_out_pkt_hndÌ
(
pkt
, 
pkt_Ën
, 
p_©Œ
);

374 
	}
}

380 
Çs_pf_m©ch_li¡
 (cÚ¡ 
ıs_­i_objeù_t
 
obj
, cÚ¡ 
ıs_­i_objeù_™_t
& 
™
,

381 
¡d
::
funùiÚ
<(
pf_m©ch_t
&)> 
â
)

383 
BASE_PACKET_PACKET_MATCH_TYPE_t
 
_ty³
;

384 
ušt64_t
 
	g_v®ue
;

385 
ıs_­i_objeù_™_t
 
	g_li¡
 = 
™
;

386 
t_¡d_”rÜ
 
	g¡d_”r
 = 
STD_ERR
 (
INTERFACE
, 
FAIL
, 0);

387 
size_t
 
	g©Œ_Ën
;

389 
ıs_­i_objeù_™_šside
 (&
_li¡
); 
ıs_­i_objeù_™_v®id
 (&_list);

390 
ıs_­i_objeù_™_Ãxt
 (&
_li¡
)) {

392 
ıs_­i_©Œ_id_t
 
	gl_idx
 = 
ıs_­i_objeù_©Œ_id
 (
_li¡
.
©Œ
);

394 
ıs_­i_objeù_™_t
 
	g_©Œ
 = 
_li¡
;

395 
ıs_­i_objeù_™_šside
 (&
_©Œ
);

396 ià(!
ıs_­i_objeù_™_v®id
 (&
_©Œ
)) {

397 
throw
 
	gÇs
::
ba£_exû±iÚ
 {
¡d_”r
, 
	g__FUNCTION__
, "Missing…aram for match in obj"};

400 autØ
	g©Œ_m_ty³
 = 
ıs_­i_objeù_™_fšd
 (&
_©Œ
, 
BASE_PACKET_RULE_MATCH_TYPE
);

401 ià(
	g©Œ_m_ty³
 =ğ
NULL
) {

402 
throw
 
Çs
::
ba£_exû±iÚ
 {
¡d_”r
, 
__FUNCTION__
, "Missing MATCH_TYPE‡ttribute"};

405 
	g_ty³
 = (
BASE_PACKET_PACKET_MATCH_TYPE_t
è
ıs_­i_objeù_©Œ_d©a_u32
 (
©Œ_m_ty³
);

406 
pf_m©ch_t
 
	gm_tv
;

407 
	gm_tv
.
	gm_ty³
 = 
_ty³
;

408 
ıs_­i_objeù_©Œ_t
 
	g©Œ_m©ch_v®
;

413 
EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "li¡ indx %luy³ %d", 
l_idx
, 
_ty³
);

415 
	g_ty³
) {

416 
	gBASE_PACKET_PACKET_MATCH_TYPE_DST_MAC
:

417 
©Œ_m©ch_v®
 = 
ıs_­i_objeù_™_fšd
 (&
_©Œ
, 
BASE_PACKET_RULE_MATCH_MAC_ADDR
);

418 ià(
	g©Œ_m©ch_v®
 =ğ
NULL
) {

419 
throw
 
Çs
::
ba£_exû±iÚ
 {
¡d_”r
, 
__FUNCTION__
, "Missing MATCH_VALUE‡ttribute"};

421 
	g©Œ_Ën
 = 
ıs_­i_objeù_©Œ_Ën
(
©Œ_m©ch_v®
);

422 ià(
	g©Œ_Ën
 < (
	gh®_mac_addr_t
)) {

423 
throw
 
	gÇs
::
ba£_exû±iÚ
 {
¡d_”r
, 
	g__FUNCTION__
, "Invalid‡ttribute†en"};

425 
memıy
(
m_tv
.
m_v®
.
mac
, 
ıs_­i_objeù_©Œ_d©a_bš
(
©Œ_m©ch_v®
),

426 (
h®_mac_addr_t
));

428 
EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "M©ch_ty³ %d", 
_ty³
);

431 
	gBASE_PACKET_PACKET_MATCH_TYPE_ETHER_TYPE
:

432 
BASE_PACKET_PACKET_MATCH_TYPE_HOSTIF_TRAP_ID
:

433 
BASE_PACKET_PACKET_MATCH_TYPE_HOSTIF_USER_TRAP_ID
:

434 
©Œ_m©ch_v®
 = 
ıs_­i_objeù_™_fšd
 (&
_©Œ
, 
BASE_PACKET_RULE_MATCH_DATA
);

435 ià(
	g©Œ_m©ch_v®
 =ğ
NULL
) {

436 
throw
 
Çs
::
ba£_exû±iÚ
 {
¡d_”r
, 
__FUNCTION__
, "Missing MATCH_VALUE‡ttribute"};

438 
	g_v®ue
 = 
ıs_­i_objeù_©Œ_d©a_u32
 (
©Œ_m©ch_v®
);

439 
	gm_tv
.
	gm_v®
.
	gu64
 = 
_v®ue
;

440 
EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "M©ch_ty³ %d v®u%lu", 
_ty³
, 
_v®ue
);

444 
throw
 
Çs
::
ba£_exû±iÚ
 {
¡d_”r
, 
	g__FUNCTION__
, "Match‡ttribute‚ot supported"};

448 
â
(
m_tv
);

452 
šlše
 
	$Çs_pf_ut_fl_aù_v®
 (
pf_aùiÚ_t
& 
©
, 
dn_v4_addr_t
& 

, 
pÜt
)

454 
¡d_sock‘_add»ss_t
 
sock_d¡
;

455 
sock_d¡
.
add»ss
.
š‘4addr
.
sš_çmy
 = 
AF_INET
;

456 
sock_d¡
.
add»ss
.
š‘4addr
.
sš_addr
 = 

;

457 
sock_d¡
.
addr_ty³
 = 
e_¡d_sock‘_a_t_INET
;

458 
sock_d¡
.
ty³
 = 
e_¡d_sock_INET4
;

459 
sock_d¡
.
add»ss
.
š‘4addr
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

461 
©
.
m_v®
.
sock_addr
 = 
sock_d¡
;

462 
	}
}

464 
Çs_pf_aùiÚ_li¡
 (cÚ¡ 
ıs_­i_objeù_t
 
obj
, cÚ¡ 
ıs_­i_objeù_™_t
& 
™
,

465 
¡d
::
funùiÚ
<(
pf_aùiÚ_t
&)> 
â
)

467 
BASE_PACKET_PACKET_ACTION_TYPE_t
 
_ty³
;

468 
ušt64_t
 
	g_v®ue
 = 0;

469 
ıs_­i_objeù_™_t
 
	g_li¡
 = 
™
;

470 
t_¡d_”rÜ
 
	g¡d_”r
 = 
STD_ERR
 (
INTERFACE
, 
FAIL
, 0);

472 
ıs_­i_objeù_™_šside
 (&
_li¡
); 
ıs_­i_objeù_™_v®id
 (&_list);

473 
ıs_­i_objeù_™_Ãxt
 (&
_li¡
)) {

475 
ıs_­i_©Œ_id_t
 
	gl_idx
 = 
ıs_­i_objeù_©Œ_id
 (
_li¡
.
©Œ
);

477 
ıs_­i_objeù_™_t
 
	g_©Œ
 = 
_li¡
;

478 
ıs_­i_objeù_™_šside
 (&
_©Œ
);

479 ià(!
ıs_­i_objeù_™_v®id
 (&
_©Œ
)) {

480 
throw
 
	gÇs
::
ba£_exû±iÚ
 {
¡d_”r
, 
	g__FUNCTION__
, "Missing…aram for‡ctions in obj"};

483 autØ
	g©Œ_m_ty³
 = 
ıs_­i_objeù_™_fšd
 (&
_©Œ
, 
BASE_PACKET_RULE_ACTION_TYPE
);

484 ià(
	g©Œ_m_ty³
 =ğ
NULL
) {

485 
throw
 
Çs
::
ba£_exû±iÚ
 {
¡d_”r
, 
__FUNCTION__
, "Missing ACTION_TYPE‡ttribute"};

488 
	g_ty³
 = (
BASE_PACKET_PACKET_ACTION_TYPE_t
è
ıs_­i_objeù_©Œ_d©a_u32
 (
©Œ_m_ty³
);

489 
dn_v4_addr_t
 
	g
;

490 
pf_aùiÚ_t
 
	ga_tv
;

491 
	ga_tv
.
	gm_ty³
 = 
_ty³
;

492 
ıs_­i_objeù_©Œ_t
 
	g©Œ_v®
;

493 
ıs_­i_objeù_©Œ_t
 
	gsock‘_©Œ
;

494 
ıs_­i_objeù_™_t
 
	gsock‘_™”
;

499 
EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "li¡ index %lu,y³ %d", 
l_idx
, 
_ty³
);

501 
	g_ty³
) {

502 
	gBASE_PACKET_PACKET_ACTION_TYPE_REDIRECT_SOCK
:

503 
BASE_PACKET_PACKET_ACTION_TYPE_COPY_TO_SOCK
:

505 
sock‘_©Œ
 = 
ıs_­i_objeù_™_fšd
 (&
_©Œ
, 
BASE_PACKET_RULE_ACTION_SOCKET_ADDRESS
);

507 ià(
	gsock‘_©Œ
 =ğ
NULL
)

508 
throw
 
Çs
::
ba£_exû±iÚ
 {
¡d_”r
, 
__FUNCTION__
, "Missing (socket)‡ttribute"};

510 
ıs_­i_objeù_™_äom_©Œ
(
sock‘_©Œ
, &
sock‘_™”
);

511 
ıs_­i_objeù_™_šside
 (&
sock‘_™”
);

512 
	g©Œ_v®
 = 
ıs_­i_objeù_™_fšd
 (&
sock‘_™”
, 
BASE_PACKET_RULE_ACTION_SOCKET_ADDRESS_IP
);

514 ià(
	g©Œ_v®
 =ğ
NULL
)

515 
throw
 
Çs
::
ba£_exû±iÚ
 {
¡d_”r
, 
__FUNCTION__
, "Missing (IP)‡ttribute"};

517 ià(
ıs_­i_objeù_©Œ_Ën
 (
©Œ_v®
è<  (
	g
))

518 
throw
 
	gÇs
::
ba£_exû±iÚ
 {
¡d_”r
, 
	g__FUNCTION__
, "Invalid IP‡ddress†en"};

520 
	g
 = *(
dn_v4_addr_t
*)
ıs_­i_objeù_©Œ_d©a_bš
(
©Œ_v®
);

522 
	g©Œ_v®
 = 
ıs_­i_objeù_™_fšd
 (&
sock‘_™”
, 
BASE_PACKET_RULE_ACTION_SOCKET_ADDRESS_UDP_PORT
);

523 ià(
	g©Œ_v®
 =ğ
NULL
)

524 
throw
 
Çs
::
ba£_exû±iÚ
 {
¡d_”r
, 
__FUNCTION__
, "Missing (Port)‡ttribute"};

526 
	g_v®ue
 = 
ıs_­i_objeù_©Œ_d©a_u16
 (
©Œ_v®
);

528 
Çs_pf_ut_fl_aù_v®
(
a_tv
, 

, ()
_v®ue
);

530 
EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "PÜˆ%lu, i°0x%x", 
_v®ue
, 
htÚl
(

.
s_addr
));

533 
	gBASE_PACKET_PACKET_ACTION_TYPE_REDIRECT_IF
:

534 
©Œ_v®
 = 
ıs_­i_objeù_™_fšd
 (&
_©Œ
, 
BASE_PACKET_RULE_ACTION_REDIRECT_IF
);

535 ià(
	g©Œ_v®
 =ğ
NULL
)

536 
throw
 
Çs
::
ba£_exû±iÚ
 {
¡d_”r
, 
__FUNCTION__
, "Missing ACTION_VALUE(IF)‡ttribute"};

538 
	g_v®ue
 = 
ıs_­i_objeù_©Œ_d©a_u32
 (
©Œ_v®
);

539 
	ga_tv
.
	gm_v®
.
	gu32
 = 
_v®ue
;

541 
EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "AùiÚ IF - ifidx %lu", 
_v®ue
);

545 
throw
 
Çs
::
ba£_exû±iÚ
 {
¡d_”r
, 
	g__FUNCTION__
, "Action‡ttribute‚ot supported"};

549 
â
(
a_tv
);

553 
t_¡d_”rÜ
 
	$Çs_pf_ıs_ü—‹
(
ıs_­i_objeù_t
 
obj
)

555 
ıs_­i_objeù_™_t
 
™
;

556 
pf_dœeùiÚ
 
dœ
 = 
BASE_PACKET_PACKET_DIRECTION_TYPE_DIR_IN
;

557 
pf_ruË
 
pä
;

558 
boŞ
 
¡İ
 = 
çl£
;

559 
boŞ
 
šv®id
 = 
çl£
;

560 
ušt32_t
 
id
 = 0;

562 
	`ıs_­i_objeù_™_begš
 (
obj
, &
™
);

563 
	`ıs_­i_objeù_™_v®id
 (&
™
); 
	`ıs_­i_objeù_™_Ãxt
 (&it)) {

565 
ıs_­i_©Œ_id_t
 
©Œ_id
 = 
	`ıs_­i_objeù_©Œ_id
 (
™
.
©Œ
);

567 
©Œ_id
) {

568 
BASE_PACKET_RULE_ID
:

569 
id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

570 
	`EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL",

571 "IgnÜšg %d duršg c»©e. New id wÈbg’”©ed", 
id
);

574 
BASE_PACKET_RULE_DIRECTION
:

575 
dœ
 = (
pf_dœeùiÚ
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

576 
	`EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "CPS Dœ %d", 
dœ
);

577 
pä
.
	`pf_r_£t_dœ
(
dœ
);

580 
BASE_PACKET_RULE_MATCH
:

581 
Œy
 {

582 
	`Çs_pf_m©ch_li¡
 (
obj
, 
™
, [&] (
pf_m©ch_t
& 
á
) {

583 
Œy
 {

584 
pä
.
	`pf_r_add_m©ch_·¿m
(
á
);

585 } 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

586 
šv®id
 = 
Œue
;

589 } 
	`ÿtch
 (
Çs
::
ba£_exû±iÚ
& 
b
) {

590 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-FIL","%s: %s",

591 
b
.
”r_â
.
	`c_¡r
(), b.
”r_msg
.c_str());

592 
šv®id
 = 
Œue
;

596 
BASE_PACKET_RULE_ACTION
:

597 
Œy
 {

598 
	`Çs_pf_aùiÚ_li¡
 (
obj
, 
™
, [&] (
pf_aùiÚ_t
& 
á
) {

599 
Œy
 {

600 
pä
.
	`pf_r_add_aùiÚ_·¿m
(
á
);

601 } 
	`ÿtch
 (
¡d
::
exû±iÚ
& 
e
) {

602 
šv®id
 = 
Œue
;

605 } 
	`ÿtch
 (
Çs
::
ba£_exû±iÚ
& 
b
) {

606 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-FIL","%s: %s",

607 
b
.
”r_â
.
	`c_¡r
(), b.
”r_msg
.c_str());

608 
šv®id
 = 
Œue
;

612 
BASE_PACKET_RULE_STOP
:

613 
¡İ
 = 
	`ıs_­i_objeù_©Œ_d©a_ušt
 (
™
.
©Œ
);

614 
	`EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "CPS Stİ %d", 
¡İ
);

615 
pä
.
	`pf_r_£t_¡İ
(
¡İ
);

619 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-FIL","UnknowÀ©Œibu‹ %lu", 
©Œ_id
);

624 if(!
šv®id
) {

625 
Çs_obj_id_t
 
g_id
 = 
pf_bË_š¡
->
	`pf_t_add_ruË
(
dœ
, 
pä
);

626 
	`ıs_­i_objeù_©Œ_d–‘e
 (
obj
, 
BASE_PACKET_RULE_ID
);

627 
	`ıs_­i_objeù_©Œ_add_u32
 (
obj
, 
BASE_PACKET_RULE_ID
, 
g_id
);

628  
STD_ERR_OK
;

631  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

632 
	}
}

634 
t_¡d_”rÜ
 
	$Çs_pf_ıs_d–‘e
(
ıs_­i_objeù_t
 
obj
)

636 
ıs_­i_objeù_©Œ_t
 
id_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
BASE_PACKET_RULE_ID
);

637 if(
id_©Œ
 =ğ
CPS_API_ATTR_NULL
) {

638 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-FIL","Id missing");

639  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

642 autØ
id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
id_©Œ
);

643 if(!
pf_bË_š¡
->
	`pf_t_d–_ruË
(
id
)) {

644 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-FIL","Couldn'ˆd–‘ruË %d", 
id
);

645  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

648  
STD_ERR_OK
;

649 
	}
}

651 
t_¡d_”rÜ
 
	$Çs_pf_ıs_wr™e
(
ıs_­i_objeù_t
 
obj
)

653 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

654 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
 (
	`ıs_­i_objeù_key
 (
obj
));

656 
	`EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "CPS PF S‘! - O³¿tiÚ %d", 
İ
);

658 if(!
pf_bË_š¡
) {

659 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-FIL","Table instance‚ot created");

660  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

663 
İ
) {

664 
ıs_­i_İ”_CREATE
:

665 
rc
 = 
	`Çs_pf_ıs_ü—‹
(
obj
);

667 
ıs_­i_İ”_SET
:

669 
	`EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "Not supported!");

671 
ıs_­i_İ”_DELETE
:

672 
rc
 = 
	`Çs_pf_ıs_d–‘e
(
obj
);

675 
	`EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "Unknown operation!");

676  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

679  
rc
;

680 
	}
}

682 
boŞ
 
	$Çs_pf_emb_m©ch_·¿ms
(
ıs_­i_objeù_t
 
obj
, 
pf_m©ch_t
& 
m_tv
, 
ušt64_t
 
l_idx
) {

684 
ıs_­i_©Œ_id_t
 
ids
[3] = {
BASE_PACKET_RULE_MATCH
, 
l_idx
, 
BASE_PACKET_RULE_MATCH_TYPE
};

685 cÚ¡ 
ids_Ën
 = (
ids
)/(ids[0]);

686 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_U32
,&(
m_tv
.
m_ty³
),

687 (
m_tv
.
m_ty³
));

689 
m_tv
.
m_ty³
) {

690 
BASE_PACKET_PACKET_MATCH_TYPE_ETHER_TYPE
:

691 
BASE_PACKET_PACKET_MATCH_TYPE_HOSTIF_TRAP_ID
:

692 
BASE_PACKET_PACKET_MATCH_TYPE_HOSTIF_USER_TRAP_ID
:

694 
ids
[2]=
BASE_PACKET_RULE_MATCH_DATA
;

695 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_U64
,&(
m_tv
.
m_v®
.
u64
),

696 (
m_tv
.
m_v®
.
u64
));

700 
	`EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "Type‚ot handled for get");

701  
çl£
;

704  
Œue
;

705 
	}
}

707 
boŞ
 
	$Çs_pf_emb_aùiÚ_·¿ms
(
ıs_­i_objeù_t
 
obj
, 
pf_aùiÚ_t
& 
a_tv
, 
ušt64_t
 
l_idx
) {

709 
ıs_­i_©Œ_id_t
 
ids
[3] = {
BASE_PACKET_RULE_ACTION
, 
l_idx
, 
BASE_PACKET_RULE_ACTION_TYPE
};

710 cÚ¡ 
ids_Ën
 = (
ids
)/(ids[0]);

711 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_U32
,&(
a_tv
.
m_ty³
),

712 (
a_tv
.
m_ty³
));

714 
dn_v4_addr_t
 

;

715 
ušt16_t
 
pÜt
;

717 
a_tv
.
m_ty³
) {

718 
BASE_PACKET_PACKET_ACTION_TYPE_REDIRECT_SOCK
:

719 
BASE_PACKET_PACKET_ACTION_TYPE_COPY_TO_SOCK
:

721 
ids
[2]=
BASE_PACKET_RULE_ACTION_SOCKET_ADDRESS_IP
;

722 

 = 
a_tv
.
m_v®
.
sock_addr
.
add»ss
.
š‘4addr
.
sš_addr
;

723 
pÜt
 = 
	`Áohs
(
a_tv
.
m_v®
.
sock_addr
.
add»ss
.
š‘4addr
.
sš_pÜt
);

724 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,&(

),(ip));

726 
ids
[2]=
BASE_PACKET_RULE_ACTION_SOCKET_ADDRESS_UDP_PORT
;

727 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_U16
,&(
pÜt
),(port));

730 
BASE_PACKET_PACKET_ACTION_TYPE_REDIRECT_IF
:

731 
ids
[2]=
BASE_PACKET_RULE_ACTION_REDIRECT_IF
;

732 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_U32
,&(
a_tv
.
m_v®
.
u32
),

733 (
a_tv
.
m_v®
.
u32
));

737 
	`EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "Type‚ot handled for get");

738  
çl£
;

741  
Œue
;

742 
	}
}

744 
t_¡d_”rÜ
 
	$Çs_pf_ıs_»ad
(
ıs_­i_objeù_t
 
ft
, cps_­i_objeù_ˆ
obj
)

746 
	`EV_LOGGING
 (
INTERFACE
, 
DEBUG
, "PKT-FIL", "CPS PF Get!");

748 if(!
pf_bË_š¡
) {

749 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-FIL","Table instance‚ot created");

750  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

753 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
, 
BASE_PACKET_RULE_ID
);

754 if(
©Œ
 =ğ
CPS_API_ATTR_NULL
) {

755 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-FIL","Id missing.. Specifyhe id for get!");

756  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

759 autØ
id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

761 cÚ¡ 
pf_ruË
* 
p_pä
;

762 if((
p_pä
 = 
pf_bË_š¡
->
	`pf_t_g‘_ruË
(
id
)è=ğ
nuÎ±r
) {

763 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-FIL","RuË %d dÛ¢'ˆexi¡!", 
id
);

764  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

767 if(!
	`ıs_­i_objeù_©Œ_add_u32
 (
obj
, 
BASE_PACKET_RULE_ID
, 
id
)) {

768  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

771 if(!
	`ıs_­i_objeù_©Œ_add_u32
 (
obj
, 
BASE_PACKET_RULE_STOP
, 
p_pä
->
	`pf_r_g‘_¡İ
())) {

772  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

775 if(!
	`ıs_­i_objeù_©Œ_add_u32
 (
obj
, 
BASE_PACKET_RULE_DIRECTION
, 
p_pä
->
	`pf_r_g‘_dœ
())) {

776  (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

779 autØ
idx
 = 0;

780 
p_pä
->
	`pf_r_g‘_m©ch_·¿ms
([&
obj
, &
idx
](
pf_m©ch_t
& 
m_tv
) {

781 
	`Çs_pf_emb_m©ch_·¿ms
(
obj
, 
m_tv
, 
idx
++);

784 
idx
 = 0;

785 
p_pä
->
	`pf_r_g‘_aùiÚ_·¿ms
([&
obj
, &
idx
](
pf_aùiÚ_t
& 
a_tv
) {

786 
	`Çs_pf_emb_aùiÚ_·¿ms
(
obj
, 
a_tv
, 
idx
++);

789  
STD_ERR_OK
;

790 
	}
}

	@src/packet/nas_packet_meta.c

21 
	~"Çs_·ck‘_m‘a.h
"

23 cÚ¡ 
ušt32_t
 
	gMETA_SIGNATURE
 = 0xdeadbeef;

26 
	s_Çs_pkt_m‘a_hdr_št_s
 {

27 
ušt32_t
 
	msigÇtu»
;

28 
ušt32_t
 
	mtÙ®_Ën
;

30 
ušt8_t
 
	m©Œs
[];

31 } 
	tÇs_pkt_m‘a_hdr_št_t
;

33 
ušt_t
 
	$Çs_pkt_m‘a_©Œ_d©a_ušt
 (
Çs_pkt_m‘a_©Œ_±r_t
 
©Œ
)

35 
size_t
 
Ën
 = 
	`Çs_pkt_m‘a_©Œ_Ën
(
©Œ
);

36 
Ën
) {

37 (
ušt64_t
):  
	`¡d_v_d©a_u64
(
©Œ
);

38 (
ušt32_t
):  
	`¡d_v_d©a_u32
 (
©Œ
);

39 (
ušt16_t
):  
	`¡d_v_d©a_u16
 (
©Œ
);

40 (
ušt8_t
):  *(ušt8_t*)
	`¡d_v_d©a
 (
©Œ
);

43 
	}
}

45 
boŞ
 
	$Çs_pkt_m‘a_™_begš
 (
ušt8_t
* 
pkt
, 
Çs_pkt_m‘a_©Œ_™_t
* 
™
)

47 
Çs_pkt_m‘a_hdr_št_t
* 
m‘a
 = (Çs_pkt_m‘a_hdr_št_ˆ*è
pkt
;

48 ià(
m‘a
->
sigÇtu»
 !ğ
META_SIGNATURE
) {

49 
™
->
©Œ
 = 
NULL
; it->
Ën
 = 0;

50  
çl£
;

52 
™
->
©Œ
 = 
m‘a
->
©Œs
;

53 
™
->
¡¬t
 = 
pkt
;

54 
™
->
Ën
 = (
	`Ë32toh
 (
m‘a
->
tÙ®_Ën
)è-  (
Çs_pkt_m‘a_hdr_št_t
);

55  
Œue
;

56 
	}
}

58 
ušt8_t
* 
	$Çs_pkt_d©a_off£t
 (
ušt8_t
* 
pkt
)

60 
Çs_pkt_m‘a_hdr_št_t
* 
m‘a
 = (Çs_pkt_m‘a_hdr_št_ˆ*è
pkt
;

61 ià(
m‘a
->
sigÇtu»
 !ğ
META_SIGNATURE
è 
pkt
;

62  (
pkt
 + 
	`Ë32toh
 (
m‘a
->
tÙ®_Ën
));

63 
	}
}

65 
boŞ
 
	$Çs_pkt_m‘a_buf_š™
 (
ušt8_t
* 
buf
, 
size_t
 
buf_Ën
, 
Çs_pkt_m‘a_©Œ_™_t
* 
™
)

67 ià(
buf_Ën
 <  (
Çs_pkt_m‘a_hdr_št_t
)) {

68 
™
->
©Œ
 = 
NULL
; it->
Ën
 = 0;

69  
çl£
;

71 
Çs_pkt_m‘a_hdr_št_t
* 
m‘a
 = (Çs_pkt_m‘a_hdr_št_t*è
buf
;

72 
m‘a
->
tÙ®_Ën
 = (
Çs_pkt_m‘a_hdr_št_t
);

73 
m‘a
->
sigÇtu»
 = 
META_SIGNATURE
;

75 
™
->
¡¬t
 = 
buf
;

76 
™
->
Ën
 = 
buf_Ën
 - (
Çs_pkt_m‘a_hdr_št_t
);

77 
™
->
©Œ
 = 
m‘a
->
©Œs
;

78  
Œue
;

79 
	}
}

81 
boŞ
 
	$Çs_pkt_m‘a_add_u32
 (
Çs_pkt_m‘a_©Œ_™_t
 *
™
, 
Çs_pkt_m‘a_©Œ_ty³_t
 
ty³
, 
ušt32_t
 
v®
)

83 
size_t
 
´ev_Ën
 = 
™
->
Ën
;

84 
™
->
©Œ
 = 
	`¡d_v_add_u32
(™->©Œ, &™->
Ën
, 
ty³
, 
v®
);

85 ià(
™
->
©Œ
 !ğ
NULL
) {

86 
Çs_pkt_m‘a_hdr_št_t
* 
m‘a
 = (Çs_pkt_m‘a_hdr_št_t*è
™
->
¡¬t
;

87 
m‘a
->
tÙ®_Ën
 +ğ(
´ev_Ën
 - 
™
->
Ën
);

88  
Œue
;

90  
çl£
;

91 
	}
}

93 
boŞ
 
	$Çs_pkt_m‘a_add_u64
 (
Çs_pkt_m‘a_©Œ_™_t
 *
™
, 
Çs_pkt_m‘a_©Œ_ty³_t
 
ty³
, 
ušt64_t
 
v®
)

95 
size_t
 
´ev_Ën
 = 
™
->
Ën
;

96 
™
->
©Œ
 = 
	`¡d_v_add_u64
(™->©Œ, &™->
Ën
, 
ty³
, 
v®
);

97 ià(
™
->
©Œ
 !ğ
NULL
) {

98 
Çs_pkt_m‘a_hdr_št_t
* 
m‘a
 = (Çs_pkt_m‘a_hdr_št_t*è
™
->
¡¬t
;

99 
m‘a
->
tÙ®_Ën
 +ğ(
´ev_Ën
 - 
™
->
Ën
);

100  
Œue
;

102  
çl£
;

103 
	}
}

	@src/packet/packet_io.c

23 
	#_GNU_SOURCE


	)

25 
	~"ev’t_log.h
"

26 
	~"ev’t_log_ty³s.h
"

27 
	~"¡d_”rÜ_codes.h
"

29 
	~"Çs_ndi_pÜt.h
"

30 
	~"h®_sh–l.h
"

31 
	~"h®_š‹rçû_commÚ.h
"

32 
	~"h®_š‹rçû.h
"

33 
	~"Çs_št_pÜt.h
"

34 
	~"Çs_·ck‘_m‘a.h
"

35 
	~"¡d_sock‘_toŞs.h
"

37 
	~"ıs_şass_m­.h
"

38 
	~"ıs_­i_İ”©iÚ.h
"

39 
	~"ıs_­i_objeù_ÿ‹gÜy.h
"

40 
	~"d–l-ba£-sæow.h
"

41 
	~"d–l-ba£-·ck‘.h
"

42 
	~"Çs_·ck‘_f‹r.h
"

44 
	~<sys/sock‘.h
>

45 
	~<lšux/if.h
>

46 
	~<lšux/if_tun.h
>

47 
	~<¡ršg.h
>

48 
	~<fú.h
>

49 
	~<sys/ioùl.h
>

50 
	~<uni¡d.h
>

51 
	~<¡dio.h
>

52 
	~<¡dlib.h
>

53 
	~<”ºo.h
>

54 
	~<±h»ad.h
>

56 
	#MAX_PKT_LEN
 12000

	)

57 
	#PKT_DBG_ERR
 (1)

	)

58 
	#PKT_DBG_DIR_IN
 (1 << 1)

	)

59 
	#PKT_DBG_DIR_OUT
 (1 << 2)

	)

60 
	#PKT_DBG_DIR_BOTH
 (
PKT_DBG_DIR_IN
 | 
PKT_DBG_DIR_OUT
)

	)

61 
	#PKT_DBG_DUMP
(
x
è((x & 
PKT_DBG_DIR_IN
è|| (x & 
PKT_DBG_DIR_OUT
))

	)

63 
	#PKT_DEBUG
(
¬g
...)\

65 ià(!
pkt_debug
) ;\

66 
	`´štf
("[PKT_IO]: %s:%d: ",
__FUNCTION__
, 
__LINE__
);\

67 
	`´štf
(
¬g
);\

68 
	`´štf
("\r\n");\

69 } 0)

	)

74 
	gpkt_debug
 = 0;

75 
ušt64_t
 
	g§m¶e_couÁ
=0;

77 
ušt64_t
 
	g·ck‘s_txed
;

78 
ušt64_t
 
	g·ck‘s_txed_to_p–še_by·ss
;

79 
ušt64_t
 
	g·ck‘s_txed_to_p–še_lookup
;

80 
ušt64_t
 
	g·ck‘s_rxed
;

81 
ušt8_t
 
	gpkt_buf
[
MAX_PKT_LEN
];

83 
	$pkt_debug_couÁ”s
(
¡d_·r£d_¡ršg_t
 
hªdË
) {

84 
	`´štf
("RX : %Îu\n", ()
·ck‘s_rxed
);

85 
	`´štf
("TX (tÙ®è : %Îu\n", ()
·ck‘s_txed
);

86 
	`´štf
("TX (p–šby·ssè : %Îu\n", ()
·ck‘s_txed_to_p–še_by·ss
);

87 
	`´štf
("TX (p–šlookupè : %Îu\n", ()
·ck‘s_txed_to_p–še_lookup
);

88 
	}
}

92 
±h»ad_t
 
	g·ck‘_io_thr
;

94 
	$h®_·ck‘_io_dump
(
ušt8_t
 *
buf
, 
Ën
, 
pkt_dœ
)

96 
v¬_j
, 
v¬_n
;

98 ià(
pkt_dœ
 & 
pkt_debug
) {

99 
v¬_n
 = 0;

100 ià(
buf
 !ğ
NULL
) {

101 
	`´štf
("[PKT_IO][DIR-%s]: %s: Dumping Raw Pkt\r\n",

102 ((
pkt_dœ
 =ğ
PKT_DBG_DIR_IN
)? "IN":"OUT"), 
__FUNCTION__
);

103 
v¬_j
 = 0; v¬_j < 
Ën
; var_j++) {

104 
	`´štf
("0x%02x ", 
buf
[
v¬_j
]);

105 ià((
v¬_n
 != 0) && ((var_n + 1) % 16 == 0))

106 
	`´štf
("\r\n");

107 
v¬_n
++;

110 
	`´štf
("\r\n");

112 
	}
}

114 
	gsæow_sock_fd
 = -1;

115 
¡d_sock‘_add»ss_t
 
	gsæow_sock_de¡
;

117 
	$_sæow_sock_š™
 ()

119 
t_¡d_”rÜ
 
rc
 = 
	`¡d_sock‘_ü—‹
 (
e_¡d_sock_INET4
, 
e_¡d_sock_ty³_DGRAM
,

120 0, 
NULL
, &
sæow_sock_fd
);

121 ià(
rc
 !ğ
STD_ERR_OK
) {

122 
	`EV_LOG_ERR
(
ev_log_t_INTERFACE
, 
ev_log_s_CRITICAL
, "PKT-IO", "SFlow sock‘ E¼Ü %d", 
rc
);

125 
	#SFLOW_PKT_DEF_IP
 "127.0.0.1"

	)

126 
	#SFLOW_PKT_DEF_PORT
 20001

	)

127 
rc
 = 
	`¡d_sock_addr_äom__¡r
 (
e_¡d_sock_INET4
, 
SFLOW_PKT_DEF_IP
,

128 
SFLOW_PKT_DEF_PORT
, &
sæow_sock_de¡
);

129 ià(
rc
 !ğ
STD_ERR_OK
) {

130 
	`EV_LOG_ERR
(
ev_log_t_INTERFACE
, 
ev_log_s_CRITICAL
, "PKT-IO", "SFlow sock‘‡dd»s ü—tiÚƒ¼Ü %d", 
rc
);

132 
	}
}

134 
t_¡d_”rÜ
 
	$_sæow_pkt_hdl
 (
ušt8_t
 *
pkt
, 
ušt32_t
 
pkt_Ën
,

135 cÚ¡ 
ndi_·ck‘_©Œ_t
 *
p_©Œ
)

137 
h®_ifšdex_t
 
rx_ifšdex
,
tx_ifšdex
 = 0;

139 ià(!
	`Çs_št_pÜt_ifšdex
 (
p_©Œ
->
Åu_id
,…_©Œ->
rx_pÜt
, &
rx_ifšdex
)) {

140 
	`EV_LOGGING
 (
INTERFACE
,
DEBUG
, "PKT-IO",

142 
p_©Œ
->
Åu_id
,…_©Œ->
rx_pÜt
);

143  
	`STD_ERR
 (
INTERFACE
, 
PARAM
, 0);

146 ià(!
	`Çs_št_pÜt_ifšdex
 (
p_©Œ
->
Åu_id
,…_©Œ->
tx_pÜt
, &
tx_ifšdex
)) {

147 
	`EV_LOGGING
 (
INTERFACE
,
DEBUG
, "PKT-IO",

149 
p_©Œ
->
Åu_id
,…_©Œ->
tx_pÜt
);

152 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"PKT-IO","[RX] SFLOW Pkt„eceived -†ength %d‚pu %d„x_ifindex %d"

154 
pkt_Ën
, 
p_©Œ
->
Åu_id
, 
rx_ifšdex
,
tx_ifšdex
,
§m¶e_couÁ
);

156 
	#META_BUF_SIZE
 1024

	)

157 
ušt8_t
 
m‘a_buf
 [
META_BUF_SIZE
];

159 
Çs_pkt_m‘a_©Œ_™_t
 
™
;

160 
	`Çs_pkt_m‘a_buf_š™
 (
m‘a_buf
, (m‘a_buf), &
™
);

161 
	`Çs_pkt_m‘a_add_u32
 (&
™
, 
NAS_PKT_META_RX_PORT
, 
rx_ifšdex
);

162 
	`Çs_pkt_m‘a_add_u32
 (&
™
, 
NAS_PKT_META_TX_PORT
, 
tx_ifšdex
);

167 
	`Çs_pkt_m‘a_add_u64
 (&
™
, 
NAS_PKT_META_SAMPLE_COUNT
, 
§m¶e_couÁ
++);

168 
	`Çs_pkt_m‘a_add_u32
 (&
™
, 
NAS_PKT_META_PKT_LEN
, 
pkt_Ën
);

172 
size_t
 
m‘a_Ën
 = (
m‘a_buf
è- 
™
.
Ën
;

173 
iovec
 
sock_d©a
[] = { {(*)
m‘a_buf
, 
m‘a_Ën
},

174 {
pkt
, 
pkt_Ën
} };

179 
¡d_sock‘_msg_t
 
sock_msg
 = { &
sæow_sock_de¡
.
add»ss
.
š‘4addr
,

180  (
sæow_sock_de¡
.
add»ss
.
š‘4addr
),

181 
sock_d©a
,  (sock_data)/ (sock_data[0]),

182 
NULL
, 0, 0};

184 
t_¡d_”rÜ
 
rc
;

185 
n
 = 
	`¡d_sock‘_İ
 (
¡d_sock‘_Œªs™_o_WRITE
, 
sæow_sock_fd
, &
sock_msg
,

186 
¡d_sock‘_Œªs™_f_NONE
, 0, &
rc
);

187 ià(
n
 < 0) {

188 
	`PKT_DEBUG
("[RX] ForwardMsgo UDP socket %d FAILED - Error %d code (%d)\r\n",

189 
sæow_sock_fd
, 
rc
, 
	`STD_ERR_EXT_PRIV
(rc));

192  
rc
;

193 
	}
}

195 
boŞ
 
	$_exŒaù_¡d_v4_sock_addr
 (cÚ¡ 
¡d_sock‘_add»ss_t
* 
š_§ddr
,

196 
dn_v4_addr_t
* 
out_
, *
out_pÜt
)

198 ià(
š_§ddr
->
ty³
 !ğ
e_¡d_sock_INET4
è 
çl£
;

199 *
out_
 = 
š_§ddr
->
add»ss
.
š‘4addr
.
sš_addr
;

200 *
out_pÜt
 = 
	`Áohs
 (
š_§ddr
->
add»ss
.
š‘4addr
.
sš_pÜt
);

201  
Œue
;

202 
	}
}

204 
	$_mk_¡d_v4_sock_addr
 (
dn_v4_addr_t
* 

, 
pÜt
,

205 
¡d_sock‘_add»ss_t
* 
out_§ddr
)

207 
out_§ddr
->
add»ss
.
š‘4addr
.
sš_çmy
 = 
AF_INET
;

208 
out_§ddr
->
add»ss
.
š‘4addr
.
sš_addr
 = *

;

209 
out_§ddr
->
addr_ty³
 = 
e_¡d_sock‘_a_t_INET
;

210 
out_§ddr
->
ty³
 = 
e_¡d_sock_INET4
;

211 
out_§ddr
->
add»ss
.
š‘4addr
.
sš_pÜt
 = 
	`htÚs
 (
pÜt
);

212 
	}
}

214 
ıs_­i_»tuº_code_t
 
	$_ıs_­i_»ad
 (*
cÚ‹xt
,

215 
ıs_­i_g‘_·¿ms_t
 *
·¿m
,

216 
size_t
 
šdex
)

218 
ıs_­i_objeù_t
 
f‹r_obj
 = 
	`ıs_­i_objeù_li¡_g‘
 (
·¿m
->
f‹rs
, 
šdex
);

220 ià(
	`ıs_­i_key_g‘_ÿt
 (
	`ıs_­i_objeù_key
 (
f‹r_obj
)è!ğ
ıs_­i_obj_CAT_BASE_SFLOW
) {

221 
	`EV_LOG
 (
ERR
, 
INTERFACE
, 
ev_log_s_MAJOR
, "PKT-IO", "Invalid Category");

222  
ıs_­i_»t_code_ERR
;

225 ià(
	`ıs_­i_key_g‘_subÿt
 (
	`ıs_­i_objeù_key
 (
f‹r_obj
)è!ğ
BASE_SFLOW_SOCKET_ADDRESS_OBJ
) {

226 
	`EV_LOG
 (
ERR
, 
INTERFACE
, 
ev_log_s_MAJOR
, "PKT-IO", "Invalid Sub-Category");

227  
ıs_­i_»t_code_ERR
;

230 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
 (
·¿m
->
li¡
);

231 ià(!
obj
) {

232 
	`EV_LOG
 (
ERR
, 
INTERFACE
, 
ev_log_s_MAJOR
, "PKT-IO",

233 "Obj Aµ’d faed. Index: %ld", 
šdex
);

234  
ıs_­i_»t_code_ERR
;

237 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
 (
	`ıs_­i_objeù_key
 (
obj
),

238 
BASE_SFLOW_SOCKET_ADDRESS_OBJ
,

239 
ıs_­i_qu®if›r_TARGET
)) {

240 
	`EV_LOG
 (
ERR
, 
INTERFACE
, 
ev_log_s_MAJOR
, "PKT-IO",

242  
ıs_­i_»t_code_ERR
;

246 
dn_v4_addr_t
 

;

247 
pÜt
 = 0;

248 
	`_exŒaù_¡d_v4_sock_addr
 (&
sæow_sock_de¡
, &

, &
pÜt
);

250 ià(!
	`ıs_­i_objeù_©Œ_add
 (
obj
, 
BASE_SFLOW_SOCKET_ADDRESS_IP
, &

,  (ip))) {

251  
ıs_­i_»t_code_ERR
;

254 ià(!
	`ıs_­i_objeù_©Œ_add_u16
 (
obj
, 
BASE_SFLOW_SOCKET_ADDRESS_UDP_PORT
, 
pÜt
)) {

255  
ıs_­i_»t_code_ERR
;

258  
ıs_­i_»t_code_OK
;

259 
	}
}

261 
ıs_­i_»tuº_code_t
 
	$_ıs_­i_wr™e_št
 (*
cÚ‹xt
,

262 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
,

263 
size_t
 
šdex
,

264 
ıs_­i_objeù_t
 
´ev
)

266 
ıs_­i_objeù_t
 
obj
;

267 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
;

269 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
 (
·¿m
->
chªge_li¡
, 
šdex
);

270 ià(
obj
 =ğ
NULL
) {

271 
	`EV_LOG
 (
ERR
, 
INTERFACE
, 
ev_log_s_MAJOR
, "PKT-IO", "Missing Change Object");

272  
ıs_­i_»t_code_ERR
;

275 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
 (
	`ıs_­i_objeù_key
 (
obj
));

276 ià(
İ
 !ğ
ıs_­i_İ”_SET
) {

277 
	`EV_LOG
 (
ERR
, 
INTERFACE
, 
ev_log_s_MAJOR
, "PKT-IO", "Invalid operation");

278  
ıs_­i_»t_code_ERR
;

281 
dn_v4_addr_t
 

;

282 
pÜt
 = 0;

283 
	`_exŒaù_¡d_v4_sock_addr
 (&
sæow_sock_de¡
, &

, &
pÜt
);

285 
boŞ
 
dœty
=
çl£
;

286 
ıs_­i_objeù_™_t
 
™
;

288 
	`ıs_­i_objeù_™_begš
 (
obj
, &
™
);

289 
	`ıs_­i_objeù_™_v®id
 (&
™
); 
	`ıs_­i_objeù_™_Ãxt
 (&it)) {

291 
ıs_­i_©Œ_id_t
 
©Œ_id
 = 
	`ıs_­i_objeù_©Œ_id
 (
™
.
©Œ
);

293 
©Œ_id
) {

294 
BASE_SFLOW_SOCKET_ADDRESS_IP
:

295 ià(
	`ıs_­i_objeù_©Œ_Ën
 (
™
.
©Œ
è<  (

)) {

296 
	`EV_LOG
 (
ERR
, 
INTERFACE
, 
ev_log_s_MINOR
, "PKT-IO",

297 "Inv®id‡‰ribu‹ %ld d©¨Ëngth", 
©Œ_id
);

298  
ıs_­i_»t_code_ERR
;

300 ià(
´ev
 !ğ
NULL
) {

301 
	`ıs_­i_objeù_©Œ_add
 (
´ev
, 
BASE_SFLOW_SOCKET_ADDRESS_IP
, &

,  (ip));

303 

 = *(
dn_v4_addr_t
*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
);

304 
dœty
 = 
Œue
;

306 
BASE_SFLOW_SOCKET_ADDRESS_UDP_PORT
:

307 ià(
´ev
 !ğ
NULL
) {

308 
	`ıs_­i_objeù_©Œ_add_u16
 (
´ev
, 
BASE_SFLOW_SOCKET_ADDRESS_UDP_PORT
, 
pÜt
);

310 
pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u16
 (
™
.
©Œ
);

311 
dœty
 = 
Œue
;

314 
	`EV_LOG
 (
ERR
, 
INTERFACE
, 
ev_log_s_MINOR
, "PKT-IO",

315 "UnknowÀ©Œibu‹ ignÜed %ld", 
©Œ_id
);

319 ià(
dœty
è
	`_mk_¡d_v4_sock_addr
 (&

, 
pÜt
, &
sæow_sock_de¡
);

320  
ıs_­i_»t_code_OK
;

321 
	}
}

323 
ıs_­i_»tuº_code_t
 
	$_ıs_­i_wr™e
 (*
cÚ‹xt
,

324 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
,

325 
size_t
 
šdex
)

327 
ıs_­i_objeù_t
 
´ev
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
 (
·¿m
->prev);

328 ià(
´ev
 =ğ
NULL
) {

329  
ıs_­i_»t_code_ERR
;

332  
	`_ıs_­i_wr™e_št
 (
cÚ‹xt
, 
·¿m
, 
šdex
, 
´ev
);

333 
	}
}

335 
ıs_­i_»tuº_code_t
 
	$_ıs_­i_rŞlback
 (*
cÚ‹xt
,

336 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
,

337 
size_t
 
šdex
)

339  
	`_ıs_­i_wr™e_št
 (
cÚ‹xt
, 
·¿m
, 
šdex
, 
NULL
);

340 
	}
}

345 
ıs_­i_»tuº_code_t
 
	$_ıs_­i_pf_»ad
 (*
cÚ‹xt
,

346 
ıs_­i_g‘_·¿ms_t
 *
·¿m
,

347 
size_t
 
šdex
)

349 
ıs_­i_objeù_t
 
ft
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
šdex
);

351 ià(
	`ıs_­i_key_g‘_subÿt
 (
	`ıs_­i_objeù_key
 (
ft
)è!ğ
BASE_PACKET_RULE_OBJ
) {

352 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-IO", "Invalid Sub-Category");

353  
ıs_­i_»t_code_ERR
;

356 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
 (
·¿m
->
li¡
);

357 ià(!
obj
) {

358 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-IO","Obj Append failed");

359  
ıs_­i_»t_code_ERR
;

362 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
 (
	`ıs_­i_objeù_key
 (
obj
),

363 
BASE_PACKET_RULE_OBJ
,

364 
ıs_­i_qu®if›r_TARGET
)) {

365 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-IO", "Failedo create Key from Table Object");

366  
ıs_­i_»t_code_ERR
;

369 if(
	`Çs_pf_ıs_»ad
(
ft
, 
obj
è!ğ
STD_ERR_OK
) {

370  
ıs_­i_»t_code_ERR
;

373  
ıs_­i_»t_code_OK
;

374 
	}
}

376 
ıs_­i_»tuº_code_t
 
	$_ıs_­i_pf_wr™e_št
 (*
cÚ‹xt
,

377 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
,

378 
size_t
 
šdex
,

379 
ıs_­i_objeù_t
 
´ev
)

381 
ıs_­i_objeù_t
 
obj
;

383 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
 (
·¿m
->
chªge_li¡
, 
šdex
);

384 ià(
obj
 =ğ
NULL
) {

385 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-IO", "Missing Change Object");

386  
ıs_­i_»t_code_ERR
;

389 if(
	`Çs_pf_ıs_wr™e
(
obj
è!ğ
STD_ERR_OK
) {

390  
ıs_­i_»t_code_ERR
;

393  
ıs_­i_»t_code_OK
;

394 
	}
}

396 
ıs_­i_»tuº_code_t
 
	$_ıs_­i_pf_wr™e
 (*
cÚ‹xt
,

397 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
,

398 
size_t
 
šdex
)

400 
ıs_­i_objeù_t
 
´ev
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
 (
·¿m
->prev);

401 ià(
´ev
 =ğ
NULL
) {

402  
ıs_­i_»t_code_ERR
;

405  
	`_ıs_­i_pf_wr™e_št
 (
cÚ‹xt
, 
·¿m
, 
šdex
, 
´ev
);

406 
	}
}

408 
ıs_­i_»tuº_code_t
 
	$_ıs_­i_pf_rŞlback
 (*
cÚ‹xt
,

409 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
,

410 
size_t
 
šdex
)

412  
	`_ıs_­i_pf_wr™e_št
 (
cÚ‹xt
, 
·¿m
, 
šdex
, 
NULL
);

413 
	}
}

415 
t_¡d_”rÜ
 
	$_ıs_·ck‘_f‹r_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
)

417 
ıs_­i_»gi¡¿tiÚ_funùiÚs_t
 
f
;

419 
	`mem£t
 (&
f
, 0, (f));

421 
f
.
hªdË
 = handle;

422 
f
.
_»ad_funùiÚ
 = 
_ıs_­i_pf_»ad
;

423 
f
.
_wr™e_funùiÚ
 = 
_ıs_­i_pf_wr™e
;

424 
f
.
_rŞlback_funùiÚ
 = 
_ıs_­i_pf_rŞlback
;

426 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
f
.
key
, 
BASE_PACKET_RULE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

429 ià(
	`ıs_­i_»gi¡”
 (&
f
è!ğ
ıs_­i_»t_code_OK
) {

430 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
, "PKT-IO", "CPS object Register failed");

431  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

434  
STD_ERR_OK
;

435 
	}
}

437 
t_¡d_”rÜ
 
	$_ıs_š™
 ()

439 
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
;

440 
ıs_­i_»tuº_code_t
 
rc
;

441 
ıs_­i_»gi¡¿tiÚ_funùiÚs_t
 
f
;

443 
rc
 = 
	`ıs_­i_İ”©iÚ_subsy¡em_š™
 (&
hªdË
,1);

445 ià(
rc
 !ğ
ıs_­i_»t_code_OK
) {

446 
	`EV_LOG
 (
ERR
, 
INTERFACE
, 
ev_log_s_CRITICAL
, "PKT-IO",

448  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 
rc
);

451 
	`mem£t
 (&
f
, 0, (f));

453 
f
.
hªdË
 = handle;

454 
f
.
_»ad_funùiÚ
 = 
_ıs_­i_»ad
;

455 
f
.
_wr™e_funùiÚ
 = 
_ıs_­i_wr™e
;

456 
f
.
_rŞlback_funùiÚ
 = 
_ıs_­i_rŞlback
;

459 
	`ıs_­i_key_š™
 (&
f
.
key
,

460 
ıs_­i_qu®if›r_TARGET
,

461 
ıs_­i_obj_CAT_BASE_SFLOW
,

462 
BASE_SFLOW_SOCKET_ADDRESS_OBJ
,

465 
rc
 = 
	`ıs_­i_»gi¡”
 (&
f
);

467 ià(
rc
 !ğ
ıs_­i_»t_code_OK
) {

468 
	`EV_LOG
 (
ERR
, 
INTERFACE
, 
ev_log_s_CRITICAL
, "PKT-IO",

470  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 
rc
);

473  
	`_ıs_·ck‘_f‹r_š™
(
hªdË
);

474 
	}
}

485 
t_¡d_”rÜ
 
	$dn_h®_·ck‘_rx
(
ušt8_t
 *
pkt
, 
ušt32_t
 
Ën
, 
ndi_·ck‘_©Œ_t
 *
p_©Œ
)

487 ++
·ck‘s_rxed
;

488 ià(
	`PKT_DBG_DUMP
(
pkt_debug
)è
	`h®_·ck‘_io_dump
(
pkt
, 
Ën
, 
PKT_DBG_DIR_IN
);

489 
	`PKT_DEBUG
("[RX] oÀäÚˆÅu %d…Üˆ%d†’ %d",
p_©Œ
->
Åu_id
,p_©Œ->
rx_pÜt
,
Ën
);

491 ià(
p_©Œ
->
Œ­_id
 =ğ
NDI_PACKET_TRAP_ID_SAMPLEPACKET
)

492  
	`_sæow_pkt_hdl
 (
pkt
, 
Ën
, 
p_©Œ
);

494 if(
	`Çs_pf_šgr_’abËd
()) {

495 
boŞ
 
¡İ
 = 
	`Çs_pf_š_pkt_hndÌ
(
pkt
, 
Ën
, 
p_©Œ
);

496 if(
¡İ
è (
STD_ERR_OK
);

499 
t_¡d_”rÜ
 
”r
 = 
	`h®_vœtu®_š‹rçû_£nd
(
p_©Œ
->
Åu_id
,p_©Œ->
rx_pÜt
,0,
pkt
,
Ën
);

500 
	`PKT_DEBUG
("[RX] D©¨wr™‹ÀtØfd %d", 
”r
);

501  (
STD_ERR_OK
);

502 
	}
}

504 
	$dn_h®_·ck‘_tx
(
Åu_id_t
 
Åu
, 
Åu_pÜt_t
 
pÜt
, *
pkt
, 
ušt32_t
 
Ën
)

506 
ndi_·ck‘_©Œ_t
 
©Œ
;

508 ++
·ck‘s_txed
;

509 ++
·ck‘s_txed_to_p–še_by·ss
;

511 ià(
	`PKT_DBG_DUMP
(
pkt_debug
)è
	`h®_·ck‘_io_dump
(
pkt
, 
Ën
, 
PKT_DBG_DIR_OUT
);

513 
©Œ
.
Åu_id
 = 
Åu
;

514 
©Œ
.
tx_pÜt
 = 
pÜt
;

517 
©Œ
.
tx_ty³
 = 
NDI_PACKET_TX_TYPE_PIPELINE_BYPASS
;

519 if(
	`Çs_pf_egr_’abËd
()) {

520 
	`Çs_pf_out_pkt_hndÌ
(
pkt
, 
Ën
, &
©Œ
);

523 ià(
	`ndi_·ck‘_tx
(
pkt
, 
Ën
, &
©Œ
è!ğ
STD_ERR_OK
) {

524 
	`PKT_DEBUG
("[TX] Pktxmission FAILED \r\n");

527 
	`PKT_DEBUG
("[TX] PkˆtxmissiÚ OK fÜ‚pu %d…Üˆ%d†’ %d\r\n",
Åu
,
pÜt
,
Ën
);

529 
	}
}

531 
	$dn_h®_·ck‘_tx_to_šg»ss_p–še
 (*
pkt
, 
ušt32_t
 
Ën
)

533 
Åu_id_t
 
Åu
;

534 
ndi_·ck‘_©Œ_t
 
©Œ
;

539 
Åu
 = 0;

541 ++
·ck‘s_txed
;

542 ++
·ck‘s_txed_to_p–še_lookup
;

544 ià(
	`PKT_DBG_DUMP
(
pkt_debug
)è
	`h®_·ck‘_io_dump
(
pkt
, 
Ën
, 
PKT_DBG_DIR_OUT
);

546 
©Œ
.
Åu_id
 = 
Åu
;

547 
©Œ
.
tx_pÜt
 = 0;

550 
©Œ
.
tx_ty³
 = 
NDI_PACKET_TX_TYPE_PIPELINE_LOOKUP
;

552 ià(
	`ndi_·ck‘_tx
 (
pkt
, 
Ën
, &
©Œ
è!ğ
STD_ERR_OK
) {

553 
	`PKT_DEBUG
("[TX] Pktxmissiono ingress…ipeline FAILED \r\n");

555 
	`PKT_DEBUG
("[TX] PkˆtxmissiÚØšg»s p–šOK fÜ‚pu %d†’ %d\r\n",
Åu
,
Ën
);

557 
	}
}

559 
	$h®_·ck‘_io_debug
 (
boŞ
 
æag
, 
pkt_dœ
) {

560 
pkt_debug
 = 
æag
;

561 ià(
pkt_debug
 && 
pkt_dœ
)…kt_debug =…kt_dir;

562 
	}
}

564 
	$chªge_debug_æag_¡©e
(
¡d_·r£d_¡ršg_t
 
hªdË
) {

565 if(
	`¡d_·r£_¡ršg_num_tok’s
(
hªdË
)==0) ;

566 
size_t
 
ix
 = 0;

567 
boŞ
 
æag
 = 
	`¡r¡r
(
	`¡d_·r£_¡ršg_Ãxt
(
hªdË
,&
ix
),"Œue")!=
NULL
 ? 1 : 0;

569 
ix
 = 1;

570 
pkt_dœ
 = 0;

571 cÚ¡ *
tok’
 = 
NULL
;

572 if((
tok’
 = 
	`¡d_·r£_¡ršg_Ãxt
(
hªdË
,&
ix
))!ğ
NULL
) {

573 if(!
	`¡rcmp
(
tok’
,"in")) {

574 
pkt_dœ
 = 
PKT_DBG_DIR_IN
;

575 } if(!
	`¡rcmp
(
tok’
,"out")) {

576 
pkt_dœ
 = 
PKT_DBG_DIR_OUT
;

577 } if(!
	`¡rcmp
(
tok’
,"both")) {

578 
pkt_dœ
 = 
PKT_DBG_DIR_BOTH
;

581 
	`h®_·ck‘_io_debug
 (
æag
, 
pkt_dœ
);

582 
	}
}

585 
t_¡d_”rÜ
 
	$h®_·ck‘_io_maš
() {

590 ià(
	`h®_vœtu®_š‹rçû_wa™
(
dn_h®_·ck‘_tx
,

591 
dn_h®_·ck‘_tx_to_šg»ss_p–še
,

592 
pkt_buf
,
MAX_PKT_LEN
)!=
STD_ERR_OK
) {

593 
	`EV_LOGGING
 (
INTERFACE
,
ERR
, "PKT-IO", "Error in initializing virtual interface…acketx");

596  
STD_ERR_OK
;

597 
	}
}

599 
t_¡d_”rÜ
 
	$h®_·ck‘_io_š™
()

601 
”rÜ
;

603 
	`EV_LOG_TRACE
(
ev_log_t_INTERFACE
, 3, "PKT-IO", "Initializing…acket I/O Thread");

605 
”rÜ
 = 
	`±h»ad_ü—‹
(&
·ck‘_io_thr
, 
NULL
, (*)
h®_·ck‘_io_maš
, NULL);

606 ià(
”rÜ
) {

607 
	`EV_LOG_ERR
(
ev_log_t_INTERFACE
, 3, "PKT-IO", "E¼Ü %s", 
	`¡»¼Ü
(
”rÜ
));

610 
	`±h»ad_£Šame_Å
(
·ck‘_io_thr
, "hal_packet_io");

613 
	`_sæow_sock_š™
 ();

614 
	`Çs_pf_š™Ÿlize
();

615 
	`_ıs_š™
 ();

617 
	`ndi_·ck‘_rx_»gi¡”
(
dn_h®_·ck‘_rx
);

619 
	`h®_sh–l_cmd_add
("pkt-io-debug",
chªge_debug_æag_¡©e
,"[true|false] [in|out|both] Changes Debug flag state\nWarning: Enablinghis will generate†ots of information‡nd may impacthe…erformance");

620 
	`h®_sh–l_cmd_add
("pkt-io-couÁ”s",
pkt_debug_couÁ”s
,"Displays Packet count");

622  
STD_ERR_OK
;

623 
	}
}

	@src/port/hal_int_utils.c

21 
	~"h®_if_m­pšg.h
"

22 
	~"ev’t_log.h
"

23 
	~"Çs_št_uts.h
"

24 
	~"¡d_uts.h
"

25 
	~"¡dio.h
"

26 
	~"h®_sh–l.h
"

28 
	~<Ãt/if.h
>

29 
	~<¡ršg.h
>

31 
boŞ
 
	$Çs_is_nÚ_Åu_phy_pÜt
(
h®_ifšdex_t
 
if_šdex
) {

32 
š‹rçû_ù¾_t
 
_pÜt
;

33 
	`mem£t
(&
_pÜt
, 0, (_port));

35 
_pÜt
.
if_šdex
 = if_index;

36 
_pÜt
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

38 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
_pÜt
è!ğ
STD_ERR_OK
) {

39 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,"INTF-C","Failedo get if_info");

40  
Œue
;

42 ià((
_pÜt
.
št_ty³
 =ğ
Çs_št_ty³_MGMT
) ||

43 ((
_pÜt
.
št_ty³
 =ğ
Çs_št_ty³_PORT
) &&

44 (!
_pÜt
.
pÜt_m­³d
))) {

45  
Œue
;

47  
çl£
;

48 
	}
}

49 
	$Çs_št_Çme_to_if_šdex
(
h®_ifšdex_t
 *
if_šdex
, cÚ¡ *
Çme
) {

51 
š‹rçû_ù¾_t
 
štf_ù¾
;

52 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

54 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

56 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

57 
	`§ã¡ºıy
(
štf_ù¾
.
if_Çme
, 
Çme
, 
	`¡¾’
(name)+1);

59 if((
rc
ğ
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

60 
	`EV_LOGGING
(
INTERFACE
, 
CRIT
, "NAS-INT",

61 "IÁ”çû % »tuºedƒ¼Ü %d", 
štf_ù¾
.
if_Çme
, 
rc
);

62  
	`STD_ERR
(
INTERFACE
,
FAIL
, 
rc
);

65 *
if_šdex
 = 
štf_ù¾
.if_index;

66  
STD_ERR_OK
;

67 
	}
}

69 
t_¡d_”rÜ
 
	$Çs_št_g‘_Åu_pÜt
(
h®_ifšdex_t
 
pÜt_šdex
, 
ndi_pÜt_t
 *
ndi_pÜt
)

71 
š‹rçû_ù¾_t
 
štf_ù¾
;

72 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

74 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

76 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

77 
štf_ù¾
.
if_šdex
 = 
pÜt_šdex
;

79 if((
rc
ğ
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

80 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT",

82 
štf_ù¾
.
if_šdex
, 
rc
);

84  
	`STD_ERR
(
INTERFACE
,
FAIL
, 
rc
);

87 ià(
štf_ù¾
.
št_ty³
 !ğ
Çs_št_ty³_PORT
 &&

88 
štf_ù¾
.
št_ty³
 !ğ
Çs_št_ty³_CPU
 &&

89 
štf_ù¾
.
št_ty³
 !ğ
Çs_št_ty³_FC
) {

90 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT",

92 
štf_ù¾
.
št_ty³
, iÁf_ù¾.
if_šdex
);

93  
	`STD_ERR
(
INTERFACE
, 
PARAM
, 0);

96 
ndi_pÜt
->
Åu_id
 = 
štf_ù¾
.npu_id;

97 
ndi_pÜt
->
Åu_pÜt
 = 
štf_ù¾
.
pÜt_id
;

99  
STD_ERR_OK
;

100 
	}
}

101 
t_¡d_”rÜ
 
	$Çs_št_g‘_if_šdex_äom_Åu_pÜt
(
h®_ifšdex_t
 *
pÜt_šdex
, 
ndi_pÜt_t
 *
ndi_pÜt
)

103 
š‹rçû_ù¾_t
 
štf_ù¾
;

104 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

106 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

108 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_PORT
;

109 
štf_ù¾
.
Åu_id
 = 
ndi_pÜt
->npu_id;

110 
štf_ù¾
.
pÜt_id
 = 
ndi_pÜt
->
Åu_pÜt
;

112 if((
rc
ğ
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

113 
	`EV_LOGGING
(
INTERFACE
, 
CRIT
, "NAS-INT",

115 
ndi_pÜt
->
Åu_id
,‚di_pÜt->
Åu_pÜt
, 
rc
);

117  
	`STD_ERR
(
INTERFACE
,
FAIL
, 
rc
);

119 *
pÜt_šdex
 = 
štf_ù¾
.
if_šdex
;

121  
STD_ERR_OK
;

122 
	}
}

124 
t_¡d_”rÜ
 
	$Çs_št_g‘_if_šdex_to_Çme
(
h®_ifšdex_t
 
if_šdex
, * 
Çme
, 
size_t
 
Ën
)

126 
š‹rçû_ù¾_t
 
štf_ù¾
;

127 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

129 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

131 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

132 
štf_ù¾
.
if_šdex
 = if_index;

134 if((
rc
ğ
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

135 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-INT",

137 
štf_ù¾
.
if_šdex
, 
rc
);

139  
	`STD_ERR
(
INTERFACE
,
FAIL
, 
rc
);

141 
	`§ã¡ºıy
(
Çme
, 
štf_ù¾
.
if_Çme
, 
Ën
);

142  
STD_ERR_OK
;

143 
	}
}

146 
t_¡d_”rÜ
 
	$Çs_g‘_št_ty³
(
h®_ifšdex_t
 
šdex
, 
Çs_št_ty³_t
 *
ty³
)

148 
š‹rçû_ù¾_t
 
štf_ù¾
;

149 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

151 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

153 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

154 
štf_ù¾
.
if_šdex
 = 
šdex
;

156 if((
rc
ğ
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

157 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-INT",

159 
štf_ù¾
.
if_šdex
, 
rc
);

161  
	`STD_ERR
(
INTERFACE
,
FAIL
, 
rc
);

164 *
ty³
 = 
štf_ù¾
.
št_ty³
;

165  
STD_ERR_OK
;

166 
	}
}

169 
	$Çs_sh–l_commªd_š™
() {

170 
	`h®_sh–l_cmd_add
("Çs-pÜt-dump",
Çs_štf_to_Åu_pÜt_m­_dump
,

172 
	}
}

175 
	$Çs_štf_to_Åu_pÜt_m­_dump
(
¡d_·r£d_¡ršg_t
 
hªdË
)

177 if(
	`¡d_·r£_¡ršg_num_tok’s
(
hªdË
)==0) ;

178 
size_t
 
ix
 = 0;

179 cÚ¡ *
tok’
 = 
NULL
;

180 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

181 
š‹rçû_ù¾_t
 
štf_ù¾
;

183 
tok’
 = 
	`¡d_·r£_¡ršg_Ãxt
(
hªdË
,&
ix
);

184 if(
NULL
 !ğ
tok’
) {

185 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

186 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

187 
	`§ã¡ºıy
(
štf_ù¾
.
if_Çme
, 
tok’
, 
	`¡¾’
(token)+1);

189 if((
rc
ğ
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

190 
	`´štf
("IÁ”çû % »tuºedƒ¼Ü %d\r\n", 
tok’
, 
rc
);

192 
	`´štf
("IÁ”çû if_šdex : %d\r\n",
štf_ù¾
.
if_šdex
);

193 
	`´štf
("IÁ”çû NPU_ID : %d\r\n",
štf_ù¾
.
Åu_id
);

194 
	`´štf
("IÁ”çû‚pu_pÜˆ: 0x%x\r\n",
štf_ù¾
.
pÜt_id
);

195 
	`´štf
("IÁ”çû­_id : %d\r\n",
štf_ù¾
.
p_id
);

196 
	`´štf
("IÁ”çû†ag_id : 0x%lx\r\n",
štf_ù¾
.
Ïg_id
);

197 
	`Çs_ndi_pÜt_m­_dump
(
štf_ù¾
.
Åu_id
,štf_ù¾.
pÜt_id
);

200 
	`´štf
("Enterhe interface‚ame\r\n");

202 
	}
}

	@src/port/nas_fc_intf.cpp

22 
	~"Çs_ndi_fc.h
"

23 
	~"Çs_ndi_pÜt.h
"

24 
	~"ıs_­i_ev’ts.h
"

25 
	~"ıs_­i_objeù_©Œ.h
"

26 
	~"¡d_mac_uts.h
"

27 
	~"ev’t_log.h
"

28 
	~"d–l-š‹rçû.h
"

29 
	~"d–l-ba£-if-phy.h
"

30 
	~"ŸÇ-if-ty³.h
"

31 
	~<unÜd”ed_m­
>

33 
	#MAX_NO_OF_SUPP_SPEED
 10

	)

34 
	#FC_MTU_SIZE
 2188

	)

37 
t_¡d_”rÜ
 
	$_£t_g’”ic_mac
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_©Œ_id_t
 
©Œ
, 
ıs_­i_objeù_t
 
obj
) {

39 
mac_¡r
[18];

40 
	`mem£t
(
mac_¡r
, 0 , (mac_str));

41 
Çs_fc_·¿m_t
 
·¿m
;

42 
ıs_­i_objeù_©Œ_t
 
mac_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

43 
©Œ
);

44 
	`STD_ASSERT
(
mac_©Œ
 !ğ
nuÎ±r
);

45 *
addr
 = 
	`ıs_­i_objeù_©Œ_d©a_bš
(
mac_©Œ
);

46 
addr_Ën
 = 
	`¡¾’
(
¡©ic_ÿ¡
<*>(
addr
));

47 ià(!
	`¡d_¡ršg_to_mac
(&
·¿m
.
mac
, 
¡©ic_ÿ¡
<cÚ¡ *>(
addr
), 
addr_Ën
)) {

48 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-FCOE-MAP", "Error set dest mac");

49  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

52 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-FCOE-MAP", "Setting mac‡ddress %s,‡ctual string %s,†en %d",

53 
	`¡d_mac_to_¡ršg
(&
·¿m
.
mac
, 
mac_¡r
,(mac_¡r)), 
¡©ic_ÿ¡
<*>(
addr
), 
addr_Ën
);

55  
	`ndi_£t_fc_©Œ
(
Åu
, 
pÜt
, &
·¿m
, 
©Œ
);

57 
	}
}

61 
t_¡d_”rÜ
 
	$_£t_g’”ic_u32
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_©Œ_id_t
 
©Œ
,

62 
ıs_­i_objeù_t
 
obj
) {

64 
Çs_fc_·¿m_t
 
·¿m
;

65 
ıs_­i_objeù_©Œ_t
 
_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
©Œ
);

66 ià(
_©Œ
==
NULL
è 
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

67 
·¿m
.
u32
 = 
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_©Œ
);

68  
	`ndi_£t_fc_©Œ
(
Åu
, 
pÜt
, &
·¿m
, 
©Œ
);

69 
	}
}

72 
t_¡d_”rÜ
 
	$_£t_g’”ic_boŞ
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_©Œ_id_t
 
©Œ
, 
ıs_­i_objeù_t
 
obj
) {

73 
Çs_fc_·¿m_t
 
·¿m
;

74 
ıs_­i_objeù_©Œ_t
 
_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
©Œ
);

75 ià(
_©Œ
==
NULL
è 
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

76 
·¿m
.
ty_boŞ
 = (
boŞ
è
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_©Œ
);

77  
	`ndi_£t_fc_©Œ
(
Åu
, 
pÜt
, &
·¿m
, 
©Œ
);

79 
	}
}

82 
t_¡d_”rÜ
 
	$_£t_fc_¥“d
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_©Œ_id_t
 
©Œ
,

83 
ıs_­i_objeù_t
 
obj
) {

85 
ıs_­i_objeù_©Œ_t
 
_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
©Œ
);

86 ià(
_©Œ
 =ğ
NULL
è 
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

87 
ušt32_t
 
¥“d
 = 
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_©Œ
);

88 ià(
¥“d
 =ğ
BASE_IF_SPEED_AUTO
) {

89 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
 ,"NAS-FCOE-MAP","Speed‡uto is‚ot supported for FC interfaces");

90  
STD_ERR_OK
;

92  
	`_£t_g’”ic_u32
(
Åu
, 
pÜt
, 
©Œ
, 
obj
);

93 
	}
}

98 cÚ¡ 
	g¡d
::
unÜd”ed_m­
<
ıs_­i_©Œ_id_t
,

99 
	$t_¡d_”rÜ
 (*)(
Åu_id_t
, 
pÜt_t
, 
ıs_­i_©Œ_id_t
, 
ıs_­i_objeù_t
 )> 
_£t_©Œ_hªdËrs
 = {

100 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_SRC_MAC_MODE
, 
_£t_g’”ic_u32
 },

101 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_SRC_MAP_PREFIX
, 
_£t_g’”ic_u32
},

102 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_INGRESS_SRC_MAC
, 
_£t_g’”ic_mac
},

104 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_DEST_MAC_MODE
, 
_£t_g’”ic_u32
},

105 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_DEST_MAP_PREFIX
, 
_£t_g’”ic_u32
},

106 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_INGRESS_DEST_MAC
, 
_£t_g’”ic_mac
},

107 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_VFT_HEADER
, 
_£t_g’”ic_u32
},

108 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_BB_CREDIT
, 
_£t_g’”ic_u32
},

109 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_BB_CREDIT_RECOVERY
, 
_£t_g’”ic_u32
},

110 { 
DELL_IF_IF_INTERFACES_INTERFACE_AUTO_NEGOTIATION
, 
_£t_g’”ic_boŞ
},

111 { 
IF_INTERFACES_INTERFACE_ENABLED
, 
_£t_g’”ic_boŞ
},

112 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_FCOE_PKT_VLANID
, 
_£t_g’”ic_u32
},

113 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_PRIORITY
, 
_£t_g’”ic_u32
},

114 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_MTU
, 
_£t_g’”ic_u32
},

115 { 
DELL_IF_IF_INTERFACES_INTERFACE_SPEED
, 
_£t_fc_¥“d
},

116 { 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PHY_MEDIA
, 
_£t_g’”ic_u32
},

117 { 
BASE_IF_FC_IF_INTERFACES_STATE_INTERFACE_BB_CREDIT_RECEIVE
, 
_£t_g’”ic_u32
},

118 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_FLOW_CONTROL_ENABLE
, 
_£t_g’”ic_boŞ
},

119 
	}
};

122 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_ü—‹_fc_pÜt
(
Åu_id_t
 
Åu_id
, 
pÜt_t
 
pÜt
, 
BASE_IF_SPEED_t
 
¥“d
, 
ušt32_t
 *
hw_pÜt_li¡
, 
size_t
 
couÁ
)

124 ià(
	`ndi_ü—‹_fc_pÜt
(
Åu_id
, 
pÜt
, 
¥“d
, 
hw_pÜt_li¡
, 
couÁ
è!ğ
STD_ERR_OK
) {

125  
ıs_­i_»t_code_ERR
;

128 
Çs_fc_·¿m_t
 
·¿m
;

129 
ıs_­i_©Œ_id_t
 
©Œ
 = 
BASE_IF_FC_IF_INTERFACES_INTERFACE_MTU
;

130 
·¿m
.
u32
 = 
FC_MTU_SIZE
;

131 ià(
	`ndi_£t_fc_©Œ
(
Åu_id
, 
pÜt
, &
·¿m
, 
©Œ
è!ğ
STD_ERR_OK
) {

132 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-FCOE-MAP"," FC create: set mtu failed‚pu %d,…ort %u",

133 
Åu_id
, 
pÜt
);

136 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
 ,"NAS-FCOE-MAP"," FC c»© %d fÜ…Üˆ %u", 
Åu_id
, 
pÜt
);

137  
ıs_­i_»t_code_OK
;

138 
	}
}

140 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_£t_fc_©Œ
(
Åu_id_t
 
Åu_id
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
, cps_­i_objeù_ˆ
´ev
)

143 
ıs_­i_objeù_™_t
 
™_»q
;

144 
	`ıs_­i_objeù_™_begš
(
obj
, &
™_»q
);

146 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-FCOE-MAP","Çs_ıs_£t_fc_pÜˆ %d fÜ…Üˆ %u", 
Åu_id
, 
pÜt
);

148  ; 
	`ıs_­i_objeù_™_v®id
(&
™_»q
); 
	`ıs_­i_objeù_™_Ãxt
(&it_req)) {

149 
ıs_­i_©Œ_id_t
 
id
 = 
	`ıs_­i_objeù_©Œ_id
(
™_»q
.
©Œ
);

150 autØ
func
 = 
_£t_©Œ_hªdËrs
.
	`fšd
(
id
);

151 ià(
func
 ==
_£t_©Œ_hªdËrs
.
	`’d
()) ;

153 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
 ,"NAS-FCOE-MAP"," Set‡ttribute for‚pu %u,…ort %u,‡ttr %lu ",

154 
Åu_id
, 
pÜt
, 
id
);

155 
t_¡d_”rÜ
 
»t
 = 
func
->
	`£cÚd
(
Åu_id
, 
pÜt
, 
id
, 
obj
 );

156 ià(
»t
 !ğ
STD_ERR_OK
) {

157 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-FCOE-MAP","FaedØ£ˆA‰ribu‹ %lu fÜ…Üˆ %u", 
id
, 
pÜt
);

159  
ıs_­i_»t_code_ERR
;;

163  
ıs_­i_»t_code_OK
;

165 
	}
}

167 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_d–‘e_fc_pÜt
(
Åu_id_t
 
Åu_id
, 
pÜt_t
 
pÜt
)

170 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-FCOE-MAP","Çs_ıs_d–‘e_fc_pÜˆ %d fÜ…Üˆ %u", 
Åu_id
, 
pÜt
);

171  
	`ndi_d–‘e_fc_pÜt
(
Åu_id
, 
pÜt
);

174 
	}
}

176 
	$Çs_fc_fl_¥“d_autÚeg_¡©e
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
)

178 
Çs_fc_id_v®ue_t
 
·¿m
;

179 
ušt64_t
 
¥“d
 = 0;

180 
t_¡d_”rÜ
 
rc
;

181 
ndi_štf_lšk_¡©e_t
 
¡©e
;

183 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-FCOE-MAP", "Çs_fc_fl_¥“d_autÚeg %d fÜ…Üˆ %u", 
Åu
, 
pÜt
);

185 
	`mem£t
(&
·¿m
, 0, (
Çs_fc_id_v®ue_t
));

186 
·¿m
.
©Œ_id
 = 
IF_INTERFACES_STATE_INTERFACE_SPEED
;

188 
rc
 = 
	`ndi_pÜt_lšk_¡©e_g‘
(
Åu
, 
pÜt
,&
¡©e
);

189 ià(
rc
 =ğ
STD_ERR_OK
) {

190 ià(
¡©e
.
İ”_¡©us
 !ğ
ndi_pÜt_OPER_UP
) {

191 
¥“d
 = 0;

192 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-FCOE-MAP", "nas_fc_fill_speed_autoneg speed seto zero");

193 
	`ıs_­i_objeù_©Œ_d–‘e
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_SPEED
);

194 
	`ıs_­i_objeù_©Œ_add_u64
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_SPEED
, 
¥“d
);

196 ià(
	`ndi_g‘_fc_©Œ
(
Åu
, 
pÜt
, &
·¿m
, 1è=ğ
STD_ERR_OK
) {

197 
¥“d
 = 
·¿m
.
v®ue
.
u64
;

198 
	`ıs_­i_objeù_©Œ_d–‘e
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_SPEED
);

199 
	`ıs_­i_objeù_©Œ_add_u64
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_SPEED
, 
¥“d
);

204 
	`mem£t
(&
·¿m
, 0, (
Çs_fc_id_v®ue_t
));

205 
·¿m
.
©Œ_id
 = 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_AUTO_NEGOTIATION
;

206 ià((
	`ndi_g‘_fc_©Œ
(
Åu
, 
pÜt
, &
·¿m
, 1)è=ğ
STD_ERR_OK
) {

207 
	`ıs_­i_objeù_©Œ_d–‘e
(
obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_AUTO_NEGOTIATION
);

208 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_AUTO_NEGOTIATION
, 
·¿m
.
v®ue
.
ty_boŞ
);

210 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_TYPE
,

211 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_FIBRECHANNEL
,

212 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_FIBRECHANNEL
));

214 
	}
}

216 
	$Çs_fc_fl_suµÜ‹d_¥“d
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
)

218 
Çs_fc_id_v®ue_t
 
·¿m
;

219 
ušt32_t
 
sup_¥“ds
[
MAX_NO_OF_SUPP_SPEED
] = {0};

221 
	`mem£t
(&
·¿m
, 0, (
Çs_fc_id_v®ue_t
));

222 
·¿m
.
©Œ_id
 = 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_SUPPORTED_SPEED
;

223 
·¿m
.
v®ue
.
li¡
.
v®s
 = 
sup_¥“ds
;

224 
·¿m
.
v®ue
.
li¡
.
Ën
 = 
MAX_NO_OF_SUPP_SPEED
;

225 
	`ıs_­i_objeù_©Œ_d–‘e
(
obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_SUPPORTED_SPEED
);

227 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-FCOE-MAP","Çs_fc_fl_suµÜ‹d_¥“d %d fÜ…Üˆ %u", 
Åu
, 
pÜt
);

228 ià((
	`ndi_g‘_fc_©Œ
(
Åu
, 
pÜt
, &
·¿m
, 1)è=ğ
STD_ERR_OK
) {

229 
mx
 = 
·¿m
.
v®ue
.
li¡
.
Ën
;

230 
ix
 =0;ix < 
mx
; ix++) {

231 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_STATE_INTERFACE_SUPPORTED_SPEED
, 
sup_¥“ds
[
ix
]);

236 
	}
}

239 
t_¡d_”rÜ
 
	$_g‘_g’”ic_u32
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_©Œ_id_t
 
©Œ
,

240 
ıs_­i_objeù_t
 
obj
) {

242 
Çs_fc_id_v®ue_t
 
·¿m
;

243 
	`mem£t
(&
·¿m
, 0, (
Çs_fc_id_v®ue_t
));

244 
·¿m
.
©Œ_id
 = 
©Œ
;

246 ià((
	`ndi_g‘_fc_©Œ
(
Åu
, 
pÜt
, &
·¿m
, 1)è!ğ
STD_ERR_OK
) {

247 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-FCOE-MAP"," faed g‘_g’”ic_u32 fÜ‚pu %d fÜ…Üˆ %u‡‰¸%lu", 
Åu
, 
pÜt
, 
©Œ
);

248  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

250 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
©Œ
, 
·¿m
.
v®ue
.
u32
);

251  
STD_ERR_OK
;

252 
	}
}

255 
t_¡d_”rÜ
 
	$_g‘_g’”ic_mac
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_©Œ_id_t
 
©Œ
, 
ıs_­i_objeù_t
 
obj
) {

257 
Çs_fc_id_v®ue_t
 
·¿m
;

258 
	`mem£t
(&
·¿m
, 0, (
Çs_fc_id_v®ue_t
));

259 
·¿m
.
©Œ_id
 = 
©Œ
;

260 
mac_¡r
[18];

261 
	`mem£t
(
mac_¡r
, 0, (mac_str));

263 ià((
	`ndi_g‘_fc_©Œ
(
Åu
, 
pÜt
, &
·¿m
, 1)è!ğ
STD_ERR_OK
) {

264 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-FCOE-MAP"," faed g‘_g’”ic_maøfÜ‚pu %d fÜ…Üˆ %u‡‰¸%lu", 
Åu
, 
pÜt
, 
©Œ
);

265  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

268 
	`¡d_mac_to_¡ršg
(&
·¿m
.
v®ue
.
mac
, 
mac_¡r
,(mac_str));

269 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
BASE_IF_FC_IF_INTERFACES_INTERFACE_INGRESS_SRC_MAC
,

270 
mac_¡r
, 
	`¡¾’
(mac_str)+1);

272 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-FCOE-MAP", "_get_generic_mac mac‡ddress %s,†en %lu",

273 
mac_¡r
, 
	`¡¾’
(mac_str));

274  
STD_ERR_OK
;

276 
	}
}

280 
t_¡d_”rÜ
 
	$_g‘_g’”ic_boŞ
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_©Œ_id_t
 
©Œ
, 
ıs_­i_objeù_t
 
obj
) {

282 
Çs_fc_id_v®ue_t
 
·¿m
;

283 
	`mem£t
(&
·¿m
, 0, (
Çs_fc_id_v®ue_t
));

284 
·¿m
.
©Œ_id
 = 
©Œ
;

285 ià((
	`ndi_g‘_fc_©Œ
(
Åu
, 
pÜt
, &
·¿m
, 1)è!ğ
STD_ERR_OK
) {

286 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-FCOE-MAP"," faed g‘_g’”ic_boŞ fÜ‚pu %d fÜ…Üˆ %u‡‰¸%lu", 
Åu
, 
pÜt
, 
©Œ
);

287  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

289 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
©Œ
, 
·¿m
.
v®ue
.
ty_boŞ
);

290  
STD_ERR_OK
;

292 
	}
}

295 cÚ¡ 
	g¡d
::
unÜd”ed_m­
<
ıs_­i_©Œ_id_t
,

296 
	$t_¡d_”rÜ
 (*)(
Åu_id_t
, 
pÜt_t
, 
ıs_­i_©Œ_id_t
, 
ıs_­i_objeù_t
 )> 
_g‘_©Œ_hªdËrs
 = {

297 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_SRC_MAC_MODE
, 
_g‘_g’”ic_u32
 },

298 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_SRC_MAP_PREFIX
, 
_g‘_g’”ic_u32
},

299 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_INGRESS_SRC_MAC
, 
_g‘_g’”ic_mac
},

301 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_DEST_MAC_MODE
, 
_g‘_g’”ic_u32
},

302 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_DEST_MAP_PREFIX
, 
_g‘_g’”ic_u32
},

303 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_INGRESS_DEST_MAC
, 
_g‘_g’”ic_mac
},

304 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_VFT_HEADER
, 
_g‘_g’”ic_u32
},

305 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_BB_CREDIT
, 
_g‘_g’”ic_u32
},

306 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_BB_CREDIT_RECOVERY
, 
_g‘_g’”ic_u32
},

307 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_FCOE_PKT_VLANID
, 
_g‘_g’”ic_u32
},

308 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_PRIORITY
, 
_g‘_g’”ic_u32
},

309 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_MTU
, 
_g‘_g’”ic_u32
},

310 { 
DELL_IF_IF_INTERFACES_INTERFACE_SPEED
, 
_g‘_g’”ic_u32
},

311 { 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
, 
_g‘_g’”ic_u32
},

312 { 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PHY_MEDIA
, 
_g‘_g’”ic_u32
},

313 { 
BASE_IF_FC_IF_INTERFACES_STATE_INTERFACE_BB_CREDIT_RECEIVE
, 
_g‘_g’”ic_u32
},

314 { 
BASE_IF_FC_IF_INTERFACES_INTERFACE_FLOW_CONTROL_ENABLE
, 
_g‘_g’”ic_boŞ
},

316 
	}
};

320 
	$Çs_fc_fl_štf_©Œ
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
)

322 autØ
™
 = 
_g‘_©Œ_hªdËrs
.
	`begš
(); iˆ!ğ_g‘_©Œ_hªdËrs.
	`’d
() ; ++it) {

323 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-FCOE-MAP"," Get‡ttribute for‚pu %u,…ort %u,‡ttr %lu ",

324 
Åu
, 
pÜt
, 
™
->
fœ¡
);

325 
™
->
	`£cÚd
(
Åu
, 
pÜt
, it->
fœ¡
, 
obj
);

329 
	}
}

332 
	$Çs_fc_fl_misc_¡©e
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
)

335 
	`_g‘_g’”ic_u32
(
Åu
, 
pÜt
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_FC_MTU
, 
obj
);

336 
	`_g‘_g’”ic_u32
(
Åu
, 
pÜt
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_BB_CREDIT
, 
obj
);

338 
	}
}

	@src/port/nas_int_logical_cps.cpp

23 
	~"¡d_rw_lock.h
"

24 
	~"Çs_os_š‹rçû.h
"

25 
	~"h®_if_m­pšg.h
"

26 
	~"Çs_if_uts.h
"

28 
	~"Çs_št_pÜt.h
"

29 
	~"Çs_št_uts.h
"

30 
	~"š‹rçû_obj.h
"

31 
	~"Çs_š‹rçû_fc.h
"

33 
	~"h®_š‹rçû_commÚ.h
"

34 
	~"h®_š‹rçû_deçuÉs.h
"

35 
	~"Çs_ndi_pÜt.h
"

37 
	~"ıs_­i_ev’ts.h
"

38 
	~"ıs_­i_objeù_©Œ.h
"

39 
	~"d–l-ba£-commÚ.h
"

40 
	~"d–l-ba£-if-phy.h
"

41 
	~"d–l-ba£-if.h
"

42 
	~"ŸÇ-if-ty³.h
"

43 
	~"d–l-ba£-if-lšux.h
"

44 
	~"d–l-š‹rçû.h
"

45 
	~"Çs_lšux_l2.h
"

47 
	~"ıs_şass_m­.h
"

48 
	~"ıs_­i_objeù_key.h
"

49 
	~"ıs_­i_İ”©iÚ.h
"

50 
	~"ıs_­i_db_š‹rçû.h
"

52 
	~"ev’t_log.h
"

53 
	~"¡d_uts.h
"

54 
	~"Çs_ndi_pÜt.h
"

55 
	~"Çs_sw™ch.h
"

56 
	~"Çs_št_com_uts.h
"

57 
	~"ıs_­i_objeù_toŞs.h
"

59 
	~<š‰y³s.h
>

60 
	~<unÜd”ed_m­
>

61 
	~<li¡
>

63 
	s_Åu_pÜt_t
 {

64 
ušt_t
 
	mÅu_id
;

65 
ušt_t
 
	mÅu_pÜt
;

67 
boŞ
 
	mİ”©Ü
=ğ(cÚ¡ 
_Åu_pÜt_t
& 
p
) const {

68  
Åu_id
 =ğ
p
.Åu_id && 
Åu_pÜt
 ==….npu_port;

72 
	s_Åu_pÜt_hash_t
 {

73 
	m¡d
::
size_t
 
İ”©Ü
(è(cÚ¡ 
_Åu_pÜt_t
& 
p
) const {

74  
¡d
::
hash
<>()(
p
.
Åu_id
è^ (¡d::hash<>()Õ.
Åu_pÜt
) << 1);

78 
	s_pÜt_ÿche
 {

79 
ušt32_t
 
	mmode
;

80 
ušt32_t
 
	mmedŸ_ty³
;

81 
BASE_IF_SUPPORTED_AUTONEG_t
 
	msuµÜ‹d_autÚeg
;

82 
BASE_IF_SPEED_t
 
	mcÚfigu»d_¥“d
 = 
BASE_IF_SPEED_0MBPS
;

83 
BASE_CMN_FEC_TYPE_t
 
	mãc_mode
;

84 
BASE_CMN_FILTER_TYPE_t
 
	mvÏn_f‹r_ty³
;

86 
_pÜt_ÿche
(è: 
mode
Ğ
BASE_IF_MODE_MODE_NONE
),

87 
medŸ_ty³
(
PLATFORM_MEDIA_TYPE_AR_POPTICS_NOTPRESENT
),

88 
suµÜ‹d_autÚeg
(
BASE_IF_SUPPORTED_AUTONEG_NOT_SUPPORTED
),

89 
ãc_mode
(
BASE_CMN_FEC_TYPE_OFF
),

90 
vÏn_f‹r_ty³
(
BASE_CMN_FILTER_TYPE_ENABLE
){}

93 
usšg
 
	gNasLogiÿlPÜtM­
 = 
¡d
::
unÜd”ed_m­
<
_Åu_pÜt_t
, 
	g_pÜt_ÿche
, 
	g_Åu_pÜt_hash_t
>;

94 
NasLogiÿlPÜtM­
 
	g_logiÿl_pÜt_tbl
;

95 
¡d_rw_lock_t
 
	g_logiÿl_pÜt_lock
;

97 autØ
	g_”rÜ_¡ršg_m­_bË
 = 
Ãw
 
¡d
::
unÜd”ed_m­
<, 
	g¡d
::
¡ršg
>

102 {
e_¡d_”r_code_CFG
, "Configuration Failure"},

103 {
	ge_¡d_”r_code_PARAM
, "Invalid Input Paramter"},

104 {
	ge_¡d_”r_code_NOMEM
, "No Memory"},

105 {
	ge_¡d_”r_code_NORESOURCE
, "No more„esource"},

106 {
	ge_¡d_”r_code_NOTSUPPORTED
, "Operation‚ot supported"}

110 
£t_ıs_obj_»tuº_©Œs
(
ıs_­i_objeù_t
 
obj
, 
t_¡d_”rÜ
 
rc
,

111 
ıs_­i_©Œ_id_t
 
©Œ
);

113 
t_¡d_”rÜ
 
	$_logiÿl_pÜt_tbl_d–‘e
(
Åu_id_t
 
Åu
,
pÜt_t
 
pÜt
){

114 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

115 
¡d_rw_lock_wr™e_gu¬d
 
	`g
(&
_logiÿl_pÜt_lock
);

116 autØ
™
 = 
_logiÿl_pÜt_tbl
.
	`fšd
(
Åu_pÜt
);

117 ià(
™
 =ğ
_logiÿl_pÜt_tbl
.
	`’d
()) {

118  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

120 
_logiÿl_pÜt_tbl
.
	`”a£
(
™
);

122  
STD_ERR_OK
;

123 
	}
}

125 
t_¡d_”rÜ
 
	$Çs_pÜt_ãc_g‘
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
BASE_CMN_FEC_TYPE_t
 *
ãc_mode
)

127 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

128 
¡d_rw_lock_»ad_gu¬d
 
	`g
(&
_logiÿl_pÜt_lock
);

129 autØ
™
 = 
_logiÿl_pÜt_tbl
.
	`fšd
(
Åu_pÜt
);

130 ià(
™
 !ğ
_logiÿl_pÜt_tbl
.
	`’d
()) {

131 *
ãc_mode
 = (
BASE_CMN_FEC_TYPE_t
è
™
->
£cÚd
.fec_mode;

132  
STD_ERR_OK
;

134  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

135 
	}
}

137 
t_¡d_”rÜ
 
	$Çs_pÜt_ãc_£t
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
BASE_CMN_FEC_TYPE_t
 
ãc_mode
)

139 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

140 
¡d_rw_lock_wr™e_gu¬d
 
	`g
(&
_logiÿl_pÜt_lock
);

141 
_logiÿl_pÜt_tbl
[
Åu_pÜt
].
ãc_mode
 = fec_mode;

142  
STD_ERR_OK
;

143 
	}
}

145 
t_¡d_”rÜ
 
	$Çs_pÜt_vÏn_f‹r_g‘
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
BASE_CMN_FILTER_TYPE_t
 *
f‹r_ty³
)

147 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

148 
¡d_rw_lock_»ad_gu¬d
 
	`g
(&
_logiÿl_pÜt_lock
);

149 autØ
™
 = 
_logiÿl_pÜt_tbl
.
	`fšd
(
Åu_pÜt
);

150 ià(
™
 !ğ
_logiÿl_pÜt_tbl
.
	`’d
()) {

151 *
f‹r_ty³
 = (
BASE_CMN_FILTER_TYPE_t
è
™
->
£cÚd
.
vÏn_f‹r_ty³
;

152  
STD_ERR_OK
;

154  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

155 
	}
}

157 
t_¡d_”rÜ
 
	$Çs_pÜt_vÏn_f‹r_£t
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
BASE_CMN_FILTER_TYPE_t
 
f‹r_ty³
)

159 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

160 
¡d_rw_lock_wr™e_gu¬d
 
	`g
(&
_logiÿl_pÜt_lock
);

161 
_logiÿl_pÜt_tbl
[
Åu_pÜt
].
vÏn_f‹r_ty³
 = 
f‹r_ty³
;

162  
STD_ERR_OK
;

163 
	}
}

166 
boŞ
 
	$if_d©a_äom_obj
(
obj_štf_ÿt_t
 
obj_ÿt
, 
ıs_­i_objeù_t
 
o
, 
š‹rçû_ù¾_t
& 
i
) {

167 
ıs_­i_objeù_©Œ_t
 
_Çme
 = 
	`ıs_­i_g‘_key_d©a
(
o
,(
obj_ÿt
 =ğ
obj_INTF
) ?

168 (
ušt
)
IF_INTERFACES_INTERFACE_NAME
:

169 (
ušt
)
IF_INTERFACES_STATE_INTERFACE_NAME
);

170 
ıs_­i_objeù_©Œ_t
 
_ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
o
,(
obj_ÿt
 =ğ
obj_INTF
) ?

171 (
ušt
)
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
:

172 (
ušt
)
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
);

175 
ıs_­i_objeù_©Œ_t
 
_Åu
 = 
nuÎ±r
;

176 
ıs_­i_objeù_©Œ_t
 
_pÜt
 = 
nuÎ±r
;

178 ià(
obj_ÿt
 =ğ
obj_INTF
) {

179 
_Åu
 = 
	`ıs_­i_objeù_©Œ_g‘
(
o
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
);

180 
_pÜt
 = 
	`ıs_­i_objeù_©Œ_g‘
(
o
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
);

183 ià(
_ifix
!=
nuÎ±r
) {

184 
	`mem£t
(&
i
,0,(i));

185 
i
.
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_ifix
);

186 
i
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

187 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
i
)==
STD_ERR_OK
è 
Œue
;

190 ià(
_Çme
!=
nuÎ±r
) {

191 
	`mem£t
(&
i
,0,(i));

192 
	`¡ºıy
(
i
.
if_Çme
,(cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_Çme
),(i.if_name)-1);

193 
i
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

194 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
i
)==
STD_ERR_OK
è 
Œue
;

197 ià(
_Åu
!=
nuÎ±r
 && 
_pÜt
!=nullptr &&

198 
	`ıs_­i_objeù_©Œ_Ën
(
_Åu
è> 0 && cps_­i_objeù_©Œ_Ën(
_pÜt
) > 0) {

199 
	`mem£t
(&
i
,0,(i));

200 
i
.
Åu_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_Åu
);

201 
i
.
pÜt_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_pÜt
);

202 
i
.
q_ty³
 = 
HAL_INTF_INFO_FROM_PORT
;

203 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
i
)==
STD_ERR_OK
è 
Œue
;

206 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"IF-CPS-CREATE","Invalid fields - can't†ocate specified…ort");

207  
çl£
;

208 
	}
}

210 
h®_ifšdex_t
 
	$Çs_št_ifšdex_äom_pÜt
(
Åu_id_t
 
Åu
,
pÜt_t
 
pÜt
) {

211 
š‹rçû_ù¾_t
 
šfo
;

212 
	`mem£t
(&
šfo
,0,(info));

213 
šfo
.
Åu_id
 = 
Åu
;

214 
šfo
.
pÜt_id
 = 
pÜt
;

215 
šfo
.
q_ty³
 = 
HAL_INTF_INFO_FROM_PORT
;

216 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
šfo
)!=
STD_ERR_OK
) {

219  
šfo
.
if_šdex
;

220 
	}
}

222 
h®_ifšdex_t
 
	$Çs_št_ifšdex_äom_Çme
(cÚ¡ *
Çme
)

224 
š‹rçû_ù¾_t
 
šfo
;

225 
	`mem£t
(&
šfo
, 0, (info));

226 
	`¡ºıy
(
šfo
.
if_Çme
, 
Çme
, (info.if_name) - 1);

227 
šfo
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

228 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
šfo
)!=
STD_ERR_OK
) {

231  
šfo
.
if_šdex
;

232 
	}
}

234 
	$_if_fl_š_suµÜ‹d_autÚeg_©Œ
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

235 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

236 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_SUPPORTED_AUTONEG
, 
_logiÿl_pÜt_tbl
[
Åu_pÜt
].
suµÜ‹d_autÚeg
);

237 
	}
}

239 
	$_if_fl_š_Åu_¥“d_©Œ
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
Çs_št_ty³_t
 
št_ty³
,

240 
ıs_­i_objeù_t
 
obj
) {

242 
BASE_IF_SPEED_t
 
¥“d
;

243 ià(
št_ty³
 =ğ
Çs_št_ty³_FC
) {

244 ià(
	`ndi_pÜt_¥“d_g‘_nocheck
(
Åu
,
pÜt
,&
¥“d
è=ğ
STD_ERR_OK
) {

245 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_STATE_INTERFACE_NPU_SPEED
, 
¥“d
);

248 
	}
}

250 
	$_if_fl_š_max_¥“d_©Œ
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
)

252 
BASE_IF_SPEED_t
 
¥“d
;

253 ià(
	`Çs_št_g‘_phy_¥“d
(
Åu
, 
pÜt
, &
¥“d
è=ğ
STD_ERR_OK
) {

254 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_MAX_SPEED
, 
¥“d
);

256 
	}
}

258 
	$_if_fl_š_suµÜ‹d_¥“ds_©Œs
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
Çs_št_ty³_t
 
št_ty³
,

259 
ıs_­i_objeù_t
 
obj
) {

261 
size_t
 
¥“d_couÁ
 = 
NDI_PORT_SUPPORTED_SPEED_MAX
;

262 
BASE_IF_SPEED_t
 
¥“d_li¡
[
NDI_PORT_SUPPORTED_SPEED_MAX
];

263 ià(
št_ty³
 =ğ
Çs_št_ty³_FC
) {

264 
	`Çs_fc_fl_suµÜ‹d_¥“d
(
Åu
, 
pÜt
, 
obj
);

267 ià(
	`ndi_pÜt_suµÜ‹d_¥“d_g‘
(
Åu
,
pÜt
,&
¥“d_couÁ
, 
¥“d_li¡
è=ğ
STD_ERR_OK
) {

268 
size_t
 
mx
 = 
¥“d_couÁ
;

269 
size_t
 
ix
 =0;ix < 
mx
; ix++) {

270 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_STATE_INTERFACE_SUPPORTED_SPEED
, 
¥“d_li¡
[
ix
]);

273 
	}
}

279 
	$_if_fl_š_“e_©Œs
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
)

281 
ušt_t
 
¡©e
;

282 
ušt16_t
 
wake_time
, 
idË_time
;

284 ià((
	`ndi_pÜt_“e_g‘
(
Åu
, 
pÜt
, &
¡©e
è=ğ
STD_ERR_OK
)

285 && (
	`ndi_pÜt_“e_g‘_wake_time
(
Åu
, 
pÜt
, &
wake_time
è=ğ
STD_ERR_OK
)

286 && (
	`ndi_pÜt_“e_g‘_idË_time
(
Åu
, 
pÜt
, &
idË_time
è=ğ
STD_ERR_OK
)) {

287 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,

288 
DELL_IF_IF_INTERFACES_INTERFACE_EEE
, 
¡©e
);

289 
	`ıs_­i_objeù_©Œ_add_u16
(
obj
,

290 
DELL_IF_IF_INTERFACES_INTERFACE_TX_WAKE_TIME
,

291 
wake_time
);

292 
	`ıs_­i_objeù_©Œ_add_u16
(
obj
,

293 
DELL_IF_IF_INTERFACES_INTERFACE_TX_IDLE_TIME
,

294 
idË_time
);

296 
	}
}

298 
	#SPEED_1MBPS
 (1000*1000)

	)

299 
	#SPEED_1GIGE
 (
ušt64_t
)(1000*1000*1000)

	)

300 
	g¡d
::
unÜd”ed_m­
<
BASE_IF_SPEED_t
, 
	gušt64_t
 ,¡d::
hash
<>>

301 
_ba£_to_›tf64b™_¥“d
 = {

302 {
BASE_IF_SPEED_0MBPS
, 0},

303 {
BASE_IF_SPEED_10MBPS
, 10*
SPEED_1MBPS
},

304 {
BASE_IF_SPEED_100MBPS
, 100*
SPEED_1MBPS
},

305 {
BASE_IF_SPEED_1GIGE
, 1*
SPEED_1GIGE
},

306 {
BASE_IF_SPEED_10GIGE
, 10*
SPEED_1GIGE
},

307 {
BASE_IF_SPEED_20GIGE
, 20*
SPEED_1GIGE
},

308 {
BASE_IF_SPEED_25GIGE
, 25*
SPEED_1GIGE
},

309 {
BASE_IF_SPEED_40GIGE
, 40*
SPEED_1GIGE
},

310 {
BASE_IF_SPEED_50GIGE
, 50*
SPEED_1GIGE
},

311 {
BASE_IF_SPEED_100GIGE
, 100*
SPEED_1GIGE
},

314 
boŞ
 
	$Çs_ba£_to_›tf_¡©e_¥“d
(
BASE_IF_SPEED_t
 
¥“d
, 
ušt64_t
 *
›tf_¥“d
) {

315 autØ
™
 = 
_ba£_to_›tf64b™_¥“d
.
	`fšd
(
¥“d
);

316 ià(
™
 !ğ
_ba£_to_›tf64b™_¥“d
.
	`’d
()) {

317 *
›tf_¥“d
 = 
™
->
£cÚd
;

318  
Œue
;

320  
çl£
;

321 
	}
}

323 
	$_if_fl_š_¥“d_du¶ex_autÚeg_¡©e_©Œs
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

324 
BASE_IF_SPEED_t
 
¥“d
;

325 ià(
	`ndi_pÜt_¥“d_g‘
(
Åu
,
pÜt
,&
¥“d
)==
STD_ERR_OK
) {

326 
ušt64_t
 
›tf_¥“d
;

327 ià(
	`Çs_ba£_to_›tf_¡©e_¥“d
(
¥“d
, &
›tf_¥“d
)) {

328 
	`ıs_­i_objeù_©Œ_add_u64
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_SPEED
,
›tf_¥“d
);

330 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT", "¥“d R—dƒ¼Ü <%d %d> s³ed %d ",
Åu
, 
pÜt
, 
¥“d
);

333 
BASE_CMN_DUPLEX_TYPE_t
 
du¶ex
;

334 ià(
	`ndi_pÜt_du¶ex_g‘
(
Åu
,
pÜt
,&
du¶ex
)==
STD_ERR_OK
) {

335 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_STATE_INTERFACE_DUPLEX
, 
du¶ex
);

337 
boŞ
 
auto_Ãg
;

338 ià(
	`ndi_pÜt_auto_Ãg_g‘
(
Åu
, 
pÜt
, &
auto_Ãg
è=ğ
STD_ERR_OK
) {

339 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_AUTO_NEGOTIATION
, 
auto_Ãg
);

342 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_TYPE
,

343 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
,

344 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
));

345 
	}
}

347 
	$_if_fl_š_¥“d_du¶ex_©Œs
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

349 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

350 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_SPEED
,

351 
_logiÿl_pÜt_tbl
[
Åu_pÜt
].
cÚfigu»d_¥“d
);

353 
BASE_CMN_DUPLEX_TYPE_t
 
du¶ex
;

354 ià(
	`ndi_pÜt_du¶ex_g‘
(
Åu
,
pÜt
,&
du¶ex
)==
STD_ERR_OK
) {

355 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_DUPLEX
, 
du¶ex
);

357 
	}
}

359 
ıs_­i_»tuº_code_t
 
	$_if_fl_š_Åu_©Œs
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,

360 
Çs_št_ty³_t
 
št_ty³
, 
ıs_­i_objeù_t
 
obj
) {

361 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_t
 
¡©e
;

362 ià(
	`ndi_pÜt_admš_¡©e_g‘
(
Åu
,
pÜt
,&
¡©e
)==
STD_ERR_OK
) {

363 
	`ıs_­i_objeù_©Œ_d–‘e
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
);

364 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
,

365 ((
¡©e
 =ğ
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_UP
è? 
Œue
 : 
çl£
));

368 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_TAGGING_MODE_t
 
mode
;

369 ià(
	`ndi_pÜt_g‘_uÁagged_pÜt_©Œib
(
Åu
,
pÜt
,&
mode
)==
STD_ERR_OK
) {

370 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_TAGGING_MODE
,
mode
);

373 
boŞ
 
auto_Ãg
;

374 ià(
	`ndi_pÜt_auto_Ãg_g‘
(
Åu
, 
pÜt
, &
auto_Ãg
è=ğ
STD_ERR_OK
) {

375 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_AUTO_NEGOTIATION
, 
auto_Ãg
);

378 
BASE_IF_PHY_MAC_LEARN_MODE_t
 
Ë¬n_mode
;

379 ià(
	`ndi_pÜt_mac_Ë¬n_mode_g‘
(
Åu
, 
pÜt
, &
Ë¬n_mode
è=ğ
STD_ERR_OK
) {

380 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_LEARN_MODE
, 
Ë¬n_mode
);

383 
BASE_CMN_FEC_TYPE_t
 
ãc_mode
;

384 ià(
STD_ERR_OK
 =ğ
	`Çs_pÜt_ãc_g‘
(
Åu
, 
pÜt
, &
ãc_mode
)) {

385 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_FEC
, 
ãc_mode
);

388 
ušt32_t
 
oui
;

389 ià(
	`ndi_pÜt_oui_g‘
(
Åu
, 
pÜt
, &
oui
è=ğ
STD_ERR_OK
) {

390 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_OUI
, 
oui
);

393 
BASE_CMN_FILTER_TYPE_t
 
f‹r_mode
;

394 ià(
STD_ERR_OK
 =ğ
	`Çs_pÜt_vÏn_f‹r_g‘
(
Åu
, 
pÜt
, &
f‹r_mode
)) {

395 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_VLAN_FILTER
, 
f‹r_mode
);

398 
	`_if_fl_š_¥“d_du¶ex_©Œs
(
Åu
,
pÜt
, 
obj
);

399 
	`_if_fl_š_“e_©Œs
(
Åu
, 
pÜt
, 
obj
);

401  
ıs_­i_»t_code_OK
;

402 
	}
}

404 
ıs_­i_»tuº_code_t
 
	$_if_g‘_´ev_äom_ÿche
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,

405 
ıs_­i_objeù_t
 
obj
) {

407 
ıs_­i_objeù_li¡_gu¬d
 
	`lg
(
	`ıs_­i_objeù_li¡_ü—‹
());

408 ià(
lg
.
	`g‘
()==
nuÎ±r
) {

409  
ıs_­i_»t_code_ERR
;

412 ià(
	`Çs_os_g‘_š‹rçû
(
obj
,
lg
.
	`g‘
())!=
STD_ERR_OK
) {

413  
ıs_­i_»t_code_ERR
;

416 
ıs_­i_objeù_t
 
os_if
 = 
	`ıs_­i_objeù_li¡_g‘
(
lg
.
	`g‘
(),0);

418 ià(
	`ıs_­i_objeù_li¡_size
(
lg
.
	`g‘
())!=1 || 
os_if
==
nuÎ±r
) {

419 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT-GET", "FaedØg‘ iÁ”çû infØäom OS fÜ‚pu %d…Üˆ%d ", 
Åu
, 
pÜt
);

421 
	`ıs_­i_objeù_şÚe
(
obj
,
os_if
);

423  
	`_if_fl_š_Åu_©Œs
(
Åu
,
pÜt
,
Çs_št_ty³_PORT
, 
obj
);

424 
	}
}

426 
ıs_­i_»tuº_code_t
 
	$if_ıu_pÜt_g‘
 (* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

427 
size_t
 
key_ix
) {

429 
Åu_id_t
 
Åu
 = 0;

430 
Åu_id_t
 
Åu_max
 = (Åu_id_t)
	`Çs_sw™ch_g‘_max_Åus
();

431 
š‹rçû_ù¾_t
 
_pÜt
;

433 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT-GET", "GET„equest„eceived for CPU…ort interface");

434  ; 
Åu
 < 
Åu_max
 ; ++npu ) {

435 
	`mem£t
(&
_pÜt
,0,(_port));

436 
_pÜt
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

437 
	`¢´štf
(
_pÜt
.
if_Çme
,(_pÜt.if_Çme),"Åu-%d",
Åu
);

438 if(
	`dn_h®_g‘_š‹rçû_šfo
(&
_pÜt
è!=
STD_ERR_OK
) {

441 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
·¿m
->
li¡
);

442 ià(
obj
==
NULL
è 
ıs_­i_»t_code_ERR
;

444 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
), 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

445 
ıs_­i_qu®if›r_TARGET
);

446 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
,

447 
ıs_­i_objeù_ATTR_T_BIN
, 
_pÜt
.
if_Çme
, 
	`¡¾’
(_port.if_name)+1);

448 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

449 
_pÜt
.
if_šdex
);

450 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

451 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_BASE_IF_CPU
,

452 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_BASE_IF_CPU
)+1);

454  
ıs_­i_»t_code_OK
;

455 
	}
}

457 
ıs_­i_»tuº_code_t
 
	$if_ıu_pÜt_£t
(* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,
size_t
 
ix
) {

459 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS_CPU","Set command for CPU…ort is‚ot supported");

460  
ıs_­i_»t_code_ERR
;

461 
	}
}

463 
ıs_­i_»tuº_code_t
 
	$if_g‘
 (* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

464 
size_t
 
key_ix
) {

466 
ıs_­i_objeù_t
 
ft
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
key_ix
);

467 
ıs_­i_objeù_©Œ_t
 
ty³_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
, 
IF_INTERFACES_INTERFACE_TYPE
);

468 
	`EV_LOG
(
INFO
,
INTERFACE
,3,"NAS-INT-GET", "GET„equest„eceived for…hysical interface");

470 *
»q_if_ty³
 = 
NULL
;

471 
boŞ
 
have_ty³_f‹r
 = 
çl£
;

472 ià(
ty³_©Œ
 !ğ
nuÎ±r
) {

473 
»q_if_ty³
 = (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
ty³_©Œ
);

474 
have_ty³_f‹r
 = 
Œue
;

477 
ıs_­i_objeù_©Œ_t
 
ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
,

478 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

479 
ıs_­i_objeù_©Œ_t
 
Çme
 = 
	`ıs_­i_g‘_key_d©a
(
ft
,
IF_INTERFACES_INTERFACE_NAME
);

481 ià(
ifix
 =ğ
nuÎ±r
 && 
Çme
 !ğ
NULL
) {

482 
š‹rçû_ù¾_t
 
_pÜt
;

483 ià(!
	`if_d©a_äom_obj
(
obj_INTF
, 
ft
,
_pÜt
)) {

484 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-GET", "WrÚg iÁ”çû‚amÜ iÁ”çû‚Ù…»£Á %s",
_pÜt
.
if_Çme
);

485  
ıs_­i_»t_code_ERR
;

487 
	`ıs_­i_objeù_©Œ_add_u32
(
ft
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

488 
_pÜt
.
if_šdex
);

491 ià(
	`Çs_os_g‘_š‹rçû
(
ft
,
·¿m
->
li¡
)!=
STD_ERR_OK
) {

492 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-GET", "Failedo get interfaces from OS");

493  
ıs_­i_»t_code_ERR
;

495 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
·¿m
->
li¡
);

496 
if_ty³
[256];

497 
size_t
 
ix
 = 0;

498 
ix
 < 
mx
) {

499 
ıs_­i_objeù_t
 
objeù
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
li¡
,
ix
);

500 
ıs_­i_objeù_©Œ_t
 
ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
objeù
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

501 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
objeù
), 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

502 
ıs_­i_qu®if›r_TARGET
);

503 
š‹rçû_ù¾_t
 
_pÜt
;

504 ià(
ifix
 !ğ
nuÎ±r
) {

505 
	`mem£t
(&
_pÜt
,0,(_port));

506 
_pÜt
.
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
ifix
);

507 
_pÜt
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

508 if(
	`dn_h®_g‘_š‹rçû_šfo
(&
_pÜt
)==
STD_ERR_OK
) {

509 ià(!
	`Çs_to_›tf_if_ty³_g‘
(
_pÜt
.
št_ty³
, 
if_ty³
, (if_type))) {

510 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-GET", "Failedo get IETF interfaceype forype id %d",

511 
_pÜt
.
št_ty³
);

512  
ıs_­i_»t_code_ERR
;

515 ià(
have_ty³_f‹r
) {

516 if(
	`¡ºcmp
(
if_ty³
,
»q_if_ty³
, (if_type)) != 0) {

517 
	`ıs_­i_objeù_li¡_»move
(
·¿m
->
li¡
,
ix
);

518 
	`ıs_­i_objeù_d–‘e
(
objeù
);

519 --
mx
;

524 
	`ıs_­i_objeù_©Œ_add
(
objeù
,
IF_INTERFACES_INTERFACE_TYPE
,

525 (cÚ¡ *)
if_ty³
, 
	`¡¾’
(if_type)+1);

527 ià(
_pÜt
.
pÜt_m­³d
) {

528 
	`ıs_­i_objeù_©Œ_add_u32
(
objeù
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
,
_pÜt
.
Åu_id
);

529 
	`ıs_­i_objeù_©Œ_add_u32
(
objeù
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
,
_pÜt
.
pÜt_id
);

530 ià(
_pÜt
.
št_ty³
 =ğ
Çs_št_ty³_FC
) {

531 
	`Çs_fc_fl_štf_©Œ
(
_pÜt
.
Åu_id
, _pÜt.
pÜt_id
, 
objeù
);

533 
	`_if_fl_š_Åu_©Œs
(
_pÜt
.
Åu_id
, _pÜt.
pÜt_id
, _pÜt.
št_ty³
, 
objeù
);

537 ià(
_pÜt
.
desc
) {

538 
	`ıs_­i_objeù_©Œ_add
(
objeù
, 
IF_INTERFACES_INTERFACE_DESCRIPTION
,

539 (cÚ¡ *)
_pÜt
.
desc
, 
	`¡¾’
(_port.desc) + 1);

542 
ifix
 = 
nuÎ±r
;

545 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-GET", "Ifindex‚ot found in object");

547 ià(
ifix
 !ğ
nuÎ±r
 && 
_pÜt
.
pÜt_m­³d
) {

548 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
_pÜt
.
Åu_id
, (ušt_t)_pÜt.
pÜt_id
};

549 
¡d_rw_lock_»ad_gu¬d
 
	`g
(&
_logiÿl_pÜt_lock
);

550 autØ
™
 = 
_logiÿl_pÜt_tbl
.
	`fšd
(
Åu_pÜt
);

551 ià(
™
 !ğ
_logiÿl_pÜt_tbl
.
	`’d
()) {

552 
	`ıs_­i_objeù_©Œ_add_u32
(
objeù
, 
DELL_IF_IF_INTERFACES_INTERFACE_MODE
,

553 
™
->
£cÚd
.
mode
);

554 
	`ıs_­i_objeù_©Œ_add_u32
(
objeù
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PHY_MEDIA
,

555 
™
->
£cÚd
.
medŸ_ty³
);

558 ià(
ifix
==
nuÎ±r
) {

559 
	`ıs_­i_objeù_li¡_»move
(
·¿m
->
li¡
,
ix
);

560 
	`ıs_­i_objeù_d–‘e
(
objeù
);

561 --
mx
;

564 ++
ix
;

567  
ıs_­i_»t_code_OK
;

568 
	}
}

570 
	$_if_fl_š_Åu_štf_¡©e
(
Åu_id_t
 
Åu_id
, 
Åu_pÜt_t
 
pÜt_id
, 
Çs_št_ty³_t
 
št_ty³
,

571 
ıs_­i_objeù_t
 
obj
)

573 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

574 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_t
 
¡©e
;

575 ià(
	`ndi_pÜt_admš_¡©e_g‘
(
Åu_id
,
pÜt_id
,&
¡©e
)==
STD_ERR_OK
) {

576 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
,
¡©e
);

578 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
İ”_¡©e
;

579 
ndi_štf_lšk_¡©e_t
 
lšk_¡©e
;

580 
rc
 = 
	`ndi_pÜt_lšk_¡©e_g‘
(
Åu_id
,
pÜt_id
,&
lšk_¡©e
);

581 ià(
rc
==
STD_ERR_OK
) {

582 
İ”_¡©e
 = 
	`ndi_to_ıs_İ”_ty³
(
lšk_¡©e
.
İ”_¡©us
);

583 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
,
İ”_¡©e
);

586 
BASE_CMN_FEC_TYPE_t
 
ãc_cÚfigu»d
;

587 ià(
	`Çs_pÜt_ãc_g‘
(
Åu_id
, 
pÜt_id
, &
ãc_cÚfigu»d
è=ğ
STD_ERR_OK
) {

588 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_CONFIGURED_FEC
, 
ãc_cÚfigu»d
);

591 
BASE_CMN_FEC_TYPE_t
 
ãc_ob£rved
;

592 ià(
	`ndi_pÜt_ãc_g‘
(
Åu_id
, 
pÜt_id
, &
ãc_ob£rved
è=ğ
STD_ERR_OK
) {

593 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_FEC
, 
ãc_ob£rved
);

596 
BASE_CMN_FILTER_TYPE_t
 
vÏn_f‹r_ob£rved
;

597 ià(
	`ndi_pÜt_vÏn_f‹r_g‘
 (
Åu_id
, 
pÜt_id
, &
vÏn_f‹r_ob£rved
è=ğ
STD_ERR_OK
) {

598 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_VLAN_FILTER
,

599 
vÏn_f‹r_ob£rved
);

602 
ušt32_t
 
oui
;

603 ià(
	`ndi_pÜt_oui_g‘
(
Åu_id
, 
pÜt_id
, &
oui
è=ğ
STD_ERR_OK
) {

604 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_OUI
, 
oui
);

607 ià(
št_ty³
 =ğ
Çs_št_ty³_FC
) {

608 
	`Çs_fc_fl_¥“d_autÚeg_¡©e
(
Åu_id
, 
pÜt_id
, 
obj
);

609 
	`Çs_fc_fl_misc_¡©e
(
Åu_id
, 
pÜt_id
, 
obj
);

611 
	`_if_fl_š_¥“d_du¶ex_autÚeg_¡©e_©Œs
(
Åu_id
,
pÜt_id
,
obj
);

613 
	}
}

616 
ıs_­i_»tuº_code_t
 
	$if_¡©e_g‘
 (* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

617 
size_t
 
key_ix
) {

619 
ıs_­i_objeù_t
 
ft
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
key_ix
);

620 
ıs_­i_objeù_©Œ_t
 
ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
, 
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
);

621 
ıs_­i_objeù_©Œ_t
 
Çme
 = 
	`ıs_­i_g‘_key_d©a
(
ft
,
IF_INTERFACES_STATE_INTERFACE_NAME
);

623 ià(
ifix
 !ğ
nuÎ±r
) {

625 
	`ıs_­i_objeù_©Œ_add_u32
(
ft
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

626 
	`ıs_­i_objeù_©Œ_d©a_u32
(
ifix
));

627 
	`ıs_­i_objeù_©Œ_d–‘e
(
ft
,
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
);

629 ià(
ifix
 =ğ
nuÎ±r
 && 
Çme
 !ğ
NULL
) {

630 
š‹rçû_ù¾_t
 
_pÜt
;

631 ià(!
	`if_d©a_äom_obj
(
obj_INTF_STATE
, 
ft
,
_pÜt
)) {

632 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-GET", "WrÚg iÁ”çû‚amÜ iÁ”çû‚Ù…»£Á %s",
_pÜt
.
if_Çme
);

633  
ıs_­i_»t_code_ERR
;

635 
	`ıs_­i_objeù_©Œ_add_u32
(
ft
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

636 
_pÜt
.
if_šdex
);

640 
ıs_­i_objeù_©Œ_t
 
ty³_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
, 
IF_INTERFACES_STATE_INTERFACE_TYPE
);

642 *
»q_if_ty³
 = 
NULL
;

643 
boŞ
 
have_ty³_f‹r
 = 
çl£
;

644 ià(
ty³_©Œ
 !ğ
nuÎ±r
) {

645 
»q_if_ty³
 = (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
ty³_©Œ
);

646 
have_ty³_f‹r
 = 
Œue
;

649 ià(
	`Çs_os_g‘_š‹rçû
(
ft
,
·¿m
->
li¡
)!=
STD_ERR_OK
) {

650  
ıs_­i_»t_code_ERR
;

652 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
·¿m
->
li¡
);

653 
if_ty³
[256];

654 
size_t
 
ix
 = 0;

655 
ix
 < 
mx
) {

656 
ıs_­i_objeù_t
 
objeù
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
li¡
,
ix
);

657 
ıs_­i_objeù_©Œ_t
 
ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
objeù
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

658 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
objeù
), 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
,

659 
ıs_­i_qu®if›r_OBSERVED
);

661 
š‹rçû_ù¾_t
 
_pÜt
;

662 
	`mem£t
(&
_pÜt
,0,(_port));

663 ià(
ifix
!=
NULL
) {

664 
_pÜt
.
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
ifix
);

665 
_pÜt
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

666 if(
	`dn_h®_g‘_š‹rçû_šfo
(&
_pÜt
)==
STD_ERR_OK
) {

667 ià(!
	`Çs_to_›tf_if_ty³_g‘
(
_pÜt
.
št_ty³
, 
if_ty³
, (if_type))) {

668 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-GET", "Failedo get IETF interfaceype forype id %d",

669 
_pÜt
.
št_ty³
);

670  
ıs_­i_»t_code_ERR
;

673 ià(
have_ty³_f‹r
) {

674 if(
	`¡ºcmp
(
if_ty³
,
»q_if_ty³
, (if_type)) != 0) {

675 
	`ıs_­i_objeù_li¡_»move
(
·¿m
->
li¡
,
ix
);

676 
	`ıs_­i_objeù_d–‘e
(
objeù
);

677 --
mx
;

681 
	`ıs_­i_£t_key_d©a
(
objeù
,
IF_INTERFACES_STATE_INTERFACE_NAME
,

682 
ıs_­i_objeù_ATTR_T_BIN
, 
_pÜt
.
if_Çme
, 
	`¡¾’
(_port.if_name)+1);

683 ià(
_pÜt
.
pÜt_m­³d
) {

684 
	`_if_fl_š_Åu_štf_¡©e
(
_pÜt
.
Åu_id
, _pÜt.
pÜt_id
, _pÜt.
št_ty³
, 
objeù
);

685 
	`_if_fl_š_suµÜ‹d_¥“ds_©Œs
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
, _pÜt.
št_ty³
, 
objeù
);

686 
	`_if_fl_š_“e_©Œs
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
,
objeù
);

687 
	`_if_fl_š_Åu_¥“d_©Œ
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
, _pÜt.
št_ty³
, 
objeù
);

688 
	`_if_fl_š_suµÜ‹d_autÚeg_©Œ
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
, 
objeù
);

689 
	`_if_fl_š_max_¥“d_©Œ
(
_pÜt
.
Åu_id
, _pÜt.
pÜt_id
, 
objeù
);

692 
	`ıs_­i_objeù_©Œ_add_u32
(
objeù
,
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
,

693 
_pÜt
.
if_šdex
);

694 
	`ıs_­i_objeù_©Œ_d–‘e
(
objeù
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

695 
	`ıs_­i_objeù_©Œ_d–‘e
(
objeù
, 
IF_INTERFACES_INTERFACE_NAME
);

696 
	`ıs_­i_objeù_©Œ_add
(
objeù
,
IF_INTERFACES_STATE_INTERFACE_TYPE
,

697 (cÚ¡ *)
if_ty³
, 
	`¡¾’
(if_type)+1);

700 
ifix
 = 
nuÎ±r
;

703 ià(
ifix
==
nuÎ±r
) {

704 
	`ıs_­i_objeù_li¡_»move
(
·¿m
->
li¡
,
ix
);

705 
	`ıs_­i_objeù_d–‘e
(
objeù
);

706 --
mx
;

709 ++
ix
;

712  
ıs_­i_»t_code_OK
;

713 
	}
}

715 
ıs_­i_»tuº_code_t
 
	$loİback_if_¡©e_£t
(* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,
size_t
 
ix
) {

718  
ıs_­i_»t_code_ERR
;

719 
	}
}

721 
ıs_­i_»tuº_code_t
 
	$loİback_if_¡©e_g‘
 (* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

722 
size_t
 
key_ix
) {

724 
ıs_­i_objeù_t
 
ft
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
key_ix
);

725 
ıs_­i_objeù_©Œ_t
 
ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
, 
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
);

726 
ıs_­i_objeù_©Œ_t
 
Çme
 = 
	`ıs_­i_g‘_key_d©a
(
ft
,
IF_INTERFACES_STATE_INTERFACE_NAME
);

727 
boŞ
 
if_ty³_added
 = 
çl£
;

729 ià(
ifix
 !ğ
nuÎ±r
) {

731 
	`ıs_­i_objeù_©Œ_add_u32
(
ft
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

732 
	`ıs_­i_objeù_©Œ_d©a_u32
(
ifix
));

733 
	`ıs_­i_objeù_©Œ_d–‘e
(
ft
,
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
);

736 ià(
ifix
 =ğ
nuÎ±r
 && 
Çme
 !ğ
NULL
) {

737 
š‹rçû_ù¾_t
 
_pÜt
;

738 ià(!
	`if_d©a_äom_obj
(
obj_INTF_STATE
, 
ft
,
_pÜt
)) {

739 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-GET", "WrÚg iÁ”çû‚amÜ iÁ”çû‚Ù…»£Á %s",
_pÜt
.
if_Çme
);

740  
ıs_­i_»t_code_ERR
;

742 
	`ıs_­i_objeù_©Œ_add_u32
(
ft
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

743 
_pÜt
.
if_šdex
);

744 } ià(
ifix
 =ğ
nuÎ±r
 && 
Çme
 ==‚ullptr) {

745 
	`ıs_­i_objeù_©Œ_add_u32
(
ft
, 
BASE_IF_LINUX_IF_INTERFACES_INTERFACE_DELL_TYPE
,

746 
BASE_CMN_INTERFACE_TYPE_LOOPBACK
);

747 
if_ty³_added
 = 
Œue
;

750 
t_¡d_”rÜ
 
rc
 = 
	`Çs_os_g‘_š‹rçû
(
ft
,
·¿m
->
li¡
);

752 ià(
if_ty³_added
) {

753 
	`ıs_­i_objeù_©Œ_d–‘e
(
ft
, 
BASE_IF_LINUX_IF_INTERFACES_INTERFACE_DELL_TYPE
);

756 ià(
rc
 !ğ
STD_ERR_OK
) {

757  
ıs_­i_»t_code_ERR
;

760 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
·¿m
->
li¡
);

761 
size_t
 
ix
 = 0;

763 
ix
 < 
mx
) {

764 
ıs_­i_objeù_t
 
objeù
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
li¡
,
ix
);

765 
ıs_­i_objeù_©Œ_t
 
ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
objeù
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

767 ià(
ifix
 =ğ
nuÎ±r
) {

768 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-GET", "Could‚Ù fšd ifšdex iÀobjeù %d", 
ix
);

769 
	`ıs_­i_objeù_li¡_»move
(
·¿m
->
li¡
, 
ix
);

770 
	`ıs_­i_objeù_d–‘e
(
objeù
);

771 --
mx
;

775 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
objeù
), 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

776 
ıs_­i_qu®if›r_OBSERVED
);

777 
š‹rçû_ù¾_t
 
_pÜt
;

778 
	`mem£t
(&
_pÜt
,0,(_port));

779 
_pÜt
.
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
ifix
);

780 
_pÜt
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

782 if(
	`dn_h®_g‘_š‹rçû_šfo
(&
_pÜt
è!ğ
STD_ERR_OK
) {

783 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-GET", "FaedØg‘„egi¡”ed infØfÜ ifšdex %d", 
_pÜt
.
if_šdex
);

784 
	`ıs_­i_objeù_li¡_»move
(
·¿m
->
li¡
, 
ix
);

785 
	`ıs_­i_objeù_d–‘e
(
objeù
);

786 --
mx
;

790 
	`ıs_­i_£t_key_d©a
(
objeù
,
IF_INTERFACES_STATE_INTERFACE_NAME
,

791 
ıs_­i_objeù_ATTR_T_BIN
, 
_pÜt
.
if_Çme
, 
	`¡¾’
(_port.if_name)+1);

793 
	`ıs_­i_objeù_©Œ_add_u32
(
objeù
,
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
,

794 
_pÜt
.
if_šdex
);

795 
	`ıs_­i_objeù_©Œ_d–‘e
(
objeù
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

796 
	`ıs_­i_objeù_©Œ_d–‘e
(
objeù
, 
IF_INTERFACES_INTERFACE_NAME
);

797 
	`ıs_­i_objeù_©Œ_add
(
objeù
,
IF_INTERFACES_STATE_INTERFACE_TYPE
,

798 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_SOFTWARELOOPBACK
,

799 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_SOFTWARELOOPBACK
)+1);

800 ++ 
ix
;

803  
ıs_­i_»t_code_OK
;

804 
	}
}

806 
ıs_­i_»tuº_code_t
 
	$if_¡©e_£t
(* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,
size_t
 
ix
) {

809  
ıs_­i_»t_code_ERR
;

810 
	}
}

812 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_ç
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

814  
ıs_­i_»t_code_OK
;

815 
	}
}

817 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_Çme
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

818  
ıs_­i_»t_code_OK
;

819 
	}
}

821 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_ggšg_mode
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

822 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_TAGGING_MODE
);

823 ià(
©Œ
 =ğ
nuÎ±r
) {

824  
ıs_­i_»t_code_ERR
;

827 
t_¡d_”rÜ
 
rc
;

828 ià((
rc
 = 
	`ndi_pÜt_£t_uÁagged_pÜt_©Œib
(
Åu
,
pÜt
,

829 (
BASE_IF_PHY_IF_INTERFACES_INTERFACE_TAGGING_MODE_t
)
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
)))!=
STD_ERR_OK
) {

830 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_TAGGING_MODE
);

831  
ıs_­i_»t_code_ERR
;

833  
ıs_­i_»t_code_OK
;

834 
	}
}

836 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_mac
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

837 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
);

838 ià(
©Œ
 =ğ
nuÎ±r
) {

839  
ıs_­i_»t_code_ERR
;

842 ià(
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
)!=
STD_ERR_OK
) {

843 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","OS update for MAC‚pu %d…ort %d",

844 
Åu
,
pÜt
);

845  
ıs_­i_»t_code_ERR
;

848 
ıs_­i_objeù_©Œ_t
 
_ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

849 ià((
_ifix
 =ğ
nuÎ±r
)) {

850 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-SET","upd©MAC fau» fÜ‚pu %d…Üˆ%d", 
Åu
,
pÜt
);

851  
ıs_­i_»t_code_ERR
;

853 
h®_ifšdex_t
 
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_ifix
);

854 *
mac_addr
 = (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
©Œ
);

855  (
	`dn_h®_upd©e_štf_mac
(
if_šdex
, 
mac_addr
));

856 
	}
}

858 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_desc
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

859 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_INTERFACE_DESCRIPTION
);

860 
š‹rçû_ù¾_t
 
štf
;

862 ià(
©Œ
 =ğ
nuÎ±r
) {

863  
ıs_­i_»t_code_ERR
;

868 
ıs_­i_objeù_©Œ_t
 
_ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

869 ià(
_ifix
 =ğ
nuÎ±r
) {

870 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-SET","upd©štàdesøçu» fÜ‚pu %d…Üˆ%d", 
Åu
,
pÜt
);

871  
ıs_­i_»t_code_ERR
;

874 
	`mem£t
(&
štf
, 0, (intf));

875 
štf
.
Åu_id
 = 
Åu
;

876 
štf
.
pÜt_id
 = 
pÜt
;

877 
štf
.
q_ty³
 = 
HAL_INTF_INFO_FROM_PORT
;

879 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf
)!=
STD_ERR_OK
) {

880 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-SET","E¼Ü g‘tšg iÁ”çû cÚŒŞ block fÜ‚pu %d…Üˆ%d", 
Åu
,
pÜt
);

881  
ıs_­i_»t_code_ERR
;

884 
štf
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

885 cÚ¡ *
desc
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
©Œ
);

886 ià(
	`dn_h®_upd©e_štf_desc
(&
štf
, 
desc
è!ğ
STD_ERR_OK
) {

887 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-SET","E¼Üƒ¼Ü upd©šg desütiÚ‚pu %d…Üˆ%d", 
Åu
,
pÜt
);

888  
ıs_­i_»t_code_ERR
;

891  
ıs_­i_»t_code_OK
;

892 
	}
}

894 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_mtu
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

895 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
);

896 ià(
©Œ
 =ğ
nuÎ±r
) {

897  
ıs_­i_»t_code_ERR
;

900 ià(
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
)!=
STD_ERR_OK
) {

901  
ıs_­i_»t_code_ERR
;

905 
ušt_t
 
mtu
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

906 
t_¡d_”rÜ
 
rc
;

907 ià((
rc
 = 
	`ndi_pÜt_mtu_£t
(
Åu
,
pÜt
, 
mtu
)è!ğ
STD_ERR_OK
) {

908 ià(
	`ndi_pÜt_mtu_g‘
(
Åu
,
pÜt
,&
mtu
)==
STD_ERR_OK
) {

909 
	`ıs_­i_objeù_©Œ_d–‘e
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
);

910 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
,
mtu
);

911 
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
);

913 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
DELL_IF_IF_INTERFACES_INTERFACE_MTU
);

914  
ıs_­i_»t_code_ERR
;

917  
ıs_­i_»t_code_OK
;

918 
	}
}

920 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_“e
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
)

922 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_EEE
);

923 ià(
©Œ
 =ğ
nuÎ±r
) {

924  
ıs_­i_»t_code_ERR
;

927 
ušt32_t
 
¡©e
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

931 ià((
¡©e
 == 0) || (state == 1)) {

932 
t_¡d_”rÜ
 
rc
;

933 ià((
rc
 = 
	`ndi_pÜt_“e_£t
(
Åu
, 
pÜt
, 
¡©e
)è!ğ
STD_ERR_OK
) {

934 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-EEE", "FaedØ£ˆ%d:%dØ¡©%d", 
Åu
, 
pÜt
, (è
¡©e
);

935 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
DELL_IF_IF_INTERFACES_INTERFACE_EEE
);

936  
ıs_­i_»t_code_ERR
;

939 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-EEE", "Inv®id s‹ %d", (è
¡©e
);

940  
ıs_­i_»t_code_ERR
;

943  
ıs_­i_»t_code_OK
;

944 
	}
}

946 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_up
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

947 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
);

948 
ıs_­i_objeù_©Œ_t
 
_ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

949 ià((
©Œ
 =ğ
nuÎ±r
è|| (
_ifix
 ==‚ullptr)) {

950  
ıs_­i_»t_code_ERR
;

953 
boŞ
 
¡©e
;

954 
boŞ
 
»v”t
;

955 
¡©e
 = (
boŞ
è
	`ıs_­i_objeù_©Œ_d©a_ušt
(
©Œ
);

956 
»v”t
 = (
¡©e
 =ğ
Œue
è? 
çl£
 :rue;

958 ià(
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
)!=
STD_ERR_OK
) {

959 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","OS update for‚pu %d…ort %do %d failed",

960 
Åu
,
pÜt
,
¡©e
);

961  
ıs_­i_»t_code_ERR
;

964 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

965 ià((
rc
=
	`ndi_pÜt_admš_¡©e_£t
(
Åu
,
pÜt
,
¡©e
))!=
STD_ERR_OK
) {

966 
	`ıs_­i_objeù_©Œ_d–‘e
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
);

967 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
,
»v”t
);

968 
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
);

969 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
IF_INTERFACES_INTERFACE_ENABLED
);

970 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","NPU update for‚pu %d…ort %do %d failed (%d)",

971 
Åu
,
pÜt
,
¡©e
,
rc
);

974 
h®_ifšdex_t
 
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_ifix
);

975 
	`Çs_£nd_admš_¡©e_ev’t
(
if_šdex
,

976 (
¡©e
 =ğ
Œue
è? 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_UP
: 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_DOWN
);

978  
ıs_­i_»t_code_OK
;

979 
	}
}

981 
ıs_­i_»tuº_code_t
 
	$_£t_mac_Ë¬n_mode
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

982 
ıs_­i_objeù_©Œ_t
 
mac_Ë¬n_mode
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

983 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_LEARN_MODE
);

984 ià(
mac_Ë¬n_mode
 =ğ
nuÎ±r
) {

985  
ıs_­i_»t_code_ERR
;

987 
BASE_IF_PHY_MAC_LEARN_MODE_t
 
mode
 = (BASE_IF_PHY_MAC_LEARN_MODE_t)

988 
	`ıs_­i_objeù_©Œ_d©a_u32
(
mac_Ë¬n_mode
);

991 ià(
	`ndi_pÜt_mac_Ë¬n_mode_£t
(
Åu
,
pÜt
,
mode
)!=
STD_ERR_OK
) {

992 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Failedo update MAC Learn modeo %d for "

993 "Åu %d…Üˆ%d",
mode
,
Åu
,
pÜt
);

994  
ıs_­i_»t_code_ERR
;

996 
ıs_­i_objeù_©Œ_t
 
_ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

997 if(
_ifix
){

998 
h®_ifšdex_t
 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_ifix
);

999 
boŞ
 
’abË
 = 
Œue
;

1000 if(
mode
 =ğ
BASE_IF_PHY_MAC_LEARN_MODE_DROP
 || mod=ğ
BASE_IF_PHY_MAC_LEARN_MODE_DISABLE
 ){

1001 
’abË
 = 
çl£
;

1003 if(
	`Çs_os_mac_chªge_Ë¬nšg
(
ifšdex
,
’abË
è!ğ
STD_ERR_OK
){

1004 
	`EV_LOG
(
INFO
,
INTERFACE
,3,"NAS-IF-SET","Failedo update MAC†earn mode in Linux kernel");

1007 
	`EV_LOG
(
INFO
,
INTERFACE
,3,"NAS-IF-SET","No ifindex inhe objecto update mac†earn mode");

1009  
ıs_­i_»t_code_OK
;

1010 
	}
}

1012 
ıs_­i_»tuº_code_t
 
	$_£t_phy_medŸ
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1014 
ıs_­i_objeù_©Œ_t
 
_phy_medŸ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1015 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PHY_MEDIA
);

1016 ià(
_phy_medŸ
 =ğ
nuÎ±r
) {

1017  
ıs_­i_»t_code_ERR
;

1019 
PLATFORM_MEDIA_TYPE_t
 
medŸ_ty³
 = (PLATFORM_MEDIA_TYPE_t)
	`ıs_­i_objeù_©Œ_d©a_u32
(
_phy_medŸ
);

1021 
t_¡d_”rÜ
 
rc
;

1022 ià((
rc
 = 
	`ndi_pÜt_medŸ_ty³_£t
(
Åu
, 
pÜt
, 
medŸ_ty³
)è!ğ
STD_ERR_OK
) {

1023 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Failedo set media_type %d for "

1024 "Åu %d…Üˆ%d",
medŸ_ty³
,
Åu
,
pÜt
);

1025 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PHY_MEDIA
);

1026  
ıs_­i_»t_code_ERR
;

1029 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

1030 
¡d_rw_lock_wr™e_gu¬d
 
	`g
(&
_logiÿl_pÜt_lock
);

1031 
_logiÿl_pÜt_tbl
[
Åu_pÜt
].
medŸ_ty³
 = media_type;

1033  
ıs_­i_»t_code_OK
;

1034 
	}
}

1036 
ıs_­i_»tuº_code_t
 
	$_£t_hw_´ofe
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1038 
ıs_­i_objeù_©Œ_t
 
_hw_´ofe
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1039 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_HW_PROFILE
);

1040 if(
_hw_´ofe
 =ğ
nuÎ±r
) {

1041  
ıs_­i_»t_code_ERR
;

1044 
ušt32_t
 
hw_´ofe
 = 
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_hw_´ofe
);

1046 
t_¡d_”rÜ
 
rc
;

1047 ià((
rc
 = 
	`ndi_pÜt_hw_´ofe_£t
(
Åu
, 
pÜt
, 
hw_´ofe
)è!ğ
STD_ERR_OK
) {

1048 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Failedo set hw_profile %d for "

1049 "Åu %d…Üˆ%d", 
hw_´ofe
, 
Åu
, 
pÜt
);

1050 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_HW_PROFILE
);

1051  
ıs_­i_»t_code_ERR
;

1053 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-IF-REG"," set hw…rofileo %d for "

1054 "Åu %d…Üˆ%d",
hw_´ofe
,
Åu
,
pÜt
);

1055  
ıs_­i_»t_code_OK
;

1056 
	}
}

1058 
ıs_­i_»tuº_code_t
 
	$_£t_id’tifiÿtiÚ_Ëd
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1060 
ıs_­i_objeù_©Œ_t
 
_id’t_Ëd
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1061 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_IDENTIFICATION_LED
);

1062 if(
_id’t_Ëd
 =ğ
nuÎ±r
) {

1063  
ıs_­i_»t_code_ERR
;

1066 
boŞ
 
¡©e
 = (boŞè
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_id’t_Ëd
);

1068 
t_¡d_”rÜ
 
rc
;

1069 ià((
rc
 = 
	`ndi_pÜt_id’tifiÿtiÚ_Ëd_£t
(
Åu
, 
pÜt
, 
¡©e
)è!ğ
STD_ERR_OK
) {

1070 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Failedo set identification†ed state %d for "

1071 "Åu %d…Üˆ%d", 
¡©e
, 
Åu
, 
pÜt
);

1072 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_IDENTIFICATION_LED
);

1073  
ıs_­i_»t_code_ERR
;

1075  
ıs_­i_»t_code_OK
;

1076 
	}
}

1078 
ıs_­i_»tuº_code_t
 
	$_£t_¥“d
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1080 
ıs_­i_objeù_©Œ_t
 
_¥“d
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1081 
DELL_IF_IF_INTERFACES_INTERFACE_SPEED
);

1082 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

1084 if(
_¥“d
 =ğ
nuÎ±r
) {

1085  
ıs_­i_»t_code_ERR
;

1087 
BASE_IF_SPEED_t
 
¥“d
 = (BASE_IF_SPEED_t)
	`ıs_­i_objeù_©Œ_d©a_u32
(
_¥“d
);

1089 
t_¡d_”rÜ
 
rc
;

1090 ià((
rc
 = 
	`ndi_pÜt_¥“d_£t
(
Åu
,
pÜt
,
¥“d
)è!ğ
STD_ERR_OK
) {

1091 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Failedo set speed %d for "

1092 "Åu %d…Üˆ%d",
¥“d
,
Åu
,
pÜt
);

1093 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
DELL_IF_IF_INTERFACES_INTERFACE_SPEED
);

1094  
ıs_­i_»t_code_ERR
;

1096 
_logiÿl_pÜt_tbl
[
Åu_pÜt
].
cÚfigu»d_¥“d
 = 
¥“d
;

1097 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-IF-REG","£ˆ¥“d %d fÜ‚pu %d…Üˆ%d",
¥“d
,
Åu
,
pÜt
);

1098  
ıs_­i_»t_code_OK
;

1099 
	}
}

1101 
ıs_­i_»tuº_code_t
 
	$_£t_suµÜ‹d_autÚeg
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1103 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

1104 
BASE_IF_SUPPORTED_AUTONEG_t
 
suµÜ‹d_autÚeg
 = 
BASE_IF_SUPPORTED_AUTONEG_BOTH_SUPPORTED
;

1105 
ıs_­i_objeù_©Œ_t
 
suµÜ‹d_autÚeg_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1106 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_SUPPORTED_AUTONEG
);

1107 if(
suµÜ‹d_autÚeg_©Œ
 =ğ
nuÎ±r
) {

1108  
ıs_­i_»t_code_ERR
;

1110 
suµÜ‹d_autÚeg
 = (
BASE_IF_SUPPORTED_AUTONEG_t
è
	`ıs_­i_objeù_©Œ_d©a_ušt
(
suµÜ‹d_autÚeg_©Œ
);

1111 
_logiÿl_pÜt_tbl
[
Åu_pÜt
].
suµÜ‹d_autÚeg
 = supported_autoneg;

1112  
ıs_­i_»t_code_OK
;

1113 
	}
}

1115 
ıs_­i_»tuº_code_t
 
	$_£t_auto_Ãg
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1117 
ıs_­i_objeù_©Œ_t
 
autÚeg_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1118 
DELL_IF_IF_INTERFACES_INTERFACE_AUTO_NEGOTIATION
);

1119 if(
autÚeg_©Œ
 =ğ
nuÎ±r
) {

1120  
ıs_­i_»t_code_ERR
;

1123 
boŞ
 
’abË
 = (boŞè
	`ıs_­i_objeù_©Œ_d©a_ušt
(
autÚeg_©Œ
);

1125 
t_¡d_”rÜ
 
rc
;

1126 ià((
rc
 = 
	`ndi_pÜt_auto_Ãg_£t
(
Åu
,
pÜt
,
’abË
)è!ğ
STD_ERR_OK
) {

1127 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Failedo set‡uto‚egotiationo %d for "

1128 "Åu %d…Üˆ%d",
’abË
,
Åu
,
pÜt
);

1129 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
DELL_IF_IF_INTERFACES_INTERFACE_AUTO_NEGOTIATION
);

1130  
ıs_­i_»t_code_ERR
;

1132 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-IF-REG"," set‡uto‚egotiationo %d for "

1133 "Åu %d…Üˆ%d",
’abË
,
Åu
,
pÜt
);

1134  
ıs_­i_»t_code_OK
;

1135 
	}
}

1137 
ıs_­i_»tuº_code_t
 
	$_£t_du¶ex_mode
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1139 
ıs_­i_objeù_©Œ_t
 
du¶ex_mode
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1140 
DELL_IF_IF_INTERFACES_INTERFACE_DUPLEX
);

1141 if(
du¶ex_mode
 =ğ
nuÎ±r
) {

1142  
ıs_­i_»t_code_ERR
;

1144 
BASE_CMN_DUPLEX_TYPE_t
 
mode
 = (BASE_CMN_DUPLEX_TYPE_t)

1145 
	`ıs_­i_objeù_©Œ_d©a_u32
(
du¶ex_mode
);

1147 
t_¡d_”rÜ
 
rc
;

1148 ià((
rc
 = 
	`ndi_pÜt_du¶ex_£t
(
Åu
,
pÜt
,
mode
)è!ğ
STD_ERR_OK
) {

1149 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Failedo set duplex modeo %d for "

1150 "Åu %d…Üˆ%d",
mode
,
Åu
,
pÜt
);

1151 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
DELL_IF_IF_INTERFACES_INTERFACE_DUPLEX
);

1152  
ıs_­i_»t_code_ERR
;

1154  
ıs_­i_»t_code_OK
;

1155 
	}
}

1157 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_mode
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1158 
_Åu_pÜt_t
 
Åu_pÜt
 = {(
ušt_t
)
Åu
, (ušt_t)
pÜt
};

1159 
ıs_­i_objeù_©Œ_t
 
if_mode_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_MODE
);

1161 if(
if_mode_©Œ
 =ğ
nuÎ±r
) {

1162  
ıs_­i_»t_code_ERR
;

1164 
BASE_IF_MODE_t
 
mode
 = (BASE_IF_MODE_t)
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_mode_©Œ
);

1165 
¡d_rw_lock_wr™e_gu¬d
 
	`g
(&
_logiÿl_pÜt_lock
);

1166 
_logiÿl_pÜt_tbl
[
Åu_pÜt
].
mode
 = mode;

1168  
ıs_­i_»t_code_OK
;

1169 
	}
}

1171 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_ãc
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1172 
ıs_­i_objeù_©Œ_t
 
ãc_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1173 
DELL_IF_IF_INTERFACES_INTERFACE_FEC
);

1174 ià(
ãc_©Œ
 =ğ
nuÎ±r
) {

1175 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-IF-UPDATE", "No FEC mode‡ttribute");

1176  
ıs_­i_»t_code_ERR
;

1178 
BASE_CMN_FEC_TYPE_t
 
ãc_mode
 = (BASE_CMN_FEC_TYPE_t)

1179 
	`ıs_­i_objeù_©Œ_d©a_u32
(
ãc_©Œ
);

1181 
t_¡d_”rÜ
 
rc
;

1182 ià((
rc
 = 
	`ndi_pÜt_ãc_£t
(
Åu
, 
pÜt
, 
ãc_mode
)è!ğ
STD_ERR_OK
) {

1183 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-UPDATE","Failedo set FEC modeo %d for "

1184 "Åu %d…Üˆ%d", 
ãc_mode
, 
Åu
, 
pÜt
);

1185 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
DELL_IF_IF_INTERFACES_INTERFACE_FEC
);

1186  
ıs_­i_»t_code_ERR
;

1189 
	`Çs_pÜt_ãc_£t
(
Åu
, 
pÜt
, 
ãc_mode
);

1190  
ıs_­i_»t_code_OK
;

1191 
	}
}

1193 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_oui
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1194 
ıs_­i_objeù_©Œ_t
 
oui_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1195 
DELL_IF_IF_INTERFACES_INTERFACE_OUI
);

1196 ià(
oui_©Œ
 =ğ
nuÎ±r
) {

1197 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-IF-UPDATE", "No OUI‚umber‡ttribute");

1198  
ıs_­i_»t_code_ERR
;

1200 
ušt32_t
 
oui
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
oui_©Œ
);

1202 
t_¡d_”rÜ
 
rc
;

1203 ià((
rc
 = 
	`ndi_pÜt_oui_£t
(
Åu
, 
pÜt
, 
oui
)è!ğ
STD_ERR_OK
) {

1204 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-UPDATE","Failedo set OUIo %d for "

1205 "Åu %d…Üˆ%d", 
oui
, 
Åu
, 
pÜt
);

1206 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
DELL_IF_IF_INTERFACES_INTERFACE_OUI
);

1207  
ıs_­i_»t_code_ERR
;

1209  
ıs_­i_»t_code_OK
;

1210 
	}
}

1212 
ıs_­i_»tuº_code_t
 
	$_£t_©Œ_vÏn_f‹r
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

1213 
ıs_­i_objeù_©Œ_t
 
vÏn_f‹r_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1214 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_VLAN_FILTER
);

1215 
t_¡d_”rÜ
 
rc
;

1217 ià(
vÏn_f‹r_©Œ
 =ğ
nuÎ±r
) {

1218 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-IF-UPDATE", "No VLAN Filterype‡ttribute");

1219  
ıs_­i_»t_code_ERR
;

1221 
BASE_CMN_FILTER_TYPE_t
 
f‹r_ty³
 = (BASE_CMN_FILTER_TYPE_t)

1222 
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_f‹r_©Œ
);

1224 ià((
rc
 = 
	`ndi_pÜt_vÏn_f‹r_£t
(
Åu
, 
pÜt
, 
f‹r_ty³
)è!ğ
STD_ERR_OK
) {

1225 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-UPDATE","Failedo set VLAN Filterypeo %d for "

1226 "Åu %d…Üˆ%d", 
f‹r_ty³
, 
Åu
, 
pÜt
);

1227 
	`£t_ıs_obj_»tuº_©Œs
(
obj
, 
rc
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_VLAN_FILTER
);

1228  
ıs_­i_»t_code_ERR
;

1231 
	`Çs_pÜt_vÏn_f‹r_£t
(
Åu
, 
pÜt
, 
f‹r_ty³
);

1232  
ıs_­i_»t_code_OK
;

1233 
	}
}

1235 
usšg
 
	gštf_£t_©Œ_hªdËr_t
 = 
	$ıs_­i_»tuº_code_t
 (*)(
Åu_id_t
, 
pÜt_t
,
ıs_­i_objeù_t
);

1236 cÚ¡ 
¡d
::
unÜd”ed_m­
<
ıs_­i_©Œ_id_t
,

1237 
¡d
::
·œ
<
štf_£t_©Œ_hªdËr_t
, cÚ¡ *>> 
_£t_©Œ_hªdËrs
 = {

1238 { 
IF_INTERFACES_INTERFACE_NAME
, {
_£t_©Œ_Çme
, "name"} },

1239 { 
IF_INTERFACES_INTERFACE_ENABLED
, {
_£t_©Œ_up
, "enabled"} },

1240 { 
DELL_IF_IF_INTERFACES_INTERFACE_MTU
, {
_£t_©Œ_mtu
, "mtu"} },

1241 { 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
, {
_£t_©Œ_ç
, "oper_status"} },

1242 { 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_TAGGING_MODE
, {
_£t_©Œ_ggšg_mode
, "tagging_mode"} },

1243 { 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, {
_£t_©Œ_mac
, "mac_addr"} },

1244 { 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_LEARN_MODE
, {
_£t_mac_Ë¬n_mode
, "mac_learn_mode"} },

1245 { 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PHY_MEDIA
, {
_£t_phy_medŸ
, "phy_media"} },

1246 { 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_IDENTIFICATION_LED
, {
_£t_id’tifiÿtiÚ_Ëd
, "identification_led"} },

1247 { 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_HW_PROFILE
, {
_£t_hw_´ofe
, "hw_profile"} },

1248 { 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_SUPPORTED_AUTONEG
, {
_£t_suµÜ‹d_autÚeg
, "supported_autoneg"} },

1249 { 
DELL_IF_IF_INTERFACES_INTERFACE_SPEED
, {
_£t_¥“d
, "speed"} },

1250 { 
DELL_IF_IF_INTERFACES_INTERFACE_AUTO_NEGOTIATION
, {
_£t_auto_Ãg
, "autoneg"} },

1251 { 
DELL_IF_IF_INTERFACES_INTERFACE_DUPLEX
, {
_£t_du¶ex_mode
, "duplex_mode"} },

1252 { 
DELL_IF_IF_INTERFACES_INTERFACE_MODE
, {
_£t_©Œ_mode
, "mode"} },

1253 { 
DELL_IF_IF_INTERFACES_INTERFACE_EEE
, {
_£t_©Œ_“e
, "eee"} },

1254 { 
DELL_IF_IF_INTERFACES_INTERFACE_FEC
, {
_£t_©Œ_ãc
, "fec"} },

1255 { 
DELL_IF_IF_INTERFACES_INTERFACE_OUI
, {
_£t_©Œ_oui
, "oui"} },

1256 { 
IF_INTERFACES_INTERFACE_DESCRIPTION
, {
_£t_©Œ_desc
, "description"}},

1257 { 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_VLAN_FILTER
, {
_£t_©Œ_vÏn_f‹r
, "vlan_filter"}}

1258 
	}
};

1260 
	$»move_§me_v®ues
(
ıs_­i_objeù_t
 
now
, cps_­i_objeù_ˆ
»q
) {

1261 
ıs_­i_objeù_™_t
 
™
;

1262 
	`ıs_­i_objeù_™_begš
(
now
,&
™
);

1263  ; 
	`ıs_­i_objeù_™_v®id
(&
™
è; 
	`ıs_­i_objeù_™_Ãxt
(&it)) {

1264 
ıs_­i_©Œ_id_t
 
id
 = 
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

1266 ià(
_£t_©Œ_hªdËrs
.
	`fšd
(
id
)==_£t_©Œ_hªdËrs.
	`’d
()) ;

1268 
ıs_­i_objeù_©Œ_t
 
Ãw_v®
 = 
	`ıs_­i_objeù_e_g‘
(
»q
,&
id
,1);

1269 ià(
Ãw_v®
==
nuÎ±r
) ;

1270 ià(
	`ıs_­i_objeù_©Œs_com·»
(
™
.
©Œ
,
Ãw_v®
)!=0) ;

1271 ià(
id
 =ğ
IF_INTERFACES_INTERFACE_ENABLED
) ;

1272 ià(
id
 =ğ
IF_INTERFACES_INTERFACE_NAME
) ;

1273 ià(
id
 =ğ
DELL_IF_IF_INTERFACES_INTERFACE_SPEED
) ;

1274 
	`ıs_­i_objeù_©Œ_d–‘e
(
»q
,
id
);

1276 
	}
}

1278 
ıs_­i_»tuº_code_t
 
	$_if_d–‘e
(
ıs_­i_objeù_t
 
»q_if
, cps_­i_objeù_ˆ
´ev
) {

1279 ià(Ğ
´ev
 =ğ
nuÎ±r
è|| (
»q_if
 ==‚ullptr)) {

1280 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-SET", "Request Intf Object is Null for Delete Interface");

1281  
ıs_­i_»t_code_ERR
;

1284 
ıs_­i_objeù_©Œ_t
 
_ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»q_if
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

1285 
ıs_­i_objeù_©Œ_t
 
_Çme
 = 
	`ıs_­i_g‘_key_d©a
(
»q_if
,
IF_INTERFACES_INTERFACE_NAME
);

1287 ià(
_ifix
==
NULL
 && 
_Çme
==NULL) {

1288  
ıs_­i_»t_code_ERR
;

1291 
š‹rçû_ù¾_t
 
_pÜt
;

1292 ià(!
	`if_d©a_äom_obj
(
obj_INTF
, 
»q_if
,
_pÜt
)) {

1293  
ıs_­i_»t_code_ERR
;

1296 
	`ıs_­i_objeù_©Œ_add_u32
(
´ev
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
_pÜt
.
if_šdex
);

1297 if(
_ifix
 =ğ
NULL
) {

1298 
	`ıs_­i_objeù_©Œ_add_u32
(
»q_if
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
_pÜt
.
if_šdex
);

1301 if(
	`Çs_št_pÜt_d–‘e
(
_pÜt
.
if_Çme
)!=
STD_ERR_OK
) {

1302 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-IF-REG", "Failedo delete†ogical interface %s",

1303 
_pÜt
.
if_Çme
);

1304  
ıs_­i_»t_code_ERR
;

1307 ià(
_pÜt
.
pÜt_m­³d
) {

1308 if(
	`_logiÿl_pÜt_tbl_d–‘e
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
è!ğ
STD_ERR_OK
){

1309 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-IF-DELETE", "Failedo delete†ogical cache for interface %s…ort %d",

1310 
_pÜt
.
if_Çme
, _pÜt.
pÜt_id
);

1314 
	`ndi_pÜt_admš_¡©e_£t
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
, 
çl£
);

1317 if(
	`ıs_­i_db_comm™_Úe
(
ıs_­i_İ”_DELETE
,
»q_if
,
nuÎ±r
,
çl£
)!ğ
ıs_­i_»t_code_OK
){

1318 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-SET","Failedo write…hysical interface objecto db");

1321 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
»q_if
),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_OBSERVED
);

1322 
	`ıs_­i_ev’t_th»ad_publish
(
»q_if
);

1323 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
»q_if
),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_TARGET
);

1325  
ıs_­i_»t_code_OK
;

1326 
	}
}

1328 
	$if_rŞlback
(
ıs_­i_objeù_t
 
rŞlback
,
š‹rçû_ù¾_t
 
_pÜt
) {

1329 
ıs_­i_objeù_™_t
 
™_rŞlback
;

1330 
	`ıs_­i_objeù_™_begš
(
rŞlback
,&
™_rŞlback
);

1331  ; 
	`ıs_­i_objeù_™_v®id
(&
™_rŞlback
è; 
	`ıs_­i_objeù_™_Ãxt
(&it_rollback)) {

1332 
ıs_­i_©Œ_id_t
 
id_rŞlback
 = 
	`ıs_­i_objeù_©Œ_id
(
™_rŞlback
.
©Œ
);

1333 autØ
func
 = 
_£t_©Œ_hªdËrs
.
	`fšd
(
id_rŞlback
);

1334 ià(
func
 ==
_£t_©Œ_hªdËrs
.
	`’d
()) ;

1335 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-IF-REG", "Calling„ollback‡ttribute %s for interface %s",

1336 
func
->
£cÚd
.£cÚd, 
_pÜt
.
if_Çme
);

1337 
ıs_­i_»tuº_code_t
 
»t
 = 
func
->
£cÚd
.
	`fœ¡
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
,
rŞlback
);

1338 ià(
»t
!=
ıs_­i_»t_code_OK
)

1339 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Failedo„ollback Attribute %s for interface %s",

1340 
func
->
£cÚd
.£cÚd, 
_pÜt
.
if_Çme
);

1342 
	}
}

1344 
ıs_­i_»tuº_code_t
 
	$_štf_¡©e_publish
(
Åu_id_t
 
Åu_id
, 
Åu_pÜt_t
 
pÜt_id
,

1345 
ıs_­i_objeù_t
 
»q_if
)

1347 
ıs_­i_objeù_©Œ_t
 
_iâame_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»q_if
,

1348 
IF_INTERFACES_INTERFACE_NAME
);

1349 
ıs_­i_objeù_©Œ_t
 
_ãc_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»q_if
,

1350 
DELL_IF_IF_INTERFACES_INTERFACE_FEC
);

1351 
ıs_­i_objeù_©Œ_t
 
_autÚeg_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»q_if
,

1352 
DELL_IF_IF_INTERFACES_INTERFACE_AUTO_NEGOTIATION
);

1354 if(
_ãc_©Œ
 =ğ
nuÎ±r
 && 
_autÚeg_©Œ
 ==‚ullptr) {

1355  
ıs_­i_»t_code_OK
;

1358 if(
_iâame_©Œ
 !ğ
nuÎ±r
) {

1359 
ıs_­i_objeù_gu¬d
 
	`_štf_¡©e_gd
(
	`ıs_­i_obj_toŞ_ü—‹
(
ıs_­i_qu®if›r_OBSERVED
,

1360 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
, 
çl£
));

1361 
ıs_­i_objeù_t
 
_štf_¡©e
 = 
_štf_¡©e_gd
.
	`g‘
();

1362 if(
_štf_¡©e
 =ğ
nuÎ±r
){

1363 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-SET","Failedo create state object");

1364  
ıs_­i_»t_code_ERR
;

1367 cÚ¡ *
iâame
 = 
¡©ic_ÿ¡
<cÚ¡ *>(
	`ıs_­i_objeù_©Œ_d©a_bš
(
_iâame_©Œ
));

1368 
	`ıs_­i_£t_key_d©a
(
_štf_¡©e
, 
IF_INTERFACES_STATE_INTERFACE_NAME
,

1369 
ıs_­i_objeù_ATTR_T_BIN
,
iâame
, 
	`¡¾’
(ifname)+1);

1371 ià(
_ãc_©Œ
 !ğ
nuÎ±r
){

1372 
BASE_CMN_FEC_TYPE_t
 
_ãc_cÚfigu»d
;

1373 ià(
STD_ERR_OK
 =ğ
	`Çs_pÜt_ãc_g‘
(
Åu_id
,
pÜt_id
,&
_ãc_cÚfigu»d
)){

1374 
	`ıs_­i_objeù_©Œ_add_u32
(
_štf_¡©e
,

1375 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_CONFIGURED_FEC
,

1376 
_ãc_cÚfigu»d
);

1380 
BASE_CMN_FEC_TYPE_t
 
_ãc_ob£rved
;

1381 ià(
STD_ERR_OK
 =ğ
	`ndi_pÜt_ãc_g‘
(
Åu_id
,
pÜt_id
,&
_ãc_ob£rved
)){

1382 
	`ıs_­i_objeù_©Œ_add_u32
(
_štf_¡©e
,

1383 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_FEC
, 
_ãc_ob£rved
);

1386 
BASE_CMN_FILTER_TYPE_t
 
vÏn_f‹r_ob£rved
;

1387 ià(
STD_ERR_OK
 =ğ
	`ndi_pÜt_vÏn_f‹r_g‘
(
Åu_id
, 
pÜt_id
,

1388 &
vÏn_f‹r_ob£rved
)) {

1389 
	`ıs_­i_objeù_©Œ_add_u32
(
_štf_¡©e
,

1390 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_VLAN_FILTER
,

1391 
vÏn_f‹r_ob£rved
);

1394 ià(
_autÚeg_©Œ
 !ğ
nuÎ±r
){

1395 
ušt32_t
 
_autÚeg
 = 
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_autÚeg_©Œ
);

1396 
	`ıs_­i_objeù_©Œ_add_u32
(
_štf_¡©e
,

1397 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_AUTO_NEGOTIATION
, 
_autÚeg
);

1400 
ndi_štf_lšk_¡©e_t
 
lšk_¡©e
;

1401 ià(
	`ndi_pÜt_lšk_¡©e_g‘
(
Åu_id
, 
pÜt_id
, &
lšk_¡©e
è!ğ
STD_ERR_OK
) {

1402 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INT-UPDATE", "Failedo get†ink state for…ort %d",

1403 
pÜt_id
);

1404  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

1406 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©e
 =

1407 
	`ndi_to_ıs_İ”_ty³
(
lšk_¡©e
.
İ”_¡©us
);

1409 
	`EV_LOGGING
(
INTERFACE
, 
NOTICE
, "INT-UPDATE", "publishšg o³¸¡©fÜ %s", 
iâame
);

1410 
	`ıs_­i_objeù_©Œ_add_u32
(
_štf_¡©e
,
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
, 
¡©e
);

1411 
	`ıs_­i_ev’t_th»ad_publish
(
_štf_¡©e
);

1413  
ıs_­i_»t_code_OK
;

1414 
	}
}

1416 
ıs_­i_»tuº_code_t
 
	$_if_upd©e
(
ıs_­i_objeù_t
 
»q_if
, cps_­i_objeù_ˆ
´ev
, 
boŞ
 
if_£t
)

1418 ià(Ğ
´ev
 =ğ
nuÎ±r
è|| (
»q_if
 ==‚ullptr)) {

1419 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-SET", "Requested Intf Object is Null for Interface update ");

1420  
ıs_­i_»t_code_ERR
;

1423 
ıs_­i_objeù_©Œ_t
 
_ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»q_if
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

1424 
ıs_­i_objeù_©Œ_t
 
_Çme
 = 
	`ıs_­i_g‘_key_d©a
(
»q_if
,
IF_INTERFACES_INTERFACE_NAME
);

1425 ià(
_ifix
==
NULL
 && 
_Çme
==NULL) {

1426  
ıs_­i_»t_code_ERR
;

1429 
š‹rçû_ù¾_t
 
_pÜt
;

1430 ià(!
	`if_d©a_äom_obj
(
obj_INTF
, 
»q_if
,
_pÜt
)) {

1431  
ıs_­i_»t_code_ERR
;

1434 
boŞ
 
cÚÃù
 = 
çl£
;

1435 
ıs_­i_objeù_©Œ_t
 
Åu_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»q_if
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
);

1436 
ıs_­i_objeù_©Œ_t
 
pÜt_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»q_if
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
);

1437 
boŞ
 
½t_discÚn_pÜt
 = 
çl£
;

1438 
pÜt_t
 
discÚn_pÜt
 = 0;

1439 
Åu_id_t
 
discÚn_Åu
 = 0;

1441 ià(
if_£t
 && 
Åu_©Œ
 !ğ
nuÎ±r
 && 
pÜt_©Œ
 !=‚ullptr) {

1442 
Åu_id_t
 
Åu
;

1443 
pÜt_t
 
pÜt
;

1444 ià(
	`ıs_­i_objeù_©Œ_Ën
(
Åu_©Œ
è> 0 && cps_­i_objeù_©Œ_Ën(
pÜt_©Œ
) > 0) {

1445 
Åu
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
Åu_©Œ
);

1446 
pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
pÜt_©Œ
);

1447 
cÚÃù
 = 
Œue
;

1449 
discÚn_Åu
 = 
Åu
 = 
_pÜt
.
Åu_id
;

1452 
discÚn_pÜt
 = 
pÜt
 = 
_pÜt
.
pÜt_id
;

1453 
½t_discÚn_pÜt
 = 
Œue
;

1459 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"IF-DISCONN","Port %d is goingo be disconncted changing its mode"

1460 "ØL2",
_pÜt
.
if_šdex
);

1461 if(!
	`Çs_štf_hªdË_štf_mode_chªge
(
_pÜt
.
if_šdex
,
BASE_IF_MODE_MODE_L2
)){

1462 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"IF-DISCONN","Failedo changehe modeo L2 for…ort %d"

1463 "tØL2",
_pÜt
.
if_šdex
);

1468 ià(
	`Çs_št_upd©e_Åu_pÜt
(
_pÜt
.
if_Çme
, 
Åu
, 
pÜt
, 
cÚÃù
è!ğ
STD_ERR_OK
) {

1469 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Failedo update‚pu…ort for interface %s",

1470 
_pÜt
.
if_Çme
);

1471  
ıs_­i_»t_code_ERR
;

1473 
¡d
::
¡ršg
 
tmp_Çme
{
_pÜt
.
if_Çme
};

1474 
	`mem£t
(&
_pÜt
, 0, (_port));

1475 
	`¡ºıy
(
_pÜt
.
if_Çme
, 
tmp_Çme
.
	`c_¡r
(), (_port.if_name) - 1);

1476 
_pÜt
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

1477 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
_pÜt
è!ğ
STD_ERR_OK
) {

1478 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","FaedØg‘ infØoàš‹rçû %s",
_pÜt
.
if_Çme
);

1479  
ıs_­i_»t_code_ERR
;

1482 if(
cÚÃù
){

1484 
ıs_­i_objeù_gu¬d
 
	`_og
(
	`ıs_­i_objeù_ü—‹
());

1485 if(!
_og
.
	`v®id
()){

1486 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-DB-GET","Failedo create object for db get");

1487  
ıs_­i_»t_code_ERR
;

1489 if(
	`Çs_štf_db_obj_g‘
(
_pÜt
.
if_Çme
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

1490 
ıs_­i_qu®if›r_TARGET
,
_og
.
	`g‘
()è!ğ
STD_ERR_OK
 ){

1491 
	`EV_LOGGING
(
INTERFACE
,
ERR
,

1493 
_pÜt
.
if_Çme
);

1494  
ıs_­i_»t_code_ERR
;

1496 ià(!
	`ıs_­i_objeù_©Œ_m”ge
(
_og
.
	`g‘
(), 
»q_if
, 
Œue
)) {

1497 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-DB-GET","Failure, object merge");

1498  
ıs_­i_»t_code_ERR
;

1500 ià(!
	`ıs_­i_objeù_şÚe
(
»q_if
, 
_og
.
	`g‘
())) {

1501 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-DB-GET","Failure, object clone");

1502  
ıs_­i_»t_code_ERR
;

1504 
	`ıs_­i_key_£t_©Œ
(
	`ıs_­i_objeù_key
(
»q_if
), 
ıs_­i_İ”_SET
);

1508 
	`ıs_­i_objeù_©Œ_add_u32
(
´ev
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
_pÜt
.
if_šdex
);

1509 if(
_ifix
 =ğ
NULL
) {

1510 
	`ıs_­i_objeù_©Œ_add_u32
(
»q_if
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
_pÜt
.
if_šdex
);

1513 ià(
_pÜt
.
pÜt_m­³d
) {

1514 if(!
cÚÃù
){

1515 ià(
	`_if_g‘_´ev_äom_ÿche
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
,
´ev
)) {

1516 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Failedo get configured‡ttributes for interface %s",

1517 
_pÜt
.
if_Çme
);

1518  
ıs_­i_»t_code_ERR
;

1520 
	`»move_§me_v®ues
(
´ev
,
»q_if
);

1525 
ıs_­i_objeù_t
 
rŞlback
 = 
	`ıs_­i_objeù_ü—‹
();

1526 
	`ıs_­i_objeù_©Œ_add_u32
(
rŞlback
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
_pÜt
.
if_šdex
);

1527 ià(
rŞlback
 =ğ
NULL
è 
ıs_­i_»t_code_ERR
;

1528 
ıs_­i_objeù_™_t
 
™_»q
;

1529 
	`ıs_­i_objeù_™_begš
(
»q_if
,&
™_»q
);

1530 
ıs_­i_»tuº_code_t
 
»t
;

1532  ; 
	`ıs_­i_objeù_™_v®id
(&
™_»q
); 
	`ıs_­i_objeù_™_Ãxt
(&it_req)) {

1533 
ıs_­i_©Œ_id_t
 
id
 = 
	`ıs_­i_objeù_©Œ_id
(
™_»q
.
©Œ
);

1534 autØ
func
 = 
_£t_©Œ_hªdËrs
.
	`fšd
(
id
);

1535 ià(
func
 ==
_£t_©Œ_hªdËrs
.
	`’d
()) ;

1536 iàĞ
_pÜt
.
št_ty³
 =ğ
Çs_št_ty³_FC
 &&

1537 (
id
 =ğ
DELL_IF_IF_INTERFACES_INTERFACE_AUTO_NEGOTIATION
 ||

1538 
id
 =ğ
DELL_IF_IF_INTERFACES_INTERFACE_SPEED
 ||

1539 
id
 =ğ
DELL_IF_IF_INTERFACES_STATE_INTERFACE_DUPLEX
)) {

1542 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-IF-REG", "S‘‡‰ribu‹ % (%" 
PRId64
 ") for interface %s",

1543 
func
->
£cÚd
.£cÚd, 
id
, 
_pÜt
.
if_Çme
);

1544 
»t
 = 
func
->
£cÚd
.
	`fœ¡
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
,
»q_if
);

1545 ià(
»t
!=
ıs_­i_»t_code_OK
) {

1546 ià(!(
if_£t
è&& (
id
 =ğ
DELL_IF_IF_INTERFACES_INTERFACE_SPEED
 ||

1547 
id
 =ğ
DELL_IF_IF_INTERFACES_INTERFACE_FEC
 ||

1548 
id
 =ğ
DELL_IF_IF_INTERFACES_INTERFACE_DUPLEX
)){

1549 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","FaedØ£ˆA‰ribu‹ % (%" 
PRId64
 ") for interface %s",

1550 
func
->
£cÚd
.£cÚd, 
id
, 
_pÜt
.
if_Çme
);

1552 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","FaedØ£ˆA‰ribu‹ % (%" 
PRId64
 ") for interface %s",

1553 
func
->
£cÚd
.£cÚd, 
id
, 
_pÜt
.
if_Çme
);

1554 
	`if_rŞlback
(
rŞlback
,
_pÜt
);

1555 
	`ıs_­i_objeù_d–‘e
(
rŞlback
);

1556  
»t
;

1559 cÚ¡ *
d©a
 = 
	`ıs_­i_objeù_g‘_d©a
(
´ev
, 
id
);

1560 ià(
NULL
 =ğ
d©a
)

1562 
	`ıs_­i_objeù_©Œ_add
(
rŞlback
, 
id
, 
d©a
, 
	`ıs_­i_objeù_©Œ_Ën
(
™_»q
.
©Œ
));

1565 
	`ıs_­i_objeù_d–‘e
(
rŞlback
);

1569 if(
	`ıs_­i_db_comm™_Úe
(
ıs_­i_İ”_SET
,
»q_if
,
nuÎ±r
,
çl£
)!ğ
ıs_­i_»t_code_OK
){

1570 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-SET","Failedo write…hysical interface objecto db");

1573 ià(
_pÜt
.
št_ty³
 =ğ
Çs_št_ty³_FC
) {

1574 ià(
	`Çs_ıs_£t_fc_©Œ
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
, 
»q_if
, 
´ev
è!ğ
ıs_­i_»t_code_OK
) {

1575 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF","FaedØ£ˆA‰ribu‹ fÜ FC iÁ”çû %s",
_pÜt
.
if_Çme
);

1576  
ıs_­i_»t_code_ERR
;

1581 ià(
½t_discÚn_pÜt
) {

1582 
	`ıs_­i_objeù_©Œ_d–‘e
(
»q_if
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
);

1583 
	`ıs_­i_objeù_©Œ_add_u32
(
»q_if
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
,

1584 
discÚn_pÜt
);

1585 
	`ıs_­i_objeù_©Œ_d–‘e
(
»q_if
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
);

1586 
	`ıs_­i_objeù_©Œ_add_u32
(
»q_if
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
,

1587 
discÚn_Åu
);

1592 if(!
	`Çs_is_vœtu®_pÜt
(
_pÜt
.
if_šdex
)){

1593 ià(
	`_štf_¡©e_publish
(
_pÜt
.
Åu_id
,_pÜt.
pÜt_id
, 
»q_if
è!ğ
ıs_­i_»t_code_OK
) {

1594 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-SET",

1595 "E¼Ü iÀpublishšg IÁ”çû S‹ objeù fÜ iÁ”çû %s", 
_pÜt
.
if_Çme
);

1599 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
»q_if
),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_OBSERVED
);

1600 
	`ıs_­i_ev’t_th»ad_publish
(
»q_if
);

1601 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
»q_if
),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_TARGET
);

1602 ià(
½t_discÚn_pÜt
) {

1603 
	`ıs_­i_objeù_©Œ_d–‘e
(
»q_if
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
);

1604 
	`ıs_­i_objeù_©Œ_d–‘e
(
»q_if
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
);

1607  
ıs_­i_»t_code_OK
;

1608 
	}
}

1610 
	$£t_ıs_obj_»tuº_©Œs
(
ıs_­i_objeù_t
 
obj
, 
t_¡d_”rÜ
 
rc
,

1611 
ıs_­i_©Œ_id_t
 
©Œ
)

1613 
t_¡d_”rÜ
 
”r_id
 = 
	`STD_ERR_EXT_ERRID
(
rc
);

1615 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-IF-UPDATE",

1617 "E¼Ü ID %d‡nd E¼Ü Priv d©¨%d \r\n", 
©Œ
, 
rc
,

1618 
	`STD_ERR_EXT_ERRID
(
rc
), 
	`STD_ERR_EXT_PRIV
(rc));

1620 autØ
™
 = 
_”rÜ_¡ršg_m­_bË
->
	`fšd
(
”r_id
);

1622 ià(
™
 =ğ
_”rÜ_¡ršg_m­_bË
->
	`’d
()) {

1623 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,

1625 
	`STD_ERR_EXT_ERRID
(
rc
), 
	`STD_ERR_EXT_PRIV
(rc),„c);

1629 autØ
©Œ_™
 = 
_£t_©Œ_hªdËrs
.
	`fšd
(
©Œ
);

1631 ià(
©Œ_™
 =ğ
_£t_©Œ_hªdËrs
.
	`’d
()) {

1632 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,

1634 "Priv %d E¼Ü Cod%d", 
©Œ
, 
	`STD_ERR_EXT_ERRID
(
rc
),

1635 
	`STD_ERR_EXT_PRIV
(
rc
),„c);

1642 
	`ıs_­i_£t_objeù_»tuº_©Œs
(
obj
, 
rc
, "%s set failed : %s",

1643 
©Œ_™
->
£cÚd
.second,

1644 
™
->
£cÚd
.
	`c_¡r
());

1646 
	}
}

1648 
	$if_add_Œack”_fÜ_»lßd
(
ıs_­i_objeù_t
 
cur
, 
boŞ
 
m­³d
, 
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
) {

1649 
®Ÿs
[100];

1650 ià(
m­³d
) {

1651 
	`¢´štf
(
®Ÿs
,×lŸs),"NAS## %d %d",
Åu
,
pÜt
);

1653 
	`¢´štf
(
®Ÿs
,(alias),"NAS##");

1655 
	`ıs_­i_objeù_©Œ_add
(
cur
,
NAS_OS_IF_ALIAS
,
®Ÿs
,
	`¡¾’
(alias)+1);

1656 
	`Çs_os_š‹rçû_£t_©Œibu‹
(
cur
,
NAS_OS_IF_ALIAS
);

1657 
	}
}

1659 
t_¡d_”rÜ
 
	$upd©e_if_Œack”
(cÚ¡ *
Çme
, 
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
boŞ
 
cÚÃù
)

1661 
h®_ifšdex_t
 
if_šdex
 = 0;

1662 ià(
	`Çs_št_Çme_to_if_šdex
(&
if_šdex
, 
Çme
è!ğ
STD_ERR_OK
) {

1663 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INTF-UPDATE", "Failedo get ifindex for interface %s",

1664 
Çme
);

1665  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

1667 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

1668 ià(
obj
 =ğ
nuÎ±r
) {

1669 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INTF-UPDATE", "Failedo create cps object");

1670  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

1672 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

1673 
if_šdex
);

1674 ià(!
cÚÃù
) {

1675 
Åu
 = 
pÜt
 = 0;

1677 
	`if_add_Œack”_fÜ_»lßd
(
obj
, 
cÚÃù
, 
Åu
, 
pÜt
);

1678 
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
, 
NAS_OS_IF_ALIAS
);

1679  
STD_ERR_OK
;

1680 
	}
}

1682 
boŞ
 
	$if_g‘_Œack”_d‘as
(
ıs_­i_objeù_t
 
cur
, 
boŞ
& 
m­³d
, 
Åu_id_t
 &
Åu
,
pÜt_t
 &
pÜt
) {

1683 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
,
NAS_OS_IF_ALIAS
);

1684 ià(
©Œ
==
NULL
è 
çl£
;

1686 
¡d_·r£d_¡ršg_t
 
hªdË
;

1687 ià(!
	`¡d_·r£_¡ršg
(&
hªdË
,(cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
©Œ
)," ")) {

1688  
çl£
;

1691 
boŞ
 
rc
 = 
çl£
;

1692 cÚ¡ *
_hash
ğ
	`¡d_·r£_¡ršg_©
(
hªdË
,0);

1693 
size_t
 
tok_num
 = 
	`¡d_·r£_¡ršg_num_tok’s
(
hªdË
);

1695 ià(
_hash
 =ğ
nuÎ±r
 || 
	`¡rcmp
("NAS##", _hash) != 0) {

1698 ià(
tok_num
 >= 3) {

1699 
m­³d
 = 
Œue
;

1700 cÚ¡ *
_Åu
 = 
	`¡d_·r£_¡ršg_©
(
hªdË
, 1);

1701 cÚ¡ *
_pÜt
 = 
	`¡d_·r£_¡ršg_©
(
hªdË
, 2);

1702 ià(
_Åu
 =ğ
nuÎ±r
 || 
_pÜt
 ==‚ullptr) {

1705 
Åu
 = (
Åu_id_t
)
	`©oi
(
_Åu
);

1706 
pÜt
 = (
pÜt_t
)
	`©oi
(
_pÜt
);

1708 
m­³d
 = 
çl£
;

1710 
rc
 = 
Œue
;

1713 
	`¡d_·r£_¡ršg_ä“
(
hªdË
);

1714  
rc
;

1715 
	}
}

1718 
ıs_­i_»tuº_code_t
 
	$_if_ü—‹
(
ıs_­i_objeù_t
 
cur
, cps_­i_objeù_ˆ
´ev
) {

1720 
ıs_­i_objeù_©Œ_t
 
_Çme
 = 
	`ıs_­i_g‘_key_d©a
(
cur
,
IF_INTERFACES_INTERFACE_NAME
);

1721 
ıs_­i_objeù_©Œ_t
 
_Åu
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
);

1722 
ıs_­i_objeù_©Œ_t
 
_pÜt
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
);

1723 
ıs_­i_objeù_©Œ_t
 
_›tf_ty³
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
, 
IF_INTERFACES_INTERFACE_TYPE
);

1725 ià(
_Çme
 =ğ
nuÎ±r
) {

1726 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-CREATE", "Interface create fail: Name‚ot…resent ");

1727  
ıs_­i_»t_code_ERR
;

1730 
Çs_št_ty³_t
 
_ty³
;

1731 iàĞ
_›tf_ty³
 !ğ
nuÎ±r
) {

1732 cÚ¡ *
›tf_štf_ty³
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_›tf_ty³
);

1733 ià(
	`›tf_to_Çs_if_ty³_g‘
(
›tf_štf_ty³
, &
_ty³
è=ğ
çl£
) {

1734 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-CREATE","Could‚Ù cÚv”ˆth% ty³ØÇ iàty³",
›tf_štf_ty³
);

1735  
ıs_­i_»t_code_ERR
;

1738 
_ty³
 = 
Çs_št_ty³_PORT
;

1742 cÚ¡ *
Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_Çme
);

1743 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT-CREATE", "IÁ”çû c»©»ûived fÜ %s", 
Çme
);

1745 
t_¡d_”rÜ
 
rc
;

1746 
boŞ
 
Åu_pÜt_´e£Á
 = 
çl£
;

1747 
Åu_id_t
 
Åu
 = 0, 
pÜt
 = 0;

1748 ià(
_Åu
 !ğ
nuÎ±r
 && 
_pÜt
 !=‚ullptr) {

1749 
Åu
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_Åu
);

1750 
pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_pÜt
);

1751 ià(
	`Çs_št_pÜt_id_u£d
(
Åu
, 
pÜt
)) {

1752 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-CREATE", "Interface‡lreadyƒxists‡t %d:%d",

1753 ()
Åu
,()
pÜt
);

1754  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
PARAM
,0);

1756 
Åu_pÜt_´e£Á
 = 
Œue
;

1759 ià(
	`Çs_št_pÜt_Çme_u£d
(
Çme
)) {

1760 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-CREATE", "Interface %s‡lreadyƒxists",

1761 
Çme
);

1762  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
PARAM
,0);

1765 
	`EV_LOGGING
(
INTERFACE
, 
NOTICE
, "NAS-INT-CREATE", "Create %s interface %s for‚pu %d…ort %d",

1766 
Åu_pÜt_´e£Á
 ? "mapped" : "unmapped",

1767 
Çme
, ()
Åu
, ()
pÜt
);

1768 ià(
Åu_pÜt_´e£Á
) {

1769 
rc
 = 
	`Çs_št_pÜt_ü—‹_m­³d
(
Åu
, 
pÜt
, 
Çme
, 
_ty³
);

1771 
rc
 = 
	`Çs_št_pÜt_ü—‹_unm­³d
(
Çme
, 
_ty³
);

1773 ià(
rc
 !ğ
STD_ERR_OK
) {

1774 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-CREATE", "Failedo create interface");

1775  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

1778 ià(
Åu_pÜt_´e£Á
) {

1779 
ndi_štf_lšk_¡©e_t
 
lšk_¡©e
;

1780 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©e
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
;

1782 
rc
 = 
	`ndi_pÜt_lšk_¡©e_g‘
(
Åu
,
pÜt
,&
lšk_¡©e
);

1783 ià(
rc
==
STD_ERR_OK
) {

1784 
¡©e
 = 
	`ndi_to_ıs_İ”_ty³
(
lšk_¡©e
.
İ”_¡©us
);

1785 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-INT-CREATE", "IÁ”çû % š™ŸÈlšk s‹ i %d",
Çme
,
¡©e
);

1786 
	`Çs_št_pÜt_lšk_chªge
(
Åu
,
pÜt
,
¡©e
);

1790 
h®_ifšdex_t
 
ifix
 = 
Åu_pÜt_´e£Á
 ? 
	`Çs_št_ifšdex_äom_pÜt
(
Åu
,
pÜt
) :

1791 
	`Çs_št_ifšdex_äom_Çme
(
Çme
);

1792 ià(
ifix
 != -1) {

1793 
	`EV_LOGGING
(
INTERFACE
,
NOTICE
,"NAS-INT-CREATE", "Interface created‚ame %s‡nd index %d ",

1794 
Çme
, 
ifix
);

1795 
	`ıs_­i_objeù_©Œ_add_u32
(
cur
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

1796 
ifix
);

1798 
	`if_add_Œack”_fÜ_»lßd
(
cur
, 
Åu_pÜt_´e£Á
, 
Åu
, 
pÜt
);

1800 if(
	`ıs_­i_db_comm™_Úe
(
ıs_­i_İ”_CREATE
,
cur
,
nuÎ±r
,
çl£
)!ğ
ıs_­i_»t_code_OK
){

1801 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-SET","Failedo write…hysical interface objecto db");

1804 
ıs_­i_»tuº_code_t
 
»t
 = 
ıs_­i_»t_code_ERR
;

1805 ià((
»t
 = 
	`_if_upd©e
(
cur
,
´ev
,
çl£
)è!ğ
ıs_­i_»t_code_OK
) {

1806  
»t
;

1809  
ıs_­i_»t_code_OK
;

1811 ià(
Åu_pÜt_´e£Á
) {

1812 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-SET", "Failedo get ifindex from NPU %d PORT %d",

1813 
Åu
, 
pÜt
);

1815 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-SET", "FaedØg‘ ifšdex from NAME %s", 
Çme
);

1819  
ıs_­i_»t_code_ERR
;

1820 
	}
}

1822 
ıs_­i_»tuº_code_t
 
	$if_£t
(* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,
size_t
 
ix
) {

1823 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

1824 ià(
obj
==
nuÎ±r
è 
ıs_­i_»t_code_ERR
;

1826 
ıs_­i_objeù_t
 
´ev
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
·¿m
->prev);

1827 ià(
´ev
==
nuÎ±r
è 
ıs_­i_»t_code_ERR
;

1829 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT-SET", "SET„equest„eceived for…hysical interface");

1830 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

1832 ià(
İ
==
ıs_­i_İ”_CREATE
è 
	`_if_ü—‹
(
obj
,
´ev
);

1833 ià(
İ
==
ıs_­i_İ”_SET
è 
	`_if_upd©e
(
obj
,
´ev
,
Œue
);

1834 ià(
İ
==
ıs_­i_İ”_DELETE
è 
	`_if_d–‘e
(
obj
,
´ev
);

1836  
ıs_­i_»t_code_ERR
;

1837 
	}
}

1840 
	$Çs_št_İ”_¡©e_cb
(
Åu_id_t
 
Åu
, 
Åu_pÜt_t
 
pÜt
,

1841 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©us
)

1844 
buff
[
CPS_API_MIN_OBJ_LEN
];

1845 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_š™
(
buff
,(buff));

1847 
š‹rçû_ù¾_t
 
_pÜt
;

1848 
	`mem£t
(&
_pÜt
,0,(_port));

1849 
_pÜt
.
Åu_id
 = 
Åu
;

1850 
_pÜt
.
pÜt_id
 = 
pÜt
;

1851 
_pÜt
.
q_ty³
 = 
HAL_INTF_INFO_FROM_PORT
;

1852 
	`EV_LOGGING
(
INTERFACE
,
INFO
,

1854 
Åu
, 
pÜt
, 
¡©us
);

1855 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
_pÜt
)!=
STD_ERR_OK
) {

1856 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-INTF-EVENT", "Interface info‚ot found for‚pu %d…ort %d",

1857 
Åu
, 
pÜt
);

1861 
	`Çs_št_pÜt_lšk_chªge
(
Åu
,
pÜt
,
¡©us
);

1863 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

1864 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
,

1865 
ıs_­i_qu®if›r_OBSERVED
)) {

1866 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG",

1867 "Could‚Ù¿n¦©tØlogiÿÈš‹rçû key fÜ‚pu %d…Üˆ%d",
Åu
,
pÜt
);

1871 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_STATE_INTERFACE_NAME
,

1872 
ıs_­i_objeù_ATTR_T_BIN
, 
_pÜt
.
if_Çme
, 
	`¡¾’
(_port.if_name)+1);

1873 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
,
_pÜt
.
if_šdex
);

1874 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
,

1875 
¡©us
);

1877 ià(
_pÜt
.
št_ty³
 =ğ
Çs_št_ty³_FC
) {

1878 
	`Çs_fc_fl_¥“d_autÚeg_¡©e
(
Åu
, 
pÜt
, 
obj
);

1880 
	`_if_fl_š_¥“d_du¶ex_autÚeg_¡©e_©Œs
(
Åu
,
pÜt
,
obj
);

1883 
BASE_CMN_FEC_TYPE_t
 
ãc_mode
;

1884 ià(
	`ndi_pÜt_ãc_g‘
(
Åu
, 
pÜt
, &
ãc_mode
è=ğ
STD_ERR_OK
) {

1885 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_FEC
, 
ãc_mode
);

1888 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INTF-EVENT",

1890 
_pÜt
.
if_Çme
, 
¡©us
);

1891 
	`h®_š‹rçû_£nd_ev’t
(
obj
);

1892 
	}
}

1894 
	$»sync_w™h_os
() {

1895 
ıs_­i_objeù_li¡_gu¬d
 
	`lg
(
	`ıs_­i_objeù_li¡_ü—‹
());

1896 
ıs_­i_objeù_gu¬d
 
	`og
(
	`ıs_­i_objeù_ü—‹
());

1898 if(
lg
.
	`g‘
()==
nuÎ±r
 || 
og
.get()==nullptr) {

1902 ià(
	`Çs_os_g‘_š‹rçû
(
og
.
	`g‘
(),
lg
.g‘())!=
STD_ERR_OK
) {

1906 
size_t
 
ix
 = 0;

1907 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
lg
.
	`g‘
());

1908  ; 
ix
 < 
mx
 ; ++ix ) {

1909 
ıs_­i_objeù_t
 
cur
 = 
	`ıs_­i_objeù_li¡_g‘
(
lg
.
	`g‘
(),
ix
);

1911 
ıs_­i_objeù_©Œ_t
 
_Çme
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
,
IF_INTERFACES_INTERFACE_NAME
);

1912 ià(
_Çme
==
nuÎ±r
) ;

1914 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-INT-CREATE", "Looking‡t interface %s",

1915 (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_Çme
));

1917 
Åu_id_t
 
Åu
 = 0;

1918 
pÜt_t
 
pÜt
 = 0;

1919 
boŞ
 
m­³d
 = 
Œue
;

1920 ià(!
	`if_g‘_Œack”_d‘as
(
cur
, 
m­³d
, 
Åu
, 
pÜt
)) {

1923 
ıs_­i_objeù_gu¬d
 
	`´ev
(
	`ıs_­i_objeù_ü—‹
());

1924 if(!
´ev
.
	`v®id
()) ;

1926 ià(
m­³d
) {

1927 
	`ıs_­i_objeù_©Œ_add_u32
(
cur
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
, 
Åu
);

1928 
	`ıs_­i_objeù_©Œ_add_u32
(
cur
,
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
,
pÜt
);

1931 ià(
	`_if_ü—‹
(
cur
,
´ev
.
	`g‘
())!=
ıs_­i_»t_code_OK
) {

1932 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-RELOAD", "R–ßd faed fÜ %d:%d",()
Åu
,()
pÜt
);

1935 
	}
}

1937 
t_¡d_”rÜ
 
	$_Çs_št_Åu_pÜt_š™
() {

1938 
Åu_id_t
 
Åu
 = 0;

1939 
Åu_id_t
 
Åu_max
 = (Åu_id_t)
	`Çs_sw™ch_g‘_max_Åus
();

1941  ; 
Åu
 < 
Åu_max
 ; ++npu ) {

1942 
Åu_pÜt_t
 
ıu_pÜt
 = 0;

1943 ià(
	`ndi_ıu_pÜt_g‘
(
Åu
, &
ıu_pÜt
)==
STD_ERR_OK
) {

1944 
buff
[100];

1945 
	`¢´štf
(
buff
,(buff),"Åu-%d",
Åu
);

1946 
t_¡d_”rÜ
 
rc
 = 
	`Çs_št_pÜt_ü—‹_m­³d
(
Åu
, 
ıu_pÜt
, 
buff
, 
Çs_št_ty³_CPU
);

1947 ià(
rc
==
STD_ERR_OK
) {

1948 
	`Çs_št_pÜt_lšk_chªge
(
Åu
,
ıu_pÜt
,
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
);

1949 
ıs_­i_objeù_gu¬d
 
	`og
(
	`ıs_­i_objeù_ü—‹
());

1950 ià(!
og
.
	`v®id
()) {

1951 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-INIT","Memory‡llocation failure");

1952  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1954 
	`ıs_­i_objeù_©Œ_add_u32
(
og
.
	`g‘
(),
IF_INTERFACES_INTERFACE_ENABLED
,

1955 
Œue
);

1957 
	`ıs_­i_objeù_©Œ_add_u32
(
og
.
	`g‘
(),
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
,

1958 
	`Çs_št_ifšdex_äom_pÜt
(
Åu
,
ıu_pÜt
));

1961 
	`Çs_os_š‹rçû_£t_©Œibu‹
(
og
.
	`g‘
(),
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
);

1963 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
og
.
	`g‘
()),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_OBSERVED
);

1964 
	`ıs_­i_objeù_£t_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
og
.
	`g‘
()),

1965 
ıs_­i_İ”_CREATE
 );

1966 
	`ıs_­i_ev’t_th»ad_publish
(
og
.
	`g‘
());

1971  
STD_ERR_OK
;

1972 
	}
}

1974 
ıs_­i_»tuº_code_t
 
	$loİback_if_g‘
(* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
* 
·¿m
,

1975 
size_t
 
key_ix
)

1977 
ıs_­i_objeù_t
 
ft
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
key_ix
);

1979 
ıs_­i_objeù_©Œ_t
 
ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
ft
,

1980 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

1981 
ıs_­i_objeù_©Œ_t
 
Çme
 = 
	`ıs_­i_g‘_key_d©a
(
ft
,
IF_INTERFACES_INTERFACE_NAME
);

1983 
boŞ
 
if_ty³_added
 = 
çl£
;

1984 ià(
ifix
 =ğ
nuÎ±r
 && 
Çme
 !=‚ullptr) {

1985 
š‹rçû_ù¾_t
 
_pÜt
;

1986 ià(!
	`if_d©a_äom_obj
(
obj_INTF
, 
ft
,
_pÜt
)) {

1987 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-GET", "WrÚg iÁ”çû‚amÜ iÁ”çû‚Ù…»£Á %s",
_pÜt
.
if_Çme
);

1988  
ıs_­i_»t_code_ERR
;

1990 
	`ıs_­i_objeù_©Œ_add_u32
(
ft
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,

1991 
_pÜt
.
if_šdex
);

1992 } ià(
ifix
 =ğ
nuÎ±r
 && 
Çme
 ==‚ullptr) {

1993 
	`ıs_­i_objeù_©Œ_add_u32
(
ft
, 
BASE_IF_LINUX_IF_INTERFACES_INTERFACE_DELL_TYPE
,

1994 
BASE_CMN_INTERFACE_TYPE_LOOPBACK
);

1995 
if_ty³_added
 = 
Œue
;

1998 
t_¡d_”rÜ
 
rc
 = 
	`Çs_os_g‘_š‹rçû
(
ft
,
·¿m
->
li¡
);

2000 ià(
if_ty³_added
) {

2001 
	`ıs_­i_objeù_©Œ_d–‘e
(
ft
, 
BASE_IF_LINUX_IF_INTERFACES_INTERFACE_DELL_TYPE
);

2004 ià(
rc
 !ğ
STD_ERR_OK
) {

2005 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-GET", "Failedo get interfaces from OS");

2006  
ıs_­i_»t_code_ERR
;

2009 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
·¿m
->
li¡
);

2010 
size_t
 
ix
 = 0;

2011 
ix
 < 
mx
) {

2012 
ıs_­i_objeù_t
 
objeù
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
li¡
, 
ix
);

2013 
ıs_­i_objeù_©Œ_t
 
ifix
 = 
	`ıs_­i_objeù_©Œ_g‘
(
objeù
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

2014 ià(
ifix
 =ğ
nuÎ±r
) {

2015 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-GET", "Could‚Ù fšd ifšdex iÀobjeù %lu", 
ix
);

2016 
	`ıs_­i_objeù_li¡_»move
(
·¿m
->
li¡
, 
ix
);

2017 
	`ıs_­i_objeù_d–‘e
(
objeù
);

2018 --
mx
;

2021 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
objeù
), 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

2022 
ıs_­i_qu®if›r_TARGET
);

2023 
š‹rçû_ù¾_t
 
_pÜt
;

2024 
	`mem£t
(&
_pÜt
,0,(_port));

2025 
_pÜt
.
if_šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
ifix
);

2026 
_pÜt
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

2027 if(
	`dn_h®_g‘_š‹rçû_šfo
(&
_pÜt
è!ğ
STD_ERR_OK
) {

2028 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-INT-GET", "FaedØg‘„egi¡”ed infØfÜ ifšdex %d", 
_pÜt
.
if_šdex
);

2029 
	`ıs_­i_objeù_li¡_»move
(
·¿m
->
li¡
, 
ix
);

2030 
	`ıs_­i_objeù_d–‘e
(
objeù
);

2031 --
mx
;

2035 
	`ıs_­i_objeù_©Œ_add
(
objeù
,
IF_INTERFACES_INTERFACE_TYPE
,

2036 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_SOFTWARELOOPBACK
,

2037 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_SOFTWARELOOPBACK
)+1);

2040 ++ 
ix
;

2043  
ıs_­i_»t_code_OK
;

2044 
	}
}

2046 
ıs_­i_»tuº_code_t
 
	$loİback_if_£t
(* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
* 
·¿m
,

2047 
size_t
 
ix
)

2050  
ıs_­i_»t_code_ERR
;

2051 
	}
}

2053 
t_¡d_”rÜ
 
	$Çs_št_logiÿl_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
) {

2055 
	`¡d_rw_lock_ü—‹_deçuÉ
(&
_logiÿl_pÜt_lock
);

2057 ià(
	`Çs_št_pÜt_š™
()!=
STD_ERR_OK
) {

2058 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-INIT", "Faildo initab subsystem");

2059  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

2062 
	`»sync_w™h_os
();

2064 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF
, 
Çs_št_ty³_PORT
, 
if_g‘
, 
if_£t
è!ğ
STD_ERR_OK
) {

2065 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-INIT", "Failedo„egister PHY interface CPS handler");

2066  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

2069 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF
, 
Çs_št_ty³_FC
, 
if_g‘
, 
if_£t
è!ğ
STD_ERR_OK
) {

2070 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-INIT", "Failedo„egister PHY interface CPS handler");

2071  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

2074 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF_STATE
, 
Çs_št_ty³_PORT
, 
if_¡©e_g‘
, 
if_¡©e_£t
)

2075 !ğ
STD_ERR_OK
) {

2076 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-INIT", "Failedo„egister PHY interface state CPS handler");

2077  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

2080 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF_STATE
, 
Çs_št_ty³_FC
, 
if_¡©e_g‘
, 
if_¡©e_£t
)

2081 !ğ
STD_ERR_OK
) {

2082 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-INIT", "Failedo„egister FC PHY interface state CPS handler");

2083  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

2086 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF
, 
Çs_št_ty³_CPU
, 
if_ıu_pÜt_g‘
, 
if_ıu_pÜt_£t
è!ğ
STD_ERR_OK
) {

2087 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-INIT", "Failedo„egister CPU interface CPS handler");

2088  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

2091 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF_STATE
, 
Çs_št_ty³_LPBK
, 
loİback_if_¡©e_g‘
, 
loİback_if_¡©e_£t
è!ğ
STD_ERR_OK
) {

2092 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-INIT", "Failedo„egister Loopback interface state CPS handler");

2093  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

2096 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF
, 
Çs_št_ty³_LPBK
, 
loİback_if_g‘
, 
loİback_if_£t
è!ğ
STD_ERR_OK
) {

2097 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-INT-INIT", "Failedo„egister Loopback interface CPS handler");

2098  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

2101 
	`Çs_št_İ”_¡©e_»gi¡”_cb
(
Çs_št_İ”_¡©e_cb
);

2103 
t_¡d_”rÜ
 
rc
;

2104 ià((
rc
=
	`_Çs_št_Åu_pÜt_š™
())!=
STD_ERR_OK
) {

2105  
rc
;

2108  
STD_ERR_OK
;

2109 
	}
}

	@src/port/nas_int_physical_cps.cpp

17 
	~"Çs_št_physiÿl_ıs.h
"

19 
	~"d–l-ba£-¶©fÜm-commÚ.h
"

20 
	~"d–l-ba£-medŸ.h
"

21 
	~"d–l-ba£-if-phy.h
"

22 
	~"d–l-ba£-if.h
"

24 
	~"Çs_os_š‹rçû.h
"

25 
	~"h®_if_m­pšg.h
"

27 
	~"h®_š‹rçû_commÚ.h
"

28 
	~"h®_š‹rçû_deçuÉs.h
"

29 
	~"Çs_ndi_pÜt.h
"

30 
	~"Çs_št_logiÿl.h
"

31 
	~"Çs_št_uts.h
"

33 
	~"ıs_şass_m­.h
"

34 
	~"ıs_­i_objeù_key.h
"

35 
	~"ıs_­i_İ”©iÚ.h
"

36 
	~"ev’t_log.h
"

37 
	~"Çs_sw™ch.h
"

38 
	~"Çs_š‹rçû_fc.h
"

40 
	~<veùÜ
>

41 
	~<unÜd”ed_m­
>

43 
	s_pÜt_ÿche
 {

44 
ušt32_t
 
	mäÚt_·Ãl_pÜt
;

45 
ušt32_t
 
	mloİback
;

46 
BASE_IF_SPEED_t
 
	m¥“d
;

47 
BASE_IF_PHY_MODE_TYPE_t
 
	mphy_mode
;

50 
usšg
 
	gNasPhyPÜtM­
 = 
¡d
::
unÜd”ed_m­
<
ušt_t
, 
	g_pÜt_ÿche
>;

51 
NasPhyPÜtM­
 
	g_phy_pÜt
;

53 
	#MAX_HWPORT_PER_PORT
 10

	)

55 
ıs_­i_»tuº_code_t
 
	$Çs_fc_to_‘h_¥“d
(
BASE_IF_SPEED_t
 
¥“d
, 
size_t
 
hwp_couÁ
, BASE_IF_SPEED_ˆ*
Åu_¥“d
) {

56 
¥“d
) {

57 
BASE_IF_SPEED_8GFC
:

58 *
Åu_¥“d
 = 
BASE_IF_SPEED_10GIGE
;

60 
BASE_IF_SPEED_16GFC
:

61 ià(
hwp_couÁ
 == 1)

62 *
Åu_¥“d
 = 
BASE_IF_SPEED_25GIGE
;

63 ià(
hwp_couÁ
 == 2)

64 *
Åu_¥“d
 = 
BASE_IF_SPEED_20GIGE
;

66  
ıs_­i_»t_code_ERR
;

68 
BASE_IF_SPEED_32GFC
:

69 ià(
hwp_couÁ
 == 2)

70 *
Åu_¥“d
 = 
BASE_IF_SPEED_50GIGE
;

71 ià(
hwp_couÁ
 == 4)

72 *
Åu_¥“d
 = 
BASE_IF_SPEED_40GIGE
;

75  
ıs_­i_»t_code_ERR
;

77  
ıs_­i_»t_code_OK
;

79 
	}
}

80 
boŞ
 
	$_is_ıu_pÜt
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
) {

81 
Åu_pÜt_t
 
ıu_pÜt
 = 0;

82 ià(
	`ndi_ıu_pÜt_g‘
(
Åu
, &
ıu_pÜt
)==
STD_ERR_OK
 && 
pÜt
==cpu_port) {

83  
Œue
;

85  
çl£
;

86 
	}
}

88 
boŞ
 
	$g‘_hw_pÜt
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ušt32_t
& 
hwpÜt
) {

89  
	`ndi_hwpÜt_li¡_g‘
(
Åu
, 
pÜt
, &
hwpÜt
è=ğ
STD_ERR_OK
;

90 
	}
}

92 
	$š™_phy_pÜt_obj
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

93 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

94 
BASE_IF_PHY_PHYSICAL_OBJ
,
ıs_­i_qu®if›r_TARGET
);

96 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_PHYSICAL_NPU_ID
,
Åu
);

97 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_PHYSICAL_PORT_ID
,
pÜt
);

98 
	}
}

100 
	$_if_fl_š_suµÜ‹d_¥“ds_©Œs
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,

101 
ıs_­i_objeù_t
 
obj
) {

102 
size_t
 
¥“d_couÁ
 = 
NDI_PORT_SUPPORTED_SPEED_MAX
;

103 
BASE_IF_SPEED_t
 
¥“d_li¡
[
NDI_PORT_SUPPORTED_SPEED_MAX
];

104 ià(
	`ndi_pÜt_suµÜ‹d_¥“d_g‘
(
Åu
,
pÜt
,&
¥“d_couÁ
, 
¥“d_li¡
è=ğ
STD_ERR_OK
) {

105 
size_t
 
mx
 = 
¥“d_couÁ
;

106 
size_t
 
ix
 =0;ix < 
mx
; ix++) {

107 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_PHYSICAL_SUPPORTED_SPEED
, 
¥“d_li¡
[
ix
]);

110 
	}
}

112 
_pÜt_ÿche
* 
	$g‘_phy_pÜt_ÿche
(
Åu_id_t
 
Åu
, 
ušt_t
 
pÜt
)

114 
ušt32_t
 
hwpÜt
;

115 ià(!
	`g‘_hw_pÜt
(
Åu
, 
pÜt
, 
hwpÜt
)) {

116  
nuÎ±r
;

118 autØ
™
 = 
_phy_pÜt
.
	`fšd
(
hwpÜt
);

119 ià(
™
 =ğ
_phy_pÜt
.
	`’d
()) {

120 
_phy_pÜt
[
hwpÜt
].
äÚt_·Ãl_pÜt
 = 0;

121 
_phy_pÜt
[
hwpÜt
].
loİback
 = 0;

122 
_phy_pÜt
[
hwpÜt
].
phy_mode
 = 
BASE_IF_PHY_MODE_TYPE_ETHERNET
;

124 
BASE_IF_SPEED_t
 
¥“d
;

125 ià(
	`ndi_pÜt_¥“d_g‘_nocheck
(
Åu
, 
pÜt
, &
¥“d
è=ğ
STD_ERR_OK
) {

126 
_phy_pÜt
[
hwpÜt
].
¥“d
 = speed;

128 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY", "Failedo get speed of…hysical…ort %d",

129 
pÜt
);

130 
_phy_pÜt
[
hwpÜt
].
¥“d
 = 
BASE_IF_SPEED_0MBPS
;

134  &
_phy_pÜt
[
hwpÜt
];

135 
	}
}

137 
t_¡d_”rÜ
 
	$Çs_št_g‘_phy_¥“d
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
BASE_IF_SPEED_t
* 
¥“d
)

139 ià(
¥“d
 =ğ
nuÎ±r
) {

140  
	`STD_ERR
(
INTERFACE
, 
PARAM
, 0);

143 
_pÜt_ÿche
* 
pÜt_šfo
 = 
	`g‘_phy_pÜt_ÿche
(
Åu
, 
pÜt
);

144 ià(
pÜt_šfo
 =ğ
nuÎ±r
) {

145 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,

147 
Åu
, 
pÜt
);

148  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

151 *
¥“d
 = 
pÜt_šfo
->speed;

152  
STD_ERR_OK
;

153 
	}
}

155 
	$make_phy_pÜt_d‘as
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
ıs_­i_objeù_t
 
obj
) {

156 
	`š™_phy_pÜt_obj
(
Åu
,
pÜt
,
obj
);

158 ià(
	`_is_ıu_pÜt
(
Åu
, 
pÜt
)) {

162 
ušt32_t
 
hwpÜt
;

163 ià(
	`g‘_hw_pÜt
(
Åu
,
pÜt
,
hwpÜt
)) {

164 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_PHYSICAL_HARDWARE_PORT_ID
,
hwpÜt
);

167 
ušt32_t
 
hwpÜt_li¡
[
MAX_HWPORT_PER_PORT
] = {0};

168 
size_t
 
couÁ
 = 
MAX_HWPORT_PER_PORT
;

169 ià(
	`ndi_hwpÜt_li¡_g‘_li¡
(
Åu
, 
pÜt
, 
hwpÜt_li¡
, &
couÁ
è=ğ
STD_ERR_OK
) {

170 
size_t
 
idx
 = 0; idx < 
couÁ
; idx ++) {

171 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_PHYSICAL_HARDWARE_PORT_LIST
,

172 
hwpÜt_li¡
[
idx
]);

176 
	`_if_fl_š_suµÜ‹d_¥“ds_©Œs
(
Åu
,
pÜt
,
obj
);

178 autØ
phy_pÜt
 = 
	`g‘_phy_pÜt_ÿche
(
Åu
, 
pÜt
);

179 if(
phy_pÜt
 !ğ
nuÎ±r
) {

180 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_PHYSICAL_FRONT_PANEL_NUMBER
,

181 
phy_pÜt
->
äÚt_·Ãl_pÜt
);

182 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_PHYSICAL_LOOPBACK
, 
phy_pÜt
->
loİback
);

183 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_PHYSICAL_SPEED
, 
phy_pÜt
->
¥“d
);

184 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_PHYSICAL_PHY_MODE
, 
phy_pÜt
->
phy_mode
);

186 
	}
}

188 
ıs_­i_»tuº_code_t
 
	$_phy_št_g‘
 (* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

189 
size_t
 
key_ix
) {

191 
ıs_­i_objeù_t
 
ft
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
key_ix
);

193 
Åu_id_t
 
Åu
 = 0;

194 
Åu_id_t
 
Åu_max
 = (Åu_id_t)
	`Çs_sw™ch_g‘_max_Åus
();

196 
ıs_­i_objeù_©Œ_t
 
_Åu
 = 
	`ıs_­i_g‘_key_d©a
(
ft
,
BASE_IF_PHY_PHYSICAL_NPU_ID
);

197 
ıs_­i_objeù_©Œ_t
 
_pÜt
 = 
	`ıs_­i_g‘_key_d©a
(
ft
,
BASE_IF_PHY_PHYSICAL_PORT_ID
);

198 
ıs_­i_objeù_©Œ_t
 
_hw_pÜt
 = 
	`ıs_­i_g‘_key_d©a
(
ft
,
BASE_IF_PHY_PHYSICAL_HARDWARE_PORT_ID
);

200  
Åu
 = 0;‚pu< 
Åu_max
 ; ++npu){

201 ià(
_Åu
!=
NULL
 && 
	`ıs_­i_objeù_©Œ_d©a_u32
(_Åu)!=(
ušt32_t
)
Åu
) ;

203 
štf_max_pÜts
 = 
	`ndi_max_Åu_pÜt_g‘
(
Åu
);

204 
pÜt_t
 
pÜt
 = 0;…Üˆ< 
štf_max_pÜts
 ; ++port ) {

205 ià(
_pÜt
!=
NULL
 && 
	`ıs_­i_objeù_©Œ_d©a_u32
(_pÜt)!=
pÜt
) ;

207 ià(
_hw_pÜt
!=
NULL
) {

208 
ušt32_t
 
hwpÜt
;

209 ià(
	`g‘_hw_pÜt
(
Åu
,
pÜt
,
hwpÜt
)) {

210 ià(
	`ıs_­i_objeù_©Œ_d©a_u32
(
_hw_pÜt
)!=
hwpÜt
) ;

215 ià(!
	`ndi_pÜt_is_v®id
(
Åu
, 
pÜt
è|| 
	`_is_ıu_pÜt
(npu,…ort)) {

219 
ıs_­i_objeù_t
 
o
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
·¿m
->
li¡
);

220 ià(
o
==
NULL
è 
ıs_­i_»t_code_ERR
;

222 
	`make_phy_pÜt_d‘as
(
Åu
,
pÜt
,
o
);

225  
ıs_­i_»t_code_OK
;

226 
	}
}

228 
ıs_­i_»tuº_code_t
 
	$_phy_£t
(
ıs_­i_objeù_t
 
»q
, cps_­i_objeù_ˆ
´ev
) {

229 
	`STD_ASSERT
(
´ev
!=
nuÎ±r
 && 
»q
!=nullptr);

231 
ıs_­i_objeù_©Œ_t
 
_Åu
 = 
	`ıs_­i_g‘_key_d©a
(
»q
,
BASE_IF_PHY_PHYSICAL_NPU_ID
);

232 
ıs_­i_objeù_©Œ_t
 
_pÜt
 = 
	`ıs_­i_g‘_key_d©a
(
»q
,
BASE_IF_PHY_PHYSICAL_PORT_ID
);

234 ià(
_Åu
==
nuÎ±r
 || 
_pÜt
==nullptr) {

235 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-PHY","Set„eq missing key instances");

236  
ıs_­i_»t_code_ERR
;

239 
Åu_id_t
 
Åu
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_Åu
);

240 
pÜt_t
 
pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_pÜt
);

242 ià(
	`_is_ıu_pÜt
(
Åu
, 
pÜt
)) {

243 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-PHY","Cª'ˆmodifyhCPU…Üˆ%d:%d",
Åu
,
pÜt
);

244  
ıs_­i_»t_code_ERR
;

247 autØ
phy_pÜt
 = 
	`g‘_phy_pÜt_ÿche
(
Åu
, 
pÜt
);

248 ià(
phy_pÜt
 =ğ
nuÎ±r
) {

249 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY", "Can't find…hy…ort cache");

250  
ıs_­i_»t_code_ERR
;

253 
ıs_­i_objeù_©Œ_t
 
_å
 = 
	`ıs_­i_g‘_key_d©a
(
»q
,
BASE_IF_PHY_PHYSICAL_FRONT_PANEL_NUMBER
);

254 
ıs_­i_objeù_©Œ_t
 
_loİback
 = 
	`ıs_­i_g‘_key_d©a
(
»q
,
BASE_IF_PHY_PHYSICAL_LOOPBACK
);

256 ià(
_å
!=
nuÎ±r
) {

257 
phy_pÜt
->
äÚt_·Ãl_pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_å
);

260 ià(
_loİback
 !ğ
nuÎ±r
) {

261 ià(
	`ndi_pÜt_loİback_£t
(
Åu
, 
pÜt
,

262 (
BASE_CMN_LOOPBACK_TYPE_t
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
_loİback
)è!ğ
STD_ERR_OK
) {

263 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-PHY","FaedØ£ˆloİback fÜ %d:%d",
Åu
,
pÜt
);

264  
ıs_­i_»t_code_ERR
;

266 
phy_pÜt
->
loİback
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_loİback
);

269 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
»q
),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_OBSERVED
);

270 
	`h®_š‹rçû_£nd_ev’t
(
»q
);

271 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
»q
),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_TARGET
);

273  
ıs_­i_»t_code_OK
;

274 
	}
}

276 
ıs_­i_»tuº_code_t
 
	$_phy_ü—‹
(
ıs_­i_objeù_t
 
cur
, cps_­i_objeù_ˆ
´ef
)

278 
ıs_­i_objeù_©Œ_t
 
Åu_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
, 
BASE_IF_PHY_PHYSICAL_NPU_ID
);

279 
ıs_­i_objeù_©Œ_t
 
¥“d_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
, 
BASE_IF_PHY_PHYSICAL_SPEED
);

280 
BASE_IF_PHY_MODE_TYPE_t
 
phy_mode
 = 
BASE_IF_PHY_MODE_TYPE_ETHERNET
;

282 ià(
Åu_©Œ
 =ğ
nuÎ±r
 || 
¥“d_©Œ
 ==‚ullptr) {

283 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY-CREATE", "Required‡ttribute‚ot…resent");

284  
ıs_­i_»t_code_ERR
;

287 
Åu_id_t
 
Åu_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
Åu_©Œ
);

288 
BASE_IF_SPEED_t
 
¥“d
 =

289 (
BASE_IF_SPEED_t
)
	`ıs_­i_objeù_©Œ_d©a_u32
(
¥“d_©Œ
);

290 
BASE_IF_SPEED_t
 
Åu_¥“d
 = 
¥“d
;

292 
¡d
::
veùÜ
<
ušt32_t
> 
hw_pÜts
;

293 
ıs_­i_objeù_™_t
 
™
;

294 
	`ıs_­i_objeù_™_begš
(
cur
, &
™
);

295 
	`ıs_­i_objeù_™_©Œ_w®k
(&
™
, 
BASE_IF_PHY_PHYSICAL_HARDWARE_PORT_LIST
)) {

296 
ušt32_t
 
pÜt_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

297 
hw_pÜts
.
	`push_back
(
pÜt_id
);

298 
	`ıs_­i_objeù_™_Ãxt
(&
™
);

300 ià(
hw_pÜts
.
	`size
() == 0) {

301 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY-CREATE", "No hardware…ort…resent");

302  
ıs_­i_»t_code_ERR
;

304 
ıs_­i_objeù_©Œ_t
 
_phy_mode_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
, 
BASE_IF_PHY_PHYSICAL_PHY_MODE
);

305 ià(
_phy_mode_©Œ
 !ğ
nuÎ±r
) {

306 
phy_mode
 = (
BASE_IF_PHY_MODE_TYPE_t
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
_phy_mode_©Œ
);

308 ià(
phy_mode
 =ğ
BASE_IF_PHY_MODE_TYPE_FC
) {

309 ià(
	`Çs_fc_to_‘h_¥“d
(
¥“d
, 
hw_pÜts
.
	`size
(), &
Åu_¥“d
è=ğ
ıs_­i_»t_code_ERR
) {

310 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY-CREATE", "Wrong FC Speed ");

311  
ıs_­i_»t_code_ERR
;

315 
Åu_pÜt_t
 
phy_pÜt_id
;

316 
t_¡d_”rÜ
 
rc
 = 
	`ndi_phy_pÜt_ü—‹
(
Åu_id
, 
Åu_¥“d
,

317 
hw_pÜts
.
	`d©a
(), hw_pÜts.
	`size
(),

318 &
phy_pÜt_id
);

319 ià(
rc
 !ğ
STD_ERR_OK
) {

320 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY-CREATE", "Failure on NDI…ort creation");

321  
ıs_­i_»t_code_ERR
;

324 
	`ıs_­i_objeù_©Œ_add_u32
(
cur
, 
BASE_IF_PHY_PHYSICAL_PORT_ID
, 
phy_pÜt_id
);

326 ià(
phy_mode
 =ğ
BASE_IF_PHY_MODE_TYPE_FC
) {

328 ià(
	`Çs_ıs_ü—‹_fc_pÜt
(
Åu_id
, 
phy_pÜt_id
, 
¥“d
, 
hw_pÜts
.
	`d©a
(), hw_pÜts.
	`size
()è!ğ
ıs_­i_»t_code_OK
) {

329 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY-CREATE", "Failure on NDI FC…ort creation");

330  
ıs_­i_»t_code_ERR
;

334 
ušt32_t
 
hwpÜt
;

335 ià(!
	`g‘_hw_pÜt
(
Åu_id
, 
phy_pÜt_id
, 
hwpÜt
)) {

336 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY-CREATE", "Failedo get hw…ort for…ort %d",

337 
phy_pÜt_id
);

338  
ıs_­i_»t_code_ERR
;

341 autØ
phy_™
 = 
_phy_pÜt
.
	`fšd
(
hwpÜt
);

342 ià(
phy_™
 =ğ
_phy_pÜt
.
	`’d
()) {

343 
_phy_pÜt
[
hwpÜt
].
äÚt_·Ãl_pÜt
 = 0;

344 
_phy_pÜt
[
hwpÜt
].
loİback
 = 0;

346 
ıs_­i_objeù_©Œ_t
 
å_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
,

347 
BASE_IF_PHY_PHYSICAL_FRONT_PANEL_NUMBER
);

348 ià(
å_©Œ
 !ğ
nuÎ±r
) {

349 
_phy_pÜt
[
hwpÜt
].
äÚt_·Ãl_pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
å_©Œ
);

351 
_phy_pÜt
[
hwpÜt
].
¥“d
 = speed;

352 
_phy_pÜt
[
hwpÜt
].
phy_mode
 =…hy_mode;

354 
	`make_phy_pÜt_d‘as
(
Åu_id
, 
phy_pÜt_id
, 
cur
);

356  
ıs_­i_»t_code_OK
;

357 
	}
}

359 
ıs_­i_»tuº_code_t
 
	$_phy_d–‘e
(
ıs_­i_objeù_t
 
cur
, cps_­i_objeù_ˆ
´ef
)

361 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_ERR
;

362 
ıs_­i_objeù_©Œ_t
 
Åu_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
, 
BASE_IF_PHY_PHYSICAL_NPU_ID
);

363 
ıs_­i_objeù_©Œ_t
 
pÜt_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
cur
, 
BASE_IF_PHY_PHYSICAL_PORT_ID
);

365 ià(
Åu_©Œ
 =ğ
nuÎ±r
 || 
pÜt_©Œ
 ==‚ullptr) {

366 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY-DELETE", "Required‡ttribute‚ot…resent");

367  
ıs_­i_»t_code_ERR
;

370 
Åu_id_t
 
Åu_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
Åu_©Œ
);

371 
Åu_pÜt_t
 
pÜt_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
pÜt_©Œ
);

373 
ušt32_t
 
hwpÜt
;

374 ià(!
	`g‘_hw_pÜt
(
Åu_id
, 
pÜt_id
, 
hwpÜt
)) {

375 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY-DELETE", "Failedo get hw…ort for…ort %d",

376 
pÜt_id
);

377  
ıs_­i_»t_code_ERR
;

380 autØ
phy_™
 = 
_phy_pÜt
.
	`fšd
(
hwpÜt
);

381 ià(
phy_™
 !ğ
_phy_pÜt
.
	`’d
(è&& (_phy_pÜt[
hwpÜt
].
phy_mode
 =ğ
BASE_IF_PHY_MODE_TYPE_FC
)) {

382 ià((
rc
 = 
	`Çs_ıs_d–‘e_fc_pÜt
(
Åu_id
, 
pÜt_id
)è!=
ıs_­i_»t_code_OK
 ){

383 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY-DELETE", "Failure on NDI FC…ort delete");

384  
rc
;

390 
t_¡d_”rÜ
 
»t
 = 
	`ndi_phy_pÜt_d–‘e
(
Åu_id
, 
pÜt_id
);

391 ià(
»t
 !ğ
STD_ERR_OK
) {

392 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-PHY-DELETE", "Failure on NDI…ort delete");

393  
ıs_­i_»t_code_ERR
;

396 autØ
™
 = 
_phy_pÜt
.
	`fšd
(
hwpÜt
);

397 ià(
™
 !ğ
_phy_pÜt
.
	`’d
()) {

398 
_phy_pÜt
.
	`”a£
(
™
);

401  
ıs_­i_»t_code_OK
;

402 
	}
}

404 
ıs_­i_»tuº_code_t
 
	$_phy_št_£t
(* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,
size_t
 
ix
) {

405 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

406 ià(
obj
==
NULL
è 
ıs_­i_»t_code_ERR
;

408 
ıs_­i_objeù_t
 
´ev
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
·¿m
->prev);

409 ià(
´ev
==
nuÎ±r
è 
ıs_­i_»t_code_ERR
;

411 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

413 ià(
İ
==
ıs_­i_İ”_CREATE
è 
	`_phy_ü—‹
(
obj
,
´ev
);

414 ià(
İ
==
ıs_­i_İ”_SET
è 
	`_phy_£t
(
obj
,
´ev
);

415 ià(
İ
==
ıs_­i_İ”_DELETE
è 
	`_phy_d–‘e
(
obj
,
´ev
);

417 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-PHY","Invalid operation");

419  
ıs_­i_»t_code_ERR
;

420 
	}
}

422 
	$_ndi_pÜt_ev’t_upd©e_
 (
ndi_pÜt_t
 *
ndi_pÜt
, 
ndi_pÜt_ev’t_t
 
ev’t
, 
ušt32_t
 
hwpÜt
) {

423 
ıs_­i_objeù_gu¬d
 
	`og
(
	`ıs_­i_objeù_ü—‹
());

425 
	`š™_phy_pÜt_obj
(
ndi_pÜt
->
Åu_id
,ndi_pÜt->
Åu_pÜt
,
og
.
	`g‘
());

427 
	`ıs_­i_objeù_©Œ_add_u32
(
og
.
	`g‘
(),
BASE_IF_PHY_PHYSICAL_HARDWARE_PORT_ID
,
hwpÜt
);

429 ià(!(
ev’t
 =ğ
ndi_pÜt_ADD
 ||ƒv’t==
ndi_pÜt_DELETE
))  ;

431 
	`ıs_­i_objeù_£t_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
og
.
	`g‘
()),
ev’t
 =ğ
ndi_pÜt_ADD
 ?

432 
ıs_­i_İ”_CREATE
 : 
ıs_­i_İ”_DELETE
 );

434 
	`h®_š‹rçû_£nd_ev’t
(
og
.
	`g‘
());

435 
	}
}

437 
t_¡d_”rÜ
 
	$Çs_št_ıs_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
) {

439 
ıs_­i_»gi¡¿tiÚ_funùiÚs_t
 
f
;

440 
buff
[
CPS_API_KEY_STR_MAX
];

441 
	`mem£t
(&
f
,0,(f));

443 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
f
.
key
,
BASE_IF_PHY_PHYSICAL_OBJ
,
ıs_­i_qu®if›r_TARGET
)) {

444 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-REG","Could‚otranslate %do key %s",

445 ()(
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
),

446 
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

447  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

449 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"NAS-IF-REG","Registering for %s",

450 
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

451 
f
.
hªdË
 = handle;

452 
f
.
_»ad_funùiÚ
 = 
_phy_št_g‘
;

453 
f
.
_wr™e_funùiÚ
 = 
_phy_št_£t
;

454 ià(
	`ıs_­i_»gi¡”
(&
f
)!=
ıs_­i_»t_code_OK
) {

455  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

458 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

459 
Åu_id_t
 
Åu
 = 0;

460 
Åu_id_t
 
Åu_max
 = (Åu_id_t)
	`Çs_sw™ch_g‘_max_Åus
();

461  ; 
Åu
 < 
Åu_max
 ; ++npu ) {

462 
rc
 = 
	`ndi_pÜt_ev’t_cb_»gi¡”
(
Åu
,
_ndi_pÜt_ev’t_upd©e_
);

463 ià(
rc
!=
STD_ERR_OK
) „c;

466  
	`Çs_št_logiÿl_š™
(
hªdË
);

467 
	}
}

	@src/port/nas_int_port.cpp

24 
	~"h®_if_m­pšg.h
"

25 
	~"h®_š‹rçû_commÚ.h
"

26 
	~"ıs_­i_objeù_key.h
"

27 
	~"ıs_­i_İ”©iÚ.h
"

28 
	~"ıs_şass_m­.h
"

29 
	~"Çs_os_š‹rçû.h
"

30 
	~"d–l-ba£-if.h
"

31 
	~"d–l-ba£-if-phy.h
"

32 
	~"Çs_št_pÜt.h
"

33 
	~"Çs_št_uts.h
"

35 
	~"swp_ut_p.h
"

37 
	~"¡d_”rÜ_codes.h
"

38 
	~"ev’t_log.h
"

39 
	~"¡d_as£¹.h
"

40 
	~"¡d_rw_lock.h
"

41 
	~"¡d_mu‹x_lock.h
"

42 
	~"¡d_time_toŞs.h
"

43 
	~"¡d__uts.h
"

45 
	~<veùÜ
>

46 
	~<¡dio.h
>

47 
	~<¡dlib.h
>

48 
	~<¡ršg.h
>

49 
	~<uni¡d.h
>

50 
	~<ev’t2/ev’t.h
>

51 
	~<sigÇl.h
>

52 
	~<unÜd”ed_m­
>

56 
	#MAX_QUEUE
 1

	)

58 
	#NAS_PKT_COUNT_TO_READ
 10

	)

60 
	#NAS_NFLOG_PKT_COUNT_TO_READ
 1

	)

62 
	#INVALID_PORT_ID
 -1

	)

65 
¡d_rw_lock_t
 
	gpÜts_lock
 = 
PTHREAD_RWLOCK_INITIALIZER
;

66 
¡d_mu‹x_lock_ü—‹_¡©ic_š™_ç¡
(
p_fd_lock
);

68 şas 
	cCNasPÜtD‘as
 {

69 
	m´iv©e
:

70 
boŞ
 
_u£d
 = 
çl£
;

71 
Åu_id_t
 
	m_Åu
 = 0;

72 
pÜt_t
 
	m_pÜt
 = 0;

73 
boŞ
 
	m_m­³d
 = 
çl£
;

74 
swp_ut_p_desü
 
	m_dsü
=
nuÎ±r
;

75 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
	m_lšk
 =

76 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
;

77 
	mpublic
:

79 
vœtu®
 
boŞ
 
ü—‹
(cÚ¡ *
Çme
);

80 
vœtu®
 
	$š™
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
) {

81 
_Åu
 = 
Åu
;

82 
_pÜt
 = 
pÜt
;

83 
_m­³d
 = 
Œue
;

85 
vœtu®
 
	$š™
() {

86 
_m­³d
 = 
çl£
;

87 
	}
}

88 
vœtu®
 
boŞ
 
d–
();

90 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
	$lšk_¡©e
() const {

91  
_lšk
;

92 
	}
}

94 
vœtu®
 
£t_lšk_¡©e
(
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©e
);

96 
h®_ifšdex_t
 
	$ifšdex
 () const;

97 
boŞ
 
	$v®id
(ècÚ¡ {  
_u£d
; 
	}
}

98 
boŞ
 
	$m­³d
(ècÚ¡ {  
_m­³d
; 
	}
}

100 
šlše
 
Åu_id_t
 
	$Åu
(ècÚ¡ {  
_Åu
; 
	}
}

101 
šlše
 
pÜt_t
 
	$pÜt
(ècÚ¡ {  
_pÜt
; 
	}
}

102 
šlše
 
swp_ut_p_desü
 
	$p
(ècÚ¡ {  
_dsü
; 
	}
}

104 
	gvœtu®
 ~
CNasPÜtD‘as
();

107 şas 
	cCNasDummyPÜt
 : 
public
 
CNasPÜtD‘as
 {

108 
public
:

109 
vœtu®
 
boŞ
 
	$ü—‹
(cÚ¡ *
Çme
è
ov”ride
 { 
Œue
;}

110 
vœtu®
 
	$š™
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
è
ov”ride
 {
	}
}

111 
vœtu®
 
	$š™
(è
ov”ride
 {
	}
}

112 
vœtu®
 
boŞ
 
	$d–
(è
ov”ride
 { 
Œue
;
	}
}

113 
vœtu®
 
	$£t_lšk_¡©e
(
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©e
è
ov”ride
 {
	}
}

116 şas 
	cNasPÜtLi¡
 {

117 
	m´iv©e
:

118 
CNasPÜtD‘as
* 
_dummy_pÜt
 = 
nuÎ±r
;

119 
	m¡d
::
unÜd”ed_m­
<
¡d
::
¡ršg
, 
	mCNasPÜtD‘as
> 
	mpÜt_Çme_šfo_m­
;

120 
	m¡d
::
veùÜ
<
¡d
::veùÜ<
CNasPÜtD‘as
*>> 
pÜt_id_šfo_li¡
;

121 
	mpublic
:

122 
¡d
::
veùÜ
<
CNasPÜtD‘as
*>& 
İ”©Ü
[](
Åu_id_t
 
Åu
)

124  
pÜt_id_šfo_li¡
[
Åu
];

126 
	$»size
(
size_t
 
Åus
è{
pÜt_id_šfo_li¡
.
	`»size
Òpus);
	}
}

127 
	$”a£
(
¡d
::
¡ršg
 
Çme
è{
pÜt_Çme_šfo_m­
.
	`”a£
Òame);
	}
}

128 
CNasPÜtD‘as
* 
	$dummy_pÜt
(è{ 
_dummy_pÜt
;
	}
}

129 cÚ¡ 
	gCNasPÜtD‘as
& 
	gİ”©Ü
[](
	g¡d
::
¡ršg
 
Çme
) const;

130 
	gCNasPÜtD‘as
& 
	gİ”©Ü
[](
	g¡d
::
¡ršg
 
Çme
è{ 
pÜt_Çme_šfo_m­
[name];}

131 
NasPÜtLi¡
();

132 
	gvœtu®
 ~
NasPÜtLi¡
();

135 
	gNasPÜtLi¡
::
	$NasPÜtLi¡
()

137 
_dummy_pÜt
 = 
Ãw
 
	`CNasDummyPÜt
();

138 
	}
}

140 
	gNasPÜtLi¡
::~
	$NasPÜtLi¡
()

142 ià(
_dummy_pÜt
 !ğ
nuÎ±r
) {

143 
d–‘e
 
_dummy_pÜt
;

144 
_dummy_pÜt
 = 
nuÎ±r
;

146 
	}
}

148 cÚ¡ 
	gCNasPÜtD‘as
& 
	gNasPÜtLi¡
::
İ”©Ü
[](
¡d
::
¡ršg
 
Çme
) const

150 autØ
™”
 = 
pÜt_Çme_šfo_m­
.
fšd
(
Çme
);

151 ià(
	g™”
 =ğ
pÜt_Çme_šfo_m­
.
’d
()) {

152  *
_dummy_pÜt
;

154  
	g™”
->
	g£cÚd
;

157 
	gNasPÜtLi¡
& 
	g_pÜts
 = *
Ãw
 
NasPÜtLi¡
();

160 
	g¡d
::
	tunÜd”ed_m­
<,
	tev’t
 *> 
	t_fd_to_ev’t_šfo_m­_t
;

162 
	s_Çs_vif_pkt_tx_t
 {

163 
ev’t_ba£
 *
	mÇs_evt_ba£
;

164 
ev’t
 *
	mÇs_sigÇl_ev’t
;

165 
h®_vœt_pkt_Œªsm™
 
	meg»ss_tx_cb
;

167 
h®_vœt_pkt_Œªsm™_to_šg»ss_p–še
 
	mtx_to_šg»ss_fun
;

168 *
	mtx_buf
;

169 
	mtx_buf_Ën
;

170 
ev’t
 *
	mÇs_næog_fd_ev
;

171 
	mÇs_næog_fd
;

172 
_fd_to_ev’t_šfo_m­_t
 
	m_p_fd_to_ev’t_šfo_m­
;

173 } 
	tÇs_vif_pkt_tx_t
;

175 
Çs_vif_pkt_tx_t
 
	gg_vif_pkt_tx
;

177 
	gÇs_næog_pkts_tx_to_šg»ss_p–še
 = 0;

178 
	gÇs_næog_pkts_tx_to_šg»ss_p–še_drİ³d
 = 0;

179 
ušt8_t
 
	gde¡_v4_äom_Ï¡_pkt
[4];

180 
time¥ec
 
	gts_Ï¡_pkt_£Á
 = {0,0};

182 
	s_¬p_h—d”
 {

183 
ušt16_t
 
	mhty³
;

184 
ušt16_t
 
	m±y³
;

185 
ušt8_t
 
	mhËn
;

186 
ušt8_t
 
	m¶’
;

187 
ušt16_t
 
	mİ”©iÚ
;

188 
ušt8_t
 
	m£nd”_hw_addr
[6];

189 
ušt8_t
 
	m£nd”_
[4];

190 
ušt8_t
 
	mrg‘_hw_addr
[6];

191 
ušt8_t
 
	mrg‘_
[4];

192 } 
	t¬p_h—d”_t
;

195 
´oûss_·ck‘s
 (
evut_sock‘_t
 
fd
, 
evt
, *
¬g
);

196 
´oûss_næog_·ck‘s
 (
evut_sock‘_t
 
fd
, 
evt
, *
¬g
);

199 
t_¡d_”rÜ
 
	$Çs_add_fd_to_evt_šfo_m­
 (
fd
, 
ev’t
 *
fd_evt
)

201 
g_vif_pkt_tx
.
_p_fd_to_ev’t_šfo_m­
[
fd
] = 
fd_evt
;

202  
STD_ERR_OK
;

203 
	}
}

206 
t_¡d_”rÜ
 
	$Çs_d–_fd_äom_evt_šfo_m­
 (
fd
)

208 
g_vif_pkt_tx
.
_p_fd_to_ev’t_šfo_m­
.
	`”a£
(
fd
);

209  
STD_ERR_OK
;

210 
	}
}

216 
t_¡d_”rÜ
 
	$p_fd_»gi¡”_w™h_evt
 (
swp_ut_p_desü
 
p
, 
CNasPÜtD‘as
 *
Çs_pÜt
) {

217 
fd_£t
 
fds
;

218 
ev’t
 *
Çs_fd_ev
 = 
NULL
;

220 
	`FD_ZERO
(&
fds
);

223 
	`swp_ut_p_fd_£t_add
(&
p
, 1, &
fds
);

225 
Œue
) {

227 
fd
 = 
	`swp_ut_p_fd_loÿ‹_äom_£t
(
p
, &
fds
);

228 ià(
fd
 < 0)

230 
	`FD_CLR
(
fd
, &
fds
);

232 autØ
™
 = 
g_vif_pkt_tx
.
_p_fd_to_ev’t_šfo_m­
.
	`fšd
(
fd
);

233 ià(
™
 !ğ
g_vif_pkt_tx
.
_p_fd_to_ev’t_šfo_m­
.
	`’d
())

236 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-UP",

238 
	`swp_ut_p_desü_g‘_Çme
(
p
),
fd
);

243 
Çs_fd_ev
 = 
	`ev’t_Ãw
(
g_vif_pkt_tx
.
Çs_evt_ba£
, 
fd
,

244 
EV_READ
 | 
EV_PERSIST
, 
´oûss_·ck‘s
, (*)
Çs_pÜt
);

246 ià(!
Çs_fd_ev
) {

247 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-TX", "NAS Packet„eadƒvent create failed for interface (%s) fd (%d).",

248 
	`swp_ut_p_desü_g‘_Çme
(
p
),
fd
);

249  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

252 ià(
	`ev’t_add
(
Çs_fd_ev
, 
NULL
) < 0) {

253 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-TX", "NAS Packet„eadƒvent‡dd failed for interface (%s) fd (%d).",

254 
	`swp_ut_p_desü_g‘_Çme
(
p
),
fd
);

255 
	`ev’t_ä“
 (
Çs_fd_ev
);

256  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

260 
	`Çs_add_fd_to_evt_šfo_m­
 (
fd
, 
Çs_fd_ev
);

263  
STD_ERR_OK
;

264 
	}
}

271 
t_¡d_”rÜ
 
	$p_fd_d”egi¡”_äom_evt
 (
swp_ut_p_desü
 
p
) {

272 
fd_£t
 
fds
;

274 
	`FD_ZERO
(&
fds
);

277 
	`swp_ut_p_fd_£t_add
(&
p
, 1, &
fds
);

278 
Œue
) {

280 
fd
 = 
	`swp_ut_p_fd_loÿ‹_äom_£t
(
p
, &
fds
);

281 ià(
fd
 < 0)

283 
	`FD_CLR
(
fd
, &
fds
);

285 autØ
™
 = 
g_vif_pkt_tx
.
_p_fd_to_ev’t_šfo_m­
.
	`fšd
(
fd
);

286 ià(
™
 =ğ
g_vif_pkt_tx
.
_p_fd_to_ev’t_šfo_m­
.
	`’d
())

289 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-UP",

291 
	`swp_ut_p_desü_g‘_Çme
(
p
),
fd
);

294 
ev’t
 *
Çs_fd_ev
 = (ev’ˆ*)
™
->
£cÚd
;

296 
	`Çs_d–_fd_äom_evt_šfo_m­
 (
fd
);

299 
	`ev’t_d–
(
Çs_fd_ev
);

300 
	`ev’t_ä“
(
Çs_fd_ev
);

303  
STD_ERR_OK
;

304 
	}
}

307 
boŞ
 
	$p_lšk_down
(
swp_ut_p_desü
 
p
) {

308 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`l
(&
p_fd_lock
);

310 
	`p_fd_d”egi¡”_äom_evt
 (
p
);

311 
	`swp_ut_şo£_fds
(
p
);

312  
Œue
;

313 
	}
}

315 
boŞ
 
	$p_lšk_up
(
swp_ut_p_desü
 
p
, 
CNasPÜtD‘as
 *
Åu
) {

318 
	`p_fd_d”egi¡”_äom_evt
 (
p
);

319 
	`swp_ut_şo£_fds
(
p
);

321 
size_t
 
»Œy
 = 0;

322 cÚ¡ 
size_t
 
MAX_RETRY
 = 12;

323 
boŞ
 
sucûss
 = 
çl£
;

324  ; 
»Œy
 < 
MAX_RETRY
 ; ++retry ) {

325 ià(
	`swp_ut_®loc_p
(
p
,
SWP_UTIL_TYPE_TAP
)!=
STD_ERR_OK
) {

326 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-LINK",

328 
	`swp_ut_p_desü_g‘_Çme
(
p
),
»Œy
);

329 
	`¡d_u¦“p
(
	`MILLI_TO_MICRO
((1<<
»Œy
)));

332 ià(
	`p_fd_»gi¡”_w™h_evt
(
p
, 
Åu
è!ğ
STD_ERR_OK
) {

333 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-LINK",

335 
	`swp_ut_p_desü_g‘_Çme
(
p
),
»Œy
);

337 
	`p_fd_d”egi¡”_äom_evt
 (
p
);

338 
	`swp_ut_şo£_fds
(
p
);

339 
	`¡d_u¦“p
(
	`MILLI_TO_MICRO
((1<<
»Œy
)));

342 
sucûss
 = 
Œue
;

345 ià(!
sucûss
) {

346  
çl£
;

348 
	`EV_LOG
(
TRACE
,
INTERFACE
,0,"INT-LINK", "Lšk u°% ",
	`swp_ut_p_desü_g‘_Çme
(
p
));

349  
Œue
;

350 
	}
}

353 
	$p_d–‘e
(
swp_ut_p_desü
 
p
) {

355 
	`p_lšk_down
(
p
);

357 cÚ¡ * 
Çme
 = 
	`swp_ut_p_desü_g‘_Çme
(
p
);

359 ià(
	`swp_ut_p_İ”©iÚ
(
Çme
,
SWP_UTIL_TYPE_TAP
,
çl£
)!=
STD_ERR_OK
) {

360 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INTF-DEL", "FaedØd–‘lšux iÁ”çû %s",
Çme
);

363 
	`swp_ut_ä“_desüs
(
p
);

364 
	}
}

366 
swp_ut_p_desü
 
	$p_ü—‹
(
CNasPÜtD‘as
 *
Åu
, cÚ¡ * 
Çme
, 
ušt_t
 
queues
) {

367 
swp_ut_p_desü
 
p
 = 
	`swp_ut_®loc_desü
();

368 ià(
p
==
nuÎ±r
) ap;

370 
	`swp_ut_p_desü_š™_wÇme
(
p
,
Çme
,
NULL
,NULL,NULL,NULL,
queues
);

372 ià(
	`swp_ut_p_İ”©iÚ
(
Çme
,
SWP_UTIL_TYPE_TAP
,
Œue
)!=
STD_ERR_OK
) {

373 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INTF-DEL", "FaedØü—‹†šux iÁ”çû %s",
Çme
);

375  
p
;

376 
	}
}

378 
	gCNasPÜtD‘as
::~
	$CNasPÜtD‘as
() {

380 
	}
}

382 
boŞ
 
CNasPÜtD‘as
::
	$d–
() {

383 
_u£d
 = 
çl£
;

384 ià(
_dsü
==
nuÎ±r
è 
Œue
;

385 
	`£t_lšk_¡©e
(
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
);

387 
	`p_d–‘e
(
_dsü
);

389 
_dsü
 = 
nuÎ±r
;

390  
Œue
;

391 
	}
}

393 
boŞ
 
	gCNasPÜtD‘as
::
	$ü—‹
(cÚ¡ *
Çme
) {

394 ià(
_u£d
è 
Œue
;

395 
_u£d
 = 
Œue
;

396 
_dsü
 = 
	`p_ü—‹
(
this
,
Çme
,
MAX_QUEUE
);

397  
Œue
;

398 
	}
}

400 
	gCNasPÜtD‘as
::
	$£t_lšk_¡©e
(
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©e
) {

401 ià(
_dsü
 =ğ
nuÎ±r
 || 
_lšk
 =ğ
¡©e
) ;

402 ià(
¡©e
 =ğ
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
) {

403 ià(
	`p_lšk_up
(
_dsü
, 
this
)è
_lšk
=
¡©e
;

405 ià(
¡©e
 =ğ
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
) {

406 
	`p_lšk_down
(
_dsü
);

407 
_lšk
 = 
¡©e
;

409 
	}
}

411 
h®_ifšdex_t
 
	gCNasPÜtD‘as
::
	$ifšdex
() const{

412 ià(
_dsü
==
nuÎ±r
)  -1;

413  
	`swp_š™_p_ifšdex
(
_dsü
);

414 
	}
}

419 
	$Çs_evt_sigÇl_cb
 (
evut_sock‘_t
 
sig_num
, 
evt
, *
¬g
)

421 
Çs_vif_pkt_tx_t
 *
p_vif_pkt_tx
 = (Çs_vif_pkt_tx_ˆ*è
¬g
;

423 autØ
™
 = 
p_vif_pkt_tx
->
_p_fd_to_ev’t_šfo_m­
.
	`begš
();

424 ; 
™
 !ğ
p_vif_pkt_tx
->
_p_fd_to_ev’t_šfo_m­
.
	`’d
();) {

426 
ev’t
 *
Çs_fd_ev
 = (ev’ˆ*è
™
->
£cÚd
;

428 
™
 = 
p_vif_pkt_tx
->
_p_fd_to_ev’t_šfo_m­
.
	`”a£
(it);

431 
	`ev’t_d–
(
Çs_fd_ev
);

432 
	`ev’t_ä“
(
Çs_fd_ev
);

435 
	`ev’t_d–
 (
g_vif_pkt_tx
.
Çs_næog_fd_ev
);

436 
	`ev’t_ä“
 (
g_vif_pkt_tx
.
Çs_næog_fd_ev
);

437 
g_vif_pkt_tx
.
Çs_næog_fd
 = -1;

439 
	`ev’t_d–
 (
p_vif_pkt_tx
->
Çs_sigÇl_ev’t
);

440 
	`ev’t_ä“
 (
p_vif_pkt_tx
->
Çs_sigÇl_ev’t
);

441 
	`ev’t_ba£_loİb»ak
(
p_vif_pkt_tx
->
Çs_evt_ba£
);

442 
	}
}

444 
	$Çs_´oûss_·ylßd_ªd_fÜm_·ck‘
 (
ušt8_t
 *
pkt_buf
,

445 
Çs_næog_·¿ms_t
 *
p_Çs_næog_·¿ms
)

447 
	#NSEC_PER_SEC
 1000000000

	)

448 
pkt_Ën
 = 0;

449 
ušt16_t
 
vÏn_id
 = 0;

450 cÚ¡ 
ušt16_t
 
vÏn_´ÙocŞ
 = 
	`htÚs
 (0x8100);

451 cÚ¡ 
ušt16_t
 
¬p_´ÙocŞ
 = 
	`htÚs
 (0x0806);

452 cÚ¡ 
ušt16_t
 
_´ÙocŞ
 = 
	`htÚs
 (0x0800);

453 cÚ¡ 
de¡_mac
[6] = {0xff, 0xff, 0xff, 0xff, 0xff, 0xff};

454 
š‹rçû_ù¾_t
 
štf_ù¾
;

455 
¬p_h—d”_t
 *
p_¬p_h—d”
 = 
NULL
;

456 
time¥ec
 
ts_cur_pkt
;

457 
time¥ec
 
ts_diff
;

462 
p_¬p_h—d”
 = (
¬p_h—d”_t
 *è
p_Çs_næog_·¿ms
->
·ylßd
;

464 ià(!(
p_Çs_næog_·¿ms
->
·ylßd_Ën
))

470 ià((
p_Çs_næog_·¿ms
->
hw_´ÙocŞ
 !ğ
¬p_´ÙocŞ
) ||

471 (
p_¬p_h—d”
->
±y³
 !ğ
_´ÙocŞ
))

477 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

478 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

479 
štf_ù¾
.
if_šdex
 = 
p_Çs_næog_·¿ms
->
out_ifšdex
;

482 ià((
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

483 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-TX", "Processing…ayload failed. Invalid interface %d. ifInfo get failed",

484 
p_Çs_næog_·¿ms
->
out_ifšdex
);

488 
	`şock_g‘time
 (
CLOCK_MONOTONIC
, &
ts_cur_pkt
);

490 
ts_diff
.
tv_n£c
 = (
ts_cur_pkt
.tv_n£ø- 
ts_Ï¡_pkt_£Á
.tv_nsec);

491 
ts_diff
.
tv_£c
 = (
ts_cur_pkt
.tv_£ø- 
ts_Ï¡_pkt_£Á
.tv_sec);

493 
ts_diff
.
tv_n£c
 >ğ
NSEC_PER_SEC
)

495 
ts_diff
.
tv_n£c
 -ğ
NSEC_PER_SEC
;

496 ++
ts_diff
.
tv_£c
;

498 
ts_diff
.
tv_n£c
 < 0)

500 
ts_diff
.
tv_n£c
 +ğ
NSEC_PER_SEC
;

501 --
ts_diff
.
tv_n£c
;

511 ià((
	`memcmp
 (&
de¡_v4_äom_Ï¡_pkt
, &
p_¬p_h—d”
->
rg‘_
, 4) == 0) &&

512 (
ts_diff
.
tv_£c
 < 1))

516 
ts_Ï¡_pkt_£Á
 = 
ts_cur_pkt
;

517 
	`memıy
 (&
de¡_v4_äom_Ï¡_pkt
, &
p_¬p_h—d”
->
rg‘_
, 4);

519 
	`memıy
 ((
pkt_buf
 + 
pkt_Ën
), &
de¡_mac
, 6);

520 
pkt_Ën
 += 6;

523 
	`memıy
 ((
pkt_buf
 + 
pkt_Ën
), 
p_¬p_h—d”
->
£nd”_hw_addr
, 6);

524 
pkt_Ën
 += 6;

526 if(
štf_ù¾
.
št_ty³
 =ğ
Çs_št_ty³_VLAN
)

528 
vÏn_id
 = 
	`htÚs
 (
štf_ù¾
.vlan_id);

530 
	`memıy
 ((
pkt_buf
 + 
pkt_Ën
), &
vÏn_´ÙocŞ
, 2);

531 
pkt_Ën
 += 2;

533 
	`memıy
 ((
pkt_buf
 + 
pkt_Ën
), &
vÏn_id
, 2);

534 
pkt_Ën
 += 2;

536 
	`memıy
 ((
pkt_buf
 + 
pkt_Ën
), &
p_Çs_næog_·¿ms
->
hw_´ÙocŞ
, 2);

537 
pkt_Ën
 += 2;

539 
	`memıy
 ((
pkt_buf
 + 
pkt_Ën
), 
p_Çs_næog_·¿ms
->
·ylßd
,…_Çs_næog_·¿ms->
·ylßd_Ën
);

540 
pkt_Ën
 +ğ
p_Çs_næog_·¿ms
->
·ylßd_Ën
;

542  
pkt_Ën
;

543 
	}
}

550 
	$´oûss_næog_·ck‘s
 (
evut_sock‘_t
 
fd
, 
evt
, *
¬g
)

552 
pkt_Ën
 = 0;

553 
pkt_couÁ
 = 0;

554 
Çs_næog_·¿ms_t
 
næog_·¿ms
;

559 
pkt_couÁ
 < 
NAS_NFLOG_PKT_COUNT_TO_READ
)

561 
pkt_Ën
 = 
	`»ad
(
fd
, 
g_vif_pkt_tx
.
tx_buf
, g_vif_pkt_tx.
tx_buf_Ën
);

563 ià(
pkt_Ën
 <=0)

568 
pkt_couÁ
++;

570 
næog_·¿ms
.
out_ifšdex
 = 0;

571 
næog_·¿ms
.
·ylßd_Ën
 = 0;

573 
	`Çs_os_Æ_g‘_næog_·¿ms
 ((
ušt8_t
 *è
g_vif_pkt_tx
.
tx_buf
,

574 
pkt_Ën
, &
næog_·¿ms
);

576 
pkt_Ën
 = 
	`Çs_´oûss_·ylßd_ªd_fÜm_·ck‘
 ((
ušt8_t
 *è
g_vif_pkt_tx
.
tx_buf
,

577 &
næog_·¿ms
);

582 ià(
pkt_Ën
 > 0) {

583 
Çs_næog_pkts_tx_to_šg»ss_p–še
++;

584 
g_vif_pkt_tx
.
	`tx_to_šg»ss_fun
 (g_vif_pkt_tx.
tx_buf
,
pkt_Ën
);

585 } ià(
pkt_Ën
 == 0) {

586 
Çs_næog_pkts_tx_to_šg»ss_p–še_drİ³d
++;

589 
	}
}

597 
	$´oûss_·ck‘s
 (
evut_sock‘_t
 
fd
, 
evt
, *
¬g
)

599 
pkt_Ën
 = 0;

600 
pkt_couÁ
 = 0;

601 
Åu_id_t
 
Åu
 = 0;

602 
pÜt_t
 
pÜt
 = 0;

611 
CNasPÜtD‘as
 *
d‘as
 = (CNasPÜtD‘a *è
¬g
;

613 
Åu
 = 
d‘as
->
	`Åu
();

614 
pÜt
 = 
d‘as
->
	`pÜt
();

616 
swp_ut_p_desü
 
p
 = 
d‘as
->
	`p
();

621 
pkt_couÁ
 < 
NAS_PKT_COUNT_TO_READ
)

624 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`l
(&
p_fd_lock
);

625 ià(
	`swp_ut_p_is_fd_š_p_fd_£t
(
p
, 
fd
è=ğ
çl£
)

627 
	`EV_LOGGING
(
INTERFACE
,
ERR
, "TAP-TX", "TAP fd closed‡lready. "

629 
Åu
, 
pÜt
, 
fd
);

633 
pkt_Ën
 = 
	`»ad
(
fd
, 
g_vif_pkt_tx
.
tx_buf
, g_vif_pkt_tx.
tx_buf_Ën
);

635 ià(
pkt_Ën
 <=0)

640 
pkt_couÁ
++;

642 
g_vif_pkt_tx
.
	`eg»ss_tx_cb
(
Åu
,
pÜt
,g_vif_pkt_tx.
tx_buf
,
pkt_Ën
);

644 
	}
}

650 
t_¡d_”rÜ
 
	$h®_vœtu®_š‹rçû_wa™
 (
h®_vœt_pkt_Œªsm™
 
tx_fun
,

651 
h®_vœt_pkt_Œªsm™_to_šg»ss_p–še
 
tx_to_šg»ss_fun
,

652 *
d©a
, 
Ën
)

655 
g_vif_pkt_tx
.
Çs_evt_ba£
 = 
NULL
;

656 
g_vif_pkt_tx
.
Çs_sigÇl_ev’t
 = 
NULL
;

657 
g_vif_pkt_tx
.
Çs_næog_fd_ev
 = 
NULL
;

658 
g_vif_pkt_tx
.
Çs_næog_fd
 = -1;

660 
g_vif_pkt_tx
.
eg»ss_tx_cb
 = 
tx_fun
;

661 
g_vif_pkt_tx
.
tx_to_šg»ss_fun
 =x_to_ingress_fun;

662 
g_vif_pkt_tx
.
tx_buf
 = 
d©a
;

663 
g_vif_pkt_tx
.
tx_buf_Ën
 = 
Ën
;

667 
g_vif_pkt_tx
.
Çs_evt_ba£
 = 
	`ev’t_ba£_Ãw
();

668 ià(!
g_vif_pkt_tx
.
Çs_evt_ba£
)

670 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-TX", "NAS Packetƒvent base initialization failed.");

671  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

674 
g_vif_pkt_tx
.
Çs_næog_fd
 = 
	`Çs_os_Æ_næog_š™
 ();

675 ià(
g_vif_pkt_tx
.
Çs_næog_fd
 == -1)

677 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-TX", "NAS NFLOG Packet„ead initialization failed.");

678  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

682 
g_vif_pkt_tx
.
Çs_næog_fd_ev
 = 
	`ev’t_Ãw
(g_vif_pkt_tx.
Çs_evt_ba£
, g_vif_pkt_tx.
Çs_næog_fd
,

683 
EV_READ
 | 
EV_PERSIST
, 
´oûss_næog_·ck‘s
, 
NULL
);

686 ià(!
g_vif_pkt_tx
.
Çs_næog_fd_ev
) {

687 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-TX", "NAS Packet„eadƒvent create failed for‚flog fd (%d).",

688 
g_vif_pkt_tx
.
Çs_næog_fd
);

689  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

692 ià(
	`ev’t_add
(
g_vif_pkt_tx
.
Çs_næog_fd_ev
, 
NULL
) < 0) {

693 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-TX", "NAS Packet„eadƒvent‡dd failed for‚flog fd (%d).",

694 
g_vif_pkt_tx
.
Çs_næog_fd
);

695 
	`ev’t_ä“
 (
g_vif_pkt_tx
.
Çs_næog_fd_ev
);

696  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

701 
g_vif_pkt_tx
.
Çs_sigÇl_ev’t
 = 
	`ev’t_Ãw
 (g_vif_pkt_tx.
Çs_evt_ba£
, 
SIGINT
,

702 
EV_SIGNAL
 | 
EV_PERSIST
, 
Çs_evt_sigÇl_cb
, (*)&
g_vif_pkt_tx
);

704 ià(!
g_vif_pkt_tx
.
Çs_sigÇl_ev’t
 || 
	`ev’t_add
(g_vif_pkt_tx.Çs_sigÇl_ev’t, 
NULL
)<0) {

705 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-TX", "NAS Packet signalƒvent initialization failed.");

706 
	`ev’t_d–
 (
g_vif_pkt_tx
.
Çs_næog_fd_ev
);

707 
	`ev’t_ä“
 (
g_vif_pkt_tx
.
Çs_næog_fd_ev
);

708  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

715 ià(
	`ev’t_ba£_di¥©ch
(
g_vif_pkt_tx
.
Çs_evt_ba£
) != 0) {

716 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-TX", "NAS Packetƒvent dispath failed...Aborting...");

717 
	`ev’t_d–
 (
g_vif_pkt_tx
.
Çs_sigÇl_ev’t
);

718 
	`ev’t_ä“
 (
g_vif_pkt_tx
.
Çs_sigÇl_ev’t
);

720 
	`ev’t_d–
 (
g_vif_pkt_tx
.
Çs_næog_fd_ev
);

721 
	`ev’t_ä“
 (
g_vif_pkt_tx
.
Çs_næog_fd_ev
);

722 
	`ev’t_ba£_ä“
 (
g_vif_pkt_tx
.
Çs_evt_ba£
);

723  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

725  
STD_ERR_OK
;

726 
	}
}

728 
t_¡d_”rÜ
 
	$h®_vœtu®_š‹rçû_£nd
(
Åu_id_t
 
Åu
, 
Åu_pÜt_t
 
pÜt
, 
queue
,

729 cÚ¡ * 
d©a
, 
Ën
) {

730 
fd
 = -1;

732 
¡d_rw_lock_»ad_gu¬d
 
	`l
(&
pÜts_lock
);

733 ià(
_pÜts
[
Åu
][
pÜt
]->
	`lšk_¡©e
()!=
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
) {

734  
STD_ERR_OK
;

736 
fd
 = 
	`swp_ut_p_desü_g‘_queue
(
_pÜts
[
Åu
][
pÜt
]->
	`p
(), 
queue
);

739 ià(
fd
!=-1) {

740 
l
 = 
	`wr™e
(
fd
,
d©a
,
Ën
);

741 ià((()
Ën
)!=
l
è 
	`STD_ERR
(
INTERFACE
,
FAIL
,
”ºo
);

743  
STD_ERR_OK
;

744 
	}
}

746 
boŞ
 
	$Çs_št_pÜt_m­³d
(cÚ¡ * 
Çme
)

748 cÚ¡‡uto& 
pÜts
 = 
_pÜts
;

749 ià(!
pÜts
[
Çme
].
	`v®id
()) {

750  
çl£
;

753  
pÜts
[
Çme
].
	`m­³d
();

754 
	}
}

756 
boŞ
 
	$Çs_št_pÜt_u£d_št
(cÚ¡ * 
Çme
, 
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,

757 
boŞ
 
check_pÜt
)

759 ià(
Çme
 !ğ
nuÎ±r
) {

760 cÚ¡‡uto& 
pÜts
 = 
_pÜts
;

761 ià(!
pÜts
[
Çme
].
	`v®id
()) {

762  
çl£
;

764 ià(
check_pÜt
) {

765  (
pÜts
[
Çme
].
	`Åu
(è=ğ
Åu
 &&

766 
pÜts
[
Çme
].
	`pÜt
(è=ğ
pÜt
);

768 } ià(
check_pÜt
) {

769  
_pÜts
[
Åu
][
pÜt
]->
	`v®id
();

772  
Œue
;

773 
	}
}

775 
boŞ
 
	$Çs_št_pÜt_id_u£d
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
) {

776 
¡d_rw_lock_»ad_gu¬d
 
	`l
(&
pÜts_lock
);

777  
	`Çs_št_pÜt_u£d_št
(
nuÎ±r
, 
Åu
, 
pÜt
, 
Œue
);

778 
	}
}

780 
boŞ
 
	$Çs_št_pÜt_Çme_u£d
(cÚ¡ *
Çme
) {

781 
¡d_rw_lock_»ad_gu¬d
 
	`l
(&
pÜts_lock
);

782  
	`Çs_št_pÜt_u£d_št
(
Çme
, 0, 0, 
çl£
);

783 
	}
}

785 
boŞ
 
	$Çs_št_pÜt_ifšdex
 (
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, 
h®_ifšdex_t
 *
ifšdex
) {

786 
¡d_rw_lock_»ad_gu¬d
 
	`l
(&
pÜts_lock
);

787 ià(!
	`Çs_št_pÜt_u£d_št
(
nuÎ±r
, 
Åu
, 
pÜt
, 
Œue
)) {

788  
çl£
;

790 *
ifšdex
 = 
_pÜts
[
Åu
][
pÜt
]->
	`ifšdex
 ();

791  
Œue
;

792 
	}
}

794 
	$Çs_št_pÜt_lšk_chªge
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,

795 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©e
) {

796 
¡d_rw_lock_wr™e_gu¬d
 
	`l
(&
pÜts_lock
);

798 ià(!
	`Çs_št_pÜt_u£d_št
(
nuÎ±r
, 
Åu
, 
pÜt
, 
Œue
)) {

799 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-STATE", "IÁ”çû s‹ inv®id -‚Øm©chšg…Üˆ%d:%d",()
Åu
,()
pÜt
);

803 
_pÜts
[
Åu
][
pÜt
]->
	`£t_lšk_¡©e
(
¡©e
);

804 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"INT-STATE", "IÁ”çû s‹ chªg%d:%dØ%d",()
Åu
,()
pÜt
,()
¡©e
);

805 
	}
}

807 
t_¡d_”rÜ
 
	$Çs_št_pÜt_ü—‹_št
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, cÚ¡ *
Çme
,

808 
Çs_št_ty³_t
 
ty³
,

809 
boŞ
 
m­³d
) {

811 
¡d_rw_lock_wr™e_gu¬d
 
	`l
(&
pÜts_lock
);

815 ià(
	`Çs_št_pÜt_u£d_št
(
Çme
, 0, 0, 
çl£
)) {

816 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-CREATE", "Not created %s - interfaceƒxist",

817 
Çme
);

818  
	`STD_ERR
(
INTERFACE
,
PARAM
,0);

821 ià(
m­³d
) {

822 
_pÜts
[
Çme
].
	`š™
(
Åu
, 
pÜt
);

824 
_pÜts
[
Çme
].
	`š™
();

826 
_pÜts
[
Çme
].
	`ü—‹
(name);

827 ià(
m­³d
) {

828 
_pÜts
[
Åu
][
pÜt
] = &_pÜts[
Çme
];

831 
š‹rçû_ù¾_t
 
d‘as
;

832 
	`mem£t
(&
d‘as
,0,(details));

833 
d‘as
.
if_šdex
 = 
_pÜts
[
Çme
].
	`ifšdex
();

834 
	`¡ºıy
(
d‘as
.
if_Çme
,
Çme
,(details.if_name)-1);

835 ià(
m­³d
) {

836 
d‘as
.
Åu_id
 = 
Åu
;

837 
d‘as
.
pÜt_id
 = 
pÜt
;

838 
d‘as
.
p_id
 = (
Åu
 << 16è+ 
pÜt
;

840 
d‘as
.
pÜt_id
 = 
¡©ic_ÿ¡
<
Åu_pÜt_t
>(
INVALID_PORT_ID
);

842 
d‘as
.
št_ty³
 = 
ty³
;

843 
d‘as
.
pÜt_m­³d
 = 
m­³d
;

844 
d‘as
.
desc
 = 
nuÎ±r
;

846 ià(
	`dn_h®_if_»gi¡”
(
HAL_INTF_OP_REG
,&
d‘as
)!=
STD_ERR_OK
) {

847 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-CREATE", "Not created %d:%d:%s - mappingƒrror",

848 ()
Åu
,()
pÜt
,
Çme
);

849 ià(
m­³d
) {

850 
_pÜts
[
Åu
][
pÜt
] = _pÜts.
	`dummy_pÜt
();

852 
_pÜts
.
	`”a£
(
Çme
);

853  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

856 
	`EV_LOGGING
(
INTERFACE
,
INFO
,"INT-CREATE", "Interface created %d:%d:%s - %d ",

857 ()
Åu
,()
pÜt
,
Çme
, 
d‘as
.
if_šdex
);

859  
STD_ERR_OK
;

860 
	}
}

862 
t_¡d_”rÜ
 
	$Çs_št_pÜt_ü—‹_m­³d
(
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
, cÚ¡ *
Çme
,

863 
Çs_št_ty³_t
 
ty³
) {

864  
	`Çs_št_pÜt_ü—‹_št
(
Åu
, 
pÜt
, 
Çme
, 
ty³
, 
Œue
);

865 
	}
}

867 
t_¡d_”rÜ
 
	$Çs_št_pÜt_ü—‹_unm­³d
(cÚ¡ *
Çme
, 
Çs_št_ty³_t
 
ty³
) {

868  
	`Çs_št_pÜt_ü—‹_št
(0, 0, 
Çme
, 
ty³
, 
çl£
);

869 
	}
}

871 
t_¡d_”rÜ
 
	$Çs_št_pÜt_d–‘e
(cÚ¡ *
Çme
) {

872 
¡d_rw_lock_wr™e_gu¬d
 
	`l
(&
pÜts_lock
);

874 
š‹rçû_ù¾_t
 
d‘as
;

876 cÚ¡‡uto& 
pÜts
 = 
_pÜts
;

877 cÚ¡‡uto& 
pÜt_šfo
 = 
pÜts
[
Çme
];

878 ià(!
pÜt_šfo
.
	`v®id
()) {

879  
	`STD_ERR
(
INTERFACE
, 
PARAM
, 0);

882 
	`mem£t
(&
d‘as
,0,(details));

883 
d‘as
.
if_šdex
 = 
pÜt_šfo
.
	`ifšdex
();

884 
d‘as
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

886 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
d‘as
)==
STD_ERR_OK
) {

887 ià(
	`dn_h®_if_»gi¡”
(
HAL_INTF_OP_DEREG
,&
d‘as
)!=
STD_ERR_OK
){

888 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"INT-DELETE", "Not deleted %s: - mappingƒrror",

889 
Çme
);

890  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

894 ià(
pÜt_šfo
.
	`m­³d
()) {

895 
Åu_id_t
 
Åu
 = 
pÜt_šfo
.
	`Åu
();

896 
pÜt_t
 
pÜt
 = 
pÜt_šfo
.
	`pÜt
();

897 
_pÜts
[
Åu
][
pÜt
] = _pÜts.
	`dummy_pÜt
();

899 
_pÜts
[
Çme
].
	`d–
();

900 
_pÜts
.
	`”a£
(
Çme
);

902  
STD_ERR_OK
;

903 
	}
}

905 
t_¡d_”rÜ
 
	$Çs_št_pÜt_š™
() {

907 
¡d_rw_lock_wr™e_gu¬d
 
	`l
(&
pÜts_lock
);

908 
size_t
 
Åus
 = 1;

910 
_pÜts
.
	`»size
(
Åus
);

912  
size_t
 
Åu_ix
 = 0;‚pu_ix < 
Åus
 ; ++npu_ix ) {

913 
size_t
 
pÜt_mx
 = 
	`ndi_max_Åu_pÜt_g‘
(
Åu_ix
)*4;

914 
_pÜts
[
Åu_ix
].
	`assign
(
pÜt_mx
, _pÜts.
	`dummy_pÜt
());

916  
STD_ERR_OK
;

917 
	}
}

920 
	$Çs_dbg_dump_p_fd_to_Çs_pÜt_m­_tbl
 ()

922 
	`´štf
("\rFDoƒvent infoable \r\n");

924 
¡d_rw_lock_»ad_gu¬d
 
	`l
(&
pÜts_lock
);

926 autØ&
™
: 
g_vif_pkt_tx
.
_p_fd_to_ev’t_šfo_m­
) {

927 
	`´štf
 ("\rFD: %d \r\n", 
™
.
fœ¡
);

931 
	}
}

933 
	$Çs_næog_dbg_couÁ”s
 ()

935 
	`´štf
("\rNAS NFLOG DEBUG COUNTERS\r\n");

936 
	`´štf
("\r========================\r\n");

937 
	`´štf
("\rTotal…ackets„eceived : %d\r\n",

938 
Çs_næog_pkts_tx_to_šg»ss_p–še
);

939 
	`´štf
("\rTotal flood…ackets dropped : %d\r\n",

940 
Çs_næog_pkts_tx_to_šg»ss_p–še_drİ³d
);

941 
	}
}

943 
	$Çs_næog_dbg_»£t_couÁ”s
 ()

945 
Çs_næog_pkts_tx_to_šg»ss_p–še
 = 0;

946 
Çs_næog_pkts_tx_to_šg»ss_p–še_drİ³d
 = 0;

947 
	}
}

949 
t_¡d_”rÜ
 
	$upd©e_if_»g_šfo
(cÚ¡ *
Çme
, 
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,

950 
boŞ
 
cÚÃù
)

952 
š‹rçû_ù¾_t
 
šfo
;

954 
	`mem£t
(&
šfo
, 0, (info));

955 
	`¡ºıy
(
šfo
.
if_Çme
, 
Çme
, (info.if_name) - 1);

956 
šfo
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

957 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
šfo
è!ğ
STD_ERR_OK
) {

958 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INTF-UPDATE", "Could‚ot find interface %s from…ort info db",

959 
Çme
);

960  
	`STD_ERR
(
INTERFACE
, 
PARAM
, 0);

962 ià(
šfo
.
št_ty³
 !ğ
Çs_št_ty³_PORT
) {

963 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INTF-UPDATE", "Registered info of interface %s is‚ot…ortype",

964 
Çme
);

965  
	`STD_ERR
(
INTERFACE
, 
PARAM
, 0);

967 ià((
cÚÃù
 && 
šfo
.
pÜt_m­³d
) ||

968 (!
cÚÃù
 && (
šfo
.
Åu_id
 !ğ
Åu
 || info.
pÜt_id
 !ğ
pÜt
))) {

969 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INTF-UPDATE", "Reg info mismatch between input‡nd…ort info db");

970  
	`STD_ERR
(
INTERFACE
, 
PARAM
, 0);

973 ià(
	`dn_h®_if_»gi¡”
(
HAL_INTF_OP_DEREG
, &
šfo
è!ğ
STD_ERR_OK
) {

974 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INTF-UPDATE", "Failedo de-register interface %s",

975 
Çme
);

976  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

978 ià(
cÚÃù
) {

979 
šfo
.
Åu_id
 = 
Åu
;

980 
šfo
.
pÜt_id
 = 
pÜt
;

981 
šfo
.
p_id
 = (
Åu
 << 16è+ 
pÜt
;

982 
šfo
.
pÜt_m­³d
 = 
Œue
;

984 
šfo
.
p_id
 = 0;

985 
šfo
.
pÜt_m­³d
 = 
çl£
;

988 ià(
	`dn_h®_if_»gi¡”
(
HAL_INTF_OP_REG
, &
šfo
è!ğ
STD_ERR_OK
) {

989 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INTF-UPDATE", "Failedo„e-register interface %s",

990 
Çme
);

991  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

994  
STD_ERR_OK
;

995 
	}
}

998 
t_¡d_”rÜ
 
	$Çs_št_upd©e_Åu_pÜt
(cÚ¡ *
Çme
, 
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,

999 
boŞ
 
cÚÃù
)

1001 
¡d_rw_lock_wr™e_gu¬d
 
	`l
(&
pÜts_lock
);

1003 ià((
cÚÃù
 && (
	`Çs_št_pÜt_m­³d
(
Çme
) ||

1004 
	`Çs_št_pÜt_u£d_št
(
nuÎ±r
, 
Åu
, 
pÜt
, 
Œue
))) ||

1005 (!
cÚÃù
 && (!
	`Çs_št_pÜt_m­³d
(
Çme
) ||

1006 !
	`Çs_št_pÜt_u£d_št
(
nuÎ±r
, 
Åu
, 
pÜt
, 
Œue
)))) {

1007 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INT-UPDATE", "Interface %s could‚ot be connected or disconnected",

1008 
Çme
);

1009 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INT-UPDATE", "npu %d…ort %d connect %s \
_port mapped %s…hysical_port used %s",

1011 
Åu
, 
pÜt
, 
cÚÃù
 ? "TRUE" : "FALSE",

1012 
	`Çs_št_pÜt_m­³d
(
Çme
) ? "TRUE" : "FALSE",

1013 
	`Çs_št_pÜt_u£d_št
(
nuÎ±r
, 
Åu
, 
pÜt
, 
Œue
) ? "TRUE" : "FALSE");

1014  
	`STD_ERR
(
INTERFACE
, 
PARAM
, 0);

1017 ià(
cÚÃù
) {

1018 
_pÜts
[
Çme
].
	`š™
(
Åu
, 
pÜt
);

1019 
_pÜts
[
Åu
][
pÜt
] = &_pÜts[
Çme
];

1020 
ndi_štf_lšk_¡©e_t
 
lšk_¡©e
;

1021 ià(
	`ndi_pÜt_lšk_¡©e_g‘
(
Åu
, 
pÜt
, &
lšk_¡©e
è!ğ
STD_ERR_OK
) {

1022 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INT-UPDATE", "Failedo get†ink state for…ort %d",

1023 
pÜt
);

1024 
_pÜts
[
Åu
][
pÜt
] = _pÜts.
	`dummy_pÜt
();

1025  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

1027 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
¡©e
 =

1028 
	`ndi_to_ıs_İ”_ty³
(
lšk_¡©e
.
İ”_¡©us
);

1029 
_pÜts
[
Åu
][
pÜt
]->
	`£t_lšk_¡©e
(
¡©e
);

1031 
_pÜts
[
Åu
][
pÜt
]->
	`£t_lšk_¡©e
(
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
);

1032 
_pÜts
[
Çme
].
	`š™
();

1033 
_pÜts
[
Åu
][
pÜt
] = _pÜts.
	`dummy_pÜt
();

1036 ià(
	`ndi_pÜt_admš_¡©e_£t
(
Åu
, 
pÜt
, 
çl£
è!ğ
STD_ERR_OK
) {

1037 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,

1039 
Çme
);

1040  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

1044 ià(
	`upd©e_if_»g_šfo
(
Çme
, 
Åu
, 
pÜt
, 
cÚÃù
è!ğ
STD_ERR_OK
) {

1045 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INTF-UPDATE", "Failedo update„eg info for interface %s",

1046 
Çme
);

1047  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

1050 ià(
	`upd©e_if_Œack”
(
Çme
, 
Åu
, 
pÜt
, 
cÚÃù
è!ğ
STD_ERR_OK
) {

1051 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "INTF-UPDATE", "Failedo updateracker for interface %s",

1052 
Çme
);

1053  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

1056 
	`EV_LOGGING
(
INTERFACE
, 
NOTICE
, "INTF-UPDATE", "Interface %s is %s NPU %d PORT %d",

1057 
Çme
, (
cÚÃù
 ? "connectedo" : "disconnected from"),

1058 
Åu
, 
pÜt
);

1060  
STD_ERR_OK
;

1061 
	}
}

	@src/stats/nas_stats_eee_cps.cpp

23 
	~"d–l-ba£-if.h
"

24 
	~"d–l-š‹rçû.h
"

25 
	~"š‹rçû_obj.h
"

26 
	~"h®_if_m­pšg.h
"

28 
	~"ıs_­i_key.h
"

29 
	~"ıs_­i_objeù_key.h
"

30 
	~"ıs_şass_m­.h
"

31 
	~"ıs_­i_İ”©iÚ.h
"

32 
	~"ev’t_log.h
"

33 
	~"Çs_ndi_¶©_¡©.h
"

34 
	~"Çs_ndi_pÜt.h
"

36 
boŞ
 
	$Çs_g‘_ifšdex
 (
ıs_­i_objeù_t
 
obj
,

37 
h®_ifšdex_t
 *
šdex
,

38 
boŞ
 
ş—r
)

40 
ıs_­i_©Œ_id_t
 
©Œ_id
;

42 ià(
ş—r
) {

43 
©Œ_id
 = 
DELL_IF_CLEAR_EEE_COUNTERS_INPUT_INTF_CHOICE_IFNAME_CASE_IFNAME
;

45 
©Œ_id
 = 
IF_INTERFACES_STATE_INTERFACE_NAME
;

48 
ıs_­i_objeù_©Œ_t
 
if_Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
,
©Œ_id
);

50 ià(
ş—r
) {

51 
©Œ_id
 = 
DELL_IF_CLEAR_EEE_COUNTERS_INPUT_INTF_CHOICE_IFINDEX_CASE_IFINDEX
;

53 
©Œ_id
 = 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
;

56 
ıs_­i_objeù_©Œ_t
 
if_šdex_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
©Œ_id
);

59 ià(
if_šdex_©Œ
 =ğ
NULL
 && 
if_Çme_©Œ
 == NULL) {

60 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-STAT",

62  
çl£
;

65 ià(
if_šdex_©Œ
){

66 *
šdex
 = (
h®_ifšdex_t
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_šdex_©Œ
);

68 cÚ¡ * 
Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
if_Çme_©Œ
);

69 
š‹rçû_ù¾_t
 
i
;

71 
	`mem£t
(&
i
,0,(i));

72 
	`¡ºıy
(
i
.
if_Çme
,
Çme
,(i.if_name)-1);

73 
i
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

74 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
i
)!=
STD_ERR_OK
){

75 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-STAT",

76 "Cª'ˆg‘ iÁ”çû cÚŒŞ infÜm©iÚ fÜ %s", 
Çme
);

77  
çl£
;

79 *
šdex
 = 
i
.
if_šdex
;

81  
Œue
;

82 
	}
}

84 
ıs_­i_»tuº_code_t
 
	$if_“e_¡©s_ş—r
 (*
cÚ‹xt
,

85 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
,

86 
size_t
 
ix
)

89 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

90 
ıs_­i_İ”©iÚ_ty³s_t
 
İ


91 ğ
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

93 ià(
İ
 !ğ
ıs_­i_İ”_ACTION
) {

94 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-EEE-STATS",

95 "Inv®id o³¿tiÚ %d fÜ cË¬šg st", 
İ
);

96  (
ıs_­i_»t_code_ERR
);

99 
h®_ifšdex_t
 
ifšdex
 = 0;

100 ià(!
	`Çs_g‘_ifšdex
(
obj
, &
ifšdex
, 
Œue
)) {

101  (
ıs_­i_»t_code_ERR
);

104 
š‹rçû_ù¾_t
 
štf_ù¾
;

105 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

107 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

108 
štf_ù¾
.
if_šdex
 = 
ifšdex
;

113 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
è!ğ
STD_ERR_OK
) {

114 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-EEE-STATS",

116 
štf_ù¾
.
if_šdex
, iÁf_ù¾.
Åu_id
, iÁf_ù¾.
pÜt_id
);

117  (
ıs_­i_»t_code_ERR
);

123 ià(
	`ndi_pÜt_ş—r_“e_¡©s
(
štf_ù¾
.
Åu_id
, iÁf_ù¾.
pÜt_id
)

124 !ğ
STD_ERR_OK
) {

125 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-EEE-STATS", "NDI failed");

127  (
ıs_­i_»t_code_ERR
);

130 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-EEE-STATS", "leaving");

132  
ıs_­i_»t_code_OK
;

133 
	}
}

138 "C" 
t_¡d_”rÜ
 
	$Çs_“e_¡©s_if_š™
 (
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
) {

140 
ıs_­i_»gi¡¿tiÚ_funùiÚs_t
 
f
;

141 
buff
[
CPS_API_KEY_STR_MAX
];

143 
	`mem£t
(&
f
, 0, (f));

145 
	`mem£t
(
buff
, 0, (buff));

148 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
f
.
key
, 
DELL_BASE_IF_CMN_DELL_IF_CLEAR_EEE_COUNTERS_INPUT_OBJ
,

149 
ıs_­i_qu®if›r_TARGET
)) {

150 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-EEE-STATS",

152 
DELL_BASE_IF_CMN_DELL_IF_CLEAR_EEE_COUNTERS_INPUT_OBJ
,

153 
	`ıs_­i_key_´št
(&
f
.
key
, 
buff
, (buff) - 1));

154  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

157 
f
.
hªdË
 = handle;

158 
f
.
_wr™e_funùiÚ
 = 
if_“e_¡©s_ş—r
;

160 ià(
	`ıs_­i_»gi¡”
(&
f
)!=
ıs_­i_»t_code_OK
) {

161  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

164  
STD_ERR_OK
;

165 
	}
}

	@src/stats/nas_stats_fc_if_cps.cpp

21 
	~"š‹rçû_obj.h
"

22 
	~"Çs_¡©s.h
"

23 
	~"h®_if_m­pšg.h
"

24 
	~"d–l-ba£-if.h
"

25 
	~"d–l-š‹rçû.h
"

26 
	~"›tf-š‹rçûs.h
"

27 
	~"ev’t_log.h
"

28 
	~"ıs_­i_objeù_key.h
"

29 
	~"Çs_ndi_commÚ.h
"

30 
	~"Çs_ndi_fc_¡©.h
"

32 
	~<time.h
>

34 
ušt64_t
 
	tÇs_fc_if_¡©_id_t
;

36 cÚ¡ 
Çs_fc_if_¡©_id_t
 
	gÇs_fc_if_¡©_ids
 [] = {

37 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_BYTES
,

38 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_FRAMES
,

39 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_UCAST_PKTS
,

40 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_BCAST_PKTS
,

41 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_INVALID_CRC
,

42 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_FRAME_TOO_LONG
,

43 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_FRAME_TRUNCATED
,

44 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_LINK_FAIL
,

45 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_LOSS_SYNC
,

46 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_CLASS2_RX_GOOD_FRAMES
,

47 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_CLASS3_RX_GOOD_FRAMES
,

48 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_BB_CREDIT0
,

49 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_BB_CREDIT0_DROP
,

50 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_PRIM_SEQ_ERR
,

51 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_LIP_COUNT
,

52 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TX_BYTES
,

53 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TX_FRAMES
,

54 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TX_UCAST_PKTS
,

55 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TX_BCAST_PKTS
,

56 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_CLASS2_TX_FRAMES
,

57 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_CLASS3_TX_FRAMES
,

58 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TX_BB_CREDIT0
,

59 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TX_OVERSIZE_FRAMES
,

60 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TOTAL_ERRORS
,

63 
size_t
 
	$Çs_¡©s_id_Ën_g‘
()

65  ((
Çs_fc_if_¡©_ids
)/(nas_fc_if_stat_ids[0]));

66 
	}
}

68 
boŞ
 
	$g‘_fc_¡©s
(
h®_ifšdex_t
 
ifšdex
, 
ıs_­i_objeù_li¡_t
 
li¡
){

70 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
li¡
);

72 ià(
obj
 =ğ
NULL
) {

73 
	`EV_LOGGING
(
INTERFACE
, 
ERR
,"NAS-FC-STAT", "Failedo create/append‚ew objecto†ist");

74  
çl£
;

77 
š‹rçû_ù¾_t
 
štf_ù¾
;

78 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

80 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

81 
štf_ù¾
.
if_šdex
 = 
ifšdex
;

83 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
è!ğ
STD_ERR_OK
) {

84 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-FC-STAT","Interface %d has NO slot %d,…ort %d",

85 
štf_ù¾
.
if_šdex
, iÁf_ù¾.
Åu_id
, iÁf_ù¾.
pÜt_id
);

86  
çl£
;

89 cÚ¡ 
size_t
 
max_pÜt_¡©_id
 = 
	`Çs_¡©s_id_Ën_g‘
();

90 
ušt64_t
 
Çs_fc_¡©_v®ues
[
max_pÜt_¡©_id
];

91 
	`mem£t
(
Çs_fc_¡©_v®ues
,0,(nas_fc_stat_values));

93 if(
	`ndi_pÜt_fc_¡©s_g‘
(
štf_ù¾
.
Åu_id
, iÁf_ù¾.
pÜt_id
,

94 (
Çs_fc_if_¡©_id_t
 *)&
Çs_fc_if_¡©_ids
[0],

95 
Çs_fc_¡©_v®ues
,
max_pÜt_¡©_id
è!ğ
STD_ERR_OK
) {

96 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-FC-STAT","Unableo get FC stats for if index %d…ort %d",

97 
štf_ù¾
.
if_šdex
, iÁf_ù¾.
pÜt_id
);

98  
çl£
;

101 
ix
 = 0 ; ix < 
max_pÜt_¡©_id
 ; ++ix ){

102 
	`ıs_­i_objeù_©Œ_add_u64
(
obj
, 
Çs_fc_if_¡©_ids
[
ix
], 
Çs_fc_¡©_v®ues
[ix]);

105 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,

106 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TIME_STAMP
,

107 
	`time
(
NULL
));

109  
Œue
;

110 
	}
}

113 
ıs_­i_»tuº_code_t
 
	$if_fc_¡©s_g‘
 (* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

114 
size_t
 
ix
) {

116 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
ix
);

118 
h®_ifšdex_t
 
ifšdex
=0;

119 if(!
	`Çs_¡©_g‘_ifšdex_äom_obj
(
obj
,&
ifšdex
,
çl£
)){

120  
	`STD_ERR
(
INTERFACE
,
CFG
,0);

123 if(
	`g‘_fc_¡©s
(
ifšdex
,
·¿m
->
li¡
)è 
ıs_­i_»t_code_OK
;

125  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

126 
	}
}

129 
ıs_­i_»tuº_code_t
 
	$if_fc_¡©s_£t
 (* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,

130 
size_t
 
ix
) {

132 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-FC-STAT","Clear specific FC counter‚ot supported");

134  
ıs_­i_»t_code_OK
;

135 
	}
}

137 "C" 
ıs_­i_»tuº_code_t
 
	$Çs_if_fc_¡©s_ş—r
 (* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,

138 
size_t
 
ix
) {

140 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

141 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

143 ià(
İ
 !ğ
ıs_­i_İ”_ACTION
) {

144 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-FC-STAT","Inv®id o³¿tiÚ %d fÜ cË¬šg st",
İ
);

145  
	`STD_ERR
(
INTERFACE
,
PARAM
,0);

148 
h®_ifšdex_t
 
ifšdex
=0;

149 if(!
	`Çs_¡©_g‘_ifšdex_äom_obj
(
obj
,&
ifšdex
,
Œue
)){

150  
	`STD_ERR
(
INTERFACE
,
CFG
,0);

153 
š‹rçû_ù¾_t
 
štf_ù¾
;

154 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

156 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

157 
štf_ù¾
.
if_šdex
 = 
ifšdex
;

159 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
è!ğ
STD_ERR_OK
) {

160 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-FC-STAT","Interface %d has NO slot %d,…ort %d",

161 
štf_ù¾
.
if_šdex
, iÁf_ù¾.
Åu_id
, iÁf_ù¾.
pÜt_id
);

162  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

165 cÚ¡ 
size_t
 
max_pÜt_¡©_id
 = 
	`Çs_¡©s_id_Ën_g‘
();

167 if(
	`ndi_pÜt_fc_¡©s_ş—r
(
štf_ù¾
.
Åu_id
,štf_ù¾.
pÜt_id
,

168 (
Çs_fc_if_¡©_id_t
 *)&
Çs_fc_if_¡©_ids
[0],

169 
max_pÜt_¡©_id
è!ğ
STD_ERR_OK
) {

170 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-FC-STAT","Unableo clear FC stats for if index %d…ort %d",

171 
štf_ù¾
.
if_šdex
, iÁf_ù¾.
pÜt_id
);

172  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

175  
ıs_­i_»t_code_OK
;

176 
	}
}

178 "C" 
t_¡d_”rÜ
 
	$Çs_¡©s_fc_if_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
) {

180 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF_STATISTICS
, 
Çs_št_ty³_FC
,

181 
if_fc_¡©s_g‘
, 
if_fc_¡©s_£t
è!ğ
STD_ERR_OK
) {

182 
	`EV_LOGGING
 (
INTERFACE
,
DEBUG
,"NAS-FC-STATS-INIT", "Failedo„egister FC interface stats CPS handler");

183  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

186  
STD_ERR_OK
;

187 
	}
}

	@src/stats/nas_stats_if_cps.cpp

23 
	~"d–l-ba£-if.h
"

24 
	~"d–l-š‹rçû.h
"

25 
	~"›tf-š‹rçûs.h
"

26 
	~"š‹rçû_obj.h
"

27 
	~"h®_if_m­pšg.h
"

29 
	~"ıs_­i_key.h
"

30 
	~"ıs_­i_objeù_key.h
"

31 
	~"ıs_şass_m­.h
"

32 
	~"ıs_­i_İ”©iÚ.h
"

33 
	~"ev’t_log.h
"

34 
	~"Çs_ndi_¶©_¡©.h
"

35 
	~"Çs_¡©s.h
"

36 
	~"Çs_fc_¡©s.h
"

37 
	~"Çs_ndi_pÜt.h
"

38 
	~"Çs_št_uts.h
"

39 
	~"¡d_uts.h
"

40 
	~"d–l-š‹rçû.h
"

41 
	~"›tf-š‹rçûs.h
"

43 
	~<time.h
>

44 
	~<chrÚo
>

45 
	~<veùÜ
>

46 
	~<unÜd”ed_m­
>

47 
	~<¡dšt.h
>

48 
	~<®gÜ™hm
>

50 
	#LPBK_STATS_PATH
 "/´oc/Ãt/dev"

	)

51 
	#ARRAY_SIZE
(
a
è(×)/(×)[0]))

	)

52 
	#BUF_SIZE
 1024

	)

53 autØ
	gif_¡©_ids
 = 
Ãw
 
¡d
::
veùÜ
<
ndi_¡©_id_t
>;

57 
	mÇme
[32];

58 
ušt64_t
 
	moid
;

59 
ušt_t
 
	mšdex
;

60 } 
	g¡©s_m­
[] = {

61 {"šput_·ck‘s", 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_PKTS
, 1},

62 {"šput_by‹s", 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_OCTETS
, 0},

63 {"šput_muÉiÿ¡", 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_MULTICAST_PKTS
, 7},

64 {"šput_”rÜs", 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_ERRORS
, 2},

65 {"šput_disÿrds", 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_DISCARDS
, 3},

66 {"ouut_·ck‘s", 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_PKTS
, 9},

67 {"ouut_by‹s", 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_OCTETS
, 8},

68 {"ouut_”rÜs", 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_ERRORS
, 10},

69 {"ouut_disÿrds",
IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_DISCARDS
, 11}

72 
boŞ


73 
	$Çs_¡©_g‘_Çme_äom_obj
(
ıs_­i_objeù_t
 
obj
, *
if_Çme
, 
size_t
 
Çme_sz
) {

75 
h®_ifšdex_t
 
šdex
;

77 
ıs_­i_objeù_©Œ_t
 
if_Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_NAME
);

78 
ıs_­i_objeù_©Œ_t
 
if_šdex_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
 );

79 ià(
if_šdex_©Œ
 =ğ
NULL
 && 
if_Çme_©Œ
 == NULL) {

80 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-STAT" ,"Get intf‚ame: missing Name/ifindex‡ttribute ");

81  
çl£
;

83 ià(
if_Çme_©Œ
) {

84 
	`§ã¡ºıy
(
if_Çme
,(cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
if_Çme_©Œ
), 
Çme_sz
);

86 
šdex
 = (
h®_ifšdex_t
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_šdex_©Œ
);

87 ià(
	`Çs_št_g‘_if_šdex_to_Çme
(
šdex
, 
if_Çme
, 
Çme_sz
è!ğ
STD_ERR_OK
) {

88  
çl£
;

91  
Œue
;

92 
	}
}

94 
boŞ
 
	$Çs_¡©_g‘_ifšdex_äom_obj
(
ıs_­i_objeù_t
 
obj
,
h®_ifšdex_t
 *
šdex
, 
boŞ
 
ş—r
){

95 
ıs_­i_©Œ_id_t
 
©Œ_id
;

97 ià(
ş—r
) {

98 
©Œ_id
 = 
DELL_IF_CLEAR_COUNTERS_INPUT_INTF_CHOICE_IFNAME_CASE_IFNAME
;

100 
©Œ_id
 = 
IF_INTERFACES_STATE_INTERFACE_NAME
;

103 
ıs_­i_objeù_©Œ_t
 
if_Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
,
©Œ_id
);

105 ià(
ş—r
) {

106 
©Œ_id
 = 
DELL_IF_CLEAR_COUNTERS_INPUT_INTF_CHOICE_IFINDEX_CASE_IFINDEX
;

108 
©Œ_id
 = 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
;

110 
ıs_­i_objeù_©Œ_t
 
if_šdex_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
©Œ_id
);

113 if(
if_šdex_©Œ
 =ğ
NULL
)

114 
if_šdex_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
);

116 if(
if_šdex_©Œ
 =ğ
NULL
 && 
if_Çme_©Œ
 == NULL) {

117 
	`EV_LOG
(
ERR
, 
INTERFACE
, 
ev_log_s_CRITICAL
, "NAS-STAT",

119  
çl£
;

122 if(
if_šdex_©Œ
){

123 *
šdex
 = (
h®_ifšdex_t
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_šdex_©Œ
);

125 cÚ¡ * 
Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
if_Çme_©Œ
);

126 
š‹rçû_ù¾_t
 
i
;

127 
	`mem£t
(&
i
,0,(i));

128 
	`¡ºıy
(
i
.
if_Çme
,
Çme
,(i.if_name)-1);

129 
i
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

130 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
i
)!=
STD_ERR_OK
){

131 
	`EV_LOG
(
ERR
, 
INTERFACE
, 0, "NAS-STAT",

132 "Cª'ˆg‘ iÁ”çû cÚŒŞ infÜm©iÚ fÜ %s",
Çme
);

133  
çl£
;

135 *
šdex
 = 
i
.
if_šdex
;

137  
Œue
;

138 
	}
}

140 
t_¡d_”rÜ
 
	$pİuÏ‹_if_¡©_ids
(){

142 
max_if_¡©_id
;

143 if(
	`g‘_¡©_ids_Ën
(
NAS_STAT_IF
,&
max_if_¡©_id
 ) !ğ
STD_ERR_OK
){

144 
	`EV_LOG
(
ERR
,
INTERFACE
, 0,"NAS-STAT", "Failedo get max†ength of supported stat ids");

145  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

148 
ndi_¡©_id_t
 
ids_li¡
[
max_if_¡©_id
];

150 
	`mem£t
(
ids_li¡
,0,(ids_list));

151 if(
	`pÜt_¡©_li¡_g‘
(
ids_li¡
, &
max_if_¡©_id
è!ğ
STD_ERR_OK
) {

152  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

155 
ix
 = 0 ; ix < 
max_if_¡©_id
 ; ++ix ){

156 
if_¡©_ids
->
	`push_back
(
ids_li¡
[
ix
]);

159  
STD_ERR_OK
;

160 
	}
}

162 autØ
g‘_cu¼’t_time
(è-> 
	g¡d
::
size_t
{

164 autØ
time_¡amp
 = 
¡d
::
chrÚo
::
¡—dy_şock
::
now
();

165 autØ
	gtime_dur
 = 
time_¡amp
.
time_sšû_•och
();

166 autØ
	gtime_now
 = 
time_dur
.
couÁ
(è* 
¡d
::
chrÚo
::
sy¡em_şock
::
³riod
::
num
 / std::chrÚo::sy¡em_şock::³riod::
d’
;

167  
	gtime_now
;

170 
boŞ
 
	$g‘_¡©s
(
h®_ifšdex_t
 
ifšdex
, 
ıs_­i_objeù_li¡_t
 
li¡
){

172 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
li¡
);

174 ià(
obj
 =ğ
NULL
) {

175 
	`EV_LOG
(
ERR
,
INTERFACE
, 0,"NAS-STAT", "Failedo create/append‚ew objecto†ist");

176  
çl£
;

180 
š‹rçû_ù¾_t
 
štf_ù¾
;

181 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

183 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

184 
štf_ù¾
.
if_šdex
 = 
ifšdex
;

186 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
è!ğ
STD_ERR_OK
) {

187 
	`EV_LOG
(
ERR
,
INTERFACE
,0,"NAS-STAT","Interface %d has NO slot %d,…ort %d",

188 
štf_ù¾
.
if_šdex
, iÁf_ù¾.
Åu_id
, iÁf_ù¾.
pÜt_id
);

189  
çl£
;

192 cÚ¡ 
size_t
 
max_pÜt_¡©_id
 = 
if_¡©_ids
->
	`size
();

193 
ušt64_t
 
¡©_v®ues
[
max_pÜt_¡©_id
];

194 
	`mem£t
(
¡©_v®ues
,0,(stat_values));

196 if(
	`ndi_pÜt_¡©s_g‘
(
štf_ù¾
.
Åu_id
, iÁf_ù¾.
pÜt_id
,

197 (
ndi_¡©_id_t
 *)&(
if_¡©_ids
->
	`©
(0)),

198 
¡©_v®ues
,
max_pÜt_¡©_id
è!ğ
STD_ERR_OK
) {

199  
çl£
;

202 
ix
 = 0 ; ix < 
max_pÜt_¡©_id
 ; ++ix ){

203 
	`ıs_­i_objeù_©Œ_add_u64
(
obj
, 
if_¡©_ids
->
	`©
(
ix
), 
¡©_v®ues
[ix]);

206 autØ
time_now
 = 
	`g‘_cu¼’t_time
();

207 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TIME_STAMP
,
time_now
);

208 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
, 
ifšdex
);

209 ià(
	`¡¾’
(
štf_ù¾
.
if_Çme
) != 0)

210 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_NAME
, 
štf_ù¾
.
if_Çme
, 
	`¡¾’
(intf_ctrl.if_name) + 1);

212  
Œue
;

213 
	}
}

215 
boŞ
 
	$fl_ıs_¡©s
 (
ıs_­i_objeù_t
 
obj
, *
±r
, cÚ¡ *
Çme
) {

217 *
§ve_±r
, *
p
;

218 
ušt_t
 
út
 = 0;

219 
boŞ
 
»t
 = 
Œue
;

220 
ušt64_t
 
¡©s_¬r
[16];

221 
	`mem£t
(
¡©s_¬r
, 0, (stats_arr));

222 ià((
p
 = 
	`¡r¡r
(
±r
, 
Çme
)è=ğ
NULL
) {

223 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-STAT", "lpbk :fill_cps_statsƒrror");

224  
çl£
;

226 
p
 = 
	`¡¹ok_r
Õ, " ", &
§ve_±r
);

227 ((
p
 = 
	`¡¹ok_r
(
NULL
, " ", &
§ve_±r
)) != NULL)

228 && (
út
 < 
	`ARRAY_SIZE
(
¡©s_¬r
))) {

229 
¡©s_¬r
[
út
++] = 
	`©Şl
(
p
);

231 
ix
 = 0 ; ix < 
	`ARRAY_SIZE
(
¡©s_m­
) ; ++ix ){

232 
	`ıs_­i_objeù_©Œ_add_u64
(
obj
, 
¡©s_m­
[
ix
].
oid
, 
¡©s_¬r
[¡©s_m­[ix].
šdex
]);

235 autØ
time_now
 = 
	`g‘_cu¼’t_time
();

236 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TIME_STAMP
,
time_now
);

237  
»t
;

238 
	}
}

240 
boŞ
 
	$g‘_štf_¡©s_äom_os
ĞcÚ¡ *
Çme
, 
ıs_­i_objeù_li¡_t
 
li¡
) {

242 
¡©s_buf
[
BUF_SIZE
];

243 
štf_Çme
[
HAL_IF_NAME_SZ
];

244 
FILE
 *
å
 = 
NULL
;

245 
boŞ
 
»t
 = 
çl£
;

247 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
li¡
);

249 ià(
obj
 =ğ
NULL
) {

250 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-STAT", "lpbk: Failedo create/append‚ew objecto†ist");

251  
»t
;

254 ià((
å
 = 
	`fİ’
(
LPBK_STATS_PATH
, "r")è=ğ
NULL
) {

255  
»t
;

258 
	`mem£t
(
¡©s_buf
, 0, (stats_buf));

261 
	`¢´štf
(
štf_Çme
, (štf_Çme), " %s%s", 
Çme
, ":");

262 
¡©s_buf
[0] = ' ';

263 
	`fg‘s
(&
¡©s_buf
[1], (¡©s_bufè-1, 
å
) == &stats_buf[1]) {

264 ià(
	`¡r¡r
(
¡©s_buf
, 
štf_Çme
è!ğ
NULL
) {

265 
»t
 = 
	`fl_ıs_¡©s
(
obj
, 
¡©s_buf
, 
štf_Çme
);

269 
	`fşo£
(
å
);

270  
»t
;

271 
	}
}

274 
ıs_­i_»tuº_code_t
 
	$if_Íbk_¡©s_g‘
 (* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

275 
size_t
 
ix
) {

276 
Çme
[
HAL_IF_NAME_SZ
];

278 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
ix
);

280 ià(!
	`Çs_¡©_g‘_Çme_äom_obj
(
obj
, 
Çme
, (name))) {

281  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
CFG
,0);

283 ià(
	`g‘_štf_¡©s_äom_os
((cÚ¡ *)
Çme
, 
·¿m
->
li¡
)è 
ıs_­i_»t_code_OK
;

285  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

287 
	}
}

290 
ıs_­i_»tuº_code_t
 
	$if_¡©s_g‘
 (* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

291 
size_t
 
ix
) {

293 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
ix
);

295 
h®_ifšdex_t
 
ifšdex
=0;

296 if(!
	`Çs_¡©_g‘_ifšdex_äom_obj
(
obj
,&
ifšdex
,
çl£
)){

297  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
CFG
,0);

301 if(
	`g‘_¡©s
(
ifšdex
,
·¿m
->
li¡
)è 
ıs_­i_»t_code_OK
;

303  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

304 
	}
}

306 
ıs_­i_»tuº_code_t
 
	$if_Íbk_¡©s_£t
 (* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
, 
size_t
 
ix
) {

307 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-STAT","Set†oopback stats‚ot supported");

308  
ıs_­i_»t_code_ERR
;

309 
	}
}

311 
ıs_­i_»tuº_code_t
 
	$if_¡©s_£t
 (* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,

312 
size_t
 
ix
) {

314 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

316 
h®_ifšdex_t
 
ifšdex
=0;

317 if(!
	`Çs_¡©_g‘_ifšdex_äom_obj
(
obj
,&
ifšdex
,
çl£
)){

318  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
CFG
,0);

321 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

323 ifĞ
İ
 =ğ
ıs_­i_İ”_DELETE
){

324 
¡d
::
veùÜ
<
ndi_¡©_id_t
> 
d–_¡©_ids
;

326 
š‹rçû_ù¾_t
 
štf_ù¾
;

327 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

329 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

330 
štf_ù¾
.
if_šdex
 = 
ifšdex
;

332 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
è!ğ
STD_ERR_OK
) {

333 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-STAT","Interface %d has NO slot %d,…ort %d",

334 
štf_ù¾
.
if_šdex
, iÁf_ù¾.
Åu_id
, iÁf_ù¾.
pÜt_id
);

335  
ıs_­i_»t_code_ERR
;

338 
ıs_­i_objeù_™_t
 
™
;

339 
	`ıs_­i_objeù_™_begš
(
obj
, &
™
);

341 ; 
	`ıs_­i_objeù_™_v®id
(&
™
); 
	`ıs_­i_objeù_™_Ãxt
(&it)) {

343 
ndi_¡©_id_t
 
id
 = (ndi_¡©_id_t)
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

344 autØ
id_™
 = 
¡d
::
	`fšd
(
if_¡©_ids
->
	`begš
(),if_¡©_ids->
	`’d
(),
id
);

345 if(
id_™
 !ğ
if_¡©_ids
->
	`’d
()){

346 
d–_¡©_ids
.
	`push_back
(
id
);

350 if(
	`ndi_pÜt_¡©s_ş—r
(
štf_ù¾
.
Åu_id
, iÁf_ù¾.
pÜt_id
,

351 (
ndi_¡©_id_t
 *)&
d–_¡©_ids
[0],

352 
d–_¡©_ids
.
	`size
()è!ğ
STD_ERR_OK
) {

353  
ıs_­i_»t_code_ERR
;;

357  
ıs_­i_»t_code_OK
;

358 
	}
}

361 
ıs_­i_»tuº_code_t
 
	$if_¡©s_ş—r
 (* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,

362 
size_t
 
ix
) {

364 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

365 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

367 ià(
İ
 !ğ
ıs_­i_İ”_ACTION
) {

368 
	`EV_LOG
(
ERR
,
INTERFACE
,0,"NAS-STAT","Inv®id o³¿tiÚ %d fÜ cË¬šg st",
İ
);

369  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
PARAM
,0);

372 
h®_ifšdex_t
 
ifšdex
=0;

373 if(!
	`Çs_¡©_g‘_ifšdex_äom_obj
(
obj
,&
ifšdex
,
Œue
)){

374  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
CFG
,0);

378 
š‹rçû_ù¾_t
 
štf_ù¾
;

379 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

381 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

382 
štf_ù¾
.
if_šdex
 = 
ifšdex
;

384 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
è!ğ
STD_ERR_OK
) {

385 
	`EV_LOG
(
ERR
,
INTERFACE
,0,"NAS-STAT","Interface %d has NO slot %d,…ort %d",

386 
štf_ù¾
.
if_šdex
, iÁf_ù¾.
Åu_id
, iÁf_ù¾.
pÜt_id
);

387  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

390 ià(
štf_ù¾
.
št_ty³
 =ğ
Çs_št_ty³_FC
)

392 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-FC-STAT","clearing FC stat");

393  (
	`Çs_if_fc_¡©s_ş—r
(
cÚ‹xt
, 
·¿m
, 
ix
));

395 if(
	`ndi_pÜt_ş—r_®l_¡©
(
štf_ù¾
.
Åu_id
,štf_ù¾.
pÜt_id
è!ğ
STD_ERR_OK
) {

396  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

399  
ıs_­i_»t_code_OK
;

400 
	}
}

403 
t_¡d_”rÜ
 
	$Çs_¡©s_if_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
) {

405 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF_STATISTICS
, 
Çs_št_ty³_PORT
,

406 
if_¡©s_g‘
, 
if_¡©s_£t
è!ğ
STD_ERR_OK
) {

407 
	`EV_LOGGING
 (
INTERFACE
, 
ERR
,"NAS-STATS-INIT", "Failedo„egister interface stats CPS handler");

408  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

410 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF_STATISTICS
, 
Çs_št_ty³_LPBK
,

411 
if_Íbk_¡©s_g‘
, 
if_Íbk_¡©s_£t
è!ğ
STD_ERR_OK
) {

412 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-STATS-INIT", "Failedo„egister†oopback stats CPS handler");

413  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

416 
ıs_­i_»gi¡¿tiÚ_funùiÚs_t
 
f
;

417 
	`mem£t
(&
f
,0,(f));

419 
buff
[
CPS_API_KEY_STR_MAX
];

420 
	`mem£t
(
buff
,0,(buff));

422 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
f
.
key
,

423 
DELL_BASE_IF_CMN_DELL_IF_CLEAR_COUNTERS_INPUT_OBJ
,

424 
ıs_­i_qu®if›r_TARGET
)) {

425 
	`EV_LOG
(
ERR
,
INTERFACE
,0,"NAS-STATS","Could‚otranslate %do key %s",

426 ()(
DELL_BASE_IF_CMN_DELL_IF_CLEAR_COUNTERS_INPUT_OBJ
),

427 
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

428  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

431 
f
.
hªdË
 = handle;

432 
f
.
_wr™e_funùiÚ
 = 
if_¡©s_ş—r
;

434 ià(
	`ıs_­i_»gi¡”
(&
f
)!=
ıs_­i_»t_code_OK
) {

435  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

438 ià(
	`pİuÏ‹_if_¡©_ids
(è!ğ
STD_ERR_OK
){

439  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

442  
STD_ERR_OK
;

443 
	}
}

	@src/stats/nas_stats_utils.c

21 
	~"Çs_ndi_¶©_¡©.h
"

22 
	~"ev’t_log.h
"

23 
	~"d–l-š‹rçû.h
"

24 
	~"›tf-š‹rçûs.h
"

25 
	~<¡ršg.h
>

27 
ušt64_t
 
	gif_¡©_ids
[] = {

28 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IF_OUT_QLEN
 ,

29 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_DROP_EVENTS
 ,

30 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_MULTICAST_PKTS
 ,

31 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_BROADCAST_PKTS
 ,

32 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_UNDERSIZE_PKTS
 ,

33 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_FRAGMENTS
 ,

34 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OVERSIZE_PKTS
 ,

35 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_RX_OVERSIZE_PKTS
 ,

36 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_TX_OVERSIZE_PKTS
 ,

37 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_JABBERS
 ,

38 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OCTETS
 ,

39 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_PKTS
 ,

40 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_COLLISIONS
 ,

41 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_CRC_ALIGN_ERRORS
 ,

42 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_TX_NO_ERRORS
 ,

43 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_RX_NO_ERRORS
 ,

44 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_GREEN_DISCARD_DROPPED_PACKETS
 ,

45 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_YELLOW_DISCARD_DROPPED_PACKETS
 ,

46 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RED_DISCARD_DROPPED_PACKETS
 ,

47 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ECN_MARKED_PACKETS
,

48 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_IN_PKTS_64_OCTETS
 ,

49 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_IN_PKTS_65_TO_127_OCTETS
 ,

50 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_IN_PKTS_128_TO_255_OCTETS
 ,

51 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_IN_PKTS_256_TO_511_OCTETS
 ,

52 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_IN_PKTS_512_TO_1023_OCTETS
 ,

53 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_IN_PKTS_1024_TO_1518_OCTETS
 ,

54 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_IN_PKTS_1519_TO_2047_OCTETS
 ,

55 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_IN_PKTS_2048_TO_4095_OCTETS
 ,

56 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_IN_PKTS_4096_TO_9216_OCTETS
 ,

57 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OUT_PKTS_64_OCTETS
 ,

58 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OUT_PKTS_65_TO_127_OCTETS
 ,

59 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OUT_PKTS_128_TO_255_OCTETS
 ,

60 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OUT_PKTS_256_TO_511_OCTETS
 ,

61 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OUT_PKTS_512_TO_1023_OCTETS
 ,

62 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OUT_PKTS_1024_TO_1518_OCTETS
 ,

63 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OUT_PKTS_1519_TO_2047_OCTETS
 ,

64 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OUT_PKTS_2048_TO_4095_OCTETS
 ,

65 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ETHER_OUT_PKTS_4096_TO_9216_OCTETS
 ,

66 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_LPI_COUNT
 ,

67 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RX_LPI_DURATION
 ,

68 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TX_LPI_COUNT
 ,

69 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TX_LPI_DURATION
 ,

70 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PAUSE_RX_PKTS
,

71 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PAUSE_TX_PKTS
,

72 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_0_RX_PKTS
,

73 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_0_TX_PKTS
,

74 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_1_RX_PKTS
,

75 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_1_TX_PKTS
,

76 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_2_RX_PKTS
,

77 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_2_TX_PKTS
,

78 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_3_RX_PKTS
,

79 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_3_TX_PKTS
,

80 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_4_RX_PKTS
,

81 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_4_TX_PKTS
,

82 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_5_RX_PKTS
,

83 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_5_TX_PKTS
,

84 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_6_RX_PKTS
,

85 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_6_TX_PKTS
,

86 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_7_RX_PKTS
,

87 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_PFC_7_TX_PKTS
,

88 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_OCTETS
 ,

89 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_UNICAST_PKTS
 ,

90 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_BROADCAST_PKTS
 ,

91 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_MULTICAST_PKTS
 ,

92 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_DISCARDS
 ,

93 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_ERRORS
 ,

94 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_UNKNOWN_PROTOS
 ,

95 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_OCTETS
 ,

96 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_UNICAST_PKTS
 ,

97 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_BROADCAST_PKTS
 ,

98 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_MULTICAST_PKTS
 ,

99 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_DISCARDS
 ,

100 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_ERRORS
 ,

102 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_ALIGNMENT_ERRORS
,

103 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_FCS_ERRORS
,

104 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_SINGLE_COLLISION_FRAMES
,

105 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_MULTIPLE_COLISION_FRAMES
,

106 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_SQE_TEST_ERRORS
,

107 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_DEFERRED_TRANSMISSIONS
,

108 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_LATE_COLLISIONS
,

109 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_EXCESSIVE_COLLISIONS
,

110 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_INTERNAL_MAC_TRANSMIT_ERRORS
,

111 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_CARRIER_SENSE_ERRORS
,

112 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_FRAME_TOO_LONG
,

113 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_INTERNAL_MAC_RECEIVE_ERRORS
,

114 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_SYMBOL_ERRORS
,

115 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_UNKNOWN_OPCODES
,

117 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IP_IN_RECEIVES
,

118 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IP_IN_HDR_ERRORS
,

119 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IP_IN_DISCARDS
,

120 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IP_IN_FORW_DATAGRAMS
,

121 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IPV6_IN_RECEIVES
,

122 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IPV6_IN_HDR_ERRORS
,

123 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IPV6_IN_ADDR_ERRORS
,

124 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IPV6_IN_DISCARDS
,

125 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IPV6_OUT_DISCARDS
,

126 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IPV6_OUT_FORW_DATAGRAMS
,

127 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IPV6_IN_MCAST_PKTS
,

128 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IPV6_OUT_MCAST_PKTS


132 
ušt64_t
 
	gvÏn_¡©_ids
[] = {

133 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_OCTETS
 ,

134 
IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_OCTETS
,

135 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_IN_PKTS
,

136 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_OUT_PKTS
,

140 
size_t
 
	g¡©_id_Ën
 [] = {

141 (
if_¡©_ids
)/(if_stat_ids[0]),

142 (
vÏn_¡©_ids
)/(vlan_stat_ids[0]),

146 
t_¡d_”rÜ
 
	$g‘_¡©_ids_Ën
(
Çs_¡©_ty³_t
 
ty³
, * 
Ën
){

147 if(
ty³
 >ğ
NAS_STAT_IF
 &&y³<ğ
NAS_STAT_VLAN
){

148 *
Ën
 = 
¡©_id_Ën
[
ty³
];

149  
STD_ERR_OK
;

152 
	`EV_LOG
(
ERR
,
INTERFACE
,0,"NAS-STAT","Invlaid Stat Type…assed");

153  
	`STD_ERR
(
NPU
,
PARAM
,0);

154 
	}
}

157 
t_¡d_”rÜ
 
	$pÜt_¡©_li¡_g‘
(
ušt64_t
 * 
li¡
, *
Ën
){

159 if(
li¡
 =ğ
NULL
){

160 
	`EV_LOG
(
ERR
,
NPU
,0,"PLATFORM-STAT","NULL List…assedo get counters id");

161  
	`STD_ERR
(
NPU
,
PARAM
,0);

164 
li¡_Ën
 = 0;

165 
suµÜ‹d_ids_Ën
 = 
¡©_id_Ën
[
NAS_STAT_IF
];

166 
li¡_Ën
 = *
Ën
 < 
suµÜ‹d_ids_Ën
 ? *len : supported_ids_len;

168 if(
li¡_Ën
 < 
suµÜ‹d_ids_Ën
){

169 
	`EV_LOG
(
INFO
,
INTERFACE
,0,"NAS-STAT","List size %d smallerhan supported ids %d",

170 *
Ën
,
suµÜ‹d_ids_Ën
);

173 
	`memıy
(
li¡
,
if_¡©_ids
,
li¡_Ën
*(if_stat_ids[0]));

174 *
Ën
 = 
li¡_Ën
;

175  
STD_ERR_OK
;

176 
	}
}

179 
t_¡d_”rÜ
 
	$vÏn_¡©_li¡_g‘
(
ušt64_t
 *
li¡
, *
Ën
){

181 if(
li¡
 =ğ
NULL
){

182 
	`EV_LOG
(
ERR
,
NPU
,0,"PLATFORM-STAT","NULL List…assedo get counters id");

183  
	`STD_ERR
(
NPU
,
PARAM
,0);

186 
vÏn_¡©_id_Ën
 = 
¡©_id_Ën
[
NAS_STAT_VLAN
];

187 
li¡_Ën
 = 0;

188 
li¡_Ën
 = *
Ën
 < 
vÏn_¡©_id_Ën
 ? *len : vlan_stat_id_len;

190 if(
li¡_Ën
 < 
vÏn_¡©_id_Ën
){

191 
	`EV_LOG
(
ERR
,
NPU
,0,"NAS-STAT","List size %d smallerhan supported ids %d",

192 *
Ën
,
vÏn_¡©_id_Ën
);

195 
	`memıy
(
li¡
,
vÏn_¡©_ids
,
li¡_Ën
*(vlan_stat_ids[0]));

196 *
Ën
 = 
li¡_Ën
;

197  
STD_ERR_OK
;

198 
	}
}

	@src/stats/nas_stats_vlan_cps.cpp

23 
	~"d–l-ba£-if.h
"

24 
	~"d–l-š‹rçû.h
"

25 
	~"›tf-š‹rçûs.h
"

27 
	~"h®_if_m­pšg.h
"

29 
	~"ıs_­i_key.h
"

30 
	~"ıs_­i_objeù_key.h
"

31 
	~"ıs_şass_m­.h
"

32 
	~"ıs_­i_İ”©iÚ.h
"

33 
	~"ev’t_log.h
"

34 
	~"Çs_ndi_¶©_¡©.h
"

35 
	~"Çs_¡©s.h
"

36 
	~"Çs_ndi_vÏn.h
"

37 
	~"ds_commÚ_ty³s.h
"

38 
	~"Çs_sw™ch.h
"

39 
	~"š‹rçû_obj.h
"

40 
	~<veùÜ
>

41 
	~<unÜd”ed_m­
>

42 
	~<unÜd”ed_£t
>

43 
	~<¡dšt.h
>

44 
	~<time.h
>

46 autØ
	gvÏn_¡©_ids
 = 
Ãw
 
¡d
::
veùÜ
<
ndi_¡©_id_t
>;

47 autØ
	gÅu_ids
 = 
Ãw
 
¡d
::
unÜd”ed_£t
<
Åu_id_t
>;

51 
t_¡d_”rÜ
 
	$pİuÏ‹_vÏn_¡©_ids
(){

53 
max_vÏn_¡©_id
;

54 if(
	`g‘_¡©_ids_Ën
(
NAS_STAT_VLAN
,&
max_vÏn_¡©_id
 ) !ğ
STD_ERR_OK
){

55 
	`EV_LOG
(
ERR
,
INTERFACE
, 0,"NAS-STAT", "Failedo get max†ength of supported stat ids");

56  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

59 
ndi_¡©_id_t
 
ids_li¡
[
max_vÏn_¡©_id
];

61 
	`mem£t
(
ids_li¡
,0,(ids_list));

63 if(
	`vÏn_¡©_li¡_g‘
(
ids_li¡
, &
max_vÏn_¡©_id
è!ğ
STD_ERR_OK
) {

64  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

67 
ix
 = 0 ; ix < 
max_vÏn_¡©_id
 ; ++ix ){

68 
vÏn_¡©_ids
->
	`push_back
(
ids_li¡
[
ix
]);

71 cÚ¡ 
Çs_sw™ches_t
 * 
sw™ches
 = 
	`Çs_sw™ch_šv’tÜy
();

73 
size_t
 
ix
 = 0; ix < 
sw™ches
->
numb”_of_sw™ches
; ++ix) {

75 cÚ¡ 
Çs_sw™ch_d‘a_t
 * 
sd
 = 
	`Çs_sw™ch
((
Çs_sw™ch_id_t
è
ix
);

76 ià(
sd
 =ğ
NULL
) {

77 
	`EV_LOG
(
ERR
,
INTERFACE
, 0, "NAS-STAT","Switch Details Configuration file isƒrroneous");

78  
	`STD_ERR
(
INTERFACE
, 
PARAM
, 0);

81 
size_t
 
sd_ix
 = 0; sd_ix < 
sd
->
numb”_of_Åus
; ++sd_ix) {

82 
Åu_ids
->
	`š£¹
(
sd
->
Åus
[
sd_ix
]);

85  
STD_ERR_OK
;

86 
	}
}

89 
boŞ
 
	$g‘_¡©s
(
h®_ifšdex_t
 
vÏn_ifšdex
, 
ıs_­i_objeù_li¡_t
 
li¡
){

91 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
li¡
);

93 ià(
obj
 =ğ
NULL
) {

94 
	`EV_LOG
(
ERR
,
INTERFACE
, 0,"NAS-STAT", "Failedo create/append‚ew objecto†ist");

95  
çl£
;

98 
š‹rçû_ù¾_t
 
štf_ù¾
;

99 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

101 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

102 
štf_ù¾
.
if_šdex
 = 
vÏn_ifšdex
;

104 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
è!ğ
STD_ERR_OK
) {

105 
	`EV_LOG
(
ERR
,
INTERFACE
,0,"NAS-STAT","Interface %d has NO slot %d,…ort %d",

106 
štf_ù¾
.
if_šdex
, iÁf_ù¾.
Åu_id
, iÁf_ù¾.
pÜt_id
);

107  
çl£
;

110 cÚ¡ 
size_t
 
vÏn_¡©_id_Ën
 = 
vÏn_¡©_ids
->
	`size
();

111 
ušt64_t
 
¡©_v®ues
[
vÏn_¡©_id_Ën
];

112 
ušt64_t
 
tÙ®_¡©_v®ues
[
vÏn_¡©_id_Ën
];

113 
	`mem£t
(
¡©_v®ues
,0,(stat_values));

114 
	`mem£t
(
tÙ®_¡©_v®ues
,0,(total_stat_values));

117 autØ
™
 = 
Åu_ids
->
	`begš
(); iˆ!ğÅu_ids->
	`’d
() ; ++it ){

119 if(
	`ndi_vÏn_¡©s_g‘
(*
™
, 
štf_ù¾
.
vÏn_id
,

120 (
ndi_¡©_id_t
 *)&(
vÏn_¡©_ids
->
	`©
(0)),

121 
¡©_v®ues
,
vÏn_¡©_id_Ën
è!ğ
STD_ERR_OK
) {

122  
çl£
;

125 
ix
 = 0 ; ix < 
vÏn_¡©_id_Ën
 ; ++ix ){

126 
tÙ®_¡©_v®ues
[
ix
] +ğ
¡©_v®ues
[ix];

129 
	`mem£t
(
¡©_v®ues
,0,(stat_values));

132 
ix
 = 0 ; ix < 
vÏn_¡©_id_Ën
 ; ++ix ){

133 
	`ıs_­i_objeù_©Œ_add_u64
(
obj
, 
vÏn_¡©_ids
->
	`©
(
ix
), 
tÙ®_¡©_v®ues
[ix]);

136 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_STATISTICS_TIME_STAMP
,
	`time
(
NULL
));

138  
Œue
;

139 
	}
}

142 
ıs_­i_»tuº_code_t
 
	$if_¡©s_g‘
 (* 
cÚ‹xt
, 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

143 
size_t
 
ix
) {

145 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
ix
);

146 
h®_ifšdex_t
 
ifšdex
=0;

148 if(!
	`Çs_¡©_g‘_ifšdex_äom_obj
(
obj
,&
ifšdex
,
çl£
)){

149  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
CFG
,0);

152 
š‹rçû_ù¾_t
 
štf_ù¾
;

153 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

155 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

156 
štf_ù¾
.
if_šdex
 = 
ifšdex
;

158 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
è!ğ
STD_ERR_OK
) {

159 
	`EV_LOG
(
ERR
,
INTERFACE
,0,"NAS-STAT","Interface %d has NO slot %d,…ort %d",

160 
štf_ù¾
.
if_šdex
, iÁf_ù¾.
Åu_id
, iÁf_ù¾.
pÜt_id
);

161  
çl£
;

163 ià((
štf_ù¾
.
št_ty³
 =ğ
Çs_št_ty³_VLAN
)

164 && (
štf_ù¾
.
št_sub_ty³
 =ğ
BASE_IF_VLAN_TYPE_MANAGEMENT
)) {

166 
Çme
[
HAL_IF_NAME_SZ
];

168 ià(!
	`Çs_¡©_g‘_Çme_äom_obj
(
obj
, 
Çme
, (name))) {

169  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
CFG
,0);

172 ià(
	`g‘_štf_¡©s_äom_os
((cÚ¡ *)
Çme
, 
·¿m
->
li¡
)) {

173  
ıs_­i_»t_code_OK
;

176 if(
	`g‘_¡©s
(
ifšdex
,
·¿m
->
li¡
)è 
ıs_­i_»t_code_OK
;

179  (
ıs_­i_»tuº_code_t
)
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

180 
	}
}

183 
ıs_­i_»tuº_code_t
 
	$if_¡©s_£t
 (* 
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,

184 
size_t
 
ix
) {

186  
ıs_­i_»t_code_ERR
;

187 
	}
}

190 
t_¡d_”rÜ
 
	$Çs_¡©s_vÏn_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
) {

192 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF_STATISTICS
, 
Çs_št_ty³_VLAN
,

193 
if_¡©s_g‘
, 
if_¡©s_£t
è!ğ
STD_ERR_OK
) {

194 
	`EV_LOG
(
ERR
,
INTERFACE
, 0,"NAS-STAT", "Failedo„egister interface stats CPS handler");

195  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

198 ià(
	`pİuÏ‹_vÏn_¡©_ids
(è!ğ
STD_ERR_OK
){

199  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

202  
STD_ERR_OK
;

203 
	}
}

	@src/swp_util_tap.c

23 
	~"swp_ut_p.h
"

24 
	~"¡d_as£¹.h
"

25 
	~"¡d_sock‘_toŞs.h
"

27 
	~<sys/sock‘.h
>

29 
	~<lšux/if_tun.h
>

30 
	~<¡ršg.h
>

31 
	~<fú.h
>

32 
	~<sys/ioùl.h
>

33 
	~<uni¡d.h
>

34 
	~<¡dio.h
>

35 
	~<¡dlib.h
>

36 
	~<¡dboŞ.h
>

37 
	~<Ãt/if.h
>

38 
	~"¡d_uts.h
"

41 
	#SWP_UTIL_TAP_NAME_MAX
 17

	)

42 
	#SWP_UTIL_TAP_QUEUE_LEN_MAX
 10

	)

43 
	#SWP_UTIL_TAP_TXQLEN
 1000

	)

47 
	s_swp_ut_p_desü
 {

48 
	mdevÇme
[
SWP_UTIL_TAP_NAME_MAX
+1];

49 
	mfds
[
SWP_UTIL_TAP_QUEUE_LEN_MAX
];

50 
	mmax_fd
;

51 
	mqueues
;

52 
	mty³
;

53 } 
	ts_swp_ut_p_desü
;

56 
	#MAX_OPT_STR_LEN
 20

	)

58 cÚ¡ * 
	$swp_ut_p_desü_g‘_Çme
(
swp_ut_p_desü
 
p
) {

59  
p
->
devÇme
;

60 
	}
}

62 
	$swp_ut_ä“_desüs
(
swp_ut_p_desü
 
ps
) {

63 
	`ä“
((*)
ps
);

64 
	}
}

66 
	$swp_ut_p_desü_g‘_queue
(
swp_ut_p_desü
 
p
,
queue
) {

67 ià((
p
 !ğ
NULL
è&& (
queue
 <…->
queues
)è…->
fds
[queue];

68  
SWP_UTIL_INV_FD
;

69 
	}
}

71 
swp_ut_p_desü
 
	$swp_ut_®loc_desü
() {

72 
size
;

73 * 
p
;

74 
size
 = (
_swp_ut_p_desü
);

75 
p
 = 
	`m®loc
(
size
);

76 ià(
p
!=
NULL
è
	`mem£t
Õ,0,
size
);

77  (
swp_ut_p_desü
)
p
;

78 
	}
}

80 
	$swp_ut_p_desü_š™_wÇme
(
swp_ut_p_desü
 
p
,

81 cÚ¡ *
n
, *
chas
, *
š¡
, 
pÜt_t
 *
pÜt
,…Üt_ˆ*
subi
,

82 
queues
)

84 
	`swp_ut_p_desü_š™
(
p
);

85 
İt_¡r
[
MAX_OPT_STR_LEN
] = "%s";

88 ià(
chas
!=
NULL
è
	`¡ºÿt
(
İt_¡r
,"%x",
MAX_OPT_STR_LEN
-
	`¡¾’
(opt_str));

89 ià(
š¡
!=
NULL
è
	`¡ºÿt
(
İt_¡r
,"%d",
MAX_OPT_STR_LEN
-
	`¡¾’
(opt_str));

90 ià(
pÜt
!=
NULL
è
	`¡ºÿt
(
İt_¡r
,"-%d",
MAX_OPT_STR_LEN
-
	`¡¾’
(opt_str));

91 ià(
subi
!=
NULL
è
	`¡ºÿt
(
İt_¡r
,"-%x",
MAX_OPT_STR_LEN
-
	`¡¾’
(opt_str));

93 
	`¢´štf
(
p
->
devÇme
,(p->devname)-1,

94 
İt_¡r
,
n
,
chas
!=
NULL
 ? *cha : 0, 
š¡
!=NULL ? *inst : 0,

95 
pÜt
!=
NULL
? *pÜˆ: 0, 
subi
!=NULL ? *subi : 0 );

96 
p
->
queues
 = queues;

97 
p
->
ty³
 = 
SWP_UTIL_TYPE_UNDEF
;

98 
	}
}

101 
	$swp_ut_p_desü_š™
(
swp_ut_p_desü
 
p
) {

102 
	`mem£t
(
p
->
devÇme
,0,(p->devname));

103 
size_t
 
ix
 = 0;

104 
size_t
 
mx
 = (
p
->
fds
)/(*(p->fds));

105  ; 
ix
 < 
mx
 ; ++ix ) 
p
->
fds
[ix] =
SWP_UTIL_INV_FD
;

106 
p
->
queues
 = 1;

107 
p
->
max_fd
 = 
SWP_UTIL_INV_FD
;

108 
p
->
ty³
 = 
SWP_UTIL_TYPE_UNDEF
;

109 
	}
}

112 
	$swp_ut_´št_p
(
swp_ut_p_desü
 
p
) {

113 
ix
 = 0;

114 
mx
 = (
p
->
fds
)/(*(tap->fds));

115 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
, "PKT-IO", "Dev : %s, Queues: %d,",

116 
p
->
devÇme
,p->
queues
);

117  ; 
ix
 < 
mx
 ; ++ix ) {

118 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
, "PKT-IO", "FD: %d", 
p
->
fds
[
ix
]);

120 
	}
}

122 
	$swp_ut_£t_³rsi¡
(
swp_ut_p_desü
 
p
, 
how
) {

123 iàĞ(
p
->
fds
[0]==
SWP_UTIL_INV_FD
) ||

124 (
	`ioùl
(
p
->
fds
[0],
TUNSETPERSIST
,
how
==0 ? 0 : 1)< 0) ) {

125 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-PERSIST", "Can't…ersistap device %s",

126 
p
->
devÇme
);

127  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

129  
STD_ERR_OK
;

130 
	}
}

132 
	$swp_ut_şo£_fds
(
swp_ut_p_desü
 
p
) {

133 
ix
 = 0;

134 
mx
 = 
p
->
queues
;

136  ; 
ix
 < 
mx
 ; ++ix ) {

137 ià(
p
->
fds
[
ix
]!=
SWP_UTIL_INV_FD
)

138 
	`şo£
(
p
->
fds
[
ix
]);

139 
p
->
fds
[
ix
]=
SWP_UTIL_INV_FD
;

141 
	}
}

143 
t_¡d_”rÜ
 
	$swp_ut_p_İ”©iÚ
(cÚ¡ * 
Çme
, 
ty³
, 
boŞ
 
ü—‹
) {

145 
iäeq
 
iä
;

147 ià(
ty³
!=
SWP_UTIL_TYPE_TAP
) {

148  
	`STD_ERR
(
INTERFACE
,
PARAM
,
ty³
);

151 
fd
=
SWP_UTIL_INV_FD
,
”r
=0;

153 ià(
	`¡¾’
(
Çme
)>((
iä
.
iä_iän
.
iän_Çme
)-1))

154  
	`STD_ERR
(
INTERFACE
,
PARAM
,
	`¡¾’
(
Çme
));

156 
	`mem£t
(&
iä
,0,(ifr));

158 
iä
.
iä_æags
 = 
IFF_TAP
 | 
IFF_MULTI_QUEUE
 | 
IFF_NO_PI
;

160 
	`¡ºıy
(
iä
.
iä_iän
.
iän_Çme
,
Çme
,

161 (
iä
.
iä_iän
.
iän_Çme
)-1);

163 ià((
fd
=
	`İ’
("/dev/Ãt/tun",
O_RDWR
))<0) {

164 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-PERSIST", "Can't open /dev/net/tun");

165  
	`STD_ERR
(
INTERFACE
,
FAIL
,
”ºo
);

167 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

169 
”r
 = 
	`ioùl
(
fd
,
TUNSETIFF
,(*)&
iä
);

170 ià(
”r
) {

171 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-OP", "Cª'ˆassocŸ‹­ deviû % tØFDƒ¼:%d",
Çme
,

172 
”r
);

173 
rc
 = 
	`STD_ERR
(
INTERFACE
,
FAIL
,
”r
);

177 if(
ü—‹
){

178 
tqËn_fd
;

179 if((
tqËn_fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0))<0){

180 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-OP", "Can't open fdo setxqlen");

182 
iä
.
iä_qËn
 = 
SWP_UTIL_TAP_TXQLEN
;

183 ià((
”r
 = 
	`ioùl
(
tqËn_fd
, 
SIOCSIFTXQLEN
, &
iä
)) < 0) {

184 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-OP", "Cª'ˆ£ˆtxqËÀfÜ % tØ%d FDƒ¼:%d",
Çme
,

185 
SWP_UTIL_TAP_TXQLEN
,
”r
);

187 
	`şo£
(
tqËn_fd
);

191 ià(
	`ioùl
(
fd
,
TUNSETPERSIST
,(
ü—‹
) ? 1 : 0)< 0) {

192 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-OP", "Can't change…ersist state for %so %d",

193 
Çme
,
ü—‹
);

194 
rc
 = 
	`STD_ERR
(
INTERFACE
,
FAIL
,
”r
);

198 
	`şo£
(
fd
);

199  
rc
;

200 
	}
}

203 
t_¡d_”rÜ
 
	$swp_ut_®loc_p
(
swp_ut_p_desü
 
p
, 
ty³
) {

204 
	`STD_ASSERT
(
p
!=
NULL
);

206 
iäeq
 
iä
;

208 ià(
ty³
!=
SWP_UTIL_TYPE_TAP
) {

209  
	`STD_ERR
(
INTERFACE
,
PARAM
,
ty³
);

212 
p
->
ty³
 =ype;

214 
fd
=
SWP_UTIL_INV_FD
,
”r
=0,
i
;

216 ià(
	`¡¾’
(
p
->
devÇme
)>((
iä
.
iä_iän
.
iän_Çme
)-1)) {

217  
	`STD_ERR
(
INTERFACE
,
PARAM
,
	`¡¾’
(
p
->
devÇme
));

220 
	`mem£t
(&
iä
,0,(ifr));

222 
iä
.
iä_æags
 = 
IFF_TAP
 | 
IFF_MULTI_QUEUE
 | 
IFF_NO_PI
;

224 
	`§ã¡ºıy
(
iä
.
iä_iän
.
iän_Çme
,
p
->
devÇme
,

225 (
iä
.
iä_iän
.
iän_Çme
));

227  
i
 = 0; i < 
p
->
queues
 ; ++i) {

228 ià((
fd
=
	`İ’
("/dev/Ãt/tun",
O_RDWR
))<0) {

229 
	`swp_ut_şo£_fds
(
p
);

230 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-ALLOC", "Can't open /dev/net/tun ");

231  
	`STD_ERR
(
INTERFACE
,
FAIL
,
”r
);

234 
”r
 = 
	`ioùl
(
fd
,
TUNSETIFF
,(*)&
iä
);

235 ià(
”r
) {

236 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-ALLOC", "Can't‡ssociate file descriptor forap (%s:%s) :%d",

237 
p
->
devÇme
,
iä
.
iä_iän
.
iän_Çme
,
”r
);

238 
	`şo£
(
fd
);

239 
	`swp_ut_şo£_fds
(
p
);

240  
	`STD_ERR
(
INTERFACE
,
FAIL
,
”r
);

242 
p
->
fds
[
i
]=
fd
;

243 
”r
 = 
	`¡d_sock_£t_nÚblock
(
fd
, 1);

244 ià(
”r
 !ğ
STD_ERR_OK
) {

245 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"TAP-ALLOC", "Can't set‚on-blockingoap fd for interface:%s: %d",

246 
iä
.
iä_iän
.
iän_Çme
,
”r
);

247 
	`şo£
(
fd
);

248 
	`swp_ut_şo£_fds
(
p
);

249  
	`STD_ERR
(
INTERFACE
,
FAIL
,
”r
);

252 ià(
p
->
max_fd
 < 
fd
)ap->max_fd = fd;

255  
STD_ERR_OK
;

256 
	}
}

258 
h®_ifšdex_t
 
	$swp_š™_p_ifšdex
(
swp_ut_p_desü
 
p
) {

259  
	`if_Çm‘ošdex
(
p
->
devÇme
);

260 
	}
}

262 
	$swp_ut_p_fd_£t_add
(
swp_ut_p_desü
 *
p
, 
desüs
, 
fd_£t
 *
£t
)

264 
dix
 = 0;

265 
dmx
 = 
desüs
;

266 
fd_max
 = 
SWP_UTIL_INV_FD
;

267  ; 
dix
 < 
dmx
 ; ++dix ) {

268 ià(
p
[
dix
]==
NULL
) ;

269 
ix
 = 0;

270 
mx
 = 
p
[
dix
]->
queues
;

271  ; 
ix
 < 
mx
 ; ++ix ) {

272 ià(
p
[
dix
]->
fds
[
ix
]==
SWP_UTIL_INV_FD
) ;

273 
	`FD_SET
(
p
[
dix
]->
fds
[
ix
],
£t
);

275 ià(
fd_max
 < 
p
[
dix
]->
max_fd
) fd_max =…[dix]->max_fd;

277  
fd_max
;

278 
	}
}

280 
	$swp_ut_p_fd_loÿ‹_äom_£t
(
swp_ut_p_desü
 
p
, 
fd_£t
 *
£t
)

282 
ix
 = 0;

283 
mx
 = 
p
->
queues
;

284  ; 
ix
 < 
mx
 ; ++ix ) {

285 ià(
p
->
fds
[
ix
]==
SWP_UTIL_INV_FD
) ;

286 ià(
	`FD_ISSET
(
p
->
fds
[
ix
],
£t
)) {

287  
p
->
fds
[
ix
];

290  
SWP_UTIL_INV_FD
;

291 
	}
}

293 
boŞ
 
	$swp_ut_p_is_fd_š_p_fd_£t
(
swp_ut_p_desü
 
p
, 
fd
)

295 
ix
 = 0;

296 
mx
 = 
p
->
queues
;

297  ; 
ix
 < 
mx
 ; ++ix ) {

298 ià(
p
->
fds
[
ix
]=ğ
fd
è 
Œue
;

300  
çl£
;

301 
	}
}

	@src/unit_test/interface_file_reader_unit_test.c

26 
	~"h®_if_m­pšg.h
"

27 
	~"h®_š‹rçû_commÚ.h
"

30 
	~<¡dio.h
>

33 
	$h®_if_»gi¡”_d‘as
(
h®_if_pÜt_d‘as_t
 * 
pÜt_d‘as
) {

34 
	`´štf
("Registering... \n");

35 
	`´štf
("Faceplate:%d\nIF Name:%s\nNPU:%d\n,PORT:%d\nFanout:%d\nSubIF:%d\n\n",

36 ()
pÜt_d‘as
->
çû¶©e_pÜt
,

37 
pÜt_d‘as
->
iâame
,

38 ()
pÜt_d‘as
->
Åu
,

39 ()
pÜt_d‘as
->
pÜt
,

40 ()
pÜt_d‘as
->
çnout
,

41 ()
pÜt_d‘as
->
sub_š‹rçû
);

42 
	}
}

44 
	$maš
() {

45 
	`h®_lßd_š‹rçû_m­
("port_names.cfg");

47 
	}
}

	@src/unit_test/nas_int_lag_unittest.cpp

22 
	~"ıs_şass_m­.h
"

23 
	~"ıs_­i_objeù.h
"

24 
	~"ıs_­i_İ”©iÚ.h
"

25 
	~"ıs_­i_objeù_key.h
"

26 
	~"ıs_­i_objeù_ÿ‹gÜy.h
"

27 
	~"ıs_­i_ev’ts.h
"

28 
	~"d–l-ba£-if-Ïg.h
"

29 
	~"d–l-ba£-if-vÏn.h
"

30 
	~"d–l-ba£-if.h
"

31 
	~"d–l-š‹rçû.h
"

32 
	~"›tf-š‹rçûs.h
"

33 
	~"ŸÇ-if-ty³.h
"

34 
	~"h®_š‹rçû_deçuÉs.h
"

35 
	~"Çs_ndi_obj_id_bË.h
"

36 
	~"¡d_uts.h
"

38 
	~<g‹¡/g‹¡.h
>

39 
	~<io¡»am
>

40 
	~<Ãt/if.h
>

42 
usšg
 
Çme¥aû
 
	g¡d
;

44 
	$TEST
(
¡d_Ïg_ü—‹_‹¡
, 
ü—‹_Ïg_štf_no_id
)

47 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

50 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

51 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

53 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

54 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

55 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

57 cÚ¡ *
Ïg_Çme
 = "bond";

58 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

61 cÚ¡ * 
mac_addr
 = "12:34:56:78:12:35";

62 
	`ıs_­i_objeù_©Œ_add
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
 , 
mac_addr
, 
	`¡¾’
(mac_addr)+1);

64 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

65 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

66 
	`ıs_­i_ü—‹
(&
Œ
,
obj
);

67 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

69 
ıs_­i_objeù_t
 
»cvd_obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
Œ
.
chªge_li¡
,0);

71 
ıs_­i_objeù_©Œ_t
 
Ïg_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
»cvd_obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

73 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
Ïg_©Œ
);

75 
cout
 <<"IF Index from K”ÃÈi "<< 
ifšdex
 << 
’dl
;

77 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

78 
	}
}

80 
	$TEST
(
¡d_Ïg_ü—‹_‹¡
, 
ü—‹_Ïg_štf
)

83 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

86 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

87 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

89 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

90 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

91 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

93 cÚ¡ *
Ïg_Çme
 = "bond1";

94 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

97 cÚ¡ * 
mac_addr
 = "12:34:56:78:12:34";

98 
	`ıs_­i_objeù_©Œ_add
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
 , 
mac_addr
, 
	`¡¾’
(mac_addr)+1);

100 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

101 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

102 
	`ıs_­i_ü—‹
(&
Œ
,
obj
);

103 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

105 
ıs_­i_objeù_t
 
»cvd_obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
Œ
.
chªge_li¡
,0);

107 
ıs_­i_objeù_©Œ_t
 
Ïg_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
»cvd_obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

109 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
Ïg_©Œ
);

111 
cout
 <<"IF Index from K”ÃÈi "<< 
ifšdex
 << 
’dl
;

113 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

114 
	}
}

116 
	$TEST
(
¡d_Ïg_¡©e_‹¡
, 
g‘_Ïg_štf_¡©e
)

118 
ıs_­i_g‘_·¿ms_t
 
gp
;

119 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

121 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

122 
	`ASSERT_TRUE
(
obj
 !ğ
nuÎ±r
);

124 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
), 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
,

125 
ıs_­i_qu®if›r_OBSERVED
);

127 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

128 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

129 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

131 cÚ¡ *
Ïg_iâame
 = "bond1";

133 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_STATE_INTERFACE_NAME
,
Ïg_iâame
,
	`¡¾’
(lag_ifname)+1);

135 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

136 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 0);

137 
ıs_­i_objeù_©Œ_t
 
Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_NAME
);

138 cÚ¡ *
Çme
 = (cÚ¡ *è
	`ıs_­i_objeù_©Œ_d©a_bš
(
Çme_©Œ
);

139 
	`ASSERT_TRUE
(
	`¡¾’
(
Çme
è=ğ¡¾’(
Ïg_iâame
));

140 
	`ASSERT_TRUE
(
	`¡ºcmp
(
Çme
, 
Ïg_iâame
, 
	`¡¾’
(lag_ifname)) == 0);

143 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

144 
	}
}

146 
	$TEST
(
¡d_£t_mac
, 
£t_mac_Ïg
)

149 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

151 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

152 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

154 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

155 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

156 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

158 cÚ¡ *
Ïg_Çme
 = "bond1";

159 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

160 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

162 cÚ¡ * 
mac_addr
 = "12:34:56:78:12:34";

163 
	`ıs_­i_objeù_©Œ_add
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
 , 
mac_addr
, 
	`¡¾’
(mac_addr)+1);

165 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

166 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

167 
	`ıs_­i_£t
(&
Œ
,
obj
);

168 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

170 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

172 
	}
}

174 
	$TEST
(
¡d_£t_desc
, 
£t_desc_Ïg
)

177 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

179 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

180 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

182 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

183 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

184 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

186 cÚ¡ *
Ïg_Çme
 = "bond1";

187 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

188 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

190 cÚ¡ *
desc
 = "bond1 interface description";

191 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_DESCRIPTION
, 
desc
, 
	`¡¾’
(desc) + 1);

193 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

194 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

195 
	`ıs_­i_£t
(&
Œ
,
obj
);

196 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

198 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

200 
	}
}

202 
	$TEST
(
¡d_£t_mtu
, 
£t_mtu_Ïg
)

204 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

206 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

207 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,
ıs_­i_qu®if›r_TARGET
);

209 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

210 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

211 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

213 cÚ¡ *
Ïg_Çme
 = "bond1";

214 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

215 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

217 
ušt_t
 
mtu
=2000;

219 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
,
mtu
);

221 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

222 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

223 
	`ıs_­i_£t
(&
Œ
,
obj
);

224 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

226 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

228 
	}
}

230 
	$TEST
(
¡d_£t_admš_up
,
£t_admš_Ïg_up
)

233 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

235 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

236 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

238 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

239 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

240 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

242 cÚ¡ *
Ïg_Çme
 = "bond1";

243 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

244 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

246 
boŞ
 
¡©e
 = 
Œue
;

247 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
,
¡©e
);

249 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

250 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

251 
	`ıs_­i_£t
(&
Œ
,
obj
);

252 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

254 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

256 
	}
}

258 
	$TEST
(
¡d_£t_admš_down
, 
£t_admš_Ïg_down
)

260 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

262 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

263 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

265 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

266 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

267 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

269 cÚ¡ *
Ïg_Çme
 = "bond1";

270 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

271 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

273 
boŞ
 
¡©e
 = 
çl£
;

274 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
,
¡©e
);

276 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

277 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

278 
	`ıs_­i_£t
(&
Œ
,
obj
);

279 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

281 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

283 
	}
}

285 
	$TEST
(
¡d_®l_pÜts_d–
, 
d–‘e_®l_pÜts_äom_Ïg
)

287 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

289 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

290 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

292 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

293 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

294 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

296 cÚ¡ *
Ïg_Çme
 = "bond1";

297 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

298 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

300 
	`ıs_­i_objeù_©Œ_add
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
, 0,0);

302 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

303 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

304 
	`ıs_­i_£t
(&
Œ
,
obj
);

305 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

306 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

307 
	}
}

309 
	$TEST
(
¡d_Ïg_add_pÜt_‹¡
, 
add_pÜts_to_Ïg
)

311 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

313 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

314 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

316 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

317 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

318 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

320 cÚ¡ *
Ïg_Çme
 = "bond1";

321 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

322 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

324 
ıs_­i_©Œ_id_t
 
ids
[3] = {
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
,0,

325 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS_NAME
 };

326 cÚ¡ 
ids_Ën
 = (
ids
)/(ids[0]);

327 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,"e101-001-0",
	`¡¾’
("e101-001-0")+1);

328 
ids
[1]++;

329 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,"e101-002-0",
	`¡¾’
("e101-001-0")+1);

330 
ids
[1]++;

331 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,"e101-003-0",
	`¡¾’
("e101-001-0")+1);

333 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

334 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

335 
	`ıs_­i_ü—‹
(&
Œ
,
obj
);

336 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

338 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

339 
	}
}

341 
	$TEST
(
¡d_Ïg_add_pÜt_‹¡
, 
add_pÜts_check_mac
)

343 
ıs_­i_g‘_·¿ms_t
 
gp
;

344 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

346 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

347 
	`ASSERT_TRUE
(
obj
 !ğ
nuÎ±r
);

349 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

350 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

352 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

353 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

354 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

356 cÚ¡ *
Ïg_iâame
 = "bond1";

357 cÚ¡ *
‹¡_mac_addr
 = "12:34:56:78:12:34";

359 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
Ïg_iâame
,
	`¡¾’
(lag_ifname)+1);

361 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

362 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 0);

363 
ıs_­i_objeù_©Œ_t
 
mac_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
);

364 cÚ¡ *
mac
 = (cÚ¡ *è
	`ıs_­i_objeù_©Œ_d©a_bš
(
mac_©Œ
);

365 
	`ASSERT_TRUE
(
	`¡¾’
(
mac
è=ğ¡¾’(
‹¡_mac_addr
));

366 
	`ASSERT_TRUE
(
	`¡ºcmp
(
mac
, 
‹¡_mac_addr
, 
	`¡¾’
(test_mac_addr)) == 0);

369 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

370 
	}
}

372 
	$TEST
(
¡d_Ïg_block_pÜts
, 
block_pÜts_to_Ïg
)

374 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

376 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

377 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

379 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

380 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

381 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

383 cÚ¡ *
Ïg_Çme
 = "bond1";

384 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

385 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

387 
	`ıs_­i_objeù_©Œ_add
(
obj
,
BASE_IF_LAG_IF_INTERFACES_INTERFACE_BLOCK_PORT_LIST
,"e101-002-0",
	`¡¾’
("e101-002-0")+1);

389 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

390 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

391 
	`ıs_­i_£t
(&
Œ
,
obj
);

392 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

394 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

395 
	}
}

397 
	$TEST
(
¡d_Ïg_block_pÜts
, 
unblock_pÜts_to_Ïg
)

399 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

401 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

402 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

404 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

405 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

406 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

408 cÚ¡ *
Ïg_Çme
 = "bond1";

409 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

410 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

412 
	`ıs_­i_objeù_©Œ_add
(
obj
,
BASE_IF_LAG_IF_INTERFACES_INTERFACE_UNBLOCK_PORT_LIST
,"e101-002-0",
	`¡¾’
("e101-002-0")+1);

414 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

415 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

416 
	`ıs_­i_£t
(&
Œ
,
obj
);

417 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

419 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

420 
	}
}

422 
	$TEST
(
¡d_Ïg_block_pÜts
, 
block_ªd_unblock_pÜts_to_Ïg
)

424 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

426 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

427 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

429 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

430 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

431 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

433 cÚ¡ *
Ïg_Çme
 = "bond1";

434 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

435 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

437 
	`ıs_­i_objeù_©Œ_add
(
obj
,
BASE_IF_LAG_IF_INTERFACES_INTERFACE_BLOCK_PORT_LIST
,"e101-001-0",
	`¡¾’
("e101-001-0")+1);

438 
	`ıs_­i_objeù_©Œ_add
(
obj
,
BASE_IF_LAG_IF_INTERFACES_INTERFACE_UNBLOCK_PORT_LIST
,"e101-002-0",
	`¡¾’
("e101-002-0")+1);

440 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

441 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

442 
	`ıs_­i_£t
(&
Œ
,
obj
);

443 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

445 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

446 
	}
}

448 
	$TEST
(
¡d_Ïg_block_pÜts
, 
v”ify_block_unblock_pÜts
)

450 
ıs_­i_g‘_·¿ms_t
 
gp
;

451 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

453 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

454 
	`ASSERT_TRUE
(
obj
 !ğ
nuÎ±r
);

456 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
), 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
,

457 
ıs_­i_qu®if›r_OBSERVED
);

459 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

460 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

461 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

463 cÚ¡ *
Ïg_iâame
 = "bond1";

464 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_STATE_INTERFACE_NAME
,
Ïg_iâame
,
	`¡¾’
(lag_ifname)+1);

466 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

467 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 0);

468 
ıs_­i_objeù_©Œ_t
 
blocked_pÜts_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_BLOCK_PORT_LIST
);

469 
ıs_­i_objeù_©Œ_t
 
unblocked_pÜts_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_UNBLOCK_PORT_LIST
);

470 cÚ¡ *
blocked_pÜts
 = (cÚ¡ *è
	`ıs_­i_objeù_©Œ_d©a_bš
(
blocked_pÜts_©Œ
);

471 cÚ¡ *
unblocked_pÜts
 = (cÚ¡ *è
	`ıs_­i_objeù_©Œ_d©a_bš
(
unblocked_pÜts_©Œ
);

472 
	`ASSERT_TRUE
(
	`¡¾’
(
blocked_pÜts
) == strlen("e101-001-0"));

473 
	`ASSERT_TRUE
(
	`¡¾’
(
unblocked_pÜts
) == strlen("e101-002-0"));

474 
	`ASSERT_TRUE
(
	`¡ºcmp
(
blocked_pÜts
, "e101-001-0", 
	`¡¾’
(blocked_ports)) == 0);

475 
	`ASSERT_TRUE
(
	`¡ºcmp
(
unblocked_pÜts
, "e101-002-0", 
	`¡¾’
(unblocked_ports)) == 0);

478 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

479 
	}
}

481 
	$TEST
(
¡d_Ïg_w™h_vÏn
, 
add_Ïg_to_vÏn
)

484 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

485 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

486 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

487 
ıs_­i_qu®if›r_TARGET
);

489 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

490 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

491 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

492 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
,100);

493 cÚ¡ * 
mac
 = "00:11:11:11:11:11";

494 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, 
mac
, 
	`¡¾’
(mac) + 1);

496 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

497 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

498 
	`ıs_­i_ü—‹
(&
Œ
,
obj
);

499 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

501 
ıs_­i_objeù_t
 
»cvd_obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
Œ
.
chªge_li¡
,0);

503 
ıs_­i_objeù_©Œ_t
 
vÏn_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»cvd_obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

504 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_©Œ
);

505 
cout
 <<"VLAN i ü—‹d, ifšdex = "<< 
ifšdex
 << 
’dl
;

507 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

510 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

511 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

512 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

513 
ıs_­i_qu®if›r_TARGET
);

515 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

516 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

517 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

518 cÚ¡ *
br_Çme
 = "br100";

519 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

520 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

521 cÚ¡ *
Ïg_Çme
 = "bond1";

522 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
, 
Ïg_Çme
,

523 
	`¡¾’
(
Ïg_Çme
) + 1);

525 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

526 
	`ıs_­i_£t
(&
Œ
,
obj
);

527 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

529 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

530 
	}
}

532 
	$Çs_´št_vÏn_objeù
(
ıs_­i_objeù_t
 
obj
)

534 
ıs_­i_objeù_™_t
 
™
;

535 
	`ıs_­i_objeù_™_begš
(
obj
,&
™
);

537  ; 
	`ıs_­i_objeù_™_v®id
(&
™
è; 
	`ıs_­i_objeù_™_Ãxt
(&it) ) {

538 
id
 = (è
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

539 
id
) {

540 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
:

541 
¡d
::
cout
<<"VLAN INDEX "<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

543 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
:

544 
¡d
::
cout
<<"VLAN ID "<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

547 
IF_INTERFACES_INTERFACE_NAME
:

548 
	`´štf
("Nam% \n", (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
));

551 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
:

552 
	`´štf
("Tagged PÜˆ% \n", (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
));

555 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
:

556 
	`´štf
("UÁagged PÜˆ% \n", (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
));

558 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
:

559 
	`´štf
("MAC Add»s % \n", (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
));

562 
IF_INTERFACES_INTERFACE_ENABLED
:

563 
¡d
::
cout
<<"Admš Stu "<< 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

566 
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
:

567 
¡d
::
cout
<<"L—ºšg mod"<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

575 
	}
}

577 
	$TEST
(
¡d_Ïg_w™h_vÏn
, 
´št_Ïg_š_vÏn
)

579 
ıs_­i_g‘_·¿ms_t
 
gp
;

580 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

582 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

583 
	`ASSERT_TRUE
(
obj
 !ğ
nuÎ±r
);

585 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
), 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

586 
ıs_­i_qu®if›r_TARGET
);

588 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

589 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

590 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

591 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
, 100);

593 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

594 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

595 
size_t
 
ix
 = 0 ; ix < 
mx
 ; ++ix ) {

596 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
,
ix
);

597 
¡d
::
cout
<<"VLAN InfÜm©iÚ"<<¡d::
’dl
;

598 
	`Çs_´št_vÏn_objeù
(
obj
);

601 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

602 
	}
}

604 
	$TEST
(
¡d_Ïg_w™h_vÏn
, 
»move_Ïg_äom_vÏn
)

607 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

608 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

609 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

610 
ıs_­i_qu®if›r_TARGET
);

611 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

612 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

613 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

615 cÚ¡ *
br_Çme
 = "br100";

616 
šdex
 = 
	`if_Çm‘ošdex
(
br_Çme
);

618 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

619 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

621 
šdex
 = 0;

622 
size_t
 
Ën
 = 0;

623 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
,

624 &
šdex
, 
Ën
);

627 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

628 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

629 
	`ıs_­i_£t
(&
Œ
,
obj
);

630 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

632 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

635 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

637 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

638 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

639 
ıs_­i_qu®if›r_TARGET
);

641 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

642 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

643 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

645 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

646 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

648 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

649 
	`ıs_­i_d–‘e
(&
Œ
,
obj
);

650 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

651 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

652 
	}
}

654 
	$TEST
(
¡d_Ïg_unblock_pÜts
,
unblock_pÜts_to_Ïg
)

656 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

658 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

659 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

661 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

662 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

663 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

665 cÚ¡ *
Ïg_Çme
 = "bond1";

666 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

667 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

669 
	`ıs_­i_objeù_©Œ_add
(
obj
,
BASE_IF_LAG_IF_INTERFACES_INTERFACE_UNBLOCK_PORT_LIST
,"e101-003-0",
	`¡¾’
("e101-003-0")+1);

671 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

672 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

673 
	`ıs_­i_£t
(&
Œ
,
obj
);

674 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

676 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

677 
	}
}

679 
	$TEST
(
¡d_Ïg_d–‘e_pÜt_‹¡
, 
d–‘e_pÜts_äom_Ïg
)

681 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

683 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

684 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

686 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

687 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

688 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

690 cÚ¡ *
Ïg_Çme
 = "bond1";

691 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

692 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

694 
ıs_­i_©Œ_id_t
 
ids
[3] = {
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
,0,

695 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS_NAME
 };

696 cÚ¡ 
ids_Ën
 = (
ids
)/(ids[0]);

697 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,"e101-001-0",
	`¡¾’
("e101-001-0")+1);

698 
ids
[1]++;

699 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,"e101-002-0",
	`¡¾’
("e101-001-0")+1);

700 
ids
[1]++;

701 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,"e101-003-0",
	`¡¾’
("e101-001-0")+1);

703 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

704 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

705 
	`ıs_­i_d–‘e
(&
Œ
,
obj
);

706 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

708 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

709 
	}
}

711 
	$TEST
(
¡d_Ïg_d–‘e_‹¡
, 
d–‘e_Ïg_štf
)

713 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

715 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

716 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

718 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

719 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

720 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

722 cÚ¡ *
Ïg_Çme
 = "bond1";

723 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

724 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

726 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

727 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

728 
	`ıs_­i_d–‘e
(&
Œ
,
obj
);

729 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

730 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

731 
	}
}

733 
	$TEST
(
¡d_Ïg_d–‘e_‹¡
, 
d–‘e_Ïg_štf_no_id
)

735 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

737 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

738 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

740 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

741 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

742 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

744 cÚ¡ *
Ïg_Çme
 = "bond";

745 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

746 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

748 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

749 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

750 
	`ıs_­i_d–‘e
(&
Œ
,
obj
);

751 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

752 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

753 
	}
}

755 
	$TEST
(
¡d_Ïg_d–‘e_‹¡
, 
d–‘e_Ïg_štf_w™h_pÜts
)

758 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

761 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

762 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

764 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

765 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

766 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

768 cÚ¡ *
Ïg_Çme
 = "bond1";

769 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

772 cÚ¡ *
mac_addr
 = "12:34:56:78:12:34";

773 
	`ıs_­i_objeù_©Œ_add
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
 , 
mac_addr
, 
	`¡¾’
(mac_addr)+1);

775 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

776 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

777 
	`ıs_­i_ü—‹
(&
Œ
,
obj
);

778 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

779 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

782 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

784 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

785 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

787 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

788 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

789 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

791 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

792 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

794 
ıs_­i_©Œ_id_t
 
ids
[3] = {
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
,0,

795 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS_NAME
 };

796 cÚ¡ 
ids_Ën
 = (
ids
)/(ids[0]);

797 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,"e101-001-0",
	`¡¾’
("e101-001-0")+1);

798 
ids
[1]++;

799 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,"e101-002-0",
	`¡¾’
("e101-001-0")+1);

800 
ids
[1]++;

801 
	`ıs_­i_objeù_e_add
(
obj
,
ids
,
ids_Ën
,
ıs_­i_objeù_ATTR_T_BIN
,"e101-003-0",
	`¡¾’
("e101-001-0")+1);

803 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

804 
	`ıs_­i_£t
(&
Œ
,
obj
);

805 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

806 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

809 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

811 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

812 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

814 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

815 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

816 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

818 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

819 
Ïg_Çme
,
	`¡¾’
(lag_name)+1);

820 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

821 
	`ıs_­i_d–‘e
(&
Œ
,
obj
);

822 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

823 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

824 
	}
}

826 
	$Çs_Ïg_´št_memeb”_pÜts
(
ıs_­i_objeù_t
 
obj
, cÚ¡ 
ıs_­i_objeù_™_t
 & 
™
){

827 
ıs_­i_objeù_™_t
 
™_lvl_1
 = 
™
;

828 
ıs_­i_©Œ_id_t
 
ids
[3] = {
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
,0,

829 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS_NAME
 };

830 cÚ¡ 
ids_Ën
 = (
ids
)/(ids[0]);

832 
	`ıs_­i_objeù_™_šside
 (&
™_lvl_1
); 
	`ıs_­i_objeù_™_v®id
 (&it_lvl_1);

833 
	`ıs_­i_objeù_™_Ãxt
 (&
™_lvl_1
)) {

835 
ids
[1] = 
	`ıs_­i_objeù_©Œ_id
 (
™_lvl_1
.
©Œ
);

836 
ıs_­i_objeù_©Œ_t
 
štf
 = 
	`ıs_­i_objeù_e_g‘
(
obj
,
ids
,
ids_Ën
);

838 if(
štf
){

839 
cout
<<
	`ıs_­i_objeù_©Œ_d©a_bš
(
štf
)<<
’dl
;

842 
	}
}

844 
	$Çs_´št_Ïg_objeù
(
ıs_­i_objeù_t
 
obj
){

845 
ıs_­i_objeù_™_t
 
™
;

846 
	`ıs_­i_objeù_™_begš
(
obj
,&
™
);

848 
cout
 << "\nLag:- Index\tID\tName\tslaves\t\t SMAC \t\t\tAStatus \t\tNPU-ID/NDI-SAI-ID\n\t";

849  ; 
	`ıs_­i_objeù_™_v®id
(&
™
è; 
	`ıs_­i_objeù_™_Ãxt
(&it) ) {

850 
id
 = (è
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

851 
id
) {

852 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
:

853 
cout
<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<'\t';

855 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_ID
:

856 
cout
<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<'\t';

858 
IF_INTERFACES_INTERFACE_NAME
:

859 
cout
<<(*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
)<<'\t';

861 
DELL_IF_IF_INTERFACES_INTERFACE_MEMBER_PORTS
:

862 
	`Çs_Ïg_´št_memeb”_pÜts
(
obj
,
™
);

864 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
:

865 
cout
<<
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
)<<'\t';

867 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
:

868 
cout
<<(
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
) ? "DOWN":"UP");

869 
cout
<<"\t\t";

871 
BASE_IF_LAG_IF_INTERFACES_INTERFACE_LAG_OPAQUE_DATA
:

873 
Çs
::
ndi_obj_id_bË_t
 
Ïg_İaque_d©a_bË
;

874 
ıs_­i_©Œ_id_t
 
©Œ_id_li¡
[] = {
BASE_IF_LAG_IF_INTERFACES_INTERFACE_LAG_OPAQUE_DATA
};

875 
Çs
::
	`ndi_obj_id_bË_ıs_un£rŸlize
 (
Ïg_İaque_d©a_bË
, 
obj
, 
©Œ_id_li¡
,

876 (
©Œ_id_li¡
)/(attr_id_list[0]));

877 autØ
™
 = 
Ïg_İaque_d©a_bË
.
	`begš
();

878 
cout
<<"\t";

879 
cout
<<
™
->
fœ¡
<<"/" <<™->
£cÚd
;

880 
cout
<<'\n';

888 
	`fæush
(
¡dout
);

889 
	}
}

892 
	$TEST
(
¡d_Ïg_g‘
, 
g‘_Ïgs_ü—‹d
)

894 
ıs_­i_g‘_·¿ms_t
 
gp
;

895 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

897 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

899 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

900 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

902 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

903 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

904 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

907 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

908 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

909 
size_t
 
ix
 = 0 ; ix < 
mx
 ; ++ix ) {

910 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
,
ix
);

911 
cout
<<"Insidloİ"<<
’dl
;

912 
	`Çs_´št_Ïg_objeù
(
obj
);

914 
cout
<<"\n";

916 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

918 
	}
}

920 
	$TEST
(
¡d_Ïg_İaque_g‘
, 
g‘_Ïgs_İaque
)

922 
ıs_­i_g‘_·¿ms_t
 
gp
;

923 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

925 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

927 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
), 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

928 
ıs_­i_qu®if›r_TARGET
);

930 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

931 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
,

932 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_IEEE8023ADLAG
));

934 
ušt64_t
 
ndi_Ïg_id
= 562949953421312;

935 
	`ıs_­i_objeù_©Œ_add_u64
(
obj
,
BASE_IF_LAG_IF_INTERFACES_INTERFACE_LAG_OPAQUE_DATA
,
ndi_Ïg_id
);

937 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

938 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

939 
size_t
 
ix
 = 0 ; ix < 
mx
 ; ++ix ) {

940 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
,
ix
);

941 
	`Çs_´št_Ïg_objeù
(
obj
);

943 
cout
<<"\n";

945 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

946 
	}
}

949 
boŞ
 
	$Ïg_obj_ev’t_cb
(
ıs_­i_objeù_t
 
obj
, *
·¿m
)

952 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

954 ifĞ
İ
 =ğ
ıs_­i_İ”_CREATE
){

955 
cout
 << "O³¿tiÚ Ty³ :- Add Lag "<< 
’dl
;

957 if(
İ
 =ğ
ıs_­i_İ”_DELETE
){

958 
cout
 << "O³¿tiÚ Ty³ :- D–‘Lag "<< 
’dl
;

960 if(
İ
 =ğ
ıs_­i_İ”_SET
){

961 
cout
 << "O³¿tiÚ Ty³ :- PÜt Add/D–. "<< 
’dl
;

964 
	`Çs_´št_Ïg_objeù
(
obj
);

965  
Œue
;

966 
	}
}

968 
	$TEST
(
¡d_Ïg_ev’t_rx_‹¡
, 
g‘_Ïg_ev’ts
)

973 
ıs_­i_ev’t_»g_t
 
»g
;

974 
	`mem£t
(&
»g
,0,(reg));

976 ià(
	`ıs_­i_ev’t_£rviû_š™
(è!ğ
ıs_­i_»t_code_OK
) {

977 
	`´štf
("***ERROR*** cps_api_event_service_init() failed\n");

981 ià(
	`ıs_­i_ev’t_th»ad_š™
(è!ğ
ıs_­i_»t_code_OK
) {

982 
	`´štf
("***ERROR*** cps_api_event_thread_init() failed\n");

986 
ıs_­i_key_t
 
key
;

988 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
key
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

989 
ıs_­i_qu®if›r_OBSERVED
);

991 
»g
.
numb”_of_objeùs
 = 1;

992 
»g
.
objeùs
 = &
key
;

994 ià(
	`ıs_­i_ev’t_th»ad_»g
(&
»g
,
Ïg_obj_ev’t_cb
,
NULL
)!=
ıs_­i_»t_code_OK
) {

995 
cout
 << "„egi¡¿tiÚ fau»"<<
’dl
;

1001 
	}
}

1005 
	$maš
(
¬gc
, **
¬gv
) {

1006 ::
‹¡šg
::
	`In™GoogËTe¡
(&
¬gc
, 
¬gv
);

1008  
	`RUN_ALL_TESTS
();

1009 
	}
}

	@src/unit_test/nas_int_loopback_unittest.cpp

18 
	~"ıs_­i_objeù.h
"

19 
	~"ıs_­i_İ”©iÚ.h
"

20 
	~"ıs_­i_objeù_ÿ‹gÜy.h
"

21 
	~"ıs_­i_ev’ts.h
"

22 
	~"ıs_şass_m­.h
"

23 
	~"ıs_­i_objeù_key.h
"

24 
	~"h®_if_m­pšg.h
"

25 
	~"d–l-ba£-commÚ.h
"

26 
	~"d–l-ba£-if-phy.h
"

28 
	~<g‹¡/g‹¡.h
>

29 
	~<io¡»am
>

31 
usšg
 
Çme¥aû
 
	g¡d
;

32 
	$‹¡_pÜt_Íbk_mode_£t
(
Åu_id_t
 
Åu
, 
Åu_pÜt_t
 
pÜt
, 
BASE_CMN_LOOPBACK_TYPE_t
 
Íbk_mode
)

35 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

37 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

38 
BASE_IF_PHY_PHYSICAL_OBJ
,

39 
ıs_­i_qu®if›r_TARGET
);

41 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_PHYSICAL_NPU_ID
,
Åu
);

42 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_PHY_PHYSICAL_PORT_ID
,
pÜt
);

45 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_PHYSICAL_LOOPBACK
, (
ušt32_t
)
Íbk_mode
);

47 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

48 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

49 
	`ıs_­i_£t
(&
Œ
,
obj
);

50 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

52 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

53 
	}
}

54 
	$TEST
(
Íbk_‹¡
, 
£t_loİback_mode
)

56 
	`‹¡_pÜt_Íbk_mode_£t
(0,25,
BASE_CMN_LOOPBACK_TYPE_PHY
);

57 
	`‹¡_pÜt_Íbk_mode_£t
(0,29,
BASE_CMN_LOOPBACK_TYPE_MAC
);

58 
	}
}

59 
	$TEST
(
Íbk_‹¡
, 
»£t_loİback_mode
)

61 
	`‹¡_pÜt_Íbk_mode_£t
(0,25,
BASE_CMN_LOOPBACK_TYPE_NONE
);

62 
	`‹¡_pÜt_Íbk_mode_£t
(0,29,
BASE_CMN_LOOPBACK_TYPE_NONE
);

63 
	}
}

65 
	$maš
(
¬gc
, **
¬gv
) {

66 ::
‹¡šg
::
	`In™GoogËTe¡
(&
¬gc
, 
¬gv
);

68  
	`RUN_ALL_TESTS
();

69 
	}
}

	@src/unit_test/nas_int_media_unittest.cpp

22 
	~"ıs_­i_objeù.h
"

23 
	~"ıs_­i_objeù_key.h
"

24 
	~"ıs_­i_İ”©iÚ.h
"

25 
	~"ıs_­i_objeù_ÿ‹gÜy.h
"

26 
	~"ıs_­i_ev’ts.h
"

27 
	~"d–l-ba£-¶©fÜm-commÚ.h
"

28 
	~"d–l-ba£-·s.h
"

29 
	~"ıs_şass_m­.h
"

30 
	~"ds_commÚ_ty³s.h
"

32 
	~<g‹¡/g‹¡.h
>

33 
	~<io¡»am
>

34 
	~<Ãt/if.h
>

35 
	~<¡dio.h
>

36 
	~<¡dšt.h
>

38 
usšg
 
Çme¥aû
 
	g¡d
;

40 
	$TEST
(
¡d_sys_mac_‹¡
, 
g‘_sys_mac
)

43 
ıs_­i_g‘_·¿ms_t
 
gp
;

44 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

46 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

47 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

48 
BASE_PAS_CHASSIS_OBJ
, 
ıs_­i_qu®if›r_OBSERVED
);

50 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

52 
h®_mac_addr_t
 
ba£_mac
;

53 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
,0);

54 
ıs_­i_objeù_©Œ_t
 
ba£_mac_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
BASE_PAS_CHASSIS_BASE_MAC_ADDRESSES
);

55 
ıs_­i_objeù_©Œ_t
 
max_mac_num
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
BASE_PAS_CHASSIS_NUM_MAC_ADDRESSES
);

56 *
_ba£_mac
 = 
	`ıs_­i_objeù_©Œ_d©a_bš
(
ba£_mac_©Œ
);

57 
	`memıy
(
ba£_mac
, 
_ba£_mac
,(base_mac));

58 
cout
<< "MAC siz:" << 
	`ıs_­i_objeù_©Œ_d©a_u32
(
max_mac_num
)<< 
’dl
;

59 
cout
 << "MAC Address: ";

60 
size_t
 
i
 =0; i < (
ba£_mac
); i++) {

61 
	`´štf
("%x:",
ba£_mac
[
i
]);

65 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

67 
	}
}

69 
	$´št_medŸ_šfo
(
ıs_­i_objeù_t
 
obj
)

71 
ıs_­i_objeù_©Œ_t
 
_¦Ù
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
BASE_PAS_MEDIA_SLOT
);

72 
ıs_­i_objeù_©Œ_t
 
_så_idx
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
BASE_PAS_MEDIA_PORT
);

73 
ıs_­i_objeù_©Œ_t
 
_´e£Á
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
BASE_PAS_MEDIA_PRESENT
);

75 
boŞ
 
boŞ_´e£nû
 = *(
ušt8_t
 *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
_´e£Á
);

76 ià(
boŞ_´e£nû
) {

77 
cout
 << "MedŸ i ´e£Á‡ˆ¦Ù "<<
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_¦Ù
);

78 
cout
 <<"‡nd…Üˆ"<<
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_så_idx
);

79 
ıs_­i_objeù_©Œ_t
 
_medŸ_ty³
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
BASE_PAS_MEDIA_TYPE
);

80 
cout
 << " medŸy³ i " << 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_medŸ_ty³
)<<
’dl
;

82 
cout
 << "MedŸ i NOT…»£Á‡ˆ¦Ù "<<
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_¦Ù
);

83 
cout
 <<"‡nd…Üˆ"<<
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_så_idx
)<<
’dl
;

86 
	}
}

88 
	$TEST
(
¡d_medŸ_‹¡
, 
g‘_medŸ_ty³
)

91 
	#MAX_SFP
 32

	)

92 
ıs_­i_g‘_·¿ms_t
 
gp
;

93 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

96 
ušt8_t
 
¦Ù
 = 1;

97 
ušt8_t
 
¡¬t
 = 1;

98 
ušt8_t
 
så_idx
 = 
¡¬t
; så_idx < 
MAX_SFP
+start; sfp_idx++) {

99 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

100 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

101 
BASE_PAS_MEDIA_OBJ
, 
ıs_­i_qu®if›r_OBSERVED
);

102 
	`ıs_­i_£t_key_d©a_ušt
(
obj
, 
BASE_PAS_MEDIA_SLOT
, &
¦Ù
, (slot));

103 
	`ıs_­i_£t_key_d©a_ušt
(
obj
, 
BASE_PAS_MEDIA_PORT
, &
så_idx
, (sfp_idx));

106 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

108 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

109 
cout
<<"R‘uºed Objeùs..."<<
mx
<<
’dl
;

110 
size_t
 
ix
 = 0 ; ix < 
mx
 ; ++ix ) {

111 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
,
ix
);

112 
	`´št_medŸ_šfo
(
obj
);

117 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

119 
	}
}

120 
boŞ
 
	$‹¡_phy_medŸ_ev’t_cb
(
ıs_­i_objeù_t
 
obj
, *
·¿m
)

122 
ıs_­i_key_t
 *
key
 = 
	`ıs_­i_objeù_key
(
obj
);

124 
cout
 << "»ûived MedŸƒv’t.. "<< 
’dl
;

125 ià(
	`ıs_­i_key_g‘_ÿt
(
key
è!ğ
ıs_­i_obj_CAT_BASE_PAS
) {

126  
Œue
;

128 
ušt_t
 
obj_id
 = 
	`ıs_­i_key_g‘_subÿt
(
key
);

130 ifĞ
obj_id
==
BASE_PAS_MEDIA_OBJ
) {

131 
	`´št_medŸ_šfo
(
obj
);

133  
Œue
;

134 
	}
}

135 
	$TEST
(
¡d_medŸ_‹¡
, 
phy_medŸ_mÚ™Ü
)

140 
ıs_­i_ev’t_»g_t
 
»g
;

141 
	`mem£t
(&
»g
,0,(reg));

143 ià(
	`ıs_­i_ev’t_£rviû_š™
(è!ğ
ıs_­i_»t_code_OK
) {

144 
	`´štf
("***ERROR*** cps_api_event_service_init() failed\n");

148 ià(
	`ıs_­i_ev’t_th»ad_š™
(è!ğ
ıs_­i_»t_code_OK
) {

149 
	`´štf
("***ERROR*** cps_api_event_thread_init() failed\n");

153 
ıs_­i_key_t
 
key
;

155 
	`ıs_­i_key_š™
(&
key
, 
ıs_­i_qu®if›r_OBSERVED
,

156 
ıs_­i_obj_CAT_BASE_PAS
, 
BASE_PAS_MEDIA_OBJ
, 0);

158 
»g
.
numb”_of_objeùs
 = 1;

159 
»g
.
objeùs
 = &
key
;

161 ià(
	`ıs_­i_ev’t_th»ad_»g
(&
»g
,
‹¡_phy_medŸ_ev’t_cb
,
NULL
)!=
ıs_­i_»t_code_OK
) {

162 
cout
 << "„egi¡¿tiÚ fau»"<<
’dl
;

168 
	}
}

169 
	$maš
(
¬gc
, **
¬gv
) {

170 ::
‹¡šg
::
	`In™GoogËTe¡
(&
¬gc
, 
¬gv
);

172  
	`RUN_ALL_TESTS
();

173 
	}
}

	@src/unit_test/nas_int_phy_unittest.cpp

22 
	~"ıs_­i_objeù.h
"

23 
	~"ıs_­i_İ”©iÚ.h
"

24 
	~"ıs_­i_objeù_ÿ‹gÜy.h
"

25 
	~"ıs_­i_ev’ts.h
"

26 
	~"h®_š‹rçû_deçuÉs.h
"

27 
	~"h®_if_m­pšg.h
"

28 
	~"ıs_şass_m­.h
"

29 
	~"ıs_­i_objeù_key.h
"

30 
	~"d–l-ba£-if-phy.h
"

31 
	~"d–l-ba£-if.h
"

32 
	~"d–l-š‹rçû.h
"

33 
	~"d–l-ba£-commÚ.h
"

34 
	~"ŸÇ-if-ty³.h
"

35 
	~"¡d_uts.h
"

37 
	~<g‹¡/g‹¡.h
>

38 
	~<io¡»am
>

39 
	~<veùÜ
>

40 
	~<unÜd”ed_m­
>

41 
	~<Ãt/if.h
>

43 
usšg
 
Çme¥aû
 
	g¡d
;

45 
	gunÜd”ed_m­
<
	gBASE_IF_SPEED_t
, cÚ¡ *, 
	ghash
<>> 
	g¥“d_Çme_m­
 = {

46 {
BASE_IF_SPEED_0MBPS
, "0M"},

47 {
BASE_IF_SPEED_10MBPS
, "10M"},

48 {
BASE_IF_SPEED_100MBPS
, "100M"},

49 {
BASE_IF_SPEED_1GIGE
, "1G"},

50 {
BASE_IF_SPEED_10GIGE
, "10G"},

51 {
BASE_IF_SPEED_20GIGE
, "20G"},

52 {
BASE_IF_SPEED_25GIGE
, "25G"},

53 {
BASE_IF_SPEED_40GIGE
, "40G"},

54 {
BASE_IF_SPEED_50GIGE
, "50G"},

55 {
BASE_IF_SPEED_100GIGE
, "100G"},

56 {
BASE_IF_SPEED_AUTO
, "Auto"}

59 cÚ¡ * 
	$g‘_¥“d_Çme
(
BASE_IF_SPEED_t
 
¥“d
)

61 ià(
¥“d_Çme_m­
.
	`fšd
(
¥“d
è=ğ¥“d_Çme_m­.
	`’d
()) {

64  
¥“d_Çme_m­
.
	`©
(
¥“d
);

65 
	}
}

67 
usšg
 
	ghwpÜt_li¡_t
 = 
veùÜ
<
ušt32_t
>;

68 
usšg
 
	gphy_pÜt_li¡_t
 = 
veùÜ
<
Åu_pÜt_t
>;

71 
ušt32_t
 
	mmedŸ_id
;

72 
hwpÜt_li¡_t
 
	mhwpÜt_li¡
;

73 
	m£t
<
	mÅu_pÜt_t
> 
	mphy_pÜt_li¡
;

74 
ušt32_t
 
	mcÚŒŞ_pÜt
;

75 
¡ršg
 
	mdá_Çme
;

76 
ušt32_t
 
	mmac_off£t
;

77 } 
	täÚt_·Ãl_pÜt_t
;

79 
usšg
 
	gå_pÜt_ÿche_t
 = 
unÜd”ed_m­
<
ušt32_t
, 
	gäÚt_·Ãl_pÜt_t
>;

82 
ušt32_t
 
	mcÚŒŞ_pÜt
;

83 
ušt32_t
 
	msubpÜt_id
;

84 
ušt32_t
 
	mäÚt_·Ãl_pÜt
;

85 } 
	th¬dw¬e_pÜt_t
;

87 
usšg
 
	ghw_pÜt_ÿche_t
 = 
unÜd”ed_m­
<
ušt32_t
, 
	gh¬dw¬e_pÜt_t
>;

90 
ušt32_t
 
	mäÚt_·Ãl_pÜt
;

91 
BASE_IF_SPEED_t
 
	m¥“d
;

92 
hwpÜt_li¡_t
 
	mhwpÜt_li¡
;

93 } 
	tphysiÿl_pÜt_t
;

95 
usšg
 
	gphy_pÜt_ÿche_t
 = 
unÜd”ed_m­
<
Åu_pÜt_t
, 
	gphysiÿl_pÜt_t
>;

97 
usšg
 
	ghw_to_phy_pÜt_m­_t
 = 
unÜd”ed_m­
<
ušt32_t
, 
	gÅu_pÜt_t
>;

99 
	$g‘_hw_to_phy_m­
(
hw_to_phy_pÜt_m­_t
& 
pÜt_m­
,

100 cÚ¡ 
phy_pÜt_ÿche_t
& 
phy_ÿche
)

102 auto& 
™em
: 
phy_ÿche
) {

103 autØ
hwpÜt
: 
™em
.
£cÚd
.
hwpÜt_li¡
) {

104 
pÜt_m­
[
hwpÜt
] = 
™em
.
fœ¡
;

107 
	}
}

109 
usšg
 
	ghw_to_šdex_m­_t
 = 
unÜd”ed_m­
<
ušt32_t
, 
	gsize_t
>;

111 
	$g‘_hw_to_šdex_m­
(
hw_to_šdex_m­_t
& 
šdex_m­
,

112 cÚ¡ 
hw_pÜt_ÿche_t
& 
hw_ÿche
,

113 cÚ¡ 
å_pÜt_ÿche_t
& 
å_ÿche
)

115 auto& 
hw_™em
: 
hw_ÿche
) {

116 
ušt32_t
 
hw_pÜt
 = 
hw_™em
.
fœ¡
;

117 
ušt32_t
 
å_pÜt
 = 
hw_™em
.
£cÚd
.
äÚt_·Ãl_pÜt
;

118 ià(
å_ÿche
.
	`fšd
(
å_pÜt
è!ğå_ÿche.
	`’d
()) {

119 auto& 
å_™em
 = 
å_ÿche
.
	`©
(
å_pÜt
);

120 
size_t
 
šdex
 = 0;

121 
boŞ
 
found
 = 
çl£
;

122 
ušt32_t
 
id
: 
å_™em
.
hwpÜt_li¡
) {

123 ià(
id
 =ğ
hw_pÜt
) {

124 
found
 = 
Œue
;

127 
šdex
 ++;

129 ià(!
found
) {

130 
šdex
 = 0;

132 
šdex_m­
[
hw_pÜt
] = 
šdex
;

135 
	}
}

137 
boŞ
 
	$g‘_å_pÜt_ÿche
(
å_pÜt_ÿche_t
& 
ÿche
,

138 cÚ¡ 
phy_pÜt_ÿche_t
& 
phy_ÿche
)

140 
hw_to_phy_pÜt_m­_t
 
hw_pÜt_m­
;

141 
	`g‘_hw_to_phy_m­
(
hw_pÜt_m­
, 
phy_ÿche
);

143 
ıs_­i_g‘_·¿ms_t
 
gp
;

144 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

145 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

146 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

147 
BASE_IF_PHY_FRONT_PANEL_PORT_OBJ
,

148 
ıs_­i_qu®if›r_TARGET
);

149 ià(
	`ıs_­i_g‘
(&
gp
è!ğ
ıs_­i_»t_code_OK
) {

150 
cout
 << "FaedØg‘ frÚˆ·ÃÈpÜˆobjeùs" << 
’dl
;

151 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

152  
çl£
;

155 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

156 
size_t
 
ix
 = 0; ix < 
mx
; ix ++) {

157 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 
ix
);

158 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
,

159 
BASE_IF_PHY_FRONT_PANEL_PORT_FRONT_PANEL_PORT
);

160 ià(
©Œ
 =ğ
nuÎ±r
) {

161 
cout
 << "Cª'ˆg‘…Üˆid from objeù " << 
ix
 << 
’dl
;

164 
ušt32_t
 
pÜt_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

165 
äÚt_·Ãl_pÜt_t
 
pÜt_šfo
 = {};

166 
ıs_­i_objeù_™_t
 
™
;

167 
	`ıs_­i_objeù_™_begš
(
obj
, &
™
);

168 ; 
	`ıs_­i_objeù_™_v®id
(&
™
); 
	`ıs_­i_objeù_™_Ãxt
(&it)) {

169 
ıs_­i_©Œ_id_t
 
id
 = 
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

170 
id
) {

171 
BASE_IF_PHY_FRONT_PANEL_PORT_MEDIA_ID
:

172 
pÜt_šfo
.
medŸ_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

174 
BASE_IF_PHY_FRONT_PANEL_PORT_PORT
:

176 
ušt32_t
 
hw_pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

177 
pÜt_šfo
.
hwpÜt_li¡
.
	`push_back
(
hw_pÜt
);

178 ià(
hw_pÜt_m­
.
	`fšd
(
hw_pÜt
è=ğhw_pÜt_m­.
	`’d
()) {

181 
pÜt_šfo
.
phy_pÜt_li¡
.
	`š£¹
(
hw_pÜt_m­
[
hw_pÜt
]);

184 
BASE_IF_PHY_FRONT_PANEL_PORT_CONTROL_PORT
:

185 
pÜt_šfo
.
cÚŒŞ_pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

187 
BASE_IF_PHY_FRONT_PANEL_PORT_DEFAULT_NAME
:

188 
pÜt_šfo
.
dá_Çme
 = (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
);

190 
BASE_IF_PHY_FRONT_PANEL_PORT_MAC_OFFSET
:

191 
pÜt_šfo
.
mac_off£t
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

195 
ÿche
[
pÜt_id
] = 
pÜt_šfo
;

198 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

199  
Œue
;

200 
	}
}

202 
boŞ
 
	$g‘_hw_pÜt_ÿche
(
hw_pÜt_ÿche_t
& 
ÿche
)

204 
ıs_­i_g‘_·¿ms_t
 
gp
;

205 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

206 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

207 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

208 
BASE_IF_PHY_HARDWARE_PORT_OBJ
,

209 
ıs_­i_qu®if›r_TARGET
);

210 ià(
	`ıs_­i_g‘
(&
gp
è!ğ
ıs_­i_»t_code_OK
) {

211 
cout
 << "FaedØg‘ h¬dw¬pÜˆobjeùs" << 
’dl
;

212 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

213  
çl£
;

216 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

217 
size_t
 
ix
 = 0; ix < 
mx
; ix ++) {

218 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 
ix
);

219 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
,

220 
BASE_IF_PHY_HARDWARE_PORT_HW_PORT
);

221 ià(
©Œ
 =ğ
nuÎ±r
) {

222 
cout
 << "Cª'ˆg‘…Üˆid from objeù " << 
ix
 << 
’dl
;

225 
ušt32_t
 
pÜt_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

226 
h¬dw¬e_pÜt_t
 
pÜt_šfo
 = {};

227 
ıs_­i_objeù_™_t
 
™
;

228 
	`ıs_­i_objeù_™_begš
(
obj
, &
™
);

229 ; 
	`ıs_­i_objeù_™_v®id
(&
™
); 
	`ıs_­i_objeù_™_Ãxt
(&it)) {

230 
ıs_­i_©Œ_id_t
 
id
 = 
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

231 
id
) {

232 
BASE_IF_PHY_HARDWARE_PORT_HW_CONTROL_PORT
:

233 
pÜt_šfo
.
cÚŒŞ_pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

235 
BASE_IF_PHY_HARDWARE_PORT_SUBPORT_ID
:

236 
pÜt_šfo
.
subpÜt_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

238 
BASE_IF_PHY_HARDWARE_PORT_FRONT_PANEL_PORT
:

239 
pÜt_šfo
.
äÚt_·Ãl_pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

243 
ÿche
[
pÜt_id
] = 
pÜt_šfo
;

246 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

247  
Œue
;

248 
	}
}

250 
boŞ
 
	$g‘_phy_pÜt_ÿche
(
phy_pÜt_ÿche_t
& 
ÿche
)

252 
ıs_­i_g‘_·¿ms_t
 
gp
;

253 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

254 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

255 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

256 
BASE_IF_PHY_PHYSICAL_OBJ
,

257 
ıs_­i_qu®if›r_TARGET
);

258 ià(
	`ıs_­i_g‘
(&
gp
è!ğ
ıs_­i_»t_code_OK
) {

259 
cout
 << "FaedØg‘…hysiÿÈpÜˆobjeùs" << 
’dl
;

260 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

261  
çl£
;

264 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

265 
size_t
 
ix
 = 0; ix < 
mx
; ix ++) {

266 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 
ix
);

267 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
,

268 
BASE_IF_PHY_PHYSICAL_PORT_ID
);

269 ià(
©Œ
 =ğ
nuÎ±r
) {

270 
cout
 << "Cª'ˆg‘…Üˆid from objeù " << 
ix
 << 
’dl
;

273 
ušt32_t
 
pÜt_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

274 
physiÿl_pÜt_t
 
pÜt_šfo
 = {};

275 
ıs_­i_objeù_™_t
 
™
;

276 
	`ıs_­i_objeù_™_begš
(
obj
, &
™
);

277 ; 
	`ıs_­i_objeù_™_v®id
(&
™
); 
	`ıs_­i_objeù_™_Ãxt
(&it)) {

278 
ıs_­i_©Œ_id_t
 
id
 = 
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

279 
id
) {

280 
BASE_IF_PHY_PHYSICAL_FRONT_PANEL_NUMBER
:

281 
pÜt_šfo
.
äÚt_·Ãl_pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

283 
BASE_IF_PHY_PHYSICAL_HARDWARE_PORT_LIST
:

284 
pÜt_šfo
.
hwpÜt_li¡
.
	`push_back
(

285 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
));

287 
BASE_IF_PHY_PHYSICAL_SPEED
:

288 
pÜt_šfo
.
¥“d
 = (
BASE_IF_SPEED_t
)
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
);

292 
ÿche
[
pÜt_id
] = 
pÜt_šfo
;

295 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

296  
Œue
;

297 
	}
}

299 
ušt32_t
 
	$g‘_äÚt_·Ãl_pÜt
(cÚ¡ *
if_Çme
,

300 
h®_ifšdex_t
 
ifšdex
)

302 
Çme_buf
[
IF_NAMESIZE
];

303 ià(
if_Çme
 =ğ
nuÎ±r
) {

304 
if_Çme
 = 
	`if_šdextÚame
(
ifšdex
, 
Çme_buf
);

305 ià(
if_Çme
 =ğ
nuÎ±r
) {

306 
cout
 << "FaedØg‘ iÁ”çû‚amäom ifšdex " << 
ifšdex
 << 
’dl
;

307  (
ušt32_t
)-1;

310 ià(
	`if_Çm‘ošdex
(
if_Çme
) == 0) {

311 
cout
 << "IÁ”çû " << 
if_Çme
 << "‚Ùƒxi¡" << 
’dl
;

312  (
ušt32_t
)-1;

315 
¡ršg
 
Çme_¡r
 = 
if_Çme
;

316 
¡ršg
 
™em
;

317 
¡ršg¡»am
 
	`ss
(
Çme_¡r
);

318 
veùÜ
<
¡ršg
> 
–ems
;

319 
	`g‘lše
(
ss
, 
™em
, '-')) {

320 
–ems
.
	`push_back
(
™em
);

322 ià(
–ems
.
	`size
() < 3) {

323 
cout
 << "Inv®id iÁ”çû‚amfÜm©: " << 
Çme_¡r
 << 
’dl
;

324  (
ušt32_t
) -1;

327  
	`¡oul
(
–ems
[1]);

328 
	}
}

330 
boŞ
 
	$ü—‹_phy_pÜt
(
BASE_IF_SPEED_t
 
¥“d
,

331 
hwpÜt_li¡_t
 
hwpÜt_li¡
,

332 
Åu_pÜt_t
& 
phy_pÜt
)

334 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

335 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

336 
BASE_IF_PHY_PHYSICAL_OBJ
,

337 
ıs_­i_qu®if›r_TARGET
);

338 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_PHYSICAL_NPU_ID
, 0);

339 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_PHYSICAL_SPEED
, 
¥“d
);

340 autØ
hw_pÜt
: 
hwpÜt_li¡
) {

341 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_PHYSICAL_HARDWARE_PORT_LIST
,

342 
hw_pÜt
);

345 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

346 
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
);

347 
	`ıs_­i_ü—‹
(&
Œ
, 
obj
);

348 ià(
	`ıs_­i_comm™
(&
Œ
è!ğ
ıs_­i_»t_code_OK
) {

349 
cout
 << "FaedØcomm™ c»©»que¡" << 
’dl
;

350 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

351  
çl£
;

354 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
Œ
.
chªge_li¡
, 0);

355 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

356 
BASE_IF_PHY_PHYSICAL_PORT_ID
);

357 ià(
©Œ
 =ğ
nuÎ±r
) {

358 
cout
 << "NØpÜˆid‡‰ribu‹ found" << 
’dl
;

359 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

360  
çl£
;

362 
phy_pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

363 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

365  
Œue
;

366 
	}
}

368 
boŞ
 
	$ü—‹_äÚt_·Ãl_pÜt
(
ušt32_t
 
å_pÜt
,

369 
BASE_IF_SPEED_t
 
¥“d
,

370 cÚ¡ 
å_pÜt_ÿche_t
& 
å_ÿche
,

371 
phy_pÜt_li¡_t
& 
phy_pÜt_li¡
)

373 ià(
å_ÿche
.
	`fšd
(
å_pÜt
è=ğå_ÿche.
	`’d
()) {

374 
cout
 << "FrÚˆ·ÃÈpÜˆ" << 
å_pÜt
 << "‚Ù found iÀÿche" << 
’dl
;

375  
çl£
;

377 auto& 
å_™em
 = 
å_ÿche
.
	`©
(
å_pÜt
);

378 ià(
å_™em
.
hwpÜt_li¡
.
	`size
() != 4) {

379 
cout
 << "FrÚˆ·ÃÈpÜˆdÛ¢'ˆcÚš 4 h¬dw¬ÏÃs" << 
’dl
;

380  
çl£
;

383 
veùÜ
<
hwpÜt_li¡_t
> 
hwpÜt_Î
;

384 
¥“d
) {

385 
BASE_IF_SPEED_10GIGE
:

386 
BASE_IF_SPEED_25GIGE
:

387 autØ
hw_pÜt
: 
å_™em
.
hwpÜt_li¡
) {

388 
hwpÜt_li¡_t
 
hp_li¡
 {
hw_pÜt
};

389 
hwpÜt_Î
.
	`push_back
(
hp_li¡
);

392 
BASE_IF_SPEED_20GIGE
:

393 
BASE_IF_SPEED_50GIGE
:

395 
hwpÜt_li¡_t
 
hp_li¡_1
 {
å_™em
.
hwpÜt_li¡
[0], fp_item.hwport_list[1]};

396 
hwpÜt_Î
.
	`push_back
(
hp_li¡_1
);

397 
hwpÜt_li¡_t
 
hp_li¡_2
 {
å_™em
.
hwpÜt_li¡
[2], fp_item.hwport_list[3]};

398 
hwpÜt_Î
.
	`push_back
(
hp_li¡_2
);

401 
BASE_IF_SPEED_40GIGE
:

402 
BASE_IF_SPEED_100GIGE
:

404 
hwpÜt_li¡_t
 
hp_li¡
;

405 autØ
hw_pÜt
: 
å_™em
.
hwpÜt_li¡
) {

406 
hp_li¡
.
	`push_back
(
hw_pÜt
);

408 
hwpÜt_Î
.
	`push_back
(
hp_li¡
);

412 
cout
 << "UnsuµÜ‹d s³edy³: " << 
¥“d
 << 
’dl
;

413  
çl£
;

416 auto& 
hwpÜt_li¡
: 
hwpÜt_Î
) {

417 
Åu_pÜt_t
 
phy_pÜt
 = 0;

418 
cout
 << "C»©šg…hysiÿÈpÜt" << 
’dl
;

419 ià(!
	`ü—‹_phy_pÜt
(
¥“d
, 
hwpÜt_li¡
, 
phy_pÜt
)) {

420 
cout
 << "FaedØü—‹…hysiÿÈpÜt" << 
’dl
;

421  
çl£
;

423 
cout
 << "PhysiÿÈpÜˆ" << 
phy_pÜt
 << " c»©ed" << 
’dl
;

424 
phy_pÜt_li¡
.
	`push_back
(
phy_pÜt
);

427  
Œue
;

428 
	}
}

430 
boŞ
 
	$d–‘e_phy_pÜt
(
Åu_pÜt_t
 
phy_pÜt
)

432 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

433 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

434 
BASE_IF_PHY_PHYSICAL_OBJ
,

435 
ıs_­i_qu®if›r_TARGET
);

436 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_PHYSICAL_NPU_ID
, 0);

437 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_PHYSICAL_PORT_ID
, 
phy_pÜt
);

438 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

439 
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
);

440 
	`ıs_­i_d–‘e
(&
Œ
, 
obj
);

441 ià(
	`ıs_­i_comm™
(&
Œ
è!ğ
ıs_­i_»t_code_OK
) {

442 
cout
 << "FaedØcomm™ d–‘»que¡" << 
’dl
;

443 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

444  
çl£
;

447 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

448  
Œue
;

449 
	}
}

451 
boŞ
 
	$d–‘e_äÚt_·Ãl_pÜt
(
ušt32_t
 
å_pÜt
,

452 cÚ¡ 
å_pÜt_ÿche_t
& 
å_ÿche
)

454 ià(
å_ÿche
.
	`fšd
(
å_pÜt
è=ğå_ÿche.
	`’d
()) {

455 
cout
 << "FrÚˆ·ÃÈpÜˆ" << 
å_pÜt
 << "‚Ù found iÀÿche" << 
’dl
;

456  
çl£
;

459 auto& 
å_™em
 = 
å_ÿche
.
	`©
(
å_pÜt
);

460 autØ
phy_pÜt
: 
å_™em
.
phy_pÜt_li¡
) {

461 
cout
 << "D–‘šg…hysiÿÈpÜˆ" << 
phy_pÜt
 << 
’dl
;

462 ià(!
	`d–‘e_phy_pÜt
(
phy_pÜt
)) {

463 
cout
 << "Faed" << 
’dl
;

464  
çl£
;

468  
Œue
;

469 
	}
}

471 
boŞ
 
	$ü—‹_logiÿl_š‹rçû
(
ušt32_t
 
å_pÜt
, ušt32_ˆ
subpÜt
,

472 
Åu_pÜt_t
 
phy_pÜt
,

473 
h®_ifšdex_t
& 
ifšdex
)

475 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

476 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

477 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

478 
ıs_­i_qu®if›r_TARGET
);

479 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
, 1);

480 
Çme_buf
[20];

481 
desc_buf
[
MAX_INTF_DESC_LEN
];

482 
	`¥rštf
(
Çme_buf
, "e101-%03d-%d", 
å_pÜt
, 
subpÜt
);

483 
	`¥rštf
(
desc_buf
, "IÁ”çû desütiÚ fÜ %s", 
Çme_buf
);

484 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
Çme_buf
,

485 
	`¡¾’
(
Çme_buf
) + 1);

486 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_DESCRIPTION
, 
desc_buf
, 
	`¡¾’
(desc_buf) + 1);

487 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_FRONT_PANEL_PORT
, 
å_pÜt
);

488 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_SUBPORT_ID
, 
subpÜt
);

489 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
, 0);

490 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
, 
phy_pÜt
);

491 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_MTU
, 1532);

492 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_NEGOTIATION
, 1);

493 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_SPEED
, 
BASE_IF_SPEED_AUTO
);

494 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_DUPLEX
,

495 
BASE_CMN_DUPLEX_TYPE_AUTO
);

496 cÚ¡ *
if_ty³
 = "ianaift:ethernetCsmacd";

497 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_TYPE
, 
if_ty³
, 
	`¡¾’
(if_type) + 1);

499 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

500 
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
);

501 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

502 ià(
	`ıs_­i_comm™
(&
Œ
è!ğ
ıs_­i_»t_code_OK
) {

503 
cout
 << "FaedØcomm™„pø»que¡" << 
’dl
;

504 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

505  
çl£
;

508 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
Œ
.
chªge_li¡
, 0);

509 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

510 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

511 ià(
©Œ
 =ğ
nuÎ±r
) {

512 
cout
 << "NØifšdex‡‰ribu‹ found" << 
’dl
;

513 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

514  
çl£
;

516 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

517 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

519  
Œue
;

520 
	}
}

522 
boŞ
 
	$d–‘e_logiÿl_š‹rçû
(cÚ¡ *
if_Çme
)

524 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

525 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

526 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

527 
ıs_­i_qu®if›r_TARGET
);

528 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
, 2);

529 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
if_Çme
,

530 
	`¡¾’
(
if_Çme
) + 1);

532 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

533 
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
);

534 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

535 ià(
	`ıs_­i_comm™
(&
Œ
è!ğ
ıs_­i_»t_code_OK
) {

536 
cout
 << "FaedØcomm™„pø»que¡" << 
’dl
;

537 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

538  
çl£
;

541 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

542  
Œue
;

543 
	}
}

545 
ušt32_t
 
	gg_å_pÜt_1
 = 54, 
	gg_å_pÜt_2
 = 53;

546 
BASE_IF_SPEED_t
 
	gg_if_¥“d
 = 
BASE_IF_SPEED_10GIGE
;

548 
	$TEST
(
Çs_physiÿl_š‹rçû
, 
dump_š‹rçû
)

550 
hw_pÜt_ÿche_t
 
hw_ÿche
;

551 
	`ASSERT_TRUE
(
	`g‘_hw_pÜt_ÿche
(
hw_ÿche
));

552 
phy_pÜt_ÿche_t
 
phy_ÿche
;

553 
	`ASSERT_TRUE
(
	`g‘_phy_pÜt_ÿche
(
phy_ÿche
));

554 
å_pÜt_ÿche_t
 
å_ÿche
;

555 
	`ASSERT_TRUE
(
	`g‘_å_pÜt_ÿche
(
å_ÿche
, 
phy_ÿche
));

556 
veùÜ
<
ušt32_t
> 
å_li¡
;

557 ià(
g_å_pÜt_1
 == 0) {

558 autØ
å_™em
: 
å_ÿche
) {

559 
å_li¡
.
	`push_back
(
å_™em
.
fœ¡
);

562 
	`ASSERT_TRUE
(
å_ÿche
.
	`fšd
(
g_å_pÜt_1
è!ğå_ÿche.
	`’d
());

563 
å_li¡
.
	`push_back
(
g_å_pÜt_1
);

565 autØ
å_id
: 
å_li¡
) {

566 auto& 
å_™em
 = 
å_ÿche
[
å_id
];

567 
cout
 << "IÁ”çû " << 
å_™em
.
dá_Çme
 << " ";

568 
cout
 << "FrÚt_Pª– " << 
å_id
 << 
’dl
;

569 autØ
phy_pÜt
: 
å_™em
.
phy_pÜt_li¡
) {

570 
cout
 << " PhysiÿÈpÜt: " << 
phy_pÜt
 << 
’dl
;

571 
	`ASSERT_TRUE
(
phy_ÿche
.
	`fšd
(
phy_pÜt
è!ğphy_ÿche.
	`’d
());

572 autØ
hw_pÜt
: 
phy_ÿche
[
phy_pÜt
].
hwpÜt_li¡
) {

573 
cout
 << " H¬dw¬pÜt: " << 
hw_pÜt
 << 
’dl
;

577 
	}
}

579 
	$ut_d–‘e_š‹rçû
(
ušt32_t
 
å_pÜt
, 
BASE_IF_SPEED_t
& 
Şd_¥“d
)

581 
phy_pÜt_ÿche_t
 
phy_ÿche
;

582 
	`ASSERT_TRUE
(
	`g‘_phy_pÜt_ÿche
(
phy_ÿche
));

583 
å_pÜt_ÿche_t
 
å_ÿche
;

584 
	`ASSERT_TRUE
(
	`g‘_å_pÜt_ÿche
(
å_ÿche
, 
phy_ÿche
));

585 
	`ASSERT_TRUE
(
å_ÿche
.
	`fšd
(
å_pÜt
è!ğå_ÿche.
	`’d
());

586 auto& 
å_™em
 = 
å_ÿche
.
	`©
(
å_pÜt
);

587 
Şd_¥“d
 = 
BASE_IF_SPEED_MAX
;

588 
Åu_pÜt_t
 
phy_pÜt
: 
å_™em
.
phy_pÜt_li¡
) {

589 
	`ASSERT_TRUE
(
phy_ÿche
.
	`fšd
(
phy_pÜt
è!ğphy_ÿche.
	`’d
());

590 auto& 
phy_™em
 = 
phy_ÿche
.
	`©
(
phy_pÜt
);

591 ià(
Şd_¥“d
 =ğ
BASE_IF_SPEED_MAX
) {

592 
Şd_¥“d
 = 
phy_™em
.
¥“d
;

594 
	`ASSERT_TRUE
(
Şd_¥“d
 =ğ
phy_™em
.
¥“d
);

597 
	`ASSERT_TRUE
(
	`d–‘e_äÚt_·Ãl_pÜt
(
å_pÜt
, 
å_ÿche
));

598 
	}
}

600 
	$ut_ü—‹_š‹rçû
(
ušt32_t
 
å_pÜt
, 
BASE_IF_SPEED_t
 
¥“d
)

602 
phy_pÜt_ÿche_t
 
phy_ÿche
;

603 
	`ASSERT_TRUE
(
	`g‘_phy_pÜt_ÿche
(
phy_ÿche
));

604 
å_pÜt_ÿche_t
 
å_ÿche
;

605 
	`ASSERT_TRUE
(
	`g‘_å_pÜt_ÿche
(
å_ÿche
, 
phy_ÿche
));

606 
	`ASSERT_TRUE
(
å_ÿche
.
	`fšd
(
å_pÜt
è!ğå_ÿche.
	`’d
());

607 
phy_pÜt_li¡_t
 
phy_pÜt_li¡
;

608 
	`ASSERT_TRUE
(
	`ü—‹_äÚt_·Ãl_pÜt
(
å_pÜt
, 
¥“d
, 
å_ÿche
,

609 
phy_pÜt_li¡
));

610 
	}
}

612 
BASE_IF_SPEED_t
 
	gg_cur_¥“d
 = 
BASE_IF_SPEED_MAX
;

614 
	$TEST
(
Çs_physiÿl_š‹rçû
, 
d–‘e_š‹rçû_1
)

616 
	`ut_d–‘e_š‹rçû
(
g_å_pÜt_1
, 
g_cur_¥“d
);

617 
	}
}

619 
	$TEST
(
Çs_physiÿl_š‹rçû
, 
ü—‹_š‹rçû
)

621 
	`ut_ü—‹_š‹rçû
(
g_å_pÜt_1
, 
g_if_¥“d
);

622 
cout
 << "FrÚˆ·ÃÈpÜˆ" << 
g_å_pÜt_1
 << ": "

623 << "¥“d chªged from " << 
	`g‘_¥“d_Çme
(
g_cur_¥“d
)

624 << "Ø" << 
	`g‘_¥“d_Çme
(
g_if_¥“d
è<< 
’dl
;

625 
	}
}

627 
	$TEST
(
Çs_physiÿl_š‹rçû
, 
d–‘e_š‹rçû_2
)

629 ià(
g_cur_¥“d
 !ğ
BASE_IF_SPEED_MAX
) {

630 
g_if_¥“d
 = 
g_cur_¥“d
;

632 
	`ut_d–‘e_š‹rçû
(
g_å_pÜt_1
, 
g_cur_¥“d
);

633 
	}
}

635 
	$TEST
(
Çs_physiÿl_š‹rçû
, 
ü—‹_š‹rçû_»¡Üe
)

637 
	`ut_ü—‹_š‹rçû
(
g_å_pÜt_1
, 
g_if_¥“d
);

638 
cout
 << "FrÚˆ·ÃÈpÜˆ" << 
g_å_pÜt_1
 << ": "

639 << "¥“d„e¡Üed from " << 
	`g‘_¥“d_Çme
(
g_cur_¥“d
)

640 << "Ø" << 
	`g‘_¥“d_Çme
(
g_if_¥“d
è<< 
’dl
;

641 
	}
}

643 
	$ut_chªge_b»akout_mode
(
ušt32_t
 
å_pÜt
, 
BASE_IF_SPEED_t
 
¥“d
)

645 
hw_pÜt_ÿche_t
 
hw_ÿche
;

646 
	`ASSERT_TRUE
(
	`g‘_hw_pÜt_ÿche
(
hw_ÿche
));

647 
phy_pÜt_ÿche_t
 
phy_ÿche
;

648 
	`ASSERT_TRUE
(
	`g‘_phy_pÜt_ÿche
(
phy_ÿche
));

649 
å_pÜt_ÿche_t
 
å_ÿche
;

650 
	`ASSERT_TRUE
(
	`g‘_å_pÜt_ÿche
(
å_ÿche
, 
phy_ÿche
));

651 
	`ASSERT_TRUE
(
å_ÿche
.
	`fšd
(
å_pÜt
è!ğå_ÿche.
	`’d
());

653 
hw_to_šdex_m­_t
 
hw_idx_m­
;

654 
Çme_buf
[32];

655 
ušt32_t
 
subpÜt
 = 0, 
hw_pÜt
 = 0;

656 auto& 
å_™em
 = 
å_ÿche
.
	`©
(
å_pÜt
);

657 ià(
å_™em
.
phy_pÜt_li¡
.
	`size
() == 1) {

658 
	`¥rštf
(
Çme_buf
, "e101-%03d-0", 
å_pÜt
);

659 
cout
 << "D–‘šg iÁ”çû " << 
Çme_buf
 << 
’dl
;

660 
	`ASSERT_TRUE
(
	`d–‘e_logiÿl_š‹rçû
(
Çme_buf
));

662 
	`g‘_hw_to_šdex_m­
(
hw_idx_m­
, 
hw_ÿche
, 
å_ÿche
);

663 
Åu_pÜt_t
 
phy_pÜt
: 
å_™em
.
phy_pÜt_li¡
) {

664 
	`ASSERT_TRUE
(
phy_ÿche
.
	`fšd
(
phy_pÜt
è!ğphy_ÿche.
	`’d
());

665 auto& 
phy_™em
 = 
phy_ÿche
.
	`©
(
phy_pÜt
);

666 
	`ASSERT_TRUE
(
phy_™em
.
hwpÜt_li¡
.
	`size
() == 1);

667 
hw_pÜt
 = 
phy_™em
.
hwpÜt_li¡
[0];

668 
cout
 << "PhysiÿÈpÜˆ" << 
phy_pÜt
 << " H¬dw¬pÜˆ" << 
hw_pÜt
 << 
’dl
;

669 
	`ASSERT_TRUE
(
hw_idx_m­
.
	`fšd
(
hw_pÜt
è!ğhw_idx_m­.
	`’d
());

670 
subpÜt
 = 
hw_idx_m­
.
	`©
(
hw_pÜt
) + 1;

671 
	`¥rštf
(
Çme_buf
, "e101-%03d-%d", 
å_pÜt
, 
subpÜt
);

672 
cout
 << "D–‘šg iÁ”çû " << 
Çme_buf
 << 
’dl
;

673 
	`ASSERT_TRUE
(
	`d–‘e_logiÿl_š‹rçû
(
Çme_buf
));

677 
cout
 << "D–‘šg frÚˆ·ÃÈpÜˆ" << 
å_pÜt
 << 
’dl
;

678 
	`ASSERT_TRUE
(
	`d–‘e_äÚt_·Ãl_pÜt
(
å_pÜt
, 
å_ÿche
));

679 
cout
 << "C»©šg frÚˆ·ÃÈpÜˆ" << 
å_pÜt
 << 
’dl
;

680 
phy_pÜt_li¡_t
 
phy_pÜt_li¡
;

681 
	`ASSERT_TRUE
(
	`ü—‹_äÚt_·Ãl_pÜt
(
å_pÜt
, 
¥“d
, 
å_ÿche
, 
phy_pÜt_li¡
));

682 
cout
 << "C»©ed " << 
phy_pÜt_li¡
.
	`size
(è<< "…hysiÿÈpÜt" << 
’dl
;

684 
phy_ÿche
.
	`ş—r
();

685 
å_ÿche
.
	`ş—r
();

686 
hw_idx_m­
.
	`ş—r
();

687 
	`ASSERT_TRUE
(
	`g‘_phy_pÜt_ÿche
(
phy_ÿche
));

688 
	`ASSERT_TRUE
(
	`g‘_å_pÜt_ÿche
(
å_ÿche
, 
phy_ÿche
));

689 
	`g‘_hw_to_šdex_m­
(
hw_idx_m­
, 
hw_ÿche
, 
å_ÿche
);

690 
h®_ifšdex_t
 
ifšdex
 = 0;

691 autØ
phy_pÜt
: 
phy_pÜt_li¡
) {

692 
	`ASSERT_TRUE
(
phy_ÿche
.
	`fšd
(
phy_pÜt
è!ğphy_ÿche.
	`’d
());

693 auto& 
phy_™em
 = 
phy_ÿche
.
	`©
(
phy_pÜt
);

694 ià(
phy_pÜt_li¡
.
	`size
() == 1) {

695 
subpÜt
 = 0;

697 
	`ASSERT_TRUE
(
phy_™em
.
hwpÜt_li¡
.
	`size
() > 0);

698 
hw_pÜt
 = 
phy_™em
.
hwpÜt_li¡
[0];

699 
cout
 << "PhysiÿÈpÜˆ" << 
phy_pÜt
 << " H¬dw¬pÜˆ" << 
hw_pÜt
 << 
’dl
;

700 
	`ASSERT_TRUE
(
hw_idx_m­
.
	`fšd
(
hw_pÜt
è!ğhw_idx_m­.
	`’d
());

701 
subpÜt
 = 
hw_idx_m­
.
	`©
(
hw_pÜt
) + 1;

702 
cout
 << "C»©šg†ogiÿÈš‹rçû fÜ frÚˆ·ÃÈpÜˆ" << 
å_pÜt


703 << " subpÜˆ" << 
subpÜt
 << 
’dl
;

705 
	`ASSERT_TRUE
(
	`ü—‹_logiÿl_š‹rçû
(
å_pÜt
, 
subpÜt
, 
phy_pÜt
, 
ifšdex
));

707 
	}
}

709 
	$TEST
(
Çs_physiÿl_š‹rçû
, 
’abË_b»akout
)

711 
	`ut_chªge_b»akout_mode
(
g_å_pÜt_2
, 
BASE_IF_SPEED_10GIGE
);

712 
	}
}

714 
	$TEST
(
Çs_physiÿl_š‹rçû
, 
di§bË_b»akout
)

716 
	`ut_chªge_b»akout_mode
(
g_å_pÜt_2
, 
BASE_IF_SPEED_40GIGE
);

717 
	}
}

719 
	$maš
(
¬gc
, *
¬gv
[])

721 ::
‹¡šg
::
	`In™GoogËTe¡
(&
¬gc
, 
¬gv
);

723 ià(
¬gc
 > 1) {

724 ià(
	`¡rcmp
(
¬gv
[1], "all") == 0) {

725 
g_å_pÜt_1
 = 0;

727 *
pÜt_¡r
 = 
	`¡¹ok
(
¬gv
[1], ",");

728 ià(
pÜt_¡r
 !ğ
nuÎ±r
) {

729 
g_å_pÜt_1
 = 
	`¡¹oul
(
pÜt_¡r
, 
NULL
, 0);

730 
pÜt_¡r
 = 
	`¡¹ok
(
NULL
, ",");

731 ià(
pÜt_¡r
 !ğ
nuÎ±r
) {

732 
g_å_pÜt_2
 = 
	`¡¹oul
(
pÜt_¡r
, 
NULL
, 0);

737 ià(
¬gc
 > 2) {

738 ià(
	`¡rcmp
(
¬gv
[2], "10g") == 0) {

739 
g_if_¥“d
 = 
BASE_IF_SPEED_10GIGE
;

740 } ià(
	`¡rcmp
(
¬gv
[2], "20g") == 0) {

741 
g_if_¥“d
 = 
BASE_IF_SPEED_20GIGE
;

742 } ià(
	`¡rcmp
(
¬gv
[2], "25g") == 0) {

743 
g_if_¥“d
 = 
BASE_IF_SPEED_25GIGE
;

744 } ià(
	`¡rcmp
(
¬gv
[2], "40g") == 0) {

745 
g_if_¥“d
 = 
BASE_IF_SPEED_40GIGE
;

746 } ià(
	`¡rcmp
(
¬gv
[2], "50g") == 0) {

747 
g_if_¥“d
 = 
BASE_IF_SPEED_50GIGE
;

748 } ià(
	`¡rcmp
(
¬gv
[2], "100g") == 0) {

749 
g_if_¥“d
 = 
BASE_IF_SPEED_100GIGE
;

751 
cout
 << "UnsuµÜ‹d s³ed " << 
¬gv
[2] << ", u£ deçuÉ" << 
’dl
;

755  
	`RUN_ALL_TESTS
();

756 
	}
}

	@src/unit_test/nas_int_rpc_unittest.cpp

22 
	~"ıs_­i_objeù.h
"

23 
	~"ıs_­i_İ”©iÚ.h
"

24 
	~"ıs_­i_objeù_ÿ‹gÜy.h
"

25 
	~"ıs_şass_m­.h
"

26 
	~"ıs_­i_objeù_key.h
"

27 
	~"d–l-ba£-if.h
"

28 
	~"d–l-ba£-if-phy.h
"

29 
	~"ŸÇ-if-ty³.h
"

30 
	~"d–l-š‹rçû.h
"

32 
	~<g‹¡/g‹¡.h
>

33 
	~<io¡»am
>

34 
	~<c¡dlib
>

35 
	~<unÜd”ed_£t
>

37 
usšg
 
Çme¥aû
 
	g¡d
;

39 cÚ¡ *
	g‹¡_iâame
 = "e101-005-0";

40 cÚ¡ 
ušt32_t
 
	g‹¡_pÜt_id
 = 45;

41 cÚ¡ 
ušt32_t
 
	g‹¡_äÚt_·Ãl_pÜt
 = 2;

42 cÚ¡ 
ušt32_t
 
	gINVALID_FRONT_PANEL_PORT
 = 
¡©ic_ÿ¡
<uint32_t>(-1);

43 
ušt32_t
 
	gçnout_äÚt_·Ãl_pÜt
 = 
INVALID_FRONT_PANEL_PORT
;

44 cÚ¡ 
ušt32_t
 
	gçnout_subpÜt_id
 = 1;

45 cÚ¡ 
ušt32_t
 
	gcheck_subpÜt_id
 = 2;

46 cÚ¡ *
	gÍ_iâame
 = "test_loopback";

47 cÚ¡ *
	gvœt_iâame
 = "test_virt_if";

48 cÚ¡ *
	gphy_iâame
 = "e101-002-0";

50 
	$d–‘e_š‹rçû_½c
(cÚ¡ *
iâame
, 
boŞ
 
loİback
 = 
çl£
)

52 
cout
 << "D–‘š‹rçû " << 
iâame
 << 
’dl
;

54 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

55 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

56 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

57 
ıs_­i_qu®if›r_TARGET
);

58 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
,

59 
DELL_BASE_IF_CMN_OPERATION_TYPE_DELETE
);

60 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
iâame
,

61 
	`¡¾’
(
iâame
) + 1);

62 ià(
loİback
) {

63 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_TYPE
,

64 
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_SOFTWARELOOPBACK
,

65 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_SOFTWARELOOPBACK
) + 1);

67 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

68 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

69 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

70 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

72 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

73 
	}
}

75 
	$TEST
(
št_½c_‹¡
, 
d–‘e_š‹rçû
)

77 
	`d–‘e_š‹rçû_½c
(
‹¡_iâame
);

78 
	}
}

80 
	$dump_»tuº_obj
(
ıs_­i_Œª§ùiÚ_·¿ms_t
& 
·¿m
)

82 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
·¿m
.
chªge_li¡
);

83 ià(
mx
 == 0) {

84 
cout
 << "NØobjeù„‘uºed" << 
’dl
;

87 
size_t
 
idx
 = 0; idx < 
mx
; idx ++) {

88 
cout
 << "R‘uº objeù " << 
idx
 + 1 << " :" << 
’dl
;

89 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
.
chªge_li¡
, 
idx
);

90 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

91 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

92 ià(
©Œ
 =ğ
NULL
) {

93 
cout
 << "NØifšdex‡‰ribu‹ iÀobjeù" << 
’dl
;

96 
ušt32_t
 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

97 
cout
 << " ifšdex - " << 
ifšdex
 << 
’dl
;

98 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
);

99 ià(
©Œ
 =ğ
NULL
) {

100 
cout
 << "NØmaøadd»s ©Œibu‹ iÀobjeù" << 
’dl
;

103 *
mac_addr
 = (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
©Œ
);

104 
cout
 << " maøadd»s - " << 
mac_addr
 << 
’dl
;

106 
	}
}

108 
	$TEST
(
št_½c_‹¡
, 
ü—‹_š‹rçû_pÜt_id
)

110 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

111 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

112 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

113 
ıs_­i_qu®if›r_TARGET
);

114 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
,

115 
DELL_BASE_IF_CMN_OPERATION_TYPE_CREATE
);

116 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_TYPE
,

117 
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
,

118 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
) + 1);

119 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
‹¡_iâame
,

120 
	`¡¾’
(
‹¡_iâame
) + 1);

121 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
, 0);

122 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
, 
‹¡_pÜt_id
);

124 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

125 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

126 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

127 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

129 
	`dump_»tuº_obj
(
Œ
);

131 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

132 
	}
}

134 
	$TEST
(
št_½c_‹¡
, 
d–‘e_š‹rçû_no_çnout
)

136 
iâame
[64];

137 
	`¢´štf
(
iâame
, (iâame), "e101-%03d-0", 
‹¡_äÚt_·Ãl_pÜt
);

138 
	`d–‘e_š‹rçû_½c
(
iâame
);

139 
	}
}

141 
	$TEST
(
št_½c_‹¡
, 
ü—‹_š‹rçû_äÚt_·Ãl_no_çnout
)

143 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

144 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

145 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

146 
ıs_­i_qu®if›r_TARGET
);

147 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
,

148 
DELL_BASE_IF_CMN_OPERATION_TYPE_CREATE
);

149 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_TYPE
,

150 
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
,

151 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
) + 1);

152 
iâame
[64];

153 
	`¢´štf
(
iâame
, (iâame), "e101-%03d-0", 
‹¡_äÚt_·Ãl_pÜt
);

154 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
iâame
, 
	`¡¾’
(ifname) + 1);

155 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
, 0);

156 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_FRONT_PANEL_PORT
, 
‹¡_äÚt_·Ãl_pÜt
);

157 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_SUBPORT_ID
, 0);

159 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

160 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

161 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

162 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

164 
	`dump_»tuº_obj
(
Œ
);

166 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

167 
	}
}

169 
ušt32_t
 
	$g‘_å_pÜt_äom_Çme
(cÚ¡ * 
if_Çme
)

171 cÚ¡ * 
NAME_PREFIX
 = "e101-";

172 ià(
	`¡ºcmp
(
if_Çme
, 
NAME_PREFIX
, 
	`¡¾’
(NAME_PREFIX)) != 0) {

173  
INVALID_FRONT_PANEL_PORT
;

175 * 
±r
;

176 
ušt32_t
 
pÜt_id
 = 
	`¡¹Ş
(&
if_Çme
[
	`¡¾’
(
NAME_PREFIX
)], &
±r
, 0);

177 ià(*
±r
 != '-') {

178  
INVALID_FRONT_PANEL_PORT
;

180  
pÜt_id
;

181 
	}
}

183 
	$check_pÜt_çnout_ÿp
(
ušt32_t
 
pÜt_id
, 
boŞ
& 
could_çnout
)

185 
ıs_­i_g‘_·¿ms_t
 
gp
;

186 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

187 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

188 
	`ASSERT_TRUE
(
obj
 !ğ
nuÎ±r
);

189 
	`ASSERT_TRUE
(
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
), 
BASE_IF_PHY_FRONT_PANEL_PORT_OBJ
,

190 
ıs_­i_qu®if›r_TARGET
));

191 
	`ASSERT_TRUE
(
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_FRONT_PANEL_PORT_FRONT_PANEL_PORT
, 
pÜt_id
));

192 
	`ASSERT_TRUE
(
	`ıs_­i_g‘
(&
gp
è=ğ
ıs_­i_»t_code_OK
);

193 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

194 
ıs_­i_key_t
 
pÜt_key
;

195 
	`mem£t
(&
pÜt_key
, 0, (port_key));

196 
	`ASSERT_TRUE
(
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
pÜt_key
, 
BASE_IF_PHY_FRONT_PANEL_PORT_OBJ
,

197 
ıs_­i_qu®if›r_TARGET
));

198 
could_çnout
 = 
çl£
;

199 
size_t
 
ix
 = 0; ix < 
mx
; ++ix) {

200 
ıs_­i_objeù_t
 
»t_obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 
ix
);

201 ià(
	`ıs_­i_key_m©ches
(
	`ıs_­i_objeù_key
(
»t_obj
), &
pÜt_key
, 
Œue
) == 0) {

202 
ıs_­i_objeù_™_t
 
™
, 
š‹º®
;

203 
	`ıs_­i_objeù_™_begš
(
»t_obj
, &
™
);

204 ; 
	`ıs_­i_objeù_™_v®id
(&
™
); 
	`ıs_­i_objeù_™_Ãxt
(&it)) {

205 ià(
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
è!ğ
BASE_IF_PHY_FRONT_PANEL_PORT_BR_CAP
) {

208 
unÜd”ed_£t
<
BASE_IF_PHY_BREAKOUT_MODE_t
> 
br_modes
{};

209 
š‹º®
 = 
™
;

210 
	`ıs_­i_objeù_™_šside
(&
š‹º®
);

211 
ıs_­i_©Œ_id_t
 
ids
[3] = {
BASE_IF_PHY_FRONT_PANEL_PORT_BR_CAP
, 0,

212 
BASE_IF_PHY_FRONT_PANEL_PORT_BR_CAP_BREAKOUT_MODE
};

213 cÚ¡ 
ids_Ën
 = (
ids
) /(ids[0]);

214 ; 
	`ıs_­i_objeù_™_v®id
(&
š‹º®
); 
	`ıs_­i_objeù_™_Ãxt
(&internal)) {

215 
ids
[1] = 
	`ıs_­i_objeù_©Œ_id
(
š‹º®
.
©Œ
);

216 autØ
br_mode_©Œ
 = 
	`ıs_­i_objeù_e_g‘
(
»t_obj
, 
ids
, 
ids_Ën
);

217 ià(
br_mode_©Œ
 !ğ
nuÎ±r
) {

218 
br_modes
.
	`š£¹
(
¡©ic_ÿ¡
<
BASE_IF_PHY_BREAKOUT_MODE_t
>(
	`ıs_­i_objeù_©Œ_d©a_u32
(
br_mode_©Œ
)));

221 ià((
br_modes
.
	`fšd
(
BASE_IF_PHY_BREAKOUT_MODE_BREAKOUT_1X1
è!ğbr_modes.
	`’d
()) &&

222 (
br_modes
.
	`fšd
(
BASE_IF_PHY_BREAKOUT_MODE_BREAKOUT_4X1
è!ğbr_modes.
	`’d
())) {

223 
could_çnout
 = 
Œue
;

230 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

231 
	}
}

233 
	$g‘_çnout_pÜt
()

235 ià(
çnout_äÚt_·Ãl_pÜt
 !ğ
INVALID_FRONT_PANEL_PORT
) {

238 
ıs_­i_g‘_·¿ms_t
 
gp
;

239 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

240 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

241 
	`ASSERT_TRUE
(
obj
 !ğ
nuÎ±r
);

242 
	`ASSERT_TRUE
(
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
), 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
,

243 
ıs_­i_qu®if›r_OBSERVED
));

244 
	`ASSERT_TRUE
(
	`ıs_­i_g‘
(&
gp
è=ğ
ıs_­i_»t_code_OK
);

245 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

246 
veùÜ
<
ušt32_t
> 
çnout_pÜts
{};

247 
size_t
 
ix
 = 0; ix < 
mx
; ++ix) {

248 
ıs_­i_objeù_t
 
»t_obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 
ix
);

249 
ıs_­i_objeù_©Œ_t
 
¥“d_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»t_obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_MAX_SPEED
);

250 ià(
¥“d_©Œ
 =ğ
nuÎ±r
) {

253 
BASE_IF_SPEED_t
 
¥“d
 = 
¡©ic_ÿ¡
<BASE_IF_SPEED_t>(
	`ıs_­i_objeù_©Œ_d©a_u32
(
¥“d_©Œ
));

254 ià(
¥“d
 =ğ
BASE_IF_SPEED_40GIGE
) {

256 
ıs_­i_objeù_©Œ_t
 
Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
»t_obj
, 
IF_INTERFACES_STATE_INTERFACE_NAME
);

257 
	`ASSERT_TRUE
(
Çme_©Œ
 !ğ
nuÎ±r
);

258 cÚ¡ * 
if_Çme
 = 
¡©ic_ÿ¡
<cÚ¡ *>(
	`ıs_­i_objeù_©Œ_d©a_bš
(
Çme_©Œ
));

259 autØ
pÜt_id
 = 
	`g‘_å_pÜt_äom_Çme
(
if_Çme
);

260 ià(
pÜt_id
 !ğ
INVALID_FRONT_PANEL_PORT
) {

261 
boŞ
 
çnout_pÜt
 = 
çl£
;

262 
	`check_pÜt_çnout_ÿp
(
pÜt_id
, 
çnout_pÜt
);

263 ià(
çnout_pÜt
) {

264 
çnout_pÜts
.
	`push_back
(
pÜt_id
);

269 ià(
çnout_pÜts
.
	`em±y
()) {

270 
cout
 << "Could‚Ù fšd‡ny frÚˆ·ÃÈpÜˆfÜ fªout" << 
’dl
;

272 
çnout_äÚt_·Ãl_pÜt
 = 
çnout_pÜts
[
	`¿nd
(è% fªout_pÜts.
	`size
()];

274 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

275 
	}
}

277 
	$TEST
(
št_½c_‹¡
, 
d–‘e_š‹rçû_çnout
)

279 
iâame
[64];

280 
cmdbuf
[256];

283 cÚ¡ *
if_¥“d
 = "10G";

284 cÚ¡ *
if_mode
 = "4x1";

287 
	`g‘_çnout_pÜt
();

288 ià(
çnout_äÚt_·Ãl_pÜt
 =ğ
INVALID_FRONT_PANEL_PORT
) {

289 
cout
 << "NØçnouˆpÜˆfound, by·s thi ‹¡" << 
’dl
;

292 
	`¢´štf
(
iâame
, (iâame), "e101-%03d-0", 
çnout_äÚt_·Ãl_pÜt
);

293 
cout
 << "EÇbË fªouˆoàš‹rçû " << 
iâame
 << 
’dl
;

294 
	`¢´štf
(
cmdbuf
, (cmdbuf), "İx-cÚfig-çnouˆ% % % 2>/dev/nuÎ", 
iâame
, 
if_mode
, 
if_¥“d
);

295 
	`sy¡em
(
cmdbuf
);

296 
	`¢´štf
(
iâame
, (iâame), "e101-%03d-%d", 
çnout_äÚt_·Ãl_pÜt
, 
çnout_subpÜt_id
);

297 
	`d–‘e_š‹rçû_½c
(
iâame
);

298 
	}
}

300 
	$TEST
(
št_½c_‹¡
, 
check_çnout_pÜt_¥“d
)

302 
iâame
[64];

303 ià(
çnout_äÚt_·Ãl_pÜt
 =ğ
INVALID_FRONT_PANEL_PORT
) {

304 
cout
 << "NØçnouˆpÜˆfound, by·s thi ‹¡" << 
’dl
;

308 
	`¢´štf
(
iâame
, (iâame), "e101-%03d-%d", 
çnout_äÚt_·Ãl_pÜt
, 
check_subpÜt_id
);

309 
ıs_­i_g‘_·¿ms_t
 
gp
;

310 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

311 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

312 
	`ASSERT_TRUE
(
obj
 !ğ
nuÎ±r
);

313 
	`ASSERT_TRUE
(
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
), 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
,

314 
ıs_­i_qu®if›r_OBSERVED
));

315 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_NAME
, 
iâame
, 
	`¡¾’
(ifname) + 1);

316 
	`ASSERT_TRUE
(
	`ıs_­i_g‘
(&
gp
è=ğ
ıs_­i_»t_code_OK
);

317 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

318 
	`ASSERT_TRUE
(
mx
 == 1);

319 
ıs_­i_objeù_t
 
»t_obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 0);

320 
ıs_­i_objeù_©Œ_t
 
¥“d_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»t_obj
, 
DELL_IF_IF_INTERFACES_STATE_INTERFACE_MAX_SPEED
);

321 
	`ASSERT_TRUE
(
¥“d_©Œ
 !ğ
nuÎ±r
);

322 
BASE_IF_SPEED_t
 
¥“d
 = 
¡©ic_ÿ¡
<BASE_IF_SPEED_t>(
	`ıs_­i_objeù_©Œ_d©a_u32
(
¥“d_©Œ
));

323 
	`ASSERT_TRUE
(
¥“d
 =ğ
BASE_IF_SPEED_10GIGE
);

324 
	}
}

326 
	$TEST
(
št_½c_‹¡
, 
ü—‹_š‹rçû_äÚt_·Ãl_çnout
)

328 
iâame
[64];

329 
cmdbuf
[256];

332 cÚ¡ *
if_¥“d
 = "40G";

333 cÚ¡ *
if_mode
 = "1x1";

335 ià(
çnout_äÚt_·Ãl_pÜt
 =ğ
INVALID_FRONT_PANEL_PORT
) {

336 
cout
 << "NØçnouˆpÜˆfound, by·s thi ‹¡" << 
’dl
;

340 
	`¢´štf
(
iâame
, (iâame), "e101-%03d-%d", 
çnout_äÚt_·Ãl_pÜt
, 
çnout_subpÜt_id
);

341 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

342 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

343 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

344 
ıs_­i_qu®if›r_TARGET
);

345 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
,

346 
DELL_BASE_IF_CMN_OPERATION_TYPE_CREATE
);

347 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_TYPE
,

348 
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
,

349 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
) + 1);

350 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
iâame
, 
	`¡¾’
(ifname) + 1);

351 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
, 0);

352 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_FRONT_PANEL_PORT
, 
çnout_äÚt_·Ãl_pÜt
);

353 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_SUBPORT_ID
, 
çnout_subpÜt_id
);

355 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

356 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

357 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

358 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

360 
	`dump_»tuº_obj
(
Œ
);

362 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

364 
cout
 << "Di§bË fªouˆoàš‹rçû " << 
iâame
 << 
’dl
;

365 
	`¢´štf
(
cmdbuf
, (cmdbuf), "İx-cÚfig-çnouˆ% % % 2>/dev/nuÎ", 
iâame
, 
if_mode
,
if_¥“d
);

366 
	`sy¡em
(
cmdbuf
);

367 
	}
}

369 
	$TEST
(
št_½c_‹¡
, 
ü—‹_š‹rçû_loİback
)

371 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

372 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

373 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

374 
ıs_­i_qu®if›r_TARGET
);

375 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
,

376 
DELL_BASE_IF_CMN_OPERATION_TYPE_CREATE
);

377 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_TYPE
,

378 
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_SOFTWARELOOPBACK
,

379 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_SOFTWARELOOPBACK
) + 1);

381 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
Í_iâame
, 
	`¡¾’
(lp_ifname) + 1);

383 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

384 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

385 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

386 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

388 
	`dump_»tuº_obj
(
Œ
);

390 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

391 
	}
}

393 
	$TEST
(
št_½c_‹¡
, 
g‘_loİback_štf_¡©e
)

395 
ıs_­i_g‘_·¿ms_t
 
gp
;

396 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

398 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

399 
	`ASSERT_TRUE
(
obj
 !ğ
nuÎ±r
);

401 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
), 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
,

402 
ıs_­i_qu®if›r_OBSERVED
);

404 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_STATE_INTERFACE_TYPE
,

405 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_SOFTWARELOOPBACK
,

406 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_SOFTWARELOOPBACK
));

408 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_STATE_INTERFACE_NAME
,
Í_iâame
,
	`¡¾’
(lp_ifname)+1);

410 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

411 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 0);

412 
ıs_­i_objeù_©Œ_t
 
Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_NAME
);

413 cÚ¡ *
Çme
 = (cÚ¡ *è
	`ıs_­i_objeù_©Œ_d©a_bš
(
Çme_©Œ
);

414 
	`ASSERT_TRUE
(
	`¡¾’
(
Çme
è=ğ¡¾’(
Í_iâame
));

415 
	`ASSERT_TRUE
(
	`¡ºcmp
(
Çme
, 
Í_iâame
, 
	`¡¾’
(lp_ifname)) == 0);

418 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

419 
	}
}

421 
	$TEST
(
št_½c_‹¡
, 
d–‘e_š‹rçû_loİback
)

423 
	`d–‘e_š‹rçû_½c
(
Í_iâame
, 
Œue
);

424 
	}
}

426 
	$TEST
(
št_½c_‹¡
, 
ü—‹_vœtu®_š‹rçû
)

428 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

429 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

430 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

431 
ıs_­i_qu®if›r_TARGET
);

432 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
,

433 
DELL_BASE_IF_CMN_OPERATION_TYPE_CREATE
);

434 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_TYPE
,

435 
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
,

436 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
) + 1);

437 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
vœt_iâame
, 
	`¡¾’
(virt_ifname) + 1);

439 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

440 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

441 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

442 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

444 
	`dump_»tuº_obj
(
Œ
);

446 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

447 
	}
}

449 
	$TEST
(
št_½c_‹¡
, 
unm­_phy_š‹rçû
)

451 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

452 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

453 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

454 
ıs_­i_qu®if›r_TARGET
);

455 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
,

456 
DELL_BASE_IF_CMN_OPERATION_TYPE_UPDATE
);

457 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
phy_iâame
, 
	`¡¾’
(phy_ifname) + 1);

458 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_FRONT_PANEL_PORT
, &
‹¡_äÚt_·Ãl_pÜt
, 0);

460 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

461 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

462 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

463 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

465 
	`dump_»tuº_obj
(
Œ
);

467 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

468 
	}
}

470 
	$TEST
(
št_½c_‹¡
, 
m­_vœtu®_š‹rçû
)

472 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

473 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

474 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

475 
ıs_­i_qu®if›r_TARGET
);

476 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
,

477 
DELL_BASE_IF_CMN_OPERATION_TYPE_UPDATE
);

478 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
vœt_iâame
, 
	`¡¾’
(virt_ifname) + 1);

479 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_FRONT_PANEL_PORT
, 
‹¡_äÚt_·Ãl_pÜt
);

480 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_SUBPORT_ID
, 0);

482 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

483 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

484 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

485 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

487 
	`dump_»tuº_obj
(
Œ
);

489 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

490 
	}
}

492 
	$TEST
(
št_½c_‹¡
, 
d–‘e_vœtu®_š‹rçû
)

494 
	`d–‘e_š‹rçû_½c
(
vœt_iâame
);

495 
	}
}

497 
	$TEST
(
št_½c_‹¡
, 
»m­_phy_š‹rçû
)

499 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

500 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

501 
DELL_BASE_IF_CMN_SET_INTERFACE_OBJ
,

502 
ıs_­i_qu®if›r_TARGET
);

503 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_SET_INTERFACE_INPUT_OPERATION
,

504 
DELL_BASE_IF_CMN_OPERATION_TYPE_UPDATE
);

505 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
phy_iâame
, 
	`¡¾’
(phy_ifname) + 1);

506 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_FRONT_PANEL_PORT
, 
‹¡_äÚt_·Ãl_pÜt
);

507 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_PHY_HARDWARE_PORT_SUBPORT_ID
, 0);

509 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

510 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

511 
	`ıs_­i_aùiÚ
(&
Œ
, 
obj
);

512 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
è=ğ
ıs_­i_»t_code_OK
);

514 
	`dump_»tuº_obj
(
Œ
);

516 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

517 
	}
}

519 
	$maš
(
¬gc
, *
¬gv
[])

521 ::
‹¡šg
::
	`In™GoogËTe¡
(&
¬gc
, 
¬gv
);

523  
	`RUN_ALL_TESTS
();

524 
	}
}

	@src/unit_test/nas_int_vlan_filter_unittest.cpp

22 
	~"ıs_şass_m­.h
"

23 
	~"ıs_­i_objeù.h
"

24 
	~"ıs_­i_İ”©iÚ.h
"

25 
	~"ıs_­i_objeù_key.h
"

26 
	~"ıs_­i_objeù_ÿ‹gÜy.h
"

27 
	~"ıs_­i_ev’ts.h
"

28 
	~"d–l-ba£-if.h
"

29 
	~"d–l-š‹rçû.h
"

30 
	~"›tf-š‹rçûs.h
"

31 
	~"ŸÇ-if-ty³.h
"

32 
	~"¡d_uts.h
"

34 
	~<g‹¡/g‹¡.h
>

35 
	~<io¡»am
>

37 
usšg
 
Çme¥aû
 
	g¡d
;

38 
ušt32_t
 
	gifšdex
 = 0;

40 
ušt32_t
 
	$g‘_vÏn_f‹r_v®ue
 ()

42 
ıs_­i_g‘_·¿ms_t
 
gp
;

43 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

44 
ušt32_t
 
f‹r_ty³
 = 0;

46 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

47 ià(
obj
 =ğ
nuÎ±r
)

49 
cout
<<"G‘ VLAN F‹¸- CPS Objeù c»©çed "<<
’dl
;

53 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
), 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_OBJ
,

54 
ıs_­i_qu®if›r_OBSERVED
);

56 cÚ¡ *
iâame
 = "e101-001-0";

58 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_STATE_INTERFACE_NAME
,
iâame
,
	`¡¾’
(ifname)+1);

60 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

61 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
, 0);

62 
ıs_­i_objeù_©Œ_t
 
f‹r_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
,

63 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_VLAN_FILTER
);

64 ià(
f‹r_©Œ
 =ğ
nuÎ±r
)

66 
cout
<<"VLAN F‹¸G‘ Objeù Faed "<<
’dl
;

67 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

71 
ıs_­i_objeù_©Œ_t
 
if_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_IF_INDEX
);

72 ià(
if_©Œ
 =ğ
nuÎ±r
)

74 
cout
<<"IÁ”çû Index A‰ribu‹ G‘ Faed "<<
’dl
;

75 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

78 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_©Œ
);

80 
cout
 <<"IF Index : "<< 
ifšdex
 << 
’dl
;

81 
f‹r_ty³
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
f‹r_©Œ
);

82 
cout
<<"VLAN FILTER TYPE : "<<
f‹r_ty³
<<
’dl
;

85 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

86  
f‹r_ty³
;

87 
	}
}

89 
	$TEST
(
¡d_vÏn_f‹r_‹¡
, 
g‘_vÏn_f‹r_ty³
)

91 
ušt32_t
 
f‹r_ty³
;

92 
f‹r_ty³
 = 
	`g‘_vÏn_f‹r_v®ue
 ();

93 
	`ASSERT_TRUE
(
f‹r_ty³
 !=0);

94 
	}
}

96 
	$TEST
(
¡d_vÏn_f‹r_£t
, 
£t_vÏn_f‹r_ty³
)

98 
ušt32_t
 
f‹r_ty³_cÚfig
 = 4;

99 
ušt32_t
 
f‹r_ty³_ob£rved
 = 0;

100 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

102 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

103 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

105 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
ifšdex
);

106 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_VLAN_FILTER
, 
f‹r_ty³_cÚfig
);

108 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

109 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

110 
	`ıs_­i_£t
(&
Œ
,
obj
);

111 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

114 
f‹r_ty³_ob£rved
 = 
	`g‘_vÏn_f‹r_v®ue
 ();

115 
	`ASSERT_TRUE
(
f‹r_ty³_cÚfig
 =ğ
f‹r_ty³_ob£rved
);

117 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

119 
	}
}

121 
	$maš
(
¬gc
, **
¬gv
) {

122 ::
‹¡šg
::
	`In™GoogËTe¡
(&
¬gc
, 
¬gv
);

124  
	`RUN_ALL_TESTS
();

125 
	}
}

	@src/unit_test/nas_int_vlan_unittest.cpp

22 
	~"ıs_­i_objeù.h
"

23 
	~"ıs_­i_İ”©iÚ.h
"

24 
	~"ıs_­i_objeù_ÿ‹gÜy.h
"

25 
	~"ıs_­i_ev’ts.h
"

26 
	~"h®_š‹rçû_deçuÉs.h
"

27 
	~"ıs_şass_m­.h
"

28 
	~"ıs_­i_objeù_key.h
"

29 
	~"d–l-š‹rçû.h
"

30 
	~"d–l-ba£-if.h
"

31 
	~"d–l-ba£-if-vÏn.h
"

32 
	~"ŸÇ-if-ty³.h
"

33 
	~"¡d_uts.h
"

35 
	~<g‹¡/g‹¡.h
>

36 
	~<io¡»am
>

37 
	~<Ãt/if.h
>

39 
usšg
 
Çme¥aû
 
	g¡d
;

41 
	$Çs_´št_vÏn_objeù
(
ıs_­i_objeù_t
 
obj
){

42 
ıs_­i_objeù_™_t
 
™
;

43 
	`ıs_­i_objeù_™_begš
(
obj
,&
™
);

45  ; 
	`ıs_­i_objeù_™_v®id
(&
™
è; 
	`ıs_­i_objeù_™_Ãxt
(&it) ) {

46 
id
 = (è
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

47 
id
) {

48 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
:

49 
¡d
::
cout
<<"VLAN INDEX "<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

51 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
:

52 
¡d
::
cout
<<"VLAN ID "<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

55 
IF_INTERFACES_INTERFACE_NAME
:

56 
	`´štf
("Nam% \n", (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
));

59 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
:

60 
¡d
::
cout
<<"Tagged PÜˆ"<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

63 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
:

64 
¡d
::
cout
<<"UÁagged PÜˆ"<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

66 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
:

67 
	`´štf
("MAC Add»s % \n", (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
));

70 
IF_INTERFACES_INTERFACE_ENABLED
:

71 
¡d
::
cout
<<"Admš Stu "<< 
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

74 
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
:

75 
¡d
::
cout
<<"L—ºšg mod"<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

83 
	}
}

86 
	$TEST
(
¡d_vÏn_‹¡
 , 
Ïg_add_rŞl_bk
) {

88 if(
	`sy¡em
("ip†ink‡dd‚ame bo33ype bond miimon 100 mode 4†acp_rate 1 min_links 1")){}

89 if(
	`sy¡em
("ip†ink‡dd‚ame bo30ype bond miimon 100 mode 4†acp_rate 1 min_links 1")){}

90 if(
	`sy¡em
("ip†ink setƒ101-001-0 master bo33")){}

91 if(
	`sy¡em
("ip†ink setƒ101-002-0 master bo33")){}

92 if(
	`sy¡em
(" ip†ink setƒ101-003-0 master bo30")){}

93 if(
	`sy¡em
("ip†ink setƒ101-004-0 master bo30")){}

94 if(
	`sy¡em
("ifconfigƒ101-005-0 1.1.1.1/8")){}

95 
	`¦“p
 (5);

96 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

97 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

98 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

99 
ıs_­i_qu®if›r_TARGET
);

100 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

101 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

102 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

104 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
,44);

105 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
,

106 "bo30", 
	`¡¾’
("bo44")+1);

107 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
,

108 "e101-011-0", 
	`¡¾’
("e101-011-0")+1);

109 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

110 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

111 
	`ıs_­i_ü—‹
(&
Œ
,
obj
);

112 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

113 
ıs_­i_objeù_t
 
»cvd_obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
Œ
.
chªge_li¡
,0);

115 
ıs_­i_objeù_©Œ_t
 
vÏn_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»cvd_obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

117 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_©Œ
);

119 
cout
 <<"RŞl_back†ag_add vÏÀid 44 ifšdex %d "<< 
ifšdex
 << 
’dl
;

121 
	`¦“p
(2);

127 
ıs_­i_objeù_t
 
obj2
 = 
	`ıs_­i_objeù_ü—‹
();

128 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj2
),

129 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

130 
ıs_­i_qu®if›r_TARGET
);

131 
	`ıs_­i_objeù_©Œ_add
(
obj2
,
IF_INTERFACES_INTERFACE_TYPE
,

132 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

133 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

136 cÚ¡ *
br_Çme
 = "br44";

138 
	`ıs_­i_£t_key_d©a
(
obj2
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

139 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

142 
	`ıs_­i_objeù_©Œ_add
(
obj2
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
,

143 "e101-005-0", 
	`¡¾’
("e101-004-12")+1);

144 
	`ıs_­i_objeù_©Œ_add
(
obj2
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
,

145 "bo33", 
	`¡¾’
("bo43")+1);

146 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ2
;

147 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ2
)==
ıs_­i_»t_code_OK
);

148 
	`ıs_­i_£t
(&
Œ2
,
obj2
);

149 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ2
)==
ıs_­i_»t_code_ERR
);

150 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ2
);

151 
	`¦“p
(2);

152 
	}
}

155 
	$TEST
(
¡d_vÏn_‹¡
, 
ROLL_BK_CREATE_VLAN
)

158 if(
	`sy¡em
("ifconfigƒ101-005-0 1.1.1.1/8")){}

159 
	`¦“p
(2);

160 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

161 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

162 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

163 
ıs_­i_qu®if›r_TARGET
);

164 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

165 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

166 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

168 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
,23);

169 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
,

170 "e101-005-0", 
	`¡¾’
("e101-004-1")+1);

171 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
,

172 "e101-006-0", 
	`¡¾’
("e101-004-1")+1);

174 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

175 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

176 
	`ıs_­i_ü—‹
(&
Œ
,
obj
);

177 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_ERR
);

179 
cout
 <<"RŞl_back fÜ bridgü—‹ dÚe" << 
’dl
;

180 
	`¦“p
(5);

182 
	}
}

185 
	$TEST
(
¡d_vÏn_‹¡
, 
rŞl_back_£t_vÏn_·¿ms
)

188 cÚ¡ * 
mac
 = "22:22:22:22:22:22";

189 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

190 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

191 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

192 
ıs_­i_qu®if›r_TARGET
);

193 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

194 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

195 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

197 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
,22);

198 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, 
mac
, 
	`¡¾’
(mac) + 1);

200 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
,
çl£
);

201 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
, 
Œue
);

202 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
,

203 "e101-007-0", 
	`¡¾’
("e101-004-1")+1);

205 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

206 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

207 
	`ıs_­i_ü—‹
(&
Œ
,
obj
);

208 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

209 
ıs_­i_objeù_t
 
»cvd_obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
Œ
.
chªge_li¡
,0);

211 
ıs_­i_objeù_©Œ_t
 
vÏn_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»cvd_obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

213 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_©Œ
);

215 
cout
 <<"IF Index from K”ÃÈi "<< 
ifšdex
 << 
’dl
;

216 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

218 
	`¦“p
(5);

219 if(
	`sy¡em
("ip†ink show br22")){}

220 if(
	`sy¡em
("hshell -c \"vlan show\"")){}

221 
	`¦“p
(30);

223 cÚ¡ *
br_Çme
 = "br22";

224 cÚ¡ * 
mac2
 = "22:22:22:22:11:11";

225 
ıs_­i_objeù_t
 
obj2
 = 
	`ıs_­i_objeù_ü—‹
();

227 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj2
),

228 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

229 
ıs_­i_qu®if›r_TARGET
);

230 
	`ıs_­i_objeù_©Œ_add
(
obj2
,
IF_INTERFACES_INTERFACE_TYPE
,

231 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

232 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

234 
	`ıs_­i_£t_key_d©a
(
obj2
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

235 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

237 
	`ıs_­i_objeù_©Œ_add
(
obj2
, 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, 
mac2
, 
	`¡¾’
(mac2) + 1);

238 
	`ıs_­i_objeù_©Œ_add_u32
(
obj2
,
IF_INTERFACES_INTERFACE_ENABLED
,
Œue
);

239 
	`ıs_­i_objeù_©Œ_add_u32
(
obj2
,
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
, 
çl£
);

240 
	`ıs_­i_objeù_©Œ_add
(
obj2
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
,

241 "e101-005-0", 
	`¡¾’
("e101-004-1")+1);

243 
	`ıs_­i_objeù_©Œ_add
(
obj2
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
,

244 "e101-009-0", 
	`¡¾’
("e101-004-1")+1);

246 
	`ıs_­i_objeù_©Œ_add
(
obj2
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
,

247 "e101-008-0", 
	`¡¾’
("e101-009-1")+1);

249 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ2
;

250 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ2
)==
ıs_­i_»t_code_OK
);

251 
	`ıs_­i_£t
(&
Œ2
,
obj2
);

252 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ2
)==
ıs_­i_»t_code_ERR
);

255 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ2
);

256 if(
	`sy¡em
("ip†ink show br22")){}

257 if(
	`sy¡em
("hshell -c \"vlan show\"")){}

258 
cout
 <<"RŞl_backe¡fÜ s‘˜·¿m dÚ"<< 
’dl
;

259 
	}
}

261 
	$TEST
(
¡d_vÏn_‹¡
, 
ü—‹_vÏn
)

263 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

265 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

266 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

267 
ıs_­i_qu®if›r_TARGET
);

269 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

270 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

271 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

273 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
,100);

275 cÚ¡ * 
mac
 = "00:11:11:11:11:11";

277 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, 
mac
, 
	`¡¾’
(mac) + 1);

279 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

280 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

281 
	`ıs_­i_ü—‹
(&
Œ
,
obj
);

282 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

284 
ıs_­i_objeù_t
 
»cvd_obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
Œ
.
chªge_li¡
,0);

286 
ıs_­i_objeù_©Œ_t
 
vÏn_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
»cvd_obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

288 
ifšdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_©Œ
);

290 
cout
 <<"IF Index from K”ÃÈi "<< 
ifšdex
 << 
’dl
;

292 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

293 
	}
}

295 
	$TEST
(
¡d_vÏn_‹¡
, 
d–_pÜt_vÏn
)

297 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

299 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

300 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

301 
ıs_­i_qu®if›r_TARGET
);

303 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

304 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

305 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

307 cÚ¡ *
br_Çme
 = "br1";

309 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

310 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

312 
pÜt_šdex
 = 0;

313 
size_t
 
Ën
 = 0;

316 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
,

317 &
pÜt_šdex
, 
Ën
);

319 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

320 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

321 
	`ıs_­i_£t
(&
Œ
,
obj
);

322 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

323 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

324 
	}
}

326 
	$TEST
(
¡d_vÏn_‹¡
, 
add_bÚd_vÏn100
)

328 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

330 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

331 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

332 
ıs_­i_qu®if›r_TARGET
);

334 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

335 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

336 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

338 cÚ¡ *
br_Çme
 = "br100";

339 
pÜt_Çme
[
HAL_IF_NAME_SZ
] = "\0";

341 
pÜt_Çme_Ën
 = 5;

342 
	`§ã¡ºıy
(
pÜt_Çme
, "bÚd1", 
pÜt_Çme_Ën
);

343 
pÜt_šdex
 = 
	`if_Çm‘ošdex
(
pÜt_Çme
);

345 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

346 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

348 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
, 
pÜt_šdex
);

350 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

351 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

352 
	`ıs_­i_£t
(&
Œ
,
obj
);

353 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

355 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

356 
	}
}

358 
	$TEST
(
¡d_vÏn_‹¡
, 
d–_bÚd_vÏn100
)

360 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

362 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

363 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

364 
ıs_­i_qu®if›r_TARGET
);

365 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

366 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

367 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

369 cÚ¡ *
br_Çme
 = "br100";

370 
šdex
 = 
	`if_Çm‘ošdex
(
br_Çme
);

372 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

373 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

375 
šdex
 = 0;

376 
size_t
 
Ën
 = 0;

377 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
,

378 &
šdex
, 
Ën
);

381 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

382 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

383 
	`ıs_­i_£t
(&
Œ
,
obj
);

384 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

386 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

387 
	}
}

390 
	$TEST
(
¡d_vÏn_‹¡
, 
add_mac_vÏn
)

392 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

394 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

395 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

396 
ıs_­i_qu®if›r_TARGET
);

398 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

399 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

400 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

402 cÚ¡ *
br_Çme
 = "br100";

405 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

406 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

408 cÚ¡ * 
mac
 = "00:11:11:11:11:11";

410 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, 
mac
,

411 
	`¡¾’
(
mac
) + 1);

413 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

414 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

415 
	`ıs_­i_£t
(&
Œ
,
obj
);

416 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

418 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

419 
	}
}

421 
	$TEST
(
¡d_vÏn_£t_admš
, 
£t_vÏn_admš
)

424 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

426 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

427 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

429 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

430 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

431 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

433 cÚ¡ *
br_Çme
 = "br100";

436 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

437 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

439 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
,
Œue
);

441 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

442 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

443 
	`ıs_­i_£t
(&
Œ
,
obj
);

444 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

446 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

448 
	}
}

450 
	$TEST
(
¡d_vÏn_£t_desc
, 
£t_vÏn_desc
)

453 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

455 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

456 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
, 
ıs_­i_qu®if›r_TARGET
);

458 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

459 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

460 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

462 cÚ¡ *
br_Çme
 = "br100";

465 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

466 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

468 cÚ¡ *
desc
 = "br100 interface description";

469 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_DESCRIPTION
, 
desc
, 
	`¡¾’
(desc) + 1);

471 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

472 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

473 
	`ıs_­i_£t
(&
Œ
,
obj
);

474 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

476 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

478 
	}
}

480 
	$TEST
(
¡d_vÏn_‹¡
, 
g‘_®l_vÏn
)

482 
ıs_­i_g‘_·¿ms_t
 
gp
;

483 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

484 
ıs_­i_key_t
 *
key
;

486 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

488 
key
 = 
	`ıs_­i_objeù_key
(
obj
);

489 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
key
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

490 
ıs_­i_qu®if›r_TARGET
);

492 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

493 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

494 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

496 
gp
.
key_couÁ
 = 1;

497 
gp
.
keys
 = 
key
;

499 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

500 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

501 
size_t
 
ix
 = 0 ; ix < 
mx
 ; ++ix ) {

502 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
,
ix
);

503 
	`Çs_´št_vÏn_objeù
(
obj
);

506 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

508 
	}
}

511 
	$TEST
(
¡d_vÏn_‹¡
, 
d–_vÏn
)

513 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

515 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

516 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

517 
ıs_­i_qu®if›r_TARGET
);

519 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

520 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

521 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

523 cÚ¡ *
br_Çme
 = "br100";

526 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

527 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

529 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

530 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

531 
	`ıs_­i_d–‘e
(&
Œ
,
obj
);

532 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

533 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

534 
	}
}

537 
	$TEST
(
¡d_vÏn_‹¡
, 
g‘_deçuÉ_vÏn
)

540 
ıs_­i_g‘_·¿ms_t
 
gp
;

541 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

543 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

545 ià(
obj
 =ğ
NULL
) {

546 
¡d
::
cout
<<"Cª‚Ù c»©Ãw objeù"<<¡d::
’dl
;

550 
ıs_­i_key_t
 
key
;

551 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
key
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,
ıs_­i_qu®if›r_TARGET
);

552 
	`ıs_­i_objeù_£t_key
(
obj
,&
key
);

554 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

555 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

556 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

559 
id
 =0;

560 
	`ıs_­i_£t_key_d©a
(
obj
,
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
,
ıs_­i_objeù_ATTR_T_U32
,

561 &
id
,(id));

564 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

565 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

566 
size_t
 
ix
 = 0 ; ix < 
mx
 ; ++ix ) {

567 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
,
ix
);

568 
¡d
::
cout
<<" DeçuÉ VLAN InfÜm©iÚ"<<¡d::
’dl
;

569 
	`Çs_´št_vÏn_objeù
(
obj
);

572 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

573 
	}
}

575 
	$TEST
(
¡d_vÏn_‹¡
, 
add_Ë¬nšg_mode
)

577 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

579 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

580 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

581 
ıs_­i_qu®if›r_TARGET
);

583 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

584 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

585 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

587 cÚ¡ *
br_Çme
 = "br100";

589 
boŞ
 
Ë¬nšg_mode
 = 
çl£
;

591 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

592 
br_Çme
, 
	`¡¾’
(br_name) + 1 );

594 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
, 
Ë¬nšg_mode
);

596 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

597 
	`ASSERT_TRUE
(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)==
ıs_­i_»t_code_OK
);

598 
	`ıs_­i_£t
(&
Œ
,
obj
);

599 
	`ASSERT_TRUE
(
	`ıs_­i_comm™
(&
Œ
)==
ıs_­i_»t_code_OK
);

601 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

602 
	}
}

604 
boŞ
 
	$vÏn_obj_ev’t_cb
(
ıs_­i_objeù_t
 
obj
, *
·¿m
)

606 
ıs_­i_objeù_™_t
 
™
;

607 
	`ıs_­i_objeù_™_begš
(
obj
,&
™
);

609 
ıs_­i_key_t
 *
key
 = 
	`ıs_­i_objeù_key
(
obj
);

610 
cout
 << "Reûived VLAN‚ÙifiÿtiÚ .. "<< 
’dl
;

612 ià(
	`ıs_­i_key_g‘_ÿt
(
key
è!ğ
ıs_­i_obj_ÿt_INTERFACE
) {

613 
cout
 << "C©egÜyy³ i nÙ IÁ”çû. "<< 
’dl
;

615 
ušt_t
 
obj_id
 = 
	`ıs_­i_key_g‘_subÿt
(
key
);

617 if(
obj_id
 =ğ
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
) {

619 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

621 ifĞ
İ
 =ğ
ıs_­i_İ”_CREATE
){

622 
cout
 << "O³¿tiÚ Ty³ :- C»©VLAN "<< 
’dl
;

624 if(
İ
 =ğ
ıs_­i_İ”_DELETE
){

625 
cout
 << "O³¿tiÚ Ty³ :- D–‘VLAN "<< 
’dl
;

627 if(
İ
 =ğ
ıs_­i_İ”_SET
){

628 
cout
 << "O³¿tiÚ Ty³ :- PÜt Add/D–. "<< 
’dl
;

631 
ıs_­i_objeù_©Œ_t
 
vÏn_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

632 
h®_ifšdex_t
 
vÏn_šdex
 = (h®_ifšdex_tè
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_©Œ
);

633 
cout
 <<"VÏÀI/F Index - " << 
vÏn_šdex
;

635  ; 
	`ıs_­i_objeù_™_v®id
(&
™
è; 
	`ıs_­i_objeù_™_Ãxt
(&it) ) {

636 
id
 = (è
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

638 
id
){

639 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
:

640 
¡d
::
cout
<<"Tagged PÜˆ"<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<',';

642 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
:

643 
¡d
::
cout
<<"UÁagged PÜˆ"<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<',';

645 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
:

646 
¡d
::
cout
<<"VLAN ID "<<
	`ıs_­i_objeù_©Œ_d©a_u32
(
™
.
©Œ
)<<¡d::
’dl
;

653 
	`fæush
(
¡dout
);

654  
Œue
;

655 
	}
}

657 
ıs_­i_»tuº_code_t
 
	$Çs_vÏn_´oûss_pÜts
(
ıs_­i_objeù_t
 
obj
, 
boŞ
 
add_pÜts
)

659 
h®_ifšdex_t
 
vÏn_šdex
 = 0;

661 
cout
 << "NAS VÏÀpÜˆupd©fÜ" << 
add_pÜts
 ;

663 
ıs_­i_objeù_©Œ_t
 
vÏn_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

665 if(
vÏn_©Œ
 =ğ
NULL
) {

666 
cout
 << "Missšg ifšdex‡‰ribu‹ fÜ CPS S‘" << 
’dl
 ;

667  
ıs_­i_»t_code_ERR
;

670 
ıs_­i_objeù_©Œ_t
 
vÏn_id_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
);

672 if(
vÏn_id_©Œ
 =ğ
NULL
) {

673 
cout
 << "Missšg VÏÀID fÜ CPS S‘" << 
’dl
;

674  
ıs_­i_»t_code_ERR
;

677 
h®_vÏn_id_t
 
vÏn_id
 = (h®_vÏn_id_tè
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_id_©Œ
);

679 
cout
 << "VÏÀID "<< 
vÏn_id
 ;

681 
vÏn_šdex
 = (
h®_ifšdex_t
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_©Œ
);

683 
cout
 << ", VÏÀšdex "<< 
vÏn_šdex
 ;

685 
ıs_­i_objeù_©Œ_t
 
g_pÜt_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
);

687 
ıs_­i_objeù_©Œ_t
 
uÁag_pÜt_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
);

689 if((
g_pÜt_©Œ
 =ğ
NULL
è&& (
uÁag_pÜt_©Œ
 == NULL)){

690 
cout
 << "Missšg PÜˆli¡ from VLAN upd©e" << 
’dl
 ;

691  
ıs_­i_»t_code_ERR
;

694  
ıs_­i_»t_code_OK
;

695 
	}
}

697 
boŞ
 
	$Çs_vÏn_pÜt_ev’t_func_cb
(
ıs_­i_objeù_t
 
obj
, *
·¿m
)

699 
ıs_­i_objeù_™_t
 
™
;

700 
	`ıs_­i_objeù_™_begš
(
obj
,&
™
);

702 
cout
 << "Reûived VLAN PÜˆnÙifiÿtiÚ .. "<< 
’dl
;

704 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

706 ià((
İ
 !ğ
ıs_­i_İ”_CREATE
è&& (İ !ğ
ıs_­i_İ”_DELETE
)){

707 
cout
 << "Reûived Inv®id VLAN o³¿tiÚ code.. "<< 
’dl
;

708 
cout
 <<"O³¿tiÚ i "<< 
İ
 << 
’dl
;

710  
ıs_­i_»t_code_ERR
;

713 
boŞ
 
add_pÜts
 = 
çl£
;

715 ifĞ
İ
 =ğ
ıs_­i_İ”_CREATE
){

716 
add_pÜts
 = 
Œue
;

719 if(
	`Çs_vÏn_´oûss_pÜts
(
obj
, 
add_pÜts
è!ğ
ıs_­i_»t_code_OK
){

720  
ıs_­i_»t_code_ERR
;

723 
cout
 << "PÜˆ´oûssšg dÚ.. "<< 
’dl
;

724  
ıs_­i_»t_code_OK
;

725 
	}
}

727 
boŞ
 
	$Çs_vÏn_ug_pÜt_ev’t_func_cb
(
ıs_­i_objeù_t
 
obj
, *
·¿m
)

729 
ıs_­i_objeù_™_t
 
™
;

730 
	`ıs_­i_objeù_™_begš
(
obj
,&
™
);

732 
cout
 << "Reûived UÁagged PÜˆnÙifiÿtiÚ from VLAN.. "<< 
’dl
;

734 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

736 ià((
İ
 !ğ
ıs_­i_İ”_CREATE
è&& (İ !ğ
ıs_­i_İ”_DELETE
)){

737 
cout
 << "Reûived Inv®id VLAN o³¿tiÚ code.. "<< 
’dl
;

738 
cout
 <<"O³¿tiÚ i "<< 
İ
 << 
’dl
;

740  
ıs_­i_»t_code_ERR
;

743 
boŞ
 
add_pÜts
 = 
çl£
;

745 ifĞ
İ
 =ğ
ıs_­i_İ”_CREATE
){

746 
add_pÜts
 = 
Œue
;

749 if(
	`Çs_vÏn_´oûss_pÜts
(
obj
, 
add_pÜts
è!ğ
ıs_­i_»t_code_OK
){

750  
ıs_­i_»t_code_ERR
;

753 
cout
 << "PÜˆ´oûssšg dÚ.. "<< 
’dl
;

754  
ıs_­i_»t_code_OK
;

755 
	}
}

757 
	$TEST
(
¡d_vÏn_ev’t_rx_‹¡
, 
g‘_gged_pÜt_nÙifiÿtiÚ
)

759 
ıs_­i_ev’t_»g_t
 
»g
;

760 
ıs_­i_key_t
 
key
;

762 
	`mem£t
(&
»g
,0,(reg));

764 ià(
	`ıs_­i_ev’t_£rviû_š™
(è!ğ
ıs_­i_»t_code_OK
) {

765 
cout
 << "***ERROR*** cps_­i_ev’t_£rviû_š™(èçed\n" << 
’dl
;

769 ià(
	`ıs_­i_ev’t_th»ad_š™
(è!ğ
ıs_­i_»t_code_OK
) {

770 
cout
 << "***ERROR*** cps_­i_ev’t_th»ad_š™(èçed\n" <<
’dl
;

774 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
key
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

775 
ıs_­i_qu®if›r_OBSERVED
);

777 
»g
.
numb”_of_objeùs
 = 1;

778 
»g
.
objeùs
 = &
key
;

780 ià(
	`ıs_­i_ev’t_th»ad_»g
(&
»g
, 
vÏn_obj_ev’t_cb
,
NULL
)!=
ıs_­i_»t_code_OK
) {

781 
cout
 << "„egi¡¿tiÚ fau»"<<
’dl
;

785 
cout
 << "Regi¡”šg fÜ Tagged VÏÀpÜˆnÙifiÿtiÚ!!!" << 
’dl
 ;

787 
	`mem£t
(&
»g
,0,(reg));

789 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
key
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
,

790 
ıs_­i_qu®if›r_OBSERVED
);

792 
»g
.
numb”_of_objeùs
 = 1;

793 
»g
.
objeùs
 = &
key
;

795 ià(
	`ıs_­i_ev’t_th»ad_»g
(&
»g
, 
Çs_vÏn_pÜt_ev’t_func_cb
, 
NULL
)!=
ıs_­i_»t_code_OK
)

796 
cout
 << "Fau»„egi¡”šg fÜ VÏÀev’ˆnÙifiÿtiÚ!!!" <<
’dl
 ;

800 
	}
}

802 
	$TEST
(
¡d_vÏn_ev’t_rx_‹¡
, 
g‘_uÁagged_pÜt_nÙifiÿtiÚ
)

804 
ıs_­i_ev’t_»g_t
 
»g
;

805 
ıs_­i_key_t
 
key
;

807 
	`mem£t
(&
»g
,0,(reg));

809 ià(
	`ıs_­i_ev’t_£rviû_š™
(è!ğ
ıs_­i_»t_code_OK
) {

810 
cout
 << "***ERROR*** cps_­i_ev’t_£rviû_š™(èçed\n" << 
’dl
;

814 ià(
	`ıs_­i_ev’t_th»ad_š™
(è!ğ
ıs_­i_»t_code_OK
) {

815 
cout
 << "***ERROR*** cps_­i_ev’t_th»ad_š™(èçed\n" <<
’dl
;

819 
cout
 << "Regi¡”šg fÜ UÁagged VÏÀpÜˆnÙifiÿtiÚ!!!" << 
’dl
 ;

821 
	`mem£t
(&
»g
,0,(reg));

823 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
key
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
,

824 
ıs_­i_qu®if›r_OBSERVED
);

826 
»g
.
numb”_of_objeùs
 = 1;

827 
»g
.
objeùs
 = &
key
;

829 ià(
	`ıs_­i_ev’t_th»ad_»g
(&
»g
, 
Çs_vÏn_ug_pÜt_ev’t_func_cb
, 
NULL
)!=
ıs_­i_»t_code_OK
)

830 
cout
 << "Fau»„egi¡”šg fÜ UÁagged…Üˆev’ˆnÙifiÿtiÚ!!!" <<
’dl
 ;

834 
	}
}

836 
	$maš
(
¬gc
, **
¬gv
) {

837 ::
‹¡šg
::
	`In™GoogËTe¡
(&
¬gc
, 
¬gv
);

839  
	`RUN_ALL_TESTS
();

840 
	}
}

	@src/unit_test/nas_pkt_meta_rcv_ut.cpp

17 
	~"¡d_sock‘_toŞs.h
"

18 
	~"¡d_fe_uts.h
"

19 
	~"Çs_·ck‘_m‘a.h
"

20 
	~"ds_commÚ_ty³s.h
"

21 
	~<io¡»am
>

22 
	~<g‹¡/g‹¡.h
>

24 
	#SOCK_PORT
 20055

	)

26 
	$TEST
(
m‘a_‹¡
, 
rx_pkt
)

28 
¡d_sock‘_add»ss_t
 
bšd
;

29 
t_¡d_”rÜ
 
rc
 = 
	`¡d_sock_addr_äom__¡r
 (
e_¡d_sock_INET4
, "127.0.0.1",

30 
SOCK_PORT
, &
bšd
);

31 
fd
;

32 
rc
 = 
	`¡d_sock‘_ü—‹
 (
e_¡d_sock_INET4
, 
e_¡d_sock_ty³_DGRAM
, 0, &
bšd
, &
fd
);

34 
	`ASSERT_TRUE
(
STD_ERR_OK
 =ğ
rc
);

36 
cÚ¡ex´
 
size_t
 
MAXLEN
 = 256;

37 
ušt8_t
 
buf
[
MAXLEN
];

38 
iovec
 
sock_d©a
 = {
buf
, 
MAXLEN
};

39 
¡d_sock‘_msg_t
 
msg
 = { 
NULL
, 0, &
sock_d©a
, 2, NULL, 0, 0};

41 autØ
n
 = 
	`¡d_sock‘_İ
 (
¡d_sock‘_Œªs™_o_READ
, 
fd
, &
msg
,

42 
¡d_sock‘_Œªs™_f_NONE
, 0, &
rc
);

44 
	`ASSERT_TRUE
(
STD_ERR_OK
 =ğ
rc
);

45 ià(
n
 < 0è
	`´štf
 ("FAILED\r\n");

47 
¡d
::
cout
 << "Reûived by‹s: " << 
n
 << std::
’dl
;

49 
Çs_pkt_m‘a_©Œ_™_t
 
™
;

50 
boŞ
 
found
=
çl£
;

52 
	`Çs_pkt_m‘a_™_begš
 (
buf
, &
™
); 
	`Çs_pkt_m‘a_™_v®id
 (&it);

53 
	`Çs_pkt_m‘a_™_Ãxt
 (&
™
)) {

54 
¡d_v_g_t
 
t
 = 
	`Çs_pkt_m‘a_©Œ_ty³
 (
™
.
©Œ
);

55 
found
=
Œue
;

56 
¡d
::
cout
 << "Found Pack‘ M‘¨©Œ " << 
t
 << std::
’dl
;

58 ià(
t
 =ğ
NAS_PKT_META_RX_PORT
) {

59 
h®_ifšdex_t
 
ifidx
 = 
	`Çs_pkt_m‘a_©Œ_d©a_ušt
 (
™
.
©Œ
);

60 
¡d
::
cout
 << "Reûived…kˆÚ IfIndex " << 
ifidx
 << std::
’dl
;

61 
	`EXPECT_TRUE
 (
ifidx
 == 45);

64 ià(
t
 =ğ
NAS_PKT_META_PKT_LEN
) {

65 
ušt32_t
 
Ën
 = 
	`Çs_pkt_m‘a_©Œ_d©a_ušt
 (
™
.
©Œ
);

66 
¡d
::
cout
 << "Reûived…kˆL’ " << 
Ën
 << std::
’dl
;

67 
	`EXPECT_TRUE
 (
Ën
 == 4);

70 ià(
t
 =ğ
NAS_PKT_META_TX_PORT
) {

71 
h®_ifšdex_t
 
ifidx
 = 
	`Çs_pkt_m‘a_©Œ_d©a_ušt
 (
™
.
©Œ
);

72 
¡d
::
cout
 << "Eg»s IÁ”çû fÜ sam¶ed…ack‘ " << 
ifidx
 << std::
’dl
;

73 
	`EXPECT_TRUE
 (
ifidx
 == 50);

76 ià(
t
 =ğ
NAS_PKT_META_SAMPLE_COUNT
) {

77 
ušt64_t
 
couÁ
 = 
	`Çs_pkt_m‘a_©Œ_d©a_ušt
 (
™
.
©Œ
);

78 
¡d
::
cout
 << "Sam¶couÁ " << 
couÁ
 << std::
’dl
;

79 
	`EXPECT_TRUE
 (
couÁ
 == 100);

82 
	`EXPECT_TRUE
 (
found
);

84 
ušt8_t
* 
pkt
 = 
	`Çs_pkt_d©a_off£t
 (
buf
);

85 
ušt32_t
 
‹¡
 = 0xbeeff00d;

86 
‹¡
 = 
	`Áohl
 (test);

87 
ušt32_t
 
d©a
 = *((ušt32_t*)
pkt
);

89 
	`EXPECT_TRUE
 (
‹¡
 =ğ
d©a
);

92 
rc
 = 
	`¡d_şo£
 (
fd
);

93 
	`ASSERT_TRUE
(
STD_ERR_OK
 =ğ
rc
);

94 
	}
}

97 
	$maš
(
¬gc
, **
¬gv
) {

98 ::
‹¡šg
::
	`In™GoogËTe¡
(&
¬gc
, 
¬gv
);

100  
	`RUN_ALL_TESTS
();

101 
	}
}

	@src/unit_test/nas_pkt_meta_send_ut.cpp

17 
	~"¡d_sock‘_toŞs.h
"

18 
	~"¡d_fe_uts.h
"

19 
	~"Çs_·ck‘_m‘a.h
"

20 
	~"ds_commÚ_ty³s.h
"

21 
	~<¡dio.h
>

24 
	$maš
 ()

26 
sock_fd
 = -1;

27 
t_¡d_”rÜ
 
rc
 = 
	`¡d_sock‘_ü—‹
 (
e_¡d_sock_INET4
, 
e_¡d_sock_ty³_DGRAM
,

28 0, 
NULL
, &
sock_fd
);

29 ià(
rc
 !ğ
STD_ERR_OK
) {

30 
	`´štf
 ("Error creating socket");

33 
	`´štf
 ("Successfully created socket\r\n");

34 
ušt8_t
 
pkt
 [] = {0xbe, 0xef,0xf0, 0x0d};

36 
¡d_sock‘_add»ss_t
 
de¡
;

38 
cÚ¡ex´
 
SOCK_IP
[] = "127.0.0.1";

39 
cÚ¡ex´
 
SOCK_PORT
 = 20055;

40 
	`¡d_sock_addr_äom__¡r
 (
e_¡d_sock_INET4
, 
SOCK_IP
, 
SOCK_PORT
, &
de¡
);

42 
h®_ifšdex_t
 
rx_ifšdex
 = 45;

43 
h®_ifšdex_t
 
tx_ifšdex
 = 50;

44 
ušt64_t
 
§m¶e_couÁ
 = 100;

46 
cÚ¡ex´
 
size_t
 
BUF_SZ
 = 1024;

47 
ušt8_t
 
m‘a_buf
 [
BUF_SZ
];

49 
Çs_pkt_m‘a_©Œ_™_t
 
™
;

50 
	`Çs_pkt_m‘a_buf_š™
 (
m‘a_buf
, (m‘a_buf), &
™
);

51 
	`Çs_pkt_m‘a_add_u32
 (&
™
, 
NAS_PKT_META_RX_PORT
, 
rx_ifšdex
);

52 
	`Çs_pkt_m‘a_add_u32
 (&
™
, 
NAS_PKT_META_TX_PORT
, 
tx_ifšdex
);

53 
	`Çs_pkt_m‘a_add_u64
 (&
™
, 
NAS_PKT_META_SAMPLE_COUNT
,
§m¶e_couÁ
);

54 
	`Çs_pkt_m‘a_add_u32
 (&
™
, 
NAS_PKT_META_PKT_LEN
, (
pkt
));

55 
size_t
 
m‘a_Ën
 = (
m‘a_buf
è- 
™
.
Ën
;

56 
iovec
 
sock_d©a
[] = { {(*)
m‘a_buf
, 
m‘a_Ën
},

57 {
pkt
, (pkt)} };

59 
¡d_sock‘_msg_t
 
sock_msg
 = { &
de¡
.
add»ss
.
š‘4addr
,

60  (
de¡
.
add»ss
.
š‘4addr
),

61 
sock_d©a
,  (sock_data)/ (sock_data[0]),

62 
NULL
, 0, 0};

64 
n
 = 
	`¡d_sock‘_İ
 (
¡d_sock‘_Œªs™_o_WRITE
, 
sock_fd
, &
sock_msg
,

65 
¡d_sock‘_Œªs™_f_NONE
, 0, &
rc
);

66 ià(
n
 < 0) {

67 
	`´štf
 ("[RX] SendMsgo UDP socket %d FAILED - Error %d \r\n",

68 
sock_fd
, 
rc
);

72 
	}
}

	@src/unit_test/nas_stats_ut.cpp

22 
	~"ıs_­i_ev’ts.h
"

23 
	~"ıs_­i_key.h
"

24 
	~"ıs_­i_İ”©iÚ.h
"

25 
	~"ıs_­i_objeù.h
"

26 
	~"ıs_­i_”rÜs.h
"

27 
	~"g‹¡/g‹¡.h
"

28 
	~"ıs_şass_m­.h
"

29 
	~"ŸÇ-if-ty³.h
"

30 
	~"d–l-ba£-if.h
"

31 
	~"d–l-š‹rçû.h
"

32 
	~"›tf-š‹rçûs.h
"

33 
	~"ıs_­i_objeù_key.h
"

35 
	$Çs_¡©_dump_objeù_cÚ‹Á
(
ıs_­i_objeù_t
 
obj
){

36 
ıs_­i_objeù_™_t
 
™
;

37 
	`ıs_­i_objeù_™_begš
(
obj
,&
™
);

39  ; 
	`ıs_­i_objeù_™_v®id
(&
™
è; 
	`ıs_­i_objeù_™_Ãxt
(&it) ) {

40 
¡d
::
cout
<<
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
)<<" "<<

41 
	`ıs_­i_objeù_©Œ_d©a_u64
(
™
.
©Œ
)<<
¡d
::
’dl
;

43 
	}
}

46 
boŞ
 
	$Çs_¡©_g‘_if
(){

48 
ıs_­i_g‘_·¿ms_t
 
gp
;

49 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

51 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

53 ià(
obj
 =ğ
NULL
) {

54 
¡d
::
cout
<<"Cª‚Ù c»©Ãw objeù"<<¡d::
’dl
;

55  
çl£
;

58 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

59 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_STATISTICS_OBJ
, 
ıs_­i_qu®if›r_OBSERVED
);

61 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_STATE_INTERFACE_TYPE
,

62 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
,

63 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
));

65 cÚ¡ *
if_Çme
 = "e101-001-0";

66 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_STATE_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

67 
if_Çme
,
	`¡¾’
(if_name)+1);

69 
boŞ
 
rc
 = 
çl£
;

71 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

73 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

74 
size_t
 
ix
 = 0 ; ix < 
mx
 ; ++ix ) {

75 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
,
ix
);

76 
	`Çs_¡©_dump_objeù_cÚ‹Á
(
obj
);

78 
rc
 = 
Œue
;

81 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

82  
rc
;

83 
	}
}

85 
boŞ
 
	$Çs_¡©_d–_if
(){

87 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

88 if(!
obj
è 
çl£
;

90 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

91 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_STATISTICS_OBJ
, 
ıs_­i_qu®if›r_OBSERVED
);

93 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_STATE_INTERFACE_TYPE
,

94 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
,

95 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_ETHERNETCSMACD
));

97 cÚ¡ *
if_Çme
 = "e101-001-0";

98 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_STATE_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

99 
if_Çme
,
	`¡¾’
(if_name)+1);

101 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_GREEN_DISCARD_DROPPED_PACKETS
,0);

102 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_YELLOW_DISCARD_DROPPED_PACKETS
,0);

103 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_IF_IF_INTERFACES_STATE_INTERFACE_STATISTICS_RED_DISCARD_DROPPED_PACKETS
,0);

105 
ıs_­i_Œª§ùiÚ_·¿ms_t
 
Œ
;

106 if(
	`ıs_­i_Œª§ùiÚ_š™
(&
Œ
)!=
ıs_­i_»t_code_OK
){

107  
çl£
;

110 
	`ıs_­i_d–‘e
(&
Œ
,
obj
);

112 if(
	`ıs_­i_comm™
(&
Œ
)!=
ıs_­i_»t_code_OK
){

113  
çl£
;

116 
	`ıs_­i_Œª§ùiÚ_şo£
(&
Œ
);

118  
Œue
;

119 
	}
}

121 
boŞ
 
	$Çs_¡©_g‘_vÏn
(){

123 
ıs_­i_g‘_·¿ms_t
 
gp
;

124 
	`ıs_­i_g‘_»que¡_š™
(&
gp
);

126 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
gp
.
f‹rs
);

128 ià(
obj
 =ğ
NULL
) {

129 
¡d
::
cout
<<"Cª‚Ù c»©Ãw objeù"<<¡d::
’dl
;

130  
çl£
;

133 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),

134 
DELL_BASE_IF_CMN_IF_INTERFACES_STATE_INTERFACE_STATISTICS_OBJ
, 
ıs_­i_qu®if›r_OBSERVED
);

136 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_STATE_INTERFACE_TYPE
,

137 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

138 (
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
));

140 cÚ¡ *
vÏn_Çme
 = "br1";

141 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_STATE_INTERFACE_NAME
,
ıs_­i_objeù_ATTR_T_BIN
,

142 
vÏn_Çme
,
	`¡¾’
(vlan_name)+1);

145 
boŞ
 
rc
 = 
çl£
;

147 ià(
	`ıs_­i_g‘
(&
gp
)==
ıs_­i_»t_code_OK
) {

149 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
gp
.
li¡
);

150 
size_t
 
ix
 = 0 ; ix < 
mx
 ; ++ix ) {

151 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
gp
.
li¡
,
ix
);

152 
	`Çs_¡©_dump_objeù_cÚ‹Á
(
obj
);

154 
rc
 = 
Œue
;

157 
	`ıs_­i_g‘_»que¡_şo£
(&
gp
);

158  
rc
;

159 
	}
}

162 
	$TEST
(
ıs_­i_ev’ts
,
sæow_‹¡
) {

163 
	`ASSERT_TRUE
(
	`Çs_¡©_g‘_if
());

164 
	`ASSERT_TRUE
(
	`Çs_¡©_g‘_vÏn
());

165 
	`ASSERT_TRUE
(
	`Çs_¡©_d–_if
());

166 
	}
}

169 
	$maš
(
¬gc
, **
¬gv
) {

170 ::
‹¡šg
::
	`In™GoogËTe¡
(&
¬gc
, 
¬gv
);

171  
	`RUN_ALL_TESTS
();

172 
	}
}

	@src/unit_test/tap_main.c

22 
	~"swp_ut_p.h
"

23 
	~<”ºo.h
>

24 
	~<¡dlib.h
>

25 
	~<¡dio.h
>

26 
	~<uni¡d.h
>

28 
	#TAP_ALLOC
 (5)

	)

30 
	$maš
() {

32 
swp_ut_p_desü
 *
ps
 = 
	`swp_ut_®loc_desü
(
TAP_ALLOC
);

34 
ix
 = 0;

35 
mx
 = 
TAP_ALLOC
;

36  ; 
ix
 < 
mx
 ; ++ix ) {

38 
	`swp_ut_p_desü_š™_wÇme
(
ps
[
ix
],"swp",&ix,&ix,&ix,
NULL
,5);

39 ià(
	`swp_ut_®loc_p
(
ps
[
ix
],
SWP_UTIL_TYPE_TAP
,1)<0) {

40 
	`´štf
("Failedo createap... %s",

41 
	`swp_ut_p_desü_g‘_Çme
(
ps
[
ix
]));

43 
	`swp_ut_´št_p
(
ps
[
ix
]);

46 
pktid
 = 0;

49 
fd_£t
 
rds
;

50 
	`FD_ZERO
(&
rds
);

52 
max_fd
 = 
	`swp_ut_p_fd_£t_add
(
ps
,
TAP_ALLOC
,&
rds
);

53 
rc
 = 0;

54 
timev®
 
t
;

55 
t
.
tv_£c
 = 10;

56 
t
.
tv_u£c
 = 0;

57 ià((
rc
=
	`£Ëù
(
max_fd
+1,&
rds
,
NULL
,NULL,&
t
))) {

58 ià(
rc
<0 || 
”ºo
==
EINTR
) ;

59 ià(
rc
==0) ;

60 
ix
 = 0;

61  ; 
ix
 < 
mx
 ; ++ix ) {

63 
fd
 = 
	`swp_ut_p_fd_loÿ‹_äom_£t
(
ps
[
ix
],&
rds
);

64 ià(
fd
<0) ;

65 
	`FD_CLR
(
fd
,&
rds
);

66 
buff
[10000];

68 
Ën
 = 
	`»ad
(
fd
,
buff
,(buff));

70 ià(
Ën
 >0) {

72 
	`´štf
("pkˆfd==%d, %d",
fd
,
pktid
++);

80 
	}
}

	@src/vlan/nas_int_bridge.cpp

22 
	~"Çs_št_bridge.h
"

23 
	~"¡d_mu‹x_lock.h
"

24 
	~"ev’t_log.h
"

25 
	~"ev’t_log_ty³s.h
"

26 
	~"h®_š‹rçû_commÚ.h
"

27 
	~"Çs_št_uts.h
"

28 
	~"Çs_št_vÏn.h
"

29 
	~"Çs_os_vÏn.h
"

30 
	~"ıs_­i_objeù.h
"

31 
	~"¡d_uts.h
"

32 
	~<unÜd”ed_m­
>

33 
	~<¡ddef.h
>

34 
	~<¡dlib.h
>

35 
	~<¡ršg.h
>

37 autØ
	gbridge_li¡
 = 
Ãw
 
bridge_li¡_t
;

38 
	g¡d
::
unÜd”ed_m­
<
h®_ifšdex_t
,¡d::
unÜd”ed_£t
<h®_ifšdex_t>> 
Çs_pÜt_to_vÏns
;

40 
	g¡d
::
	tunÜd”ed_m­
 <
	th®_vÏn_id_t
, 
	th®_ifšdex_t
> 
	tvÏnid_to_bridge_t
;

41 
vÏnid_to_bridge_t
 
	gvid_to_bridge
;

46 
¡d_mu‹x_lock_ü—‹_¡©ic_š™_ç¡
(
br_lock
);

48 
boŞ
 
	$Çs_vÏn_id_š_u£
(
h®_vÏn_id_t
 
vÏn_id
)

50 
boŞ
 
»t
 = 
Œue
;

52 autØ
™”
 = 
vid_to_bridge
.
	`fšd
(
vÏn_id
);

53 ià(
™”
 =ğ
vid_to_bridge
.
	`’d
()){

54 
»t
 = 
çl£
;

56 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Br",

58 
™”
->
£cÚd
, 
vÏn_id
);

60  
»t
;

61 
	}
}

63 
boŞ
 
	$Çs_hªdË_vid_to_br
(
h®_vÏn_id_t
 
vÏn_id
, 
h®_ifšdex_t
 
if_šdex
)

65 ià(
	`Çs_vÏn_id_š_u£
(
vÏn_id
)) {

66 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Br",

67 "FaedØm­ vid %dØbridgid %d", 
vÏn_id
 ,
if_šdex
);

68  
çl£
;

70 
vid_to_bridge
[
vÏn_id
] = 
if_šdex
;

71  
Œue
;

72 
	}
}

74 
	$Çs_d–_vÏn_to_bridge_m­
 (
h®_vÏn_id_t
 
vÏn_id
, 
h®_ifšdex_t
 
if_šdex
) {

76 autØ
™”
 = 
vid_to_bridge
.
	`fšd
(
vÏn_id
);

77 ià(
™”
 !ğ
vid_to_bridge
.
	`’d
()) {

78 
vid_to_bridge
.
	`”a£
(
™”
);

80 
	}
}

83 
t_¡d_”rÜ
 
	$Çs_vÏn_g‘_®l_šfo
(
ıs_­i_objeù_li¡_t
 
li¡
)

86 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

89 ‡utØ
loÿl_™
 = 
bridge_li¡
->
	`begš
();†oÿl_™!ğbridge_li¡->
	`’d
(); ++local_it ) {

90 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
li¡
);

91 
	`Çs_·ck_vÏn_if
(
obj
, &
loÿl_™
->
£cÚd
);

93  
STD_ERR_OK
;

94 
	}
}

96 
	$Çs_bridge_lock
()

98 
	`¡d_mu‹x_lock
 (&
br_lock
);

99 
	}
}

101 
	$Çs_bridge_uÆock
()

103 
	`¡d_mu‹x_uÆock
 (&
br_lock
);

104 
	}
}

106 
	$Çs_upd©e_pÜt_to_vÏns_m­
(cÚ¡ 
h®_ifšdex_t
 
pÜt_idx
, cÚ¡ h®_ifšdex_ˆ
vÏn_idx
, 
boŞ
 
add
) {

107 ià(
add
) {

108 
Çs_pÜt_to_vÏns
[
pÜt_idx
].
	`š£¹
(
vÏn_idx
);

110 ià(
Çs_pÜt_to_vÏns
.
	`fšd
(
pÜt_idx
è!ğÇs_pÜt_to_vÏns.
	`’d
()) {

111 ià(
Çs_pÜt_to_vÏns
[
pÜt_idx
].
	`size
() == 1) {

112 
Çs_pÜt_to_vÏns
.
	`”a£
(
pÜt_idx
);

114 
Çs_pÜt_to_vÏns
[
pÜt_idx
].
	`”a£
(
vÏn_idx
);

120 
	}
}

122 
	$Çs_Ïg_upd©e_vÏn_İ”_¡©e_cb
(
h®_ifšdex_t
 
Ïgif_idx
,

123 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
İ”_¡©us
) {

124 
Çs_bridge_t
 *
vÏn_’Œy
;

126 ià(
Çs_pÜt_to_vÏns
.
	`fšd
(
Ïgif_idx
è!ğÇs_pÜt_to_vÏns.
	`’d
()) {

127 cÚ¡‡utØ&
vÏn_šdex
 : 
Çs_pÜt_to_vÏns
[
Ïgif_idx
]) {

129 ià((
vÏn_’Œy
 = 
	`Çs_g‘_bridge_node
(
vÏn_šdex
)è=ğ
NULL
) {

133 ià(
İ”_¡©us
 =ğ
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
) {

134 
vÏn_’Œy
->
İ”_li¡
[
Ïgif_idx
] = 
Œue
;

135 
vÏn_’Œy
->
İ”_¡©us
 = oper_status;

137 
vÏn_’Œy
->
İ”_li¡
[
Ïgif_idx
] = 
çl£
;

138 
vÏn_’Œy
->
İ”_¡©us
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
;

139 cÚ¡‡utØ&
İ”_¡©us
 : 
vÏn_’Œy
->
İ”_li¡
) {

140 ià(
İ”_¡©us
.
£cÚd
) {

141 
vÏn_’Œy
->
İ”_¡©us
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
;

151 
	}
}

153 
	$Çs_pÜt_upd©e_vÏn_İ”_¡©e_cb
(
Åu_id_t
 
Åu
, 
Åu_pÜt_t
 
pÜt
,

154 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
İ”_¡©us
) {

155 
h®_ifšdex_t
 
pÜt_šdex
;

156 
Çs_bridge_t
 *
vÏn_’Œy
;

157 
ndi_pÜt_t
 
ndi_pÜt
;

158 
ndi_pÜt
.
Åu_id
 = 
Åu
;

159 
ndi_pÜt
.
Åu_pÜt
 = 
pÜt
;

161 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-CPS-LAG",

164 ià(
	`Çs_št_g‘_if_šdex_äom_Åu_pÜt
(&
pÜt_šdex
, &
ndi_pÜt
è!ğ
STD_ERR_OK
) {

168 ià(
Çs_pÜt_to_vÏns
.
	`fšd
(
pÜt_šdex
è!ğÇs_pÜt_to_vÏns.
	`’d
()) {

169 cÚ¡‡utØ&
vÏn_šdex
 : 
Çs_pÜt_to_vÏns
[
pÜt_šdex
]) {

171 ià((
vÏn_’Œy
 = 
	`Çs_g‘_bridge_node
(
vÏn_šdex
)è=ğ
NULL
) {

175 ià(
İ”_¡©us
 =ğ
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
) {

176 
vÏn_’Œy
->
İ”_li¡
[
pÜt_šdex
] = 
Œue
;

177 
vÏn_’Œy
->
İ”_¡©us
 = oper_status;

179 
vÏn_’Œy
->
İ”_li¡
[
pÜt_šdex
] = 
çl£
;

180 
vÏn_’Œy
->
İ”_¡©us
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
;

181 cÚ¡‡utØ&
İ”_¡©us
 : 
vÏn_’Œy
->
İ”_li¡
) {

182 ià(
İ”_¡©us
.
£cÚd
) {

183 
vÏn_’Œy
->
İ”_¡©us
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
;

193 
	}
}

195 
Çs_bridge_t
 *
	$Çs_g‘_bridge_node
(
h®_ifšdex_t
 
šdex
)

198 autØ
™
 = 
bridge_li¡
->
	`fšd
(
šdex
);

200 ià(
™
 =ğ
bridge_li¡
->
	`’d
()) {

201 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Br","E¼Ü fšdšg bridgštà%d", 
šdex
);

202  
NULL
;

204 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Br", "Found Bridgnod%d", 
šdex
);

205  &
™
->
£cÚd
;

206 
	}
}

208 
Çs_bridge_t
 *
	$Çs_g‘_bridge_node_äom_vid
 (
h®_vÏn_id_t
 
vÏn_id
) {

209 autØ
™”
 = 
vid_to_bridge
.
	`fšd
(
vÏn_id
);

210 ià(
™”
 =ğ
vid_to_bridge
.
	`’d
()){

211  
NULL
;

213  (
	`Çs_g‘_bridge_node
(
vid_to_bridge
[
vÏn_id
]));

215 
	}
}

217 
Çs_bridge_t
 *
	$Çs_g‘_bridge_node_äom_Çme
 (cÚ¡ *
vÏn_if_Çme
)

219 ià(
vÏn_if_Çme
 =ğ
NULL
)  NULL;

220 
h®_ifšdex_t
 
if_šdex
;

221 ià(
	`Çs_št_Çme_to_if_šdex
(&
if_šdex
, 
vÏn_if_Çme
è=ğ
STD_ERR_OK
) {

222 (
	`Çs_g‘_bridge_node
(
if_šdex
));

224  
NULL
;

225 
	}
}

227 
Çs_bridge_t
* 
	$Çs_ü—‹_š£¹_bridge_node
(
h®_ifšdex_t
 
šdex
, cÚ¡ *
Çme
, 
boŞ
 &
ü—‹
)

229 
Çs_bridge_t
 *
p_bridge_node
;

231 
p_bridge_node
 = 
	`Çs_g‘_bridge_node
(
šdex
);

232 
ü—‹
 = 
çl£
;

234 ià(
p_bridge_node
 =ğ
NULL
) {

235 
Çs_bridge_t
 
node
;

236 
	`mem£t
(&
node
, 0, (node));

237 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Br",

238 "Bridgštà%d c»©ed", 
šdex
);

239 
node
.
ifšdex
 = 
šdex
;

240 
node
.
İ”_¡©us
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
;

241 
node
.
İ”_li¡
 = 
	`Çs_vÏn_pÜt_İ”_¡©us_t
();

242 
	`§ã¡ºıy
(
node
.
Çme
,‚ame, (node.name));

244 
bridge_li¡
->
	`š£¹
({
šdex
,
node
});

245 
Çs_bridge_t
 *
p_node
 = &
bridge_li¡
->
	`©
(
šdex
);

246 
	`¡d_dÎ_š™
 (&
p_node
->
gged_li¡
.
pÜt_li¡
);

247 
	`¡d_dÎ_š™
 (&
p_node
->
uÁagged_li¡
.
pÜt_li¡
);

248 
	`¡d_dÎ_š™
 (&
p_node
->
uÁagged_Ïg
.
pÜt_li¡
);

249 
	`¡d_dÎ_š™
 (&
p_node
->
gged_Ïg
.
pÜt_li¡
);

250 
ü—‹
 = 
Œue
;

251 
	`Çs_os_£t_bridge_deçuÉ_mac_agešg
(
šdex
);

252  
p_node
;

254 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Br",

255 "Bridgštàšdex %d‡Ì—dyƒxi¡s", 
šdex
);

257  
p_bridge_node
;

258 
	}
}

260 
t_¡d_”rÜ


261 
	$Çs_hªdË_vÏn_mem_li¡_d–‘e
(
h®_ifšdex_t
 
bridge_šdex
, 
Çs_li¡_t
 *
p_li¡
,

262 
h®_vÏn_id_t
 
vid
, 
Çs_pÜt_mode_t
 
pÜt_mode
, 
boŞ
 
Ïg
) {

265 
Çs_li¡_node_t
 *
p_™”_node
 = 
NULL
, *
‹mp_node
 = NULL;

266 
t_¡d_”rÜ
 
»t
;

268 
p_™”_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&
p_li¡
->
pÜt_li¡
);

269 
p_™”_node
 !ğ
NULL
)

271 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

272 "d–‘memeb” :Found vÏÀmemb” %d iÀbridg%d", 
p_™”_node
->
ifšdex
, 
bridge_šdex
);

273 
‹mp_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_li¡
->
pÜt_li¡
, 
p_™”_node
);

275 ià(
Ïg
) {

276 ià((
»t
 = 
	`Çs_d–‘e_Ïg_äom_vÏn_š_Åu
(
p_™”_node
->
ifšdex
 , 
vid
, 
pÜt_mode
)è!ğ
STD_ERR_OK
) {

277  
»t
;

280 ià(!
	`Çs_is_nÚ_Åu_phy_pÜt
(
p_™”_node
->
ifšdex
)) {

281 ià(
	`Çs_add_Ü_d–_pÜt_to_vÏn
(
p_™”_node
->
ndi_pÜt
.
Åu_id
, 
vid
,

282 &(
p_™”_node
->
ndi_pÜt
), 
pÜt_mode
, 
çl£
,…_™”_node->
ifšdex
)

283 !ğ
STD_ERR_OK
) {

284 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

285 "E¼Ü d–‘šg…Üˆ%d w™h mod%d from vÏÀ%d", 
p_™”_node
->
ifšdex
,

286 
pÜt_mode
, 
vid
);

287  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

291 
	`Çs_d–‘e_lšk_node
(&
p_li¡
->
pÜt_li¡
, 
p_™”_node
);

292 
p_™”_node
 = 
‹mp_node
;

293 
p_li¡
->
pÜt_couÁ
--;

295  
STD_ERR_OK
;

296 
	}
}

298 
t_¡d_”rÜ


299 
	$Çs_hªdË_d–‘e_®l_mem
(
Çs_bridge_t
 *
p_bridge
)

301 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

303 ià((
rc
 = 
	`Çs_hªdË_vÏn_mem_li¡_d–‘e
(
p_bridge
->
ifšdex
, &p_bridge->
gged_li¡
,…_bridge->
vÏn_id
, 
NAS_PORT_TAGGED
, 
çl£
))

304 !ğ
STD_ERR_OK
 ) {

305  
rc
;

308 ià((
rc
 = 
	`Çs_hªdË_vÏn_mem_li¡_d–‘e
(
p_bridge
->
ifšdex
, &p_bridge->
gged_Ïg
,…_bridge->
vÏn_id
, 
NAS_PORT_TAGGED
, 
Œue
))

309 !ğ
STD_ERR_OK
 ) {

310  
rc
;

312 ià((
rc
 = 
	`Çs_hªdË_vÏn_mem_li¡_d–‘e
(
p_bridge
->
ifšdex
, &p_bridge->
uÁagged_li¡
,p_bridge->
vÏn_id
, 
NAS_PORT_UNTAGGED
, 
çl£
))

313 !ğ
STD_ERR_OK
 ) {

314  
rc
;

316 ià((
rc
 = 
	`Çs_hªdË_vÏn_mem_li¡_d–‘e
(
p_bridge
->
ifšdex
, &p_bridge->
uÁagged_Ïg
,p_bridge->
vÏn_id
, 
NAS_PORT_UNTAGGED
, 
Œue
))

317 !ğ
STD_ERR_OK
 ) {

318  
rc
;

320  
rc
;

321 
	}
}

323 
t_¡d_”rÜ


324 
	$Çs_ş—nup_bridge
(
Çs_bridge_t
 *
p_bridge_node
)

326 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

328 if((
p_bridge_node
->
vÏn_id
 !ğ0è&& (p_bridge_node->vÏn_id !ğ
SYSTEM_DEFAULT_VLAN
)) {

330 ià(
	`Çs_hªdË_d–‘e_®l_mem
(
p_bridge_node
è!ğ
STD_ERR_OK
) {

331 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Br",

333 
p_bridge_node
->
vÏn_id
,…_bridge_node->
ifšdex
);

334 
rc
 = (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

336 if(
	`Çs_vÏn_d–‘e
(0, 
p_bridge_node
->
vÏn_id
è!ğ
STD_ERR_OK
) {

337 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Br",

339 
p_bridge_node
->
vÏn_id
,…_bridge_node->
ifšdex
);

340 
rc
 = (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

346 if(
p_bridge_node
->
vÏn_id
 !=0 ) {

347 if(
	`Çs_publish_vÏn_objeù
(
p_bridge_node
, 
ıs_­i_İ”_DELETE
)!ğ
ıs_­i_»t_code_OK
)

349 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

352 if(
	`Çs_»gi¡”_vÏn_štf
(
p_bridge_node
, 
HAL_INTF_OP_DEREG
è!ğ
STD_ERR_OK
) {

353 
rc
 = (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

355 
	`Çs_d–_vÏn_to_bridge_m­
(
p_bridge_node
->
vÏn_id
,…_bridge_node->
ifšdex
);

358 
bridge_li¡
->
	`”a£
(
p_bridge_node
->
ifšdex
);

359  
rc
;

360 
	}
}

361 
t_¡d_”rÜ
 
	$Çs_d–‘e_bridge
(
h®_ifšdex_t
 
šdex
)

363 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

365 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Br",

366 "Bridgštà%d fÜ d–‘iÚ", 
šdex
);

368 
	`Çs_bridge_lock
();

370 
Çs_bridge_t
 *
p_bridge_node
 = 
	`Çs_g‘_bridge_node
(
šdex
);

371 ià(
p_bridge_node
==
NULL
) {

372 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Br",

373 "E¼Ü fšdšg bridg%d fÜ d–‘iÚ", 
šdex
);

374 
rc
 = (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

378 if(
	`Çs_ş—nup_bridge
(
p_bridge_node
è!ğ
STD_ERR_OK
) {

379 
rc
 = (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

384 
	`Çs_bridge_uÆock
();

385  
rc
;

386 
	}
}

	@src/vlan/nas_int_vlan.cpp

22 
	~"Çs_ndi_vÏn.h
"

23 
	~"Çs_št_bridge.h
"

24 
	~"Çs_št_vÏn.h
"

25 
	~"Çs_št_pÜt.h
"

26 
	~"ev’t_log.h
"

27 
	~"ev’t_log_ty³s.h
"

28 
	~"Çs_št_uts.h
"

29 
	~"Çs_ndi_pÜt.h
"

30 
	~"d–l-ba£-if-vÏn.h
"

31 
	~"d–l-ba£-if.h
"

32 
	~"d–l-š‹rçû.h
"

33 
	~"ŸÇ-if-ty³.h
"

34 
	~"Çs_ndi_sw™ch.h
"

35 
	~"Çs_os_š‹rçû.h
"

36 
	~"ıs_­i_objeù_key.h
"

37 
	~"ıs_­i_ev’ts.h
"

38 
	~"ıs_şass_m­.h
"

39 
	~"Çs_sw™ch.h
"

40 
	~"¡d_mac_uts.h
"

41 
	~"h®_š‹rçû_commÚ.h
"

42 
	~"ŸÇ-if-ty³.h
"

43 
	~"Çs_if_uts.h
"

44 
	~"Çs_št_ba£_if.h
"

46 
	~<¡dlib.h
>

47 
	~<¡dio.h
>

48 
	~<¡ršg.h
>

51 cÚ¡ 
	gMAX_CPS_MSG_BUFF
=10000;

53 
t_¡d_”rÜ
 
	$Çs_check_štf_vÏn_memb”sh
(
Çs_bridge_t
 *
p_bridge_node
, 
h®_ifšdex_t
 
ifšdex
,

54 
Çs_pÜt_mode_t
 
pÜt_mode
, 
Çs_št_ty³_t
 
štf_ty³
,

55 
boŞ
 *
is_memb”
)

57 
Çs_li¡_t
 *
memb”s
 = 
NULL
;

58 ià(
p_bridge_node
 =ğ
NULL
) {

59  
	`STD_ERR
(
INTERFACE
, 
PARAM
, 0);

61 ià((
štf_ty³
 =ğ
Çs_št_ty³_PORT
è|| (štf_ty³ =ğ
Çs_št_ty³_FC
)) {

62 if(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

63 
memb”s
 = &
p_bridge_node
->
gged_li¡
;

65 
memb”s
 = &
p_bridge_node
->
uÁagged_li¡
;

67 } ià(
štf_ty³
 =ğ
Çs_št_ty³_LAG
) {

68 if(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

69 
memb”s
 = &
p_bridge_node
->
gged_Ïg
;

71 
memb”s
 = &
p_bridge_node
->
uÁagged_Ïg
;

74 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VÏn", "wrÚgy³ oàthš‹rçû %d bridg%dy³ %d ", 
ifšdex
,

75 
p_bridge_node
->
ifšdex
, 
štf_ty³
);

76  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

79 
Çs_li¡_node_t
 *
p_lšk_node
 = 
	`Çs_g‘_lšk_node
(&
memb”s
->
pÜt_li¡
, 
ifšdex
);

80 ià(
p_lšk_node
 =ğ
NULL
) {

81 *
is_memb”
 = 
çl£
;

83 *
is_memb”
 = 
Œue
;

85  
STD_ERR_OK
;

86 
	}
}

89 
ıs_­i_»tuº_code_t
 
	$Çs_publish_vÏn_pÜt_li¡
(
Çs_bridge_t
 *
p_bridge_node
, 
Çs_pÜt_li¡_t
 &
pÜt_li¡
,

90 
Çs_pÜt_mode_t
 
pÜt_mode
, 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
)

92 
buff
[
MAX_CPS_MSG_BUFF
];

93 
	`mem£t
(
buff
,0,(buff));

94 
id
 = 0;

95 
ıs_­i_objeù_t
 
obj_pub
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

97 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VLAN","VLAN…ublishƒvent oper %d for VLAN %d",

98 
İ
, 
p_bridge_node
->
vÏn_id
);

100 if(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

101 
id
 = 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
;

104 
id
 = 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
;

107 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj_pub
), 
id
,

108 
ıs_­i_qu®if›r_OBSERVED
);

110 
	`ıs_­i_£t_key_d©a
(
obj_pub
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
ıs_­i_objeù_ATTR_T_U32
,

111 &
p_bridge_node
->
ifšdex
, (p_bridge_node->ifindex));

113 
	`ıs_­i_objeù_£t_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj_pub
),
İ
);

115 ‡utØ
™
 = 
pÜt_li¡
.
	`begš
(); iˆ!ğpÜt_li¡.
	`’d
();++it) {

116 
	`ıs_­i_objeù_©Œ_add_u32
(
obj_pub
, 
id
, *
™
);

119 
	`ıs_­i_objeù_©Œ_add_u32
(
obj_pub
, 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
, 
p_bridge_node
->
vÏn_id
);

121 ià(
	`ıs_­i_ev’t_th»ad_publish
(
obj_pub
)!=
STD_ERR_OK
) {

122 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-VLAN","Failedo send VLAN…ublishƒvent. Service issue");

123  
ıs_­i_»t_code_ERR
;

125  
ıs_­i_»t_code_OK
;

126 
	}
}

128 
t_¡d_”rÜ
 
	$Çs_vÏn_ü—‹
(
Åu_id_t
 
Åu_id
, 
h®_vÏn_id_t
 
vÏn_id
)

130 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

131 "C»©šg VLAN %d iÀNPU %d", 
vÏn_id
, 
Åu_id
);

133  (
	`ndi_ü—‹_vÏn
(
Åu_id
, 
vÏn_id
));

134 
	}
}

136 
	$Çs_hªdË_bridge_mac
(
Çs_bridge_t
 *
b_node
)

138 
buff
[
MAX_CPS_MSG_BUFF
];

139 
mac_¡r
[
MAC_STRING_SZ
];

141 
	`mem£t
(
buff
,0,
MAX_CPS_MSG_BUFF
);

142 
	`mem£t
(
mac_¡r
,0,
MAC_STRING_SZ
);

143 ià(
	`Çs_if_g‘_assigÃd_mac
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

144 
b_node
->
Çme
, b_node->
vÏn_id
, 
mac_¡r
, (mac_str))

145 !ğ
STD_ERR_OK
) {

146 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 , "NAS-Vlan",

150 
ıs_­i_objeù_t
 
Çme_obj
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

151 
	`ıs_­i_£t_key_d©a
(
Çme_obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
ıs_­i_objeù_ATTR_T_U32
,

152 &
b_node
->
ifšdex
,(b_node->ifindex));

153 
	`ıs_­i_objeù_©Œ_add
(
Çme_obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
,

154 
mac_¡r
 ,
	`¡¾’
(mac_str)+1);

155 
	`Çs_ıs_£t_vÏn_mac
(
Çme_obj
, 
b_node
);

156 
	}
}

158 
	g¡d
::
·œ
<
boŞ
, 
	gboŞ
> 
	$Çs_g‘_štf_·ck‘_drİ
(
h®_ifšdex_t
 
ifšdex
)

160 
uÁagged_út
 = 0, 
gged_út
 = 0;

161 autØ
ma¡”_cb
 = [&
uÁagged_út
, &
gged_út
](
if_ma¡”_šfo_t
 
m_šfo
) {

162 ià(
m_šfo
.
ty³
 !ğ
Çs_št_ty³_VLAN
) {

165 ià(
m_šfo
.
mode
 =ğ
NAS_PORT_UNTAGGED
 || m_šfo.mod=ğ
NAS_PORT_HYBRID
) {

166 
uÁagged_út
 ++;

168 ià(
m_šfo
.
mode
 =ğ
NAS_PORT_TAGGED
 || m_šfo.mod=ğ
NAS_PORT_HYBRID
) {

169 
gged_út
 ++;

172 
	`Çs_štf_ma¡”_ÿÎback
(
ifšdex
, 
ma¡”_cb
);

173 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan", "Interface with ifindex %d is untagged member of %d bridges‡nd \
 member of %d bridges",

175 
ifšdex
, 
uÁagged_út
, 
gged_út
);

176 
boŞ
 
drİ_uÁag
 = 
Œue
, 
drİ_g
 =rue;

177 ià(
uÁagged_út
 > 0) {

178 
drİ_uÁag
 = 
çl£
;

180 ià(
gged_út
 > 0) {

181 
drİ_g
 = 
çl£
;

183 ià(
uÁagged_út
 =ğ0 && 
gged_út
 == 0) {

184 
drİ_uÁag
 = 
drİ_g
 = 
çl£
;

186  
¡d
::
	`make_·œ
(
drİ_uÁag
, 
drİ_g
);

187 
	}
}

189 
t_¡d_”rÜ
 
	$Çs_add_Ü_d–_pÜt_to_vÏn
(
Åu_id_t
 
Åu_id
, 
h®_vÏn_id_t
 
vÏn_id
,

190 
ndi_pÜt_t
 *
p_ndi_pÜt
, 
Çs_pÜt_mode_t
 
pÜt_mode
,

191 
boŞ
 
add_pÜt
, 
h®_ifšdex_t
 
ifšdex
)

193 
ndi_pÜt_li¡_t
 
ndi_pÜt_li¡
;

194 
ndi_pÜt_li¡_t
 *
uÁag_li¡
 = 
NULL
;

195 
ndi_pÜt_li¡_t
 *
g_li¡
 = 
NULL
;

197 
ndi_pÜt_li¡
.
pÜt_couÁ
 = 1;

198 
ndi_pÜt_li¡
.
pÜt_li¡
 =
p_ndi_pÜt
;

199 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

200 
Çs_bridge_t
 *
vÏn_’Œy
 = 
	`Çs_g‘_bridge_node_äom_vid
(
vÏn_id
);

202 ià(!
vÏn_’Œy
) {

203  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

206 ià(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

207 
g_li¡
 = &
ndi_pÜt_li¡
;

210 
uÁag_li¡
 = &
ndi_pÜt_li¡
;

213 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

214 "Upd©šg VLAN memb”: % % pÜˆ<%d %d> % VLAN %d", (
add_pÜt
 ? "add" : "delete"),

215 
p_ndi_pÜt
->
Åu_id
,…_ndi_pÜt->
Åu_pÜt
, (
add_pÜt
 ? "from" : "to"),

216 (
pÜt_mode
 =ğ
NAS_PORT_TAGGED
 ? "tagged" : "untagged"),

217 
vÏn_id
);

219 ià(
	`ndi_add_Ü_d–_pÜts_to_vÏn
(
Åu_id
, 
vÏn_id
, 
g_li¡
, 
uÁag_li¡
, 
add_pÜt
)

220 !ğ
STD_ERR_OK
) {

221  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

224 ià(
pÜt_mode
 =ğ
NAS_PORT_UNTAGGED
) {

225 ià(
add_pÜt
) {

226 ià((
rc
 = 
	`ndi_£t_pÜt_vid
(
Åu_id
, 
p_ndi_pÜt
->
Åu_pÜt
, 
vÏn_id
)è!ğ
STD_ERR_OK
) {

227 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Port",

229 
Åu_id
, 
p_ndi_pÜt
->
Åu_pÜt
);

234 autØ
pkt_drİ
 = 
	`Çs_g‘_štf_·ck‘_drİ
(
ifšdex
);

235 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

237 
p_ndi_pÜt
->
Åu_id
,…_ndi_pÜt->
Åu_pÜt
,

238 
pkt_drİ
.
fœ¡
 ? "drop" : "not drop",

239 
pkt_drİ
.
£cÚd
 ? "drop" : "not drop");

240 ià((
rc
 = 
	`ndi_pÜt_£t_·ck‘_drİ
(
Åu_id
, 
p_ndi_pÜt
->
Åu_pÜt
,

241 
NDI_PORT_DROP_UNTAGGED
, 
pkt_drİ
.
fœ¡
)è!ğ
STD_ERR_OK
) {

242 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Port",

244 
Åu_id
, 
p_ndi_pÜt
->
Åu_pÜt
);

246 ià((
rc
 = 
	`ndi_pÜt_£t_·ck‘_drİ
(
Åu_id
, 
p_ndi_pÜt
->
Åu_pÜt
,

247 
NDI_PORT_DROP_TAGGED
, 
pkt_drİ
.
£cÚd
)è!ğ
STD_ERR_OK
) {

248 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Port",

250 
Åu_id
, 
p_ndi_pÜt
->
Åu_pÜt
);

253 
ndi_štf_lšk_¡©e_t
 
lšk_¡©e
;

254 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_t
 
İ”_¡©e
;

255 
rc
 = 
	`ndi_pÜt_lšk_¡©e_g‘
(
p_ndi_pÜt
->
Åu_id
,…_ndi_pÜt->
Åu_pÜt
, &
lšk_¡©e
);

256 
h®_ifšdex_t
 
pÜt_idx
;

258 ià(
	`Çs_št_g‘_if_šdex_äom_Åu_pÜt
(&
pÜt_idx
, 
p_ndi_pÜt
è!ğ
STD_ERR_OK
) {

259  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

262 ià(
rc
 !ğ
STD_ERR_OK
) {

263  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

266 ià(
add_pÜt
) {

268 
İ”_¡©e
 = 
	`ndi_to_ıs_İ”_ty³
(
lšk_¡©e
.
İ”_¡©us
);

269 ià(
İ”_¡©e
 =ğ
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
) {

270 (
vÏn_’Œy
->
İ”_li¡
)[
pÜt_idx
] = 
Œue
;

271 
vÏn_’Œy
->
İ”_¡©us
 = 
İ”_¡©e
;

273 (
vÏn_’Œy
->
İ”_li¡
)[
pÜt_idx
] = 
çl£
;

275 
	`Çs_upd©e_pÜt_to_vÏns_m­
(
pÜt_idx
, 
vÏn_’Œy
->
ifšdex
, 
Œue
);

279 (
vÏn_’Œy
->
İ”_li¡
).
	`”a£
(
pÜt_idx
);

280 
vÏn_’Œy
->
İ”_¡©us
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
;

281 cÚ¡‡utØ&
İ”_¡©us
: 
vÏn_’Œy
->
İ”_li¡
) {

282 ià(
İ”_¡©us
.
£cÚd
) {

283 
vÏn_’Œy
->
İ”_¡©us
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
;

287 
	`Çs_upd©e_pÜt_to_vÏns_m­
(
pÜt_idx
, 
vÏn_’Œy
->
ifšdex
, 
çl£
);

290  
STD_ERR_OK
;

292 
	}
}

294 
t_¡d_”rÜ
 
	$Çs_vÏn_d–‘e
(
Åu_id_t
 
Åu_id
, 
h®_vÏn_id_t
 
vÏn_id
)

296  (
	`ndi_d–‘e_vÏn
(
Åu_id
, 
vÏn_id
));

297 
	}
}

299 
t_¡d_”rÜ
 
Çs_add_pÜt_li¡_to_vÏn
(
Åu_id_t
 
Åu_id
, 
h®_vÏn_id_t
 
vÏn_id
,

300 cÚ¡ 
¡d
::
veùÜ
<¡d::
·œ
<
ndi_pÜt_t
, 
h®_ifšdex_t
>>& 
pÜt_li¡
,

301 
boŞ
 
gged_pÜt_li¡
)

303 
t_¡d_”rÜ
 
	grc
 = 
STD_ERR_OK
;

304 
	g¡d
::
veùÜ
<
ndi_pÜt_t
> 
tmp_pÜt_li¡
{};

305 auto& 
	gpÜt_šfo
: 
pÜt_li¡
) {

306 
tmp_pÜt_li¡
.
push_back
(
pÜt_šfo
.
fœ¡
);

308 
ndi_pÜt_li¡_t
 
	gndi_pÜt_li¡
{
	gtmp_pÜt_li¡
.
size
(),mp_pÜt_li¡.
d©a
()};

309 ià(
	ggged_pÜt_li¡
) {

310 ià((
	grc
 = 
ndi_add_Ü_d–_pÜts_to_vÏn
(
Åu_id
, 
vÏn_id
, &
ndi_pÜt_li¡
, 
NULL
, 
Œue
))

311 !ğ
STD_ERR_OK
)

312  
rc
;

315 ià((
	grc
 = 
ndi_add_Ü_d–_pÜts_to_vÏn
(
Åu_id
, 
vÏn_id
, 
NULL
, &
ndi_pÜt_li¡
, 
Œue
))

316 !ğ
STD_ERR_OK
)

317  
rc
;

319 auto& 
	gpÜt_šfo
: 
pÜt_li¡
) {

320 
Åu_pÜt_t
 
pÜt_id
 = 
pÜt_šfo
.
fœ¡
.
Åu_pÜt
;

321 autØ
	gpkt_drİ
 = 
Çs_g‘_štf_·ck‘_drİ
(
pÜt_šfo
.
£cÚd
);

322 
EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Port",

324 
Åu_id
, 
pÜt_id
,

325 
pkt_drİ
.
fœ¡
 ? "drop" : "not drop",

326 
pkt_drİ
.
£cÚd
 ? "drop" : "not drop");

327 
	grc
 = 
ndi_pÜt_£t_·ck‘_drİ
(
Åu_id
, 
pÜt_id
, 
NDI_PORT_DROP_UNTAGGED
, 
pkt_drİ
.
fœ¡
);

328 ià(
	grc
 !ğ
STD_ERR_OK
) {

329 
EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Port", "Failedo disable untagged drop for…ort <%d %d>",

330 
Åu_id
, 
pÜt_id
);

332 
	grc
 = 
ndi_pÜt_£t_·ck‘_drİ
(
Åu_id
, 
pÜt_id
, 
NDI_PORT_DROP_TAGGED
, 
pkt_drİ
.
£cÚd
);

333 ià(
	grc
 !ğ
STD_ERR_OK
) {

334 
EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Port", "Failedo disable untagged drop for…ort <%d %d>",

335 
Åu_id
, 
pÜt_id
);

338  
	gSTD_ERR_OK
;

341 
t_¡d_”rÜ
 
	$Çs_vÏn_g‘_štf_ù¾_šfo
(
h®_ifšdex_t
 
šdex
, 
š‹rçû_ù¾_t
 &
i
){

342 
t_¡d_”rÜ
 
rc
;

343 
	`mem£t
(&
i
,0,(i));

344 
i
.
if_šdex
 = 
šdex
;

345 
i
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

346 ià((
rc
 = 
	`dn_h®_g‘_š‹rçû_šfo
(&
i
)è!ğ
STD_ERR_OK
){

347 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

349 "š‹rçû %d", 
šdex
);

350  
rc
;

352  
STD_ERR_OK
;

354 
	}
}

357 
Çs_cİy_bridge_pÜts_to_ndi_pÜt_li¡
(
¡d_dÎ_h—d
 *
p_pÜt_li¡
,

358 
¡d
::
veùÜ
<¡d::
·œ
<
ndi_pÜt_t
, 
h®_ifšdex_t
>>& 
ndi_pÜts
)

360 
Çs_li¡_node_t
 *
	gp_lšk_™”_node
 = 
NULL
, *
	gp_‹mp_node
 = NULL;

362 
	gp_lšk_™”_node
 = 
Çs_g‘_fœ¡_lšk_node
(
p_pÜt_li¡
);

364 
	gp_lšk_™”_node
 !ğ
NULL
)

366 
EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

368 
p_lšk_™”_node
->
ndi_pÜt
.
Åu_pÜt
);

369 
	gndi_pÜts
.
push_back
(
¡d
::
make_·œ
(
p_lšk_™”_node
->
ndi_pÜt
,…_lšk_™”_node->
ifšdex
));

371 
	gp_‹mp_node
 = 
p_lšk_™”_node
;

372 
	gp_lšk_™”_node
 = 
Çs_g‘_Ãxt_lšk_node
(
p_pÜt_li¡
, 
p_‹mp_node
);

377 
t_¡d_”rÜ
 
	$Çs_add_®l_ut_pÜts_to_vÏn
(
Çs_bridge_t
 *
p_bridge_node
)

379 
size_t
 
pÜt_couÁ
 = 
p_bridge_node
->
uÁagged_li¡
.port_count;

380 
Åu_id
 = 0;

381 
Çs_li¡_node_t
 *
p_™”_node
 = 
NULL
;

383 
t_¡d_”rÜ
 
”r
 = 
STD_ERR_OK
;

385 ià(
pÜt_couÁ
 != 0) {

387 
¡d
::
veùÜ
<¡d::
·œ
<
ndi_pÜt_t
, 
h®_ifšdex_t
>> 
pÜt_li¡
{};

388 
	`Çs_cİy_bridge_pÜts_to_ndi_pÜt_li¡
(&
p_bridge_node
->
uÁagged_li¡
.
pÜt_li¡
,

389 
pÜt_li¡
);

392 ià(
	`Çs_add_pÜt_li¡_to_vÏn
(
Åu_id
, 
p_bridge_node
->
vÏn_id
,

393 
pÜt_li¡
,

394 
çl£
è!ğ
STD_ERR_OK
) {

395 
”r
 = (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

399 
p_™”_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&
p_bridge_node
->
uÁagged_li¡
.
pÜt_li¡
);

401 
p_™”_node
 !ğ
NULL
)

403 
	`ndi_£t_pÜt_vid
(
p_™”_node
->
ndi_pÜt
.
Åu_id
,

404 
p_™”_node
->
ndi_pÜt
.
Åu_pÜt
, 
p_bridge_node
->
vÏn_id
);

405 
p_™”_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_bridge_node
->
uÁagged_li¡
.
pÜt_li¡
,

406 
p_™”_node
);

411  
”r
;

412 
	}
}

414 
t_¡d_”rÜ
 
	$Çs_add_®l_ut_Ïgs_to_vÏn
(
Çs_bridge_t
 *
p_bridge_node
)

416 
Çs_li¡_node_t
 *
p_™”_node
 = 
NULL
;

417 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

419 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

420 "Checkšg uÁagged bÚd†i¡ iÀbridg%d", 
p_bridge_node
->
ifšdex
);

422 
p_™”_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&
p_bridge_node
->
uÁagged_Ïg
.
pÜt_li¡
);

424 
p_™”_node
 !ğ
NULL
)

426 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

427 "Found uÁagged bÚd %d iÀbridg%d", 
p_™”_node
->
ifšdex
,

428 
p_bridge_node
->
ifšdex
);

430 if((
rc
 = 
	`Çs_hªdË_Ïg_add_to_vÏn
(
p_bridge_node
, 
p_™”_node
->
ifšdex
,

431 
NAS_PORT_UNTAGGED
, 
çl£
, 
nuÎ±r
)è!ğ
STD_ERR_OK
) {

432 
rc
 = 
	`STD_ERR
(
INTERFACE
,
FAIL
,„c);

434 
p_™”_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_bridge_node
->
uÁagged_Ïg
.
pÜt_li¡
,

435 
p_™”_node
);

437  
rc
;

438 
	}
}

440 
t_¡d_”rÜ
 
	$Çs_´oûss_Ïg_fÜ_vÏn_d–
(
Çs_li¡_t
 *
p_li¡
,

441 
h®_ifšdex_t
 
if_šdex
)

443 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
;

445 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

447 
if_šdex
);

449 
p_lšk_node
 = 
	`Çs_g‘_lšk_node
(&
p_li¡
->
pÜt_li¡
, 
if_šdex
);

450 ià(
p_lšk_node
) {

451 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

453 
if_šdex
);

455 
	`Çs_d–‘e_lšk_node
(&
p_li¡
->
pÜt_li¡
, 
p_lšk_node
);

456 
p_li¡
->
pÜt_couÁ
--;

458  
STD_ERR_OK
;

459 
	}
}

460 
t_¡d_”rÜ
 
	$Çs_´oûss_li¡_fÜ_vÏn_d–
(
Çs_bridge_t
 *
p_bridge
,

461 
Çs_li¡_t
 *
p_li¡
,

462 
h®_ifšdex_t
 
if_šdex
,

463 
h®_vÏn_id_t
 
vÏn_id
,

464 
Çs_pÜt_mode_t
 
pÜt_mode
)

466 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
;

467 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

469 
p_lšk_node
 = 
	`Çs_g‘_lšk_node
(&
p_li¡
->
pÜt_li¡
, 
if_šdex
);

470 ià(
p_lšk_node
) {

471 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

473 
if_šdex
, 
p_lšk_node
->
ndi_pÜt
.
Åu_id
,

474 
p_lšk_node
->
ndi_pÜt
.
Åu_pÜt
);

476 ià(
	`Çs_add_Ü_d–_pÜt_to_vÏn
(
p_lšk_node
->
ndi_pÜt
.
Åu_id
, 
vÏn_id
,

477 &(
p_lšk_node
->
ndi_pÜt
), 
pÜt_mode
, 
çl£
, 
if_šdex
)

478 !ğ
STD_ERR_OK
) {

479 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

481 
if_šdex
, 
vÏn_id
);

482  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

485 
	`Çs_d–‘e_lšk_node
(&
p_li¡
->
pÜt_li¡
, 
p_lšk_node
);

486 
p_li¡
->
pÜt_couÁ
--;

488  
rc
;

489 
	}
}

498 
	$Çs_´oûss_d–_vÏn_mem_äom_os
 (
h®_ifšdex_t
 
bridge_id
, 
Çs_pÜt_li¡_t
 &
pÜt_li¡
,

499 
Çs_pÜt_mode_t
 
pÜt_mode
)

501 
Çs_bridge_t
 *
p_bridge_node
 = 
NULL
;

502 
Çs_št_ty³_t
 
štf_ty³
;

503 
Çs_li¡_t
 *
p_li¡
 = 
NULL
;

504 
h®_ifšdex_t
 
if_šdex
 = 0;

505 
Çs_pÜt_li¡_t
 
publish_li¡
;

508 ià(
pÜt_li¡
.
	`em±y
()) {

511 
	`Çs_bridge_lock
();

512 ià((
p_bridge_node
 = 
	`Çs_g‘_bridge_node
(
bridge_id
)è=ğ
NULL
) {

513 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 , "NAS-Vlan",

514 "E¼Ü fšdšg bridgIÁ”çû %d\n", 
bridge_id
);

515 
	`Çs_bridge_uÆock
();

518 autØ
™
=
pÜt_li¡
.
	`begš
();™ !ğpÜt_li¡.
	`’d
(); ++it) {

520 
if_šdex
 = *
™
;

521 
p_li¡
 = (
pÜt_mode
 =ğ
NAS_PORT_UNTAGGED
) ?

522 &
p_bridge_node
->
uÁagged_li¡
 : &p_bridge_node->
gged_li¡
;

524 ià(
	`Çs_g‘_št_ty³
(
if_šdex
, &
štf_ty³
è!ğ
STD_ERR_OK
) {

525 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

526 "E¼Ü fšdšg index %d iÀštf_ù¾", 
if_šdex
);

530 
if_ma¡”_šfo_t
 
ma¡”_šfo
 = { 
Çs_št_ty³_VLAN
, 
pÜt_mode
, 
p_bridge_node
->
ifšdex
};

531 
BASE_IF_MODE_t
 
štf_mode
 = 
	`Çs_štf_g‘_mode
(
if_šdex
);

533 if(!
	`Çs_štf_d–_ma¡”
(
if_šdex
, 
ma¡”_šfo
)){

534 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN","Failedo del master for vlan memeber…ort");

536 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
if_šdex
);

537 ià(
Ãw_mode
 !ğ
štf_mode
) {

538 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
if_šdex
, 
Ãw_mode
è=ğ
çl£
) {

539 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN",

540 "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
if_šdex
);

544 ià(!
	`Çs_is_vœtu®_pÜt
(
if_šdex
è&& (
štf_ty³
 =ğ
Çs_št_ty³_PORT
)) {

545 
	`EV_LOGGING
(
INTERFACE
, 
INFO
 ,"NAS-Vlan",

546 "D–‘PÜˆ%d from bridg%d ", 
if_šdex
, 
bridge_id
);

548 if(!
	`Çs_štf_ş—nup_l2mc_cÚfig
(
if_šdex
, 
p_bridge_node
->
vÏn_id
)) {

549 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

550 "E¼Ü cËªšg L2MC memb”sh fÜ iÁ”çû %d", 
if_šdex
);

553 ià(
	`Çs_´oûss_li¡_fÜ_vÏn_d–
(
p_bridge_node
, 
p_li¡
,

554 
if_šdex
, 
p_bridge_node
->
vÏn_id
,

555 
pÜt_mode
è!ğ
STD_ERR_OK
) {

559 
publish_li¡
.
	`š£¹
(
if_šdex
);

560 } ià(
štf_ty³
 =ğ
Çs_št_ty³_LAG
) {

561 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

562 "D–‘% LAG %d from Bridg%d ", (
pÜt_mode
 =ğ
NAS_PORT_UNTAGGED
) ? "untagged" : "tagged",

563 
if_šdex
, 
bridge_id
);

565 
	`Çs_add_Ü_d–_Ïg_š_vÏn
(
if_šdex
, 
p_bridge_node
->
vÏn_id
, 
pÜt_mode
, 
çl£
, false);

566 ià(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

567 
	`Çs_´oûss_Ïg_fÜ_vÏn_d–
(&
p_bridge_node
->
gged_Ïg
, 
if_šdex
);

569 
	`Çs_´oûss_Ïg_fÜ_vÏn_d–
(&
p_bridge_node
->
uÁagged_Ïg
, 
if_šdex
);

573 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

574 "UnknowÀš‹rçûy³ o¸nÙ suµÜ‹d: if_šdex %dy³ %d ", 
if_šdex
, 
štf_ty³
);

580 
	`Çs_publish_vÏn_pÜt_li¡
(
p_bridge_node
, 
publish_li¡
, 
pÜt_mode
, 
ıs_­i_İ”_DELETE
);

581 
	`Çs_bridge_uÆock
();

583 
	}
}

585 
Çs_li¡_node_t
 *
	$Çs_ü—‹_vÏn_pÜt_node
(
Çs_bridge_t
 *
p_bridge_node
,

586 
h®_ifšdex_t
 
ifšdex
,

587 
Çs_pÜt_mode_t
 
pÜt_mode
,

588 
boŞ
 *
ü—‹_æag
) {

589 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
;

590 
ndi_pÜt_t
 
ndi_pÜt
;

591 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

593 
	`mem£t
(&
ndi_pÜt
, 0, (
ndi_pÜt_t
));

594 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

596 
ifšdex
, 
pÜt_mode
, 
p_bridge_node
->ifindex);

597 ifĞ
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

598 
p_lšk_node
 = 
	`Çs_g‘_lšk_node
(&
p_bridge_node
->
gged_li¡
.
pÜt_li¡
, 
ifšdex
);

600 
p_lšk_node
 = 
	`Çs_g‘_lšk_node
(&
p_bridge_node
->
uÁagged_li¡
.
pÜt_li¡
, 
ifšdex
);

603 ià(
p_lšk_node
 =ğ
NULL
) {

604 *
ü—‹_æag
 = 
Œue
;

605 if((
rc
 = (
	`Çs_št_g‘_Åu_pÜt
(
ifšdex
, &
ndi_pÜt
))è!ğ
STD_ERR_OK
) {

606 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

608 
ifšdex
, 
rc
);

612 
p_lšk_node
 = (
Çs_li¡_node_t
 *)
	`m®loc
((nas_list_node_t));

613 ià(
p_lšk_node
 !ğ
NULL
) {

614 
	`mem£t
(
p_lšk_node
, 0, (
Çs_li¡_node_t
));

615 
p_lšk_node
->
ifšdex
 = ifindex;

616 
p_lšk_node
->
ndi_pÜt
.
Åu_pÜt
 =‚di_port.npu_port;

617 
p_lšk_node
->
ndi_pÜt
.
Åu_id
 =‚di_port.npu_id;

619 ià(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

620 
p_bridge_node
->
gged_li¡
.
pÜt_couÁ
++;

621 
	`Çs_š£¹_lšk_node
(&
p_bridge_node
->
gged_li¡
.
pÜt_li¡
, 
p_lšk_node
);

624 
	`Çs_š£¹_lšk_node
(&
p_bridge_node
->
uÁagged_li¡
.
pÜt_li¡
, 
p_lšk_node
);

625 
p_bridge_node
->
uÁagged_li¡
.
pÜt_couÁ
++;

627 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

629 
ifšdex
, 
p_bridge_node
->ifindex);

632 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

633 "VÏÀmemb” in£¹iÚ %d fau»", 
ifšdex
);

636 *
ü—‹_æag
 = 
çl£
;

638  
p_lšk_node
;

639 
	}
}

641 
t_¡d_”rÜ
 
	$Çs_ü—‹_uÁagged_Ïg_node
(
Çs_bridge_t
 *
p_bridge_node
,

642 
h®_ifšdex_t
 
ifšdex
)

644 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
;

646 
p_lšk_node
 = (
Çs_li¡_node_t
 *)
	`m®loc
((nas_list_node_t));

647 ià(
p_lšk_node
 !ğ
NULL
) {

648 
	`mem£t
(
p_lšk_node
, 0, (
Çs_li¡_node_t
));

649 
p_lšk_node
->
ifšdex
 = ifindex;

651 
p_bridge_node
->
uÁagged_Ïg
.
pÜt_couÁ
++;

652 
	`Çs_š£¹_lšk_node
(&
p_bridge_node
->
uÁagged_Ïg
.
pÜt_li¡
, 
p_lšk_node
);

655  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

657  
STD_ERR_OK
;

658 
	}
}

660 
t_¡d_”rÜ
 
	$Çs_hªdË_ü—‹_vÏn
(
Çs_bridge_t
 *
p_bridge_node
, 
h®_vÏn_id_t
 
vÏn_id
)

662 
t_¡d_”rÜ
 
rc
 = (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

664 ià((
p_bridge_node
->
vÏn_id
 == 0) && (vlan_id != 0)) {

665 ià(!
	`Çs_hªdË_vid_to_br
(
vÏn_id
, 
p_bridge_node
->
ifšdex
)) {

666 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 , "NAS-Vlan",

667 "E¼Ü SamVÏÀID %dƒxi¡ š‡nÙh” bridge", 
vÏn_id
);

668  
rc
;

670 
p_bridge_node
->
vÏn_id
 = vlan_id;

672 ià((
rc
 = 
	`Çs_vÏn_ü—‹
(0, 
vÏn_id
)è!ğ
STD_ERR_OK
) {

673  
rc
;

676 ià(
	`Çs_»gi¡”_vÏn_štf
(
p_bridge_node
, 
HAL_INTF_OP_REG
è!ğ
STD_ERR_OK
) {

677  
rc
;

680 
	`Çs_hªdË_bridge_mac
(
p_bridge_node
);

682  
STD_ERR_OK
;

683 
	}
}

685 
t_¡d_”rÜ
 
	$Çs_´oûss_memb”_add™iÚ_to_vÏn
(
Çs_bridge_t
 *
p_bridge_node
, 
h®_ifšdex_t
 
pÜt_idx
,

686 
Çs_št_ty³_t
 
štf_ty³
, 
Çs_pÜt_mode_t
 
pÜt_mode
,

687 
h®_vÏn_id_t
 
vÏn_id
)

689 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
;

690 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

691 
boŞ
 
ü—‹_æag
=
çl£
;

693 ià(
štf_ty³
 =ğ
Çs_št_ty³_PORT
) {

694 
p_lšk_node
 = 
	`Çs_ü—‹_vÏn_pÜt_node
(
p_bridge_node
, 
pÜt_idx
,

695 
pÜt_mode
, &
ü—‹_æag
);

696 if(
p_lšk_node
 =ğ
NULL
) {

697 
rc
 = 
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

698  
rc
;

700 if(
ü—‹_æag
 =ğ
çl£
) {

701 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

702 "PÜˆ®»adyƒxi¡ %d iÀBridg%d", 
pÜt_idx
, 
p_bridge_node
->
ifšdex
);

704  
rc
;

708 if(
p_bridge_node
->
vÏn_id
 == 0) {

709 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

710 "C»©šg uÁagged bÚd %d iÀbridg%d", 
pÜt_idx
, 
p_bridge_node
->
ifšdex
);

712 if(
	`Çs_ü—‹_uÁagged_Ïg_node
(
p_bridge_node
, 
pÜt_idx
è!ğ
STD_ERR_OK
)

713  
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0);

717 ià(
p_bridge_node
->
vÏn_id
 != 0 ) {

719 if(
štf_ty³
 =ğ
Çs_št_ty³_PORT
) {

721 ià((
rc
 = 
	`Çs_add_Ü_d–_pÜt_to_vÏn
(
p_lšk_node
->
ndi_pÜt
.
Åu_id
, 
p_bridge_node
->
vÏn_id
,

722 &(
p_lšk_node
->
ndi_pÜt
), 
pÜt_mode
, 
Œue
, 
pÜt_idx
))

723 !ğ
STD_ERR_OK
) {

724 
rc
 = (
	`STD_ERR
(
INTERFACE
,
FAIL
,„c));

725  
rc
;

728 if(
štf_ty³
 =ğ
Çs_št_ty³_LAG
){

729 if((
rc
 = 
	`Çs_hªdË_Ïg_add_to_vÏn
(
p_bridge_node
, 
pÜt_idx
,

730 
pÜt_mode
, 
çl£
, 
nuÎ±r
)è!ğ
STD_ERR_OK
) {

731 
rc
ğ(
	`STD_ERR
(
INTERFACE
, 
FAIL
,rc));

735  
rc
;

736 
	}
}

738 
	$Çs_´oûss_add_vÏn_mem_äom_os
(
h®_ifšdex_t
 
bridge_id
, 
Çs_pÜt_li¡_t
 &
pÜt_li¡
,

739 
h®_vÏn_id_t
 
vÏn_id
, 
Çs_pÜt_mode_t
 
pÜt_mode
)

741 
Çs_bridge_t
 *
p_bridge_node
 = 
NULL
;

742 
Çs_št_ty³_t
 
štf_ty³
;

743 
Çs_pÜt_li¡_t
 
publish_li¡
;

744 
h®_ifšdex_t
 
if_šdex
;

746 ià(
pÜt_li¡
.
	`em±y
()) {

749 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

751 (
pÜt_mode
 =ğ
NAS_PORT_UNTAGGED
è? "uÁagged" : "gged", 
vÏn_id
, 
bridge_id
);

752 
	`Çs_bridge_lock
();

753 ià((
p_bridge_node
 = 
	`Çs_g‘_bridge_node
(
bridge_id
)è=ğ
NULL
 ) {

754 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

755 "E¼Ü fšdšg bridg%d ", 
bridge_id
);

756 
	`Çs_bridge_uÆock
();

759 ià((
vÏn_id
 !ğ0è&& (
p_bridge_node
->vlan_id !=0)) {

761 ià(
p_bridge_node
->
vÏn_id
 != vlan_id ) {

762 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

763 "Inv®id VÏÀID %d fÜ bridg%d ", 
vÏn_id
, 
bridge_id
);

764 
	`Çs_bridge_uÆock
();

768 ià(
p_bridge_node
->
vÏn_id
 == 0 && vlan_id != 0) {

769 ià(
	`Çs_hªdË_ü—‹_vÏn
(
p_bridge_node
, 
vÏn_id
è!ğ
STD_ERR_OK
) {

770 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 , "NAS-Vlan",

771 "VLAN c»©iÚ faed fÜ bridg%d vÏn_id %d \n", 
p_bridge_node
->
ifšdex
, 
vÏn_id
);

772 
	`Çs_bridge_uÆock
();

777 ià(
	`Çs_add_®l_ut_pÜts_to_vÏn
(
p_bridge_node
è!ğ
STD_ERR_OK
) {

778 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

779 "VLAN Add uÁagged…Üt çed %d vÏn_id %d \n", 
p_bridge_node
->
ifšdex
, 
vÏn_id
);

781 ià(
	`Çs_add_®l_ut_Ïgs_to_vÏn
(
p_bridge_node
è!ğ
STD_ERR_OK
) {

782 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

783 "VLAN Add uÁagged bridgçed %d vÏn_id %d \n", 
p_bridge_node
->
ifšdex
, 
vÏn_id
);

785 ià(
	`Çs_publish_vÏn_objeù
(
p_bridge_node
, 
ıs_­i_İ”_CREATE
)!ğ
ıs_­i_»t_code_OK
) {

786 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

792 autØ
™
=
pÜt_li¡
.
	`begš
();™ !ğpÜt_li¡.
	`’d
(); ++it) {

793 
if_šdex
 = *
™
;

795 if(
	`Çs_g‘_št_ty³
(
if_šdex
, &
štf_ty³
è!ğ
STD_ERR_OK
) {

796 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

797 "E¼Ü fšdšg index %d iÀštf_ù¾ ", 
if_šdex
);

800 
boŞ
 
is_memb”
;

801 ià(
	`Çs_check_štf_vÏn_memb”sh
(
p_bridge_node
, 
if_šdex
, 
pÜt_mode
, 
štf_ty³
, &
is_memb”
è!ğ
STD_ERR_OK
) {

802 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN", "Error finding Interface index %d membership in bridge index %d",

803 
if_šdex
, 
p_bridge_node
->
ifšdex
);

806 ià(
is_memb”
) {

807 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN", "Interface idx %d is‡lready member of bridge idx %d",

808 
if_šdex
, 
p_bridge_node
->
ifšdex
);

812 ià(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
 && 
vÏn_id
 != 0) {

814 ià(
	`Çs_ck_pÜt_exi¡
(
vÏn_id
, 
if_šdex
è!=
Œue
 ) {

815 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

816 "Tagged PÜˆdÛ¢'ˆexi¡ %d iÀo fÜ bridg%d", 
if_šdex
, 
p_bridge_node
->
ifšdex
);

820 
if_ma¡”_šfo_t
 
ma¡”_šfo
 = { 
Çs_št_ty³_VLAN
, 
pÜt_mode
, 
p_bridge_node
->
ifšdex
};

821 
BASE_IF_MODE_t
 
štf_mode
 = 
	`Çs_štf_g‘_mode
(
if_šdex
);

822 if(!
	`Çs_štf_add_ma¡”
(
if_šdex
, 
ma¡”_šfo
)){

823 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN","Failedo‡dd master for vlan memeber…ort");

825 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
if_šdex
);

826 ià(
Ãw_mode
 !ğ
štf_mode
) {

827 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
if_šdex
, 
Ãw_mode
è=ğ
çl£
) {

828 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN", "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
if_šdex
);

832 if(!
	`Çs_is_vœtu®_pÜt
(
if_šdex
)){

833 if((
	`Çs_´oûss_memb”_add™iÚ_to_vÏn
(
p_bridge_node
, 
if_šdex
,

834 
štf_ty³
, 
pÜt_mode
, 
vÏn_id
))

835 !ğ
STD_ERR_OK
) {

836 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

837 "E¼Ü iÀaddšg…Üˆ%d iÀthbridg%d ", 
if_šdex
, 
bridge_id
);

841 
publish_li¡
.
	`š£¹
(
if_šdex
);

844 
	`Çs_publish_vÏn_pÜt_li¡
(
p_bridge_node
, 
publish_li¡
, 
pÜt_mode
, 
ıs_­i_İ”_CREATE
);

845 
	`Çs_bridge_uÆock
();

847 
	}
}

850 
	$Çs_·ck_vÏn_pÜt_li¡
(
ıs_­i_objeù_t
 
obj
, 
Çs_li¡_t
 *
p_li¡
, 
©Œ_id
)

852 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
;

853 
Çme
[
HAL_IF_NAME_SZ
] = "\0";

855 
p_lšk_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&
p_li¡
->
pÜt_li¡
);

857 
p_lšk_node
 !ğ
NULL
) {

858 
	`mem£t
(
Çme
,0,(name));

859 ià(
	`Çs_št_g‘_if_šdex_to_Çme
(
p_lšk_node
->
ifšdex
, 
Çme
, Òame)è=ğ
STD_ERR_OK
) {

860 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
©Œ_id
, (cÚ¡ *)
Çme
, 
	`¡¾’
(name)+1);

862 
p_lšk_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_li¡
->
pÜt_li¡
,…_link_node);

864 
	}
}

866 
	$Çs_·ck_vÏn_if
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

868 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj
),
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

869 
ıs_­i_qu®if›r_TARGET
);

871 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

872 &
p_bridge
->
Çme
, 
	`¡¾’
(p_bridge->name)+1);

874 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
p_bridge
->
ifšdex
);

876 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_TYPE
,

877 (cÚ¡ *)
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
,

878 
	`¡¾’
(
IF_INTERFACE_TYPE_IANAIFT_IANA_INTERFACE_TYPE_IANAIFT_L2VLAN
)+1);

880 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
, 
p_bridge
->
vÏn_id
);

882 
	`Çs_·ck_vÏn_pÜt_li¡
(
obj
, &
p_bridge
->
gged_li¡
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
);

884 
	`Çs_·ck_vÏn_pÜt_li¡
(
obj
, &
p_bridge
->
gged_Ïg
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
);

886 
	`Çs_·ck_vÏn_pÜt_li¡
(
obj
, &
p_bridge
->
uÁagged_li¡
,
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
);

888 
	`Çs_·ck_vÏn_pÜt_li¡
(
obj
, &
p_bridge
->
uÁagged_Ïg
,
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
);

890 
	`ıs_­i_objeù_©Œ_add
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, 
p_bridge
->
mac_addr
,

891 (
p_bridge
->
mac_addr
));

893 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
IF_INTERFACES_INTERFACE_ENABLED
,

894 (
p_bridge
->
admš_¡©us
 =ğ
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_UP
è? 
Œue
: 
çl£
);

896 
boŞ
 
Ë¬nšg_mode
 = 
p_bridge
->
Ë¬nšg_di§bË
 ? 
çl£
 : 
Œue
;

898 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
, 
Ë¬nšg_mode
);

900 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_VLAN_TYPE
,

901 
p_bridge
->
št_sub_ty³
);

905 
	`Çs_os_g‘_š‹rçû_mtu
(
p_bridge
->
Çme
, 
obj
);

908 
š‹rçû_ù¾_t
 
štf_ù¾_blk
;

909 if(
	`Çs_vÏn_g‘_štf_ù¾_šfo
(
p_bridge
->
ifšdex
, 
štf_ù¾_blk
è!ğ
STD_ERR_OK
) {

910 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

915 if(
štf_ù¾_blk
.
desc
) {

916 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
IF_INTERFACES_INTERFACE_DESCRIPTION
,

917 (cÚ¡ *)
štf_ù¾_blk
.
desc
, 
	`¡¾’
(intf_ctrl_blk.desc) + 1);

919 
	}
}

922 
t_¡d_”rÜ
 
	$Çs_g‘_vÏn_štf
(cÚ¡ *
if_Çme
, 
h®_ifšdex_t
 
ifšdex
, 
ıs_­i_objeù_li¡_t
 
li¡
, 
boŞ
 
g‘_¡©e
)

924 
Çs_bridge_t
 *
p_bridge
 = 
NULL
;

926 if(
if_Çme
è
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

927 "G‘ vÏÀš‹rçû %s", 
if_Çme
);

928 if(
ifšdex
è
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

929 "G‘ vÏÀšdex %d", 
ifšdex
);

932 if(
if_Çme
è
p_bridge
 = 
	`Çs_g‘_bridge_node_äom_Çme
(if_name);

933 
p_bridge
 = 
	`Çs_g‘_bridge_node
(
ifšdex
);

935 if(
p_bridge
 =ğ
NULL
) {

936 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

937 "E¼Ü fšdšg bridg% fÜ g‘ o³¿tiÚ", 
if_Çme
);

938 (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

940 
ıs_­i_objeù_t
 
objeù
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
li¡
);

941 ià(
objeù
 =ğ
nuÎ±r
) {

942 (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

944 
	`Çs_·ck_vÏn_if
(
objeù
, 
p_bridge
);

945 ià(
g‘_¡©e
) {

946 
	`ıs_­i_objeù_©Œ_add_u32
(
objeù
, 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
, 
p_bridge
->
admš_¡©us
);

947 
	`ıs_­i_objeù_©Œ_add_u32
(
objeù
, 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
, 
p_bridge
->
İ”_¡©us
);

950  
STD_ERR_OK
;

951 
	}
}

953 
t_¡d_”rÜ
 
	$Çs_g‘_vÏn_štf_äom_vid
(
h®_vÏn_id_t
 
vid
, 
ıs_­i_objeù_li¡_t
 
li¡
, 
boŞ
 
g‘_¡©e
)

955 
Çs_bridge_t
 *
p_bridge
 = 
NULL
;

957 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

958 "G‘ vÏÀš‹rçû from vid %d", 
vid
);

960 
p_bridge
 = 
	`Çs_g‘_bridge_node_äom_vid
(
vid
);

962 if(
p_bridge
 =ğ
NULL
) {

963 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

964 "E¼Ü fšdšg bridgvÏÀID %d fÜ g‘ o³¿tiÚ", 
vid
);

965 (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

967 
ıs_­i_objeù_t
 
objeù
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
li¡
);

968 ià(
objeù
 =ğ
nuÎ±r
) {

969 (
	`STD_ERR
(
INTERFACE
, 
FAIL
, 0));

971 
	`Çs_·ck_vÏn_if
(
objeù
, 
p_bridge
);

972 ià(
g‘_¡©e
) {

973 
	`ıs_­i_objeù_©Œ_add_u32
(
objeù
, 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
, 
p_bridge
->
admš_¡©us
);

974 
	`ıs_­i_objeù_©Œ_add_u32
(
objeù
, 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
, 
p_bridge
->
İ”_¡©us
);

976  
STD_ERR_OK
;

977 
	}
}

979 
t_¡d_”rÜ
 
	$Çs_»gi¡”_vÏn_štf
(
Çs_bridge_t
 *
p_bridge
, 
h®_štf_»g_İ_ty³_t
 
İ
)

981 
š‹rçû_ù¾_t
 
d‘as
;

983 
	`EV_LOGGING
(
INTERFACE
, 
INFO
 ,"NAS-Vlan", "Registering VLAN %d %d with ifCntrl",

984 
p_bridge
->
ifšdex
,…_bridge->
vÏn_id
);

986 
	`mem£t
(&
d‘as
,0,(details));

987 
d‘as
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

988 
d‘as
.
if_šdex
 = 
p_bridge
->
ifšdex
;

989 
d‘as
.
vÏn_id
 = 
p_bridge
->vlan_id;

990 
d‘as
.
št_ty³
 = 
Çs_št_ty³_VLAN
;

991 
d‘as
.
št_sub_ty³
 = 
p_bridge
->int_sub_type;

992 
d‘as
.
desc
 = 
NULL
;

993 
	`¡ºıy
(
d‘as
.
if_Çme
, 
p_bridge
->
Çme
, (details.if_name)-1);

995 ià(
	`dn_h®_if_»gi¡”
(
İ
, &
d‘as
)!=
STD_ERR_OK
) {

996 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-Vlan", "VLAN %d %d Not„egistered with ifCntrl ",

997 
p_bridge
->
ifšdex
,…_bridge->
vÏn_id
);

998  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1000  
STD_ERR_OK
;

1001 
	}
}

1003 
ıs_­i_»tuº_code_t
 
	$Çs_publish_vÏn_objeù
(
Çs_bridge_t
 *
p_bridge_node
, 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
)

1005 
buff
[
MAX_CPS_MSG_BUFF
];

1006 
	`mem£t
(
buff
,0,(buff));

1008 
ıs_­i_objeù_t
 
obj_pub
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

1009 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(
	`ıs_­i_objeù_key
(
obj_pub
), 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_OBJ
,

1010 
ıs_­i_qu®if›r_OBSERVED
);

1012 
	`ıs_­i_£t_key_d©a
(
obj_pub
,
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

1013 &
p_bridge_node
->
Çme
, 
	`¡¾’
(p_bridge_node->name)+1);

1015 
	`ıs_­i_objeù_©Œ_add_u32
(
obj_pub
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
p_bridge_node
->
ifšdex
);

1017 
	`ıs_­i_objeù_©Œ_add_u32
(
obj_pub
, 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
, 
p_bridge_node
->
vÏn_id
);

1019 
	`ıs_­i_objeù_©Œ_add_u32
(
obj_pub
, 
DELL_IF_IF_INTERFACES_INTERFACE_VLAN_TYPE
,

1020 
p_bridge_node
->
št_sub_ty³
);

1022 
	`Çs_·ck_vÏn_pÜt_li¡
(
obj_pub
, &
p_bridge_node
->
gged_li¡
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
);

1023 
	`Çs_·ck_vÏn_pÜt_li¡
(
obj_pub
, &
p_bridge_node
->
uÁagged_li¡
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
);

1025 
	`ıs_­i_objeù_£t_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj_pub
),
İ
);

1027 ià(
	`ıs_­i_ev’t_th»ad_publish
(
obj_pub
)!=
STD_ERR_OK
) {

1028 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN","Failedo send VLAN…ublishƒvent. Service issue");

1029  
ıs_­i_»t_code_ERR
;

1031  
ıs_­i_»t_code_OK
;

1032 
	}
}

1034 
t_¡d_”rÜ
 
	$Çs_deçuÉ_vÏn_ÿche_š™
()

1036 cÚ¡ 
Çs_sw™ches_t
 *
sw™ches
 = 
	`Çs_sw™ch_šv’tÜy
();

1038 
size_t
 
ix
 = 0; ix < 
sw™ches
->
numb”_of_sw™ches
; ++ix) {

1039 cÚ¡ 
Çs_sw™ch_d‘a_t
 * 
sd
 = 
	`Çs_sw™ch
((
Çs_sw™ch_id_t
è
ix
);

1041 ià(
sd
 =ğ
NULL
) {

1042 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN","Switch Details Configuration file isƒrroneous");

1043  
	`STD_ERR
(
INTERFACE
,
PARAM
,0);

1046 
size_t
 
sd_ix
 = 0; sd_ix < 
sd
->
numb”_of_Åus
; ++sd_ix) {

1047 if(
	`ndi_d–_Ãw_memb”_äom_deçuÉ_vÏn
(
sd
->
Åus
[
sd_ix
],0,
Œue
è!ğ
STD_ERR_OK
) {

1048 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN","Failedo„emove members"

1049 " from deçuÉ vÏÀfÜ NPU %d.",
sd
->
Åus
[
sd_ix
]);

1054  
STD_ERR_OK
;

1055 
	}
}

	@src/vlan/nas_vlan_cps.cpp

21 
	~"d–l-ba£-if-vÏn.h
"

22 
	~"d–l-ba£-if.h
"

23 
	~"d–l-š‹rçû.h
"

24 
	~"Çs_os_š‹rçû.h
"

25 
	~"š‹rçû_obj.h
"

26 
	~"Çs_os_vÏn.h
"

27 
	~"ev’t_log.h
"

28 
	~"ev’t_log_ty³s.h
"

29 
	~"Çs_št_vÏn.h
"

30 
	~"Çs_št_bridge.h
"

31 
	~"Çs_št_uts.h
"

32 
	~"ıs_­i_objeù_key.h
"

33 
	~"ıs_­i_İ”©iÚ.h
"

34 
	~"ıs_şass_m­.h
"

35 
	~"¡d_mac_uts.h
"

36 
	~"ıs_­i_ev’ts.h
"

37 
	~"d–l-ba£-if-Ïg.h
"

38 
	~"Çs_ndi_vÏn.h
"

39 
	~"Çs_ndi_pÜt.h
"

40 
	~"¡d_uts.h
"

41 
	~"h®_š‹rçû_commÚ.h
"

42 
	~"Çs_št_com_uts.h
"

43 
	~"Çs_if_uts.h
"

44 
	~"Çs_št_Ïg_­i.h
"

45 
	~"¡d_cÚfig_node.h
"

46 
	~"¡d_mu‹x_lock.h
"

47 
	~"ıs_­i_objeù_toŞs.h
"

48 
	~<¡dboŞ.h
>

49 
	~<¡dio.h
>

50 
	~<unÜd”ed_£t
>

52 cÚ¡ 
	gMAX_CPS_MSG_BUFF
=10000;

53 
	#NUM_INT_CPS_API_THREAD
 1

	)

55 
	#INTERFACE_VLAN_CFG_FILE
 "/‘c/İx/š‹rçû_vÏn_cÚfig.xml"

	)

57 
ıs_­i_İ”©iÚ_hªdË_t
 
	gÇs_if_glob®_hªdË
;

59 
boŞ
 
	g_sÿËd_vÏn
 = 
çl£
;

60 autØ
	g_l3_vÏn_£t
 = * 
Ãw
 
¡d
::
unÜd”ed_£t
<
h®_vÏn_id_t
>;

61 
¡d_mu‹x_lock_ü—‹_¡©ic_š™_»c
(
_vÏn_mode_mtx
);

63 
t_¡d_”rÜ
 
Çs_´oûss_ıs_pÜts
(
Çs_bridge_t
 *
p_bridge
, 
Çs_pÜt_mode_t
 
pÜt_mode
,

64 
Çs_pÜt_li¡_t
 &
pÜt_li¡
, 
vÏn_rŞl_bk_t
 *
p_rŞl_bk
);

65 
t_¡d_”rÜ
 
Çs_ıs_d–_pÜt_äom_vÏn
(
Çs_bridge_t
 *
p_bridge
, 
Çs_li¡_node_t
 *
p_lšk_node
, 
Çs_pÜt_mode_t
 
pÜt_mode
);

66 
t_¡d_”rÜ
 
Çs_ıs_ş—nup_vÏn_li¡s
(
h®_vÏn_id_t
 
vÏn_id
, 
Çs_li¡_t
 *
p_lšk_node_li¡
);

67 
t_¡d_”rÜ
 
Çs_ıs_add_pÜt_to_vÏn
(
Çs_bridge_t
 *
p_bridge
, 
h®_ifšdex_t
 
pÜt_idx
, 
Çs_pÜt_mode_t
 
pÜt_mode
);

69 
šlše
 
ıs_­i_»tuº_code_t
 
	$Çs_vÏn_g‘_İ”_¡©us
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

71 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS
, 
p_bridge
->
İ”_¡©us
);

72  
ıs_­i_»t_code_OK
;

73 
	}
}

75 
šlše
 
ıs_­i_»tuº_code_t
 
	$Çs_vÏn_g‘_admš_¡©us
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

77 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS
, 
p_bridge
->
admš_¡©us
);

78  
ıs_­i_»t_code_OK
;

79 
	}
}

81 
šlše
 
ıs_­i_»tuº_code_t
 
	$Çs_vÏn_g‘_štf_¡©us
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

84 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
IF_INTERFACES_INTERFACE_ENABLED
,

85 (
p_bridge
->
admš_¡©us
 =ğ
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_UP
è? 
Œue
: 
çl£
);

86  
ıs_­i_»t_code_OK
;

87 
	}
}

89 
šlše
 
ıs_­i_»tuº_code_t
 
	$Çs_vÏn_g‘_Ë¬nšg_mode
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

91 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
,

92 
p_bridge
->
Ë¬nšg_di§bË
);

93  
ıs_­i_»t_code_OK
;

94 
	}
}

96 
šlše
 
ıs_­i_»tuº_code_t
 
	$Çs_vÏn_g‘_mac
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

98 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
,

99 
p_bridge
->
mac_addr
, (p_bridge->mac_addr));

100  
ıs_­i_»t_code_OK
;

101 
	}
}

103 
šlše
 
ıs_­i_»tuº_code_t
 
	$Çs_vÏn_g‘_mtu
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

105 if(
p_bridge
->
mtu
){

106 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_MTU
,
p_bridge
->
mtu
);

107  
ıs_­i_»t_code_OK
;

109  (
	`Çs_os_g‘_š‹rçû_mtu
(
p_bridge
->
Çme
, 
obj
));

111 
	}
}

113 
boŞ
 
	$Çs_vÏn_´oûss_pÜt_assocŸtiÚ
(
h®_ifšdex_t
 
ifšdex
, 
Åu_id_t
 
Åu
, 
pÜt_t
 
pÜt
,
boŞ
 
add
){

115 autØ
m_li¡
 = 
	`Çs_štf_g‘_ma¡”
(
ifšdex
);

116 autØ
™
 : 
m_li¡
){

117 if(
™
.
ty³
 =ğ
Çs_št_ty³_LAG
){

119 }if(
™
.
ty³
 =ğ
Çs_št_ty³_VLAN
){

121 
	`Çs_bridge_lock
();

122 
ndi_pÜt_t
 
ndi_pÜt
;

123 
ndi_pÜt
.
Åu_id
 = 
Åu
;

124 
ndi_pÜt
.
Åu_pÜt
 = 
pÜt
;

125 
Çs_bridge_t
 * 
br_m
 = 
	`Çs_g‘_bridge_node
(
™
.
m_if_idx
);

127 if(
br_m
 =ğ
NULL
){

131 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN-MAP","NØbridgfÜ iÁ”çû ifšdex %d",
ifšdex
);

132 
	`Çs_bridge_uÆock
();

133  
çl£
;

136 if((
	`Çs_add_Ü_d–_pÜt_to_vÏn
(
Åu
,
br_m
->
vÏn_id
,&
ndi_pÜt
, 
™
.
mode
, 
add
, 
ifšdex
)è!ğ
STD_ERR_OK
){

137 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VLAN-MAP","Error‡dding…ort <%d %d>o NPU",

138 
ndi_pÜt
.
Åu_id
,‚di_pÜt.
Åu_pÜt
);

139 
	`Çs_bridge_uÆock
();

140  
çl£
;

142 
Çs_li¡_t
 *
memb”s
 = 
NULL
;

143 ià(
™
.
mode
 =ğ
NAS_PORT_TAGGED
) {

144 
memb”s
 = &
br_m
->
gged_li¡
;

146 
memb”s
 = &
br_m
->
uÁagged_li¡
;

148 
Çs_li¡_node_t
 *
p_lšk_node
 = 
	`Çs_g‘_lšk_node
(&
memb”s
->
pÜt_li¡
, 
ifšdex
);

149 ià(
p_lšk_node
 !ğ
NULL
) {

150 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VLAN-MAP", "Associate %d, br idx %d, mem idx %d member NPU…ort %d,‚ew NPU…ort %d",

151 
add
, 
br_m
->
ifšdex
, ifšdex, 
p_lšk_node
->
ndi_pÜt
.
Åu_pÜt
,‚di_port.npu_port);

154 ià(!
add
 && (
p_lšk_node
->
ndi_pÜt
.
Åu_pÜt
 != 0)) {

155 
p_lšk_node
->
ndi_pÜt
.
Åu_pÜt
 = 0;

157 
p_lšk_node
->
ndi_pÜt
.
Åu_pÜt
 =‚di_port.npu_port;

161 
	`Çs_bridge_uÆock
();

164  
Œue
;

165 
	}
}

167 
boŞ
 
	$Çs_vÏn_if_£t_hªdËr
(
ıs_­i_objeù_t
 
obj
, *
cÚ‹xt
)

169 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN-MAP","Got Interfaceƒvent");

170 
Çs_št_pÜt_m­pšg_t
 
pÜt_m­pšg
;

171 if(!
	`Çs_g‘_phy_pÜt_m­pšg_chªge
Ğ
obj
, &
pÜt_m­pšg
)){

172 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN-MAP","Interfaceƒvent is‚ot‡n "

174  
Œue
;

177 
ıs_­i_objeù_©Œ_t
 
Åu_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

178 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_NPU_ID
);

179 
ıs_­i_objeù_©Œ_t
 
pÜt_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

180 
BASE_IF_PHY_IF_INTERFACES_INTERFACE_PORT_ID
);

181 
ıs_­i_objeù_©Œ_t
 
if_šdex_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
,

182 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

184 ià(
Åu_©Œ
 =ğ
nuÎ±r
 || 
pÜt_©Œ
 =ğnuÎ±¸|| 
if_šdex_©Œ
 ==‚ullptr) {

185 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
, "NAS-VLAN-MAP", "Interface object does‚ot have if-index/npu/port");

186  
Œue
;

189 
h®_ifšdex_t
 
ifidx
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_šdex_©Œ
);

190 
Åu_id_t
 
Åu
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
Åu_©Œ
);

191 
Åu_pÜt_t
 
pÜt
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
pÜt_©Œ
);

193 
boŞ
 
add
 = (
pÜt_m­pšg
 =ğ
Çs_št_phy_pÜt_MAPPED
è? 
Œue
 : 
çl£
;

195  
	`Çs_vÏn_´oûss_pÜt_assocŸtiÚ
(
ifidx
,
Åu
,
pÜt
,
add
);

197 
	}
}

200 
ıs_­i_»tuº_code_t
 
	$Çs_vÏn_£t_štf_¡©us
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

204 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
IF_INTERFACES_INTERFACE_ENABLED
);

206 ià(
©Œ
 =ğ
NULL
){  
ıs_­i_»t_code_ERR
; }

208 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
p_bridge
->
ifšdex
);

210 if(
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
IF_INTERFACES_INTERFACE_ENABLED
è!ğ
STD_ERR_OK
)

212 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-CPS-VLAN","Failure setting Vlan‡dmin status");

213  
ıs_­i_»t_code_ERR
;

216 
p_bridge
->
admš_¡©us
 = ((
boŞ
)
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
è=ğ
Œue
)?

217 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_UP
 : 
IF_INTERFACES_STATE_INTERFACE_ADMIN_STATUS_DOWN
;

219  
ıs_­i_»t_code_OK
;

220 
	}
}

222 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_£t_vÏn_Ë¬nšg_mode
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

224 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
);

226 ià(
©Œ
 =ğ
nuÎ±r
è{  
ıs_­i_»t_code_ERR
; }

228 
boŞ
 
Ë¬nšg_di§bË
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
è? 
çl£
 :
Œue
 ;

230 if(
	`ndi_£t_vÏn_Ë¬nšg
(0, 
p_bridge
->
vÏn_id
, 
Ë¬nšg_di§bË
è!ğ
STD_ERR_OK
) {

231 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-Vlan", "Error setting†earning disable state for VLAN %d",

232 
p_bridge
->
ifšdex
);

233  
ıs_­i_»t_code_ERR
;

236 
p_bridge
->
Ë¬nšg_di§bË
 =†earning_disable;

237  
ıs_­i_»t_code_OK
;

238 
	}
}

240 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_£t_vÏn_mac
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

242 
ıs_­i_objeù_©Œ_t
 
_mac_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
);

244 ià(
_mac_©Œ
 =ğ
nuÎ±r
è{  
ıs_­i_»t_code_ERR
; }

246 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
p_bridge
->
ifšdex
);

248 if(
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
è!ğ
STD_ERR_OK
) {

249 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-Vlan", "Failure setting bridge %d MAC in OS",

250 
p_bridge
->
ifšdex
);

251  
ıs_­i_»t_code_ERR
;

253 * 
mac_addr_¡r
 = (*è
	`ıs_­i_objeù_©Œ_d©a_bš
(
_mac_©Œ
);

254 
	`§ã¡ºıy
(
p_bridge
->
mac_addr
, (cÚ¡ *)
mac_addr_¡r
, (p_bridge->mac_addr));

255 
	`EV_LOGGING
(
INTERFACE
, 
INFO
 ,"NAS-Vlan", "Rcvd MAC %s set for bridge %d\n",

256 
p_bridge
->
mac_addr
,…_bridge->
ifšdex
);

258 ià(
	`dn_h®_upd©e_štf_mac
(
p_bridge
->
ifšdex
, (cÚ¡ *)
mac_addr_¡r
è!ğ
STD_ERR_OK
) {

259 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-Vlan", "Failure saving bridge %d MAC in intf block",

260 
p_bridge
->
ifšdex
);

261  
ıs_­i_»t_code_ERR
;

263  
ıs_­i_»t_code_OK
;

264 
	}
}

266 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_£t_vÏn_desc
(cÚ¡ 
ıs_­i_objeù_©Œ_t
 &
desc_©Œ
, cÚ¡ 
h®_ifšdex_t
 
ifšdex
)

268 
š‹rçû_ù¾_t
 
štf
;

272 cÚ¡ *
desc
 = (cÚ¡ *è
	`ıs_­i_objeù_©Œ_d©a_bš
(
desc_©Œ
);

273 ià(
	`¡¾’
(
desc
è> 
MAX_INTF_DESC_LEN
) {

274 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-Vlan", "Failure saving bridge %d desc. Desc†engthƒxceed max (%d)",

275 
MAX_INTF_DESC_LEN
);

276  
ıs_­i_»t_code_ERR
;

279 
	`mem£t
(&
štf
, 0, (intf));

281 
štf
.
if_šdex
 = 
ifšdex
;

282 
štf
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

284 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
štf
)!=
STD_ERR_OK
) {

285 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-IF-SET","Error getting interface control block for bridge %d ",

286 
ifšdex
);

287  
ıs_­i_»t_code_ERR
;

290 
štf
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

291 ià(
	`dn_h®_upd©e_štf_desc
(&
štf
, (cÚ¡ *)
desc
è!ğ
STD_ERR_OK
) {

292 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-Vlan", "Failure saving bridge %s desc in intf block",

293 
štf
.
if_Çme
);

294  
ıs_­i_»t_code_ERR
;

297  
ıs_­i_»t_code_OK
;

298 
	}
}

300 
boŞ
 
	$Çs_£t_vÏn_memb”_pÜt_mtu
(
h®_ifšdex_t
 
ifšdex
, 
ušt32_t
 
mtu
, 
h®_vÏn_id_t
 
vÏn_id
){

301 
ıs_­i_objeù_gu¬d
 
	`og
(
	`ıs_­i_objeù_ü—‹
());

302 if(
og
.
	`g‘
(è=ğ
nuÎ±r
){

303 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN","No memoryo create‚ew object");

304  
çl£
;

307 
	`ıs_­i_objeù_©Œ_add_u32
(
og
.
	`g‘
(), 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
ifšdex
);

308 
	`ıs_­i_objeù_©Œ_add_u32
(
og
.
	`g‘
(), 
DELL_IF_IF_INTERFACES_INTERFACE_MTU
, 
mtu
);

309 
	`ıs_­i_objeù_©Œ_add_u16
(
og
.
	`g‘
(), 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
, 
vÏn_id
);

310 if(
	`Çs_os_vÏn_£t_memb”_pÜt_mtu
(
og
.
	`g‘
()è=ğ
STD_ERR_OK
è 
Œue
;

312  
çl£
;

313 
	}
}

315 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_£t_vÏn_mtu
(
ıs_­i_objeù_t
 
obj
, 
Çs_bridge_t
 *
p_bridge
)

317 
ıs_­i_objeù_©Œ_t
 
_mtu_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_MTU
);

319 ià(
_mtu_©Œ
 =ğ
nuÎ±r
è{  
ıs_­i_»t_code_ERR
; }

321 
ušt32_t
 
mtu
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
_mtu_©Œ
);

323 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
p_bridge
->
ifšdex
);

325 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
;

326 
p_lšk_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&(
p_bridge
->
gged_li¡
.
pÜt_li¡
));

327 
p_lšk_node
 !ğ
NULL
) {

328 if(!
	`Çs_£t_vÏn_memb”_pÜt_mtu
(
p_lšk_node
->
ifšdex
,
mtu
,
p_bridge
->
vÏn_id
)){

329 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN","Failedo set mtu for member…orts of vlan %d",

330 
p_bridge
->
ifšdex
);

331  
ıs_­i_»t_code_ERR
;

333 
p_lšk_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_bridge
->
gged_li¡
.
pÜt_li¡
,…_link_node);

336 
p_lšk_node
 = 
NULL
;

337 
p_lšk_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&(
p_bridge
->
gged_Ïg
.
pÜt_li¡
));

338 
p_lšk_node
 !ğ
NULL
) {

339 if(!
	`Çs_£t_vÏn_memb”_pÜt_mtu
(
p_lšk_node
->
ifšdex
,
mtu
,
p_bridge
->
vÏn_id
)){

340 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN","Failedo set mtu for member†ags of vlan %d",

341 
p_bridge
->
ifšdex
);

342  
ıs_­i_»t_code_ERR
;

344 
p_lšk_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_bridge
->
gged_Ïg
.
pÜt_li¡
,…_link_node);

346 if(
	`Çs_os_š‹rçû_£t_©Œibu‹
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
è!ğ
STD_ERR_OK
) {

347 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 ,"NAS-Vlan", "Failure setting MTU for VLAN %d in OS",

348 
p_bridge
->
ifšdex
);

349  
ıs_­i_»t_code_ERR
;

351 
p_bridge
->
mtu
 = mtu;

353  
ıs_­i_»t_code_OK
;

354 
	}
}

356 autØ
	g£t_vÏn_©Œ
 = 
Ãw
 
¡d
::
unÜd”ed_m­
<
ıs_­i_©Œ_id_t
,

357 
	$ıs_­i_»tuº_code_t
 (*)(
ıs_­i_objeù_t
, 
Çs_bridge_t
 *)>

359 { 
IF_INTERFACES_INTERFACE_ENABLED
, 
Çs_vÏn_£t_štf_¡©us
 },

360 { 
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
, 
Çs_ıs_£t_vÏn_Ë¬nšg_mode
 },

361 { 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, 
Çs_ıs_£t_vÏn_mac
},

362 { 
DELL_IF_IF_INTERFACES_INTERFACE_MTU
, 
Çs_ıs_£t_vÏn_mtu
}

363 
	}
};

365 autØ
	gg‘_vÏn_©Œ
 = 
Ãw
 
¡d
::
unÜd”ed_m­
<
ıs_­i_©Œ_id_t
,

366 
	$ıs_­i_»tuº_code_t
 (*)(
ıs_­i_objeù_t
, 
Çs_bridge_t
 *)>

368 { 
IF_INTERFACES_INTERFACE_ENABLED
, 
Çs_vÏn_g‘_štf_¡©us
 },

369 { 
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
, 
Çs_vÏn_g‘_Ë¬nšg_mode
 },

370 { 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
, 
Çs_vÏn_g‘_mac
},

371 { 
DELL_IF_IF_INTERFACES_INTERFACE_MTU
, 
Çs_vÏn_g‘_mtu
}

372 
	}
};

374 
	$hªdË_vÏn_ü—‹_rŞl_bk
(
Çs_bridge_t
 *
p_bridge_node
) {

377 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

378 ià(
obj
 =ğ
NULL
) {

379 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 , "NAS-Vlan",

380 "RŞl_bk: hªdË_vÏn_ü—‹_rŞl_bk cp obj c»©çed fÜ b¸% ", 
p_bridge_node
->
Çme
);

383 
ıs_­i_objeù_gu¬d
 
	`g
(
obj
);

385 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

386 "RŞl_bk :D–‘šg Bridg%s", 
p_bridge_node
->
Çme
);

388 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
p_bridge_node
->
ifšdex
);

389 
	`ıs_­i_£t_key_d©a
(
obj
,
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

390 
p_bridge_node
->
Çme
, 
	`¡¾’
(p_bridge_node->name)+1);

392 ià(
	`Çs_os_d–_vÏn
(
obj
è!ğ
STD_ERR_OK
) {

393 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 , "NAS-Vlan",

394 "RŞl_bk: Fau» d–‘šg vÏn/B¸% äom k”Ãl", 
p_bridge_node
->
Çme
);

397 
	`Çs_ıs_ş—nup_vÏn_li¡s
(
p_bridge_node
->
vÏn_id
, &p_bridge_node->
gged_li¡
);

398 
	`Çs_ıs_ş—nup_vÏn_li¡s
(
p_bridge_node
->
vÏn_id
, &p_bridge_node->
gged_Ïg
);

400 ià(
	`Çs_ş—nup_bridge
(
p_bridge_node
è!ğ
STD_ERR_OK
) {

401 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan", "Roll_bk: :Failure cleaning vlan data");

403 
	}
}

406 
	$hªdË_rŞl_bak
(
Çs_bridge_t
 *
p_bridge
, 
vÏn_rŞl_bk_t
 &
p_rŞl_bk
, 
ıs_­i_objeù_t
 
obj
)

408 
ıs_­i_objeù_™_t
 
™
;

410 
	`ıs_­i_objeù_™_begš
(
obj
,&
™
);

411 
h®_ifšdex_t
 
d–_ifšdex
 = 0;

413  ; 
	`ıs_­i_objeù_™_v®id
(&
™
è; 
	`ıs_­i_objeù_™_Ãxt
(&it) ) {

414 
id
 = (è
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

415 autØ
func
 = 
£t_vÏn_©Œ
->
	`fšd
(
id
);

416 ià(
func
 =ğ
£t_vÏn_©Œ
->
	`’d
()) ;

417 
ıs_­i_»tuº_code_t
 
»t
 = 
func
->
	`£cÚd
(
obj
,
p_bridge
);

418 ià(
»t
 !ğ
ıs_­i_»t_code_OK
) {

419 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VÏn","RŞlback fau» fÜh©Œibu‹ %d vÏÀšdex %d", 
id
,

420 
p_bridge
->
ifšdex
);

424 autØ
™
=
p_rŞl_bk
.
pÜt_d–_li¡
.
	`begš
(); it!õ_rŞl_bk.pÜt_d–_li¡.
	`’d
(); ++it) {

426 ià(
	`Çs_ıs_add_pÜt_to_vÏn
(
p_bridge
, 
™
->
fœ¡
, it->
£cÚd
è!ğ
STD_ERR_OK
) {

427 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

428 "RŞl_bk: E¼Ü‡ddšg…Üˆ%dØbridg%d iÀOS", 
™
->
fœ¡
, 
p_bridge
->
ifšdex
);

430 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

431 "RŞl_bk: Sucûs addšg…Üˆ%dØbridg%d iÀOS", 
™
->
fœ¡
, 
p_bridge
->
ifšdex
);

436 autØ
™
=
p_rŞl_bk
.
pÜt_add_li¡
.
	`begš
(); it!õ_rŞl_bk.pÜt_add_li¡.
	`’d
(); ++it) {

437 autØ
mode
 = 
™
->
£cÚd
;

438 
Çs_li¡_t
 *
p_li¡
 = 
NULL
;

439 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
;

440 
Çs_li¡_node_t
 *
p_‹mp_node
 = 
NULL
;

441 if(
mode
 =ğ
NAS_PORT_TAGGED
) {

442 
p_li¡
 = &(
p_bridge
->
gged_li¡
);

444 
p_li¡
 = &(
p_bridge
->
uÁagged_li¡
);

447 
p_lšk_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&(
p_li¡
->
pÜt_li¡
));

448 
p_lšk_node
 !ğ
NULL
) {

449 
p_‹mp_node
 = 
p_lšk_node
;

450 ià(
p_lšk_node
->
ifšdex
 =ğ
™
->
fœ¡
) {

452 
d–_ifšdex
 = 
p_lšk_node
->
ifšdex
;

453 ià(
	`Çs_ıs_d–_pÜt_äom_vÏn
(
p_bridge
, 
p_‹mp_node
, 
mode
è!ğ
STD_ERR_OK
) {

454 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

455 "RŞl_bk: E¼Ü d–‘šg…Üˆ%d from Bridg%d ", 
p_lšk_node
->
ifšdex
, 
p_bridge
->ifindex);

457 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

458 "RŞl_bk: Sucûs d–‘šg…Üˆ%d from Bridg%d ", 
d–_ifšdex
, 
p_bridge
->
ifšdex
);

463 
p_lšk_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_li¡
->
pÜt_li¡
, 
p_‹mp_node
);

466 autØ
™
=
p_rŞl_bk
.
Ïg_d–_li¡
.
	`begš
(); it!õ_rŞl_bk.Ïg_d–_li¡.
	`’d
(); ++it) {

468 ià(
	`Çs_hªdË_Ïg_add_to_vÏn
(
p_bridge
, 
™
->
fœ¡
,

469 
™
->
£cÚd
, 
Œue
, 
nuÎ±r
è!ğ
STD_ERR_OK
) {

470 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

471 "RŞl_bk: E¼Ü‡ddšg†ag %dØBridg%d ", 
™
->
fœ¡
, 
p_bridge
->
ifšdex
);

473 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

474 "RŞl_bk: Sucûs addšg†ag %dØBridg%d ", 
™
->
fœ¡
, 
p_bridge
->
ifšdex
);

479 autØ
™
=
p_rŞl_bk
.
Ïg_add_li¡
.
	`begš
(); it!õ_rŞl_bk.Ïg_add_li¡.
	`’d
(); ++it) {

481 ià(
	`Çs_hªdË_Ïg_d–_äom_vÏn
(
p_bridge
, 
™
->
fœ¡
,

482 
™
->
£cÚd
, 
Œue
, 
nuÎ±r
è!ğ
STD_ERR_OK
) {

483 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

484 "RŞl_bk: E¼Ü d–‘šg†ag %d from Bridg%d", 
™
->
fœ¡
, 
p_bridge
->
ifšdex
);

487 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

488 "RŞl_bk: Sucûs d–‘šg†ag %d from Bridg%d", 
™
->
fœ¡
, 
p_bridge
->
ifšdex
);

491 
	}
}

493 
boŞ
 
	$_Çs_š‹rçû_hªdË_mode_chªge
(
Çs_bridge_t
 * 
p_bridge
){

496 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`_lg
(&
_vÏn_mode_mtx
);

497 if(!
_sÿËd_vÏn
è 
Œue
;

500 if(
p_bridge
->
mode
 =ğ
BASE_IF_MODE_MODE_L3
){

502 
Çs_li¡_node_t
 * 
_node
 = 
NULL
;

504 
_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&(
p_bridge
->
gged_li¡
.
pÜt_li¡
));

505 
_node
 !ğ
NULL
) {

506 
	`Çs_ıs_add_pÜt_to_os
(
p_bridge
->
ifšdex
,p_bridge->
vÏn_id
,
NAS_PORT_TAGGED
,

507 
_node
->
ifšdex
,
p_bridge
->
mtu
,
BASE_IF_MODE_MODE_L3
);

508 
_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&(
p_bridge
->
gged_li¡
.
pÜt_li¡
), _node);

511 
_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&(
p_bridge
->
gged_Ïg
.
pÜt_li¡
));

512 
_node
 !ğ
NULL
) {

513 
	`Çs_ıs_add_pÜt_to_os
(
p_bridge
->
ifšdex
,p_bridge->
vÏn_id
,
NAS_PORT_TAGGED
,

514 
_node
->
ifšdex
,
p_bridge
->
mtu
,
BASE_IF_MODE_MODE_L3
);

515 
_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&(
p_bridge
->
gged_Ïg
.
pÜt_li¡
), _node);

518  
Œue
;

519 
	}
}

522 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_upd©e_vÏn
(
Çs_bridge_t
 *
p_bridge
, 
ıs_­i_objeù_t
 
obj
)

524 ià(
p_bridge
 =ğ
NULL
è 
ıs_­i_»t_code_ERR
;

526 
ıs_­i_objeù_™_t
 
™
;

527 
Çs_pÜt_li¡_t
 
g_pÜt_li¡
;

528 
Çs_pÜt_li¡_t
 
uÁag_pÜt_li¡
;

529 
boŞ
 
rŞl_back
 = 
çl£
;

530 
boŞ
 
ü—‹
 = 
çl£
;

531 
boŞ
 
uÁag_li¡_©Œ
 = 
çl£
;

532 
boŞ
 
g_li¡_©Œ
 = 
çl£
;

533 
vÏn_rŞl_bk_t
 
p_rŞl_bk
;

536 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

537 ià(
İ
 =ğ
ıs_­i_İ”_CREATE
è
ü—‹
 =
Œue
;

538 
ıs_­i_objeù_t
 
obj_rŞl_bk
 = 
	`ıs_­i_objeù_ü—‹
();

539 ià(
obj_rŞl_bk
 =ğ
NULL
) {

540  
ıs_­i_»t_code_ERR
;

542 
ıs_­i_objeù_gu¬d
 
	`obj_gu¬d
 (
obj_rŞl_bk
);

544 
	`ıs_­i_£t_key_d©a
(
obj_rŞl_bk
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
,
ıs_­i_objeù_ATTR_T_U32
,

545 &
p_bridge
->
ifšdex
,(
h®_ifšdex_t
));

547 
	`ıs_­i_objeù_™_begš
(
obj
,&
™
);

549  ; 
	`ıs_­i_objeù_™_v®id
(&
™
è; 
	`ıs_­i_objeù_™_Ãxt
(&it) ) {

551 
id
 = (è
	`ıs_­i_objeù_©Œ_id
(
™
.
©Œ
);

552 
id
) {

554 
DELL_IF_IF_INTERFACES_INTERFACE_VLAN_MODE
:

555 
p_bridge
->
mode
 = (
BASE_IF_MODE_t
)
	`ıs_­i_objeù_©Œ_d©a_ušt
(
™
.
©Œ
);

556 
	`_Çs_š‹rçû_hªdË_mode_chªge
(
p_bridge
);

558 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
:

559 
uÁag_li¡_©Œ
 = 
Œue
;

561 ià(
	`ıs_­i_objeù_©Œ_Ën
(
™
.
©Œ
) != 0) {

562 
h®_ifšdex_t
 
pÜt_if_šdex
;

563 ià(
	`Çs_št_Çme_to_if_šdex
(&
pÜt_if_šdex
, (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
))

564 =ğ
STD_ERR_OK
) {

565 
uÁag_pÜt_li¡
.
	`š£¹
(
pÜt_if_šdex
);

570 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
:

571 
g_li¡_©Œ
 = 
Œue
;

572 ià(
	`ıs_­i_objeù_©Œ_Ën
(
™
.
©Œ
) != 0) {

573 
h®_ifšdex_t
 
pÜt_if_šdex
;

574 ià(
	`Çs_št_Çme_to_if_šdex
(&
pÜt_if_šdex
, (cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
™
.
©Œ
))

575 =ğ
STD_ERR_OK
) {

576 
g_pÜt_li¡
.
	`š£¹
(
pÜt_if_šdex
);

580 
IF_INTERFACES_INTERFACE_DESCRIPTION
:

581 ià(
	`Çs_ıs_£t_vÏn_desc
(
™
.
©Œ
, 
p_bridge
->
ifšdex
è!ğ
ıs_­i_»t_code_OK
) {

582 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

584  
ıs_­i_»t_code_ERR
;

588 
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
:

589 
DELL_IF_IF_INTERFACES_INTERFACE_LEARNING_MODE
:

590 
DELL_IF_IF_INTERFACES_INTERFACE_MTU
:

591 
IF_INTERFACES_INTERFACE_ENABLED
:

593 autØ
g‘_func
 = 
g‘_vÏn_©Œ
->
	`fšd
(
id
);

594 autØ
£t_func
 = 
£t_vÏn_©Œ
->
	`fšd
(
id
);

596 
g‘_func
 = 
g‘_vÏn_©Œ
->
	`fšd
(
id
);

597 ià(
g‘_func
 =ğ
g‘_vÏn_©Œ
->
	`’d
()) ;

598 ()
g‘_func
->
	`£cÚd
(
obj_rŞl_bk
,
p_bridge
);

600 ià(
£t_func
 =ğ
£t_vÏn_©Œ
->
	`’d
()) ;

601 ià(
£t_func
->
	`£cÚd
(
obj
,
p_bridge
è!ğ
ıs_­i_»t_code_OK
) {

602 
rŞl_back
 = 
Œue
;

607 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

608 "Reûived‡‰rib %d", 
id
);

613 ià(
g_li¡_©Œ
 =ğ
Œue
 && !
rŞl_back
) {

614 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

615 "Reûived %luagged…Üt fÜ VLAN %d index %d", 
g_pÜt_li¡
.
	`size
(),

616 
p_bridge
->
vÏn_id
,…_bridge->
ifšdex
);

618 ià(
	`Çs_´oûss_ıs_pÜts
(
p_bridge
, 
NAS_PORT_TAGGED
, 
g_pÜt_li¡
 , &
p_rŞl_bk
è!ğ
STD_ERR_OK
) {

619 
rŞl_back
 = 
Œue
;

622 ià(
uÁag_li¡_©Œ
 =ğ
Œue
 && !
rŞl_back
) {

623 
	`EV_LOGGING
(
INTERFACE
, 
INFO
 , "NAS-Vlan",

624 "Reûived %lu uÁagged…Üt fÜ VLAN %d index %d", 
uÁag_pÜt_li¡
.
	`size
(),

625 
p_bridge
->
vÏn_id
,…_bridge->
ifšdex
);

627 ià(
	`Çs_´oûss_ıs_pÜts
(
p_bridge
, 
NAS_PORT_UNTAGGED
, 
uÁag_pÜt_li¡
, &
p_rŞl_bk
è!ğ
STD_ERR_OK
){

628 
rŞl_back
 = 
Œue
;

632 ià(
rŞl_back
) {

633 
	`EV_LOGGING
(
INTERFACE
, 
INFO
 , "NAS-Vlan",

634 "RŞÈback s‘ fÜ vÏnid %d bridg %d", 
p_bridge
->
vÏn_id
,…_bridge->
ifšdex
);

635 ià(!
ü—‹
) {

636 
	`hªdË_rŞl_bak
(
p_bridge
, 
p_rŞl_bk
, 
obj_rŞl_bk
);

638  
ıs_­i_»t_code_ERR
;

640  
ıs_­i_»t_code_OK
;

642 
	}
}

644 
boŞ
 
	$Çs_ck_pÜt_exi¡
(
h®_vÏn_id_t
 
vÏn_id
, 
h®_ifšdex_t
 
pÜt_šdex
) {

645 
ıs_­i_objeù_t
 
vÏn_obj
 = 
	`ıs_­i_objeù_ü—‹
();

646 ià(
vÏn_obj
 =ğ
NULL
) {

647 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan", "nas_ck_port_exist: Out of mem");

648  
çl£
;

650 
ıs_­i_objeù_gu¬d
 
	`obj_gu¬d
(
vÏn_obj
);

651 
	`ıs_­i_objeù_©Œ_add_u32
(
vÏn_obj
,
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
, 
pÜt_šdex
);

652 
	`ıs_­i_objeù_©Œ_add_u32
(
vÏn_obj
,
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
, 
vÏn_id
);

653  
	`Çs_os_g_pÜt_exi¡
(
vÏn_obj
);

654 
	}
}

657 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_ü—‹_vÏn
(
ıs_­i_objeù_t
 
obj
)

659 
h®_ifšdex_t
 
br_šdex
 = 0;

660 
Çme
[
HAL_IF_NAME_SZ
] = "\0";

661 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_ERR
;

662 
boŞ
 
ü—‹
 = 
çl£
;

664 
ıs_­i_objeù_©Œ_t
 
vÏn_id_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
);

666 ià(
vÏn_id_©Œ
 =ğ
NULL
) {

667 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

669 
	`ıs_­i_£t_objeù_»tuº_©Œs
(
obj
, 
rc
, "Missing VLAN ID during create vlan");

670  
rc
;

672 
ıs_­i_objeù_©Œ_t
 
vÏn_Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
);

673 
ıs_­i_objeù_©Œ_t
 
mac_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,
DELL_IF_IF_INTERFACES_INTERFACE_PHYS_ADDRESS
);

675 
	`Çs_bridge_lock
();

679 
h®_vÏn_id_t
 
vÏn_id
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_id_©Œ
);

681 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_VLAN_TYPE
);

682 
BASE_IF_VLAN_TYPE_t
 
vÏn_ty³
 = 
BASE_IF_VLAN_TYPE_DATA
;

684 ià(
©Œ
 !ğ
NULL
) {

685 
vÏn_ty³
 = (
BASE_IF_VLAN_TYPE_t
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

688 if(
	`Çs_vÏn_id_š_u£
(
vÏn_id
)) {

689 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VÏn", "VLAN ID %d i ®»ady c»©ed", 
vÏn_id
);

691 
	`ıs_­i_£t_objeù_»tuº_©Œs
(
obj
, 
rc
, "VLAN ID %d i ®»ady c»©ed", 
vÏn_id
);

692 
	`Çs_bridge_uÆock
();

693  
rc
;

696 ifĞ(
vÏn_id
 < 
MIN_VLAN_ID
è|| (vÏn_id > 
MAX_VLAN_ID
) ) {

697 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

698 "Inv®id VLAN ID duršg c»©vÏÀ%d", 
vÏn_id
);

699 
	`ıs_­i_£t_objeù_»tuº_©Œs
(
obj
, 
rc
, "Inv®id VLAN ID duršg c»©vÏÀ%d", 
vÏn_id
);

700 
	`Çs_bridge_uÆock
();

701  
rc
;

703 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VÏn", "C»©VLAN %d usšg CPS", 
vÏn_id
);

705 
ıs_­i_objeù_©Œ_t
 
mode_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_VLAN_MODE
);

706 
BASE_IF_MODE_t
 
mode
 = 
BASE_IF_MODE_MODE_L2
;

709 autØ
™
 = 
_l3_vÏn_£t
.
	`fšd
(
vÏn_id
);

710 if(
™
 !ğ
_l3_vÏn_£t
.
	`’d
()è
mode
 = 
BASE_IF_MODE_MODE_L3
;

712 ià(
mode_©Œ
 !ğ
NULL
) {

713 
mode
 = (
BASE_IF_MODE_t
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
mode_©Œ
);

717 
	`mem£t
(
Çme
,0,(name));

719 if(
vÏn_Çme_©Œ
 !ğ
NULL
) {

720 
	`¡ºıy
(
Çme
,(*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
vÏn_Çme_©Œ
),(name)-1);

722 
	`¢´štf
(
Çme
, Òame), "br%d", 
vÏn_id
);

723 
	`ıs_­i_£t_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
, 
Çme
, 
	`¡¾’
(name)+1);

727 ià(
	`Çs_os_add_vÏn
(
obj
, &
br_šdex
è!ğ
STD_ERR_OK
) {

728 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

729 "Fau» c»©šg VLAN id %d iÀK”Ãl", 
vÏn_id
);

730 
	`ıs_­i_£t_objeù_»tuº_©Œs
(
obj
, 
rc
, "Fau» c»©šg VLAN id %d iÀK”Ãl", 
vÏn_id
);

731 
	`Çs_bridge_uÆock
();

732  
rc
;

735 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

736 "K”ÃÈ´og¿mmed, c»©šg bridgw™h index %d", 
br_šdex
);

740 
Çs_bridge_t
 *
p_bridge_node
 = 
	`Çs_ü—‹_š£¹_bridge_node
(
br_šdex
, 
Çme
, 
ü—‹
);

741 ià(
p_bridge_node
 !ğ
NULL
 &&

742 (
	`Çs_hªdË_vid_to_br
(
vÏn_id
, 
p_bridge_node
->
ifšdex
))) {

743 
p_bridge_node
->
vÏn_id
 = vlan_id;

744 
p_bridge_node
->
mode
 = mode;

745 
p_bridge_node
->
št_sub_ty³
 = (è
vÏn_ty³
;

746 if(
mac_©Œ
 !ğ
NULL
) {

747 
	`¡ºıy
((*)
p_bridge_node
->
mac_addr
, (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
mac_©Œ
),

748 
	`ıs_­i_objeù_©Œ_Ën
(
mac_©Œ
));

751 if(
vÏn_id
 !ğ
SYSTEM_DEFAULT_VLAN
) {

752 ià(
	`Çs_vÏn_ü—‹
(0, 
vÏn_id
è!ğ
STD_ERR_OK
) {

753 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

754 "Fau» c»©šg VLAN id %d iÀNPU ", 
vÏn_id
);

755 ià(
	`Çs_os_d–_vÏn
(
obj
è!ğ
STD_ERR_OK
) {

756 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

757 "RŞl_bk: Fau» d–‘šg vÏÀ% š k”Ãl\n", 
Çme
);

764 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

766 
p_bridge_node
->
ifšdex
,…_bridge_node->
vÏn_id
);

770 if(
	`Çs_»gi¡”_vÏn_štf
(
p_bridge_node
, 
HAL_INTF_OP_REG
è!ğ
STD_ERR_OK
) {

773 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
br_šdex
, 
BASE_IF_MODE_MODE_NONE
è=ğ
çl£
) {

774 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-CPS-LAG",

775 "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
br_šdex
);

777 ià(
	`Çs_ıs_upd©e_vÏn
(
p_bridge_node
, 
obj
è!ğ
ıs_­i_»t_code_OK
) {

778 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

780 
p_bridge_node
->
ifšdex
,…_bridge_node->
vÏn_id
);

781 
	`hªdË_vÏn_ü—‹_rŞl_bk
(
p_bridge_node
);

786 if(
	`Çs_publish_vÏn_objeù
(
p_bridge_node
, 
ıs_­i_İ”_CREATE
)!ğ
ıs_­i_»t_code_OK
)

788 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

793 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
br_šdex
);

794 
rc
 = 
ıs_­i_»t_code_OK
;

798 
	`Çs_bridge_uÆock
();

799  
rc
;

800 
	}
}

802 
boŞ


803 
	$Çs_hªdË_mode_fÜ_mem_li¡
(
h®_ifšdex_t
 
bridge_šdex
, 
Çs_li¡_t
 *
p_li¡
, 
Çs_pÜt_mode_t
 
pÜt_mode
 )

805 
Çs_li¡_node_t
 *
p_™”_node
 = 
NULL
;

806 
if_ma¡”_šfo_t
 
ma¡”_šfo
 = { 
Çs_št_ty³_VLAN
, 
pÜt_mode
, 
bridge_šdex
};

807 
p_™”_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&
p_li¡
->
pÜt_li¡
);

809 
p_™”_node
 !ğ
NULL
)

811 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

812 "Upd©mod:Found vÏÀmemb” %d iÀbridg%d", 
p_™”_node
->
ifšdex
, 
bridge_šdex
);

813 
BASE_IF_MODE_t
 
štf_mode
 = 
	`Çs_štf_g‘_mode
(
p_™”_node
->
ifšdex
);

815 if(!
	`Çs_štf_d–_ma¡”
(
p_™”_node
->
ifšdex
, 
ma¡”_šfo
)){

816 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN","VLAN DEL:Failedo del master for vlan memeber…ort");

818 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
p_™”_node
->
ifšdex
);

819 ià(
Ãw_mode
 !ğ
štf_mode
) {

820 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
p_™”_node
->
ifšdex
, 
Ãw_mode
è=ğ
çl£
) {

821 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN", "VLAN DEL: Updateo NAS-L3‡bout interface mode change failed(%d)",

822 
p_™”_node
->
ifšdex
);

826 
p_™”_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_li¡
->
pÜt_li¡
,…_iter_node);

828  
Œue
;

829 
	}
}

831 
t_¡d_”rÜ
 
	$Çs_hªdË_vÏn_memb”s_mode_chªge
(
Çs_bridge_t
 *
p_bridge
)

833 ià(!
	`Çs_hªdË_mode_fÜ_mem_li¡
(
p_bridge
->
ifšdex
, &p_bridge->
gged_li¡
, 
NAS_PORT_TAGGED
)) {

834 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN", "bridge %d Mode change failed for vlan…ortagged†ist",

835 
p_bridge
->
ifšdex
);

838 ià(!
	`Çs_hªdË_mode_fÜ_mem_li¡
(
p_bridge
->
ifšdex
, &p_bridge->
gged_Ïg
, 
NAS_PORT_TAGGED
)) {

839 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN", "bridge %d Mode change failed for vlan†agagged†ist",

840 
p_bridge
->
ifšdex
);

842 ià(!
	`Çs_hªdË_mode_fÜ_mem_li¡
(
p_bridge
->
ifšdex
, &p_bridge->
uÁagged_li¡
, 
NAS_PORT_UNTAGGED
)) {

843 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN", "bridge %d Mode change failed for vlan…ort untagged†ist",

844 
p_bridge
->
ifšdex
);

846 ià(!
	`Çs_hªdË_mode_fÜ_mem_li¡
(
p_bridge
->
ifšdex
, &p_bridge->
uÁagged_Ïg
, 
NAS_PORT_UNTAGGED
)) {

847 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN", "bridge %d Mode change failed for vlan†ag untagged†ist",

848 
p_bridge
->
ifšdex
);

851  
STD_ERR_OK
;

852 
	}
}

855 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_d–‘e_vÏn
(
ıs_­i_objeù_t
 
obj
)

857 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

858 
buff
[
MAX_CPS_MSG_BUFF
];

861 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VLAN-DELETE", "CPS Delete VLAN ");

862 
ıs_­i_objeù_©Œ_t
 
vÏn_Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
);

863 
ıs_­i_objeù_©Œ_t
 
vÏn_if_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

865 ià((
vÏn_Çme_©Œ
 =ğ
nuÎ±r
è&& (
vÏn_if_©Œ
 ==‚ullptr)) {

866 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VLAN-DELETE", "Missing Vlan interface‚ame or if_index");

867  
ıs_­i_»t_code_ERR
;

870 
	`Çs_bridge_lock
();

871 
Çs_bridge_t
 *
p_bridge_node
 = 
NULL
;

873 ià(
vÏn_if_©Œ
 !ğ
nuÎ±r
) {

874 
h®_ifšdex_t
 
br_šdex
 = (h®_ifšdex_tè
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_if_©Œ
);

875 
p_bridge_node
 = 
	`Çs_g‘_bridge_node
(
br_šdex
);

876 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VLAN-DELETE", "CPS D–‘VLAN fÜ vÏÀšdex %d", 
br_šdex
);

878 
p_bridge_node
 = 
	`Çs_g‘_bridge_node_äom_Çme
((cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
vÏn_Çme_©Œ
));

879 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VLAN-DELETE", "CPS Delete VLAN for vlan interface %s",

880 (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(
vÏn_Çme_©Œ
));

885 ià(
p_bridge_node
 =ğ
NULL
) {

886 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VLAN-DELETE", "Error finding bridge‚ode");

887 
	`Çs_bridge_uÆock
();

888  
ıs_­i_»t_code_ERR
;

891 
ıs_­i_objeù_t
 
idx_obj
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

893 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

894 "D–‘šg Bridg%s", 
p_bridge_node
->
Çme
);

896 
	`ıs_­i_objeù_©Œ_add_u32
(
idx_obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
p_bridge_node
->
ifšdex
);

897 
	`ıs_­i_£t_key_d©a
(
idx_obj
,
IF_INTERFACES_INTERFACE_NAME
, 
ıs_­i_objeù_ATTR_T_BIN
,

898 
p_bridge_node
->
Çme
, 
	`¡¾’
(p_bridge_node->name)+1);

900 ià(
	`Çs_hªdË_vÏn_memb”s_mode_chªge
(
p_bridge_node
è!ğ
STD_ERR_OK
) {

901 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN", "nas_handle_vlan_members_mode_change failed for %d",

902 
p_bridge_node
->
ifšdex
);

905 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
p_bridge_node
->
ifšdex
, 
BASE_IF_MODE_MODE_L2
è=ğ
çl£
) {

906 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN", "Updateo NAS-L3‡bout interface mode change failed(%d)",

907 
p_bridge_node
->
ifšdex
);

909 ià(!
	`Çs_štf_ş—nup_l2mc_cÚfig
(0, 
p_bridge_node
->
vÏn_id
)) {

910 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan", "Error cleaning L2MC membership for VLAN %d",

911 
p_bridge_node
->
vÏn_id
);

913 ià(
	`Çs_os_d–_vÏn
(
idx_obj
è!ğ
STD_ERR_OK
) {

914 
	`EV_LOGGING
(
INTERFACE
, 
ERR
 , "NAS-Vlan",

915 "Fau» d–‘šg vÏÀ% äom k”Ãl", 
p_bridge_node
->
Çme
);

918 
	`Çs_ıs_ş—nup_vÏn_li¡s
(
p_bridge_node
->
vÏn_id
, &p_bridge_node->
gged_li¡
);

919 
	`Çs_ıs_ş—nup_vÏn_li¡s
(
p_bridge_node
->
vÏn_id
, &p_bridge_node->
gged_Ïg
);

921 ià(
	`Çs_ş—nup_bridge
(
p_bridge_node
è!ğ
STD_ERR_OK
) {

922 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan", "Failure cleaning vlan data");

923 
rc
 = 
ıs_­i_»t_code_ERR
;

925 
	`Çs_bridge_uÆock
();

926  
rc
;

927 
	}
}

930 
ıs_­i_»tuº_code_t
 
	$Çs_ıs_£t_vÏn
(
ıs_­i_objeù_t
 
obj
)

932 
h®_ifšdex_t
 
br_šdex
 = 0;

933 
Çs_bridge_t
 *
p_bridge
;

935 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan", "CPS Set VLAN");

937 
ıs_­i_objeù_©Œ_t
 
vÏn_Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
obj
, 
IF_INTERFACES_INTERFACE_NAME
);

938 
ıs_­i_objeù_©Œ_t
 
vÏn_if_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

940 ià((
vÏn_Çme_©Œ
 =ğ
nuÎ±r
è&& (
vÏn_if_©Œ
 ==‚ullptr)) {

941 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan-SET", "Missing Vlan interface‚ame or if_index");

942  
ıs_­i_»t_code_ERR
;

945 
	`Çs_bridge_lock
();

947 ià(
vÏn_if_©Œ
 !ğ
nuÎ±r
) {

948 
br_šdex
 = (
h®_ifšdex_t
è
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_if_©Œ
);

949 
p_bridge
 = 
	`Çs_g‘_bridge_node
(
br_šdex
);

951 
p_bridge
 = 
	`Çs_g‘_bridge_node_äom_Çme
((cÚ¡ *)
	`ıs_­i_objeù_©Œ_d©a_bš
(
vÏn_Çme_©Œ
));

954 ià(
p_bridge
 =ğ
NULL
) {

955 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

956 "E¼Ü fšdšg ifšdex %d fÜ Bridgš CPS S‘", 
br_šdex
);

957 
	`Çs_bridge_uÆock
();

958  
ıs_­i_»t_code_ERR
;

961 
ıs_­i_objeù_©Œ_t
 
©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_VLAN_TYPE
);

963 ià(
©Œ
 !ğ
NULL
) {

964 
BASE_IF_VLAN_TYPE_t
 
vÏn_ty³
 = (BASE_IF_VLAN_TYPE_tè
	`ıs_­i_objeù_©Œ_d©a_u32
(
©Œ
);

965 
p_bridge
->
št_sub_ty³
 = (è
vÏn_ty³
;

968 ià(
	`Çs_ıs_upd©e_vÏn
(
p_bridge
, 
obj
è!ğ
ıs_­i_»t_code_OK
) {

969 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

971 
p_bridge
->
ifšdex
,…_bridge->
vÏn_id
);

972 
	`Çs_bridge_uÆock
();

973  
ıs_­i_»t_code_ERR
;

975 
	`Çs_bridge_uÆock
();

976  
ıs_­i_»t_code_OK
;

977 
	}
}

979 
ıs_­i_»tuº_code_t
 
	$Çs_´oûss_ıs_vÏn_£t
(*
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
, 
size_t
 
ix
)

981 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

982 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

984 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

987 
ıs_­i_objeù_t
 
şÚed
 = 
	`ıs_­i_objeù_li¡_ü—‹_obj_ªd_­³nd
(
·¿m
->
´ev
);

988 ià(
şÚed
 =ğ
NULL
è 
ıs_­i_»t_code_ERR
;

990 
	`ıs_­i_objeù_şÚe
(
şÚed
,
obj
);

992 ià(
İ
 =ğ
ıs_­i_İ”_CREATE
è(
	`Çs_ıs_ü—‹_vÏn
(
obj
));

993 ià(
İ
 =ğ
ıs_­i_İ”_SET
è(
	`Çs_ıs_£t_vÏn
(
obj
));

994 ià(
İ
 =ğ
ıs_­i_İ”_DELETE
è(
	`Çs_ıs_d–‘e_vÏn
(
obj
));

996  
ıs_­i_»t_code_ERR
;

997 
	}
}

999 
ıs_­i_»tuº_code_t
 
	$Çs_´oûss_ıs_vÏn_g‘
(* 
cÚ‹xt
,

1000 
ıs_­i_g‘_·¿ms_t
 *
·¿m
,

1001 
size_t
 
ix
)

1003 
size_t
 
iix
 = 0;

1004 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
·¿m
->
li¡
);

1006 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

1008 
	`Çs_bridge_lock
();

1010 
ıs_­i_objeù_t
 
f‹r
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
, 
ix
);

1011 
ıs_­i_objeù_©Œ_t
 
Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
f‹r
,

1012 
IF_INTERFACES_INTERFACE_NAME
);

1013 
ıs_­i_objeù_©Œ_t
 
vÏn_id_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
f‹r
,

1014 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
);

1015 
ıs_­i_objeù_©Œ_t
 
if_šdex_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
f‹r
,

1016 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

1018 ià(
Çme_©Œ
 !ğ
NULL
 || 
if_šdex_©Œ
 != NULL) {

1019 cÚ¡ *
if_Çme
 = 
NULL
;

1020 
h®_ifšdex_t
 
šdex
 = 0;

1021 if(
Çme_©Œ
è
if_Çme
 = (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(name_attr);

1022 if(
if_šdex_©Œ
è
šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(if_index_attr);

1023 ià(
	`Çs_g‘_vÏn_štf
(
if_Çme
, 
šdex
, 
·¿m
->
li¡
, 
çl£
è!ğ
STD_ERR_OK
) {

1024 
	`Çs_bridge_uÆock
();

1025  
ıs_­i_»t_code_ERR
;

1027 } ià(
vÏn_id_©Œ
 !ğ
NULL
) {

1028 
h®_vÏn_id_t
 
vid
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_id_©Œ
);

1029 ià(
	`Çs_g‘_vÏn_štf_äom_vid
(
vid
, 
·¿m
->
li¡
, 
çl£
è!ğ
STD_ERR_OK
) {

1030 
	`Çs_bridge_uÆock
();

1031  
ıs_­i_»t_code_ERR
;

1035 
	`Çs_vÏn_g‘_®l_šfo
(
·¿m
->
li¡
);

1038 ++
iix
;

1039 }
iix
 < 
mx
);

1041 
	`Çs_bridge_uÆock
();

1042  
ıs_­i_»t_code_OK
;

1043 
	}
}

1045 
ıs_­i_»tuº_code_t
 
	$Çs_´oûss_ıs_vÏn_¡©e_£t
(*
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
, 
size_t
 
ix
)

1047  
ıs_­i_»t_code_ERR
;

1048 
	}
}

1050 
ıs_­i_»tuº_code_t
 
	$Çs_´oûss_ıs_vÏn_¡©e_g‘
(* 
cÚ‹xt
,

1051 
ıs_­i_g‘_·¿ms_t
 *
·¿m
,

1052 
size_t
 
ix
)

1054 
size_t
 
iix
 = 0;

1055 
size_t
 
mx
 = 
	`ıs_­i_objeù_li¡_size
(
·¿m
->
li¡
);

1057 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan",

1059 
	`Çs_bridge_lock
();

1061 
ıs_­i_objeù_t
 
f‹r
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
, 
ix
);

1062 
ıs_­i_objeù_©Œ_t
 
Çme_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
f‹r
,

1063 
IF_INTERFACES_STATE_INTERFACE_NAME
);

1064 
ıs_­i_objeù_©Œ_t
 
if_šdex_©Œ
 = 
	`ıs_­i_g‘_key_d©a
(
f‹r
,

1065 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
);

1066 
ıs_­i_objeù_©Œ_t
 
vÏn_id_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
f‹r
,

1067 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
);

1069 ià(
Çme_©Œ
 !ğ
NULL
 || 
if_šdex_©Œ
 != NULL) {

1070 cÚ¡ *
if_Çme
 = 
NULL
;

1071 
h®_ifšdex_t
 
šdex
 = 0;

1072 if(
Çme_©Œ
è
if_Çme
 = (*)
	`ıs_­i_objeù_©Œ_d©a_bš
(name_attr);

1073 if(
if_šdex_©Œ
è
šdex
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(if_index_attr);

1074 ià(
	`Çs_g‘_vÏn_štf
(
if_Çme
, 
šdex
, 
·¿m
->
li¡
, 
Œue
è!ğ
STD_ERR_OK
) {

1075 
	`Çs_bridge_uÆock
();

1076  
ıs_­i_»t_code_ERR
;

1078 } ià(
vÏn_id_©Œ
 !ğ
NULL
) {

1079 
h®_vÏn_id_t
 
vid
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
vÏn_id_©Œ
);

1080 ià(
	`Çs_g‘_vÏn_štf_äom_vid
(
vid
, 
·¿m
->
li¡
, 
Œue
è!ğ
STD_ERR_OK
) {

1081 
	`Çs_bridge_uÆock
();

1082  
ıs_­i_»t_code_ERR
;

1086 
	`Çs_vÏn_g‘_®l_šfo
(
·¿m
->
li¡
);

1089 ++
iix
;

1090 }
iix
 < 
mx
);

1092 
	`Çs_bridge_uÆock
();

1093  
ıs_­i_»t_code_OK
;

1094 
	}
}

1097 
ıs_­i_»tuº_code_t
 
	$Çs_if_hªdË_glob®_£t
 (* 
cÚ‹xt
,

1098 
ıs_­i_Œª§ùiÚ_·¿ms_t
 *
·¿m
,

1099 
size_t
 
ix
) {

1100 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

1101 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

1103 
	`EV_LOGGING
(
INTERFACE
, 
DEBUG
, "NAS-Vlan","nas_if_handle_global_set");

1105 ifĞ
İ
 =ğ
ıs_­i_İ”_SET
){

1106 
ıs_­i_objeù_©Œ_t
 
_sÿËd_vÏn_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
,

1107 
DELL_IF_IF_INTERFACES_VLAN_GLOBALS_SCALED_VLAN
);

1108 ià(
_sÿËd_vÏn_©Œ
 !ğ
NULL
) {

1109 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`_lg
(&
_vÏn_mode_mtx
);

1110 
_sÿËd_vÏn
 = 
	`ıs_­i_objeù_©Œ_d©a_ušt
(
_sÿËd_vÏn_©Œ
);

1111 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN","Changedhe default scaled vlan modeo %d",

1112 
_sÿËd_vÏn
);

1113  
ıs_­i_»t_code_OK
;

1117  
ıs_­i_»t_code_ERR
;

1119 
	}
}

1121 
	$_´oûss_vÏn_cÚfig_fe
(){

1123 
¡d_cÚfig_hdl_t
 
_hdl
 = 
	`¡d_cÚfig_lßd
(
INTERFACE_VLAN_CFG_FILE
);

1124 if(
_hdl
 =ğ
NULL
){

1125 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN","Error†oading Interface VLAN config file");

1128 
¡d_cÚfig_node_t
 
_node
 = 
	`¡d_cÚfig_g‘_roÙ
(
_hdl
);

1129 if(
_node
 =ğ
NULL
){

1132 
_node
 = 
	`¡d_cÚfig_g‘_chd
(_node); _nod!ğ
NULL
 ; _nodğ
	`¡d_cÚfig_Ãxt_node
(_node)){

1133 cÚ¡ * 
vÏn_id
 = 
	`¡d_cÚfig_©Œ_g‘
(
_node
,"id");

1134 
_l3_vÏn_£t
.
	`š£¹
(
	`©oi
(
vÏn_id
));

1137 
	`¡d_cÚfig_uÆßd
(
_hdl
);

1139 
	}
}

1141 
t_¡d_”rÜ
 
	$Çs_ıs_vÏn_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
hªdË
) {

1143 
	`_´oûss_vÏn_cÚfig_fe
();

1145 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF
, 
Çs_št_ty³_VLAN
,

1146 
Çs_´oûss_ıs_vÏn_g‘
, 
Çs_´oûss_ıs_vÏn_£t
è!ğ
STD_ERR_OK
) {

1147 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VLAN-INIT", "Failedo„egister VLAN interface CPS handler");

1148  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1151 ià(
	`štf_obj_hªdËr_»gi¡¿tiÚ
(
obj_INTF_STATE
, 
Çs_št_ty³_VLAN
,

1152 
Çs_´oûss_ıs_vÏn_¡©e_g‘
, 
Çs_´oûss_ıs_vÏn_¡©e_£t
è!ğ
STD_ERR_OK
) {

1153 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VLAN-INIT", "Failedo„egister VLAN interface state CPS handler");

1154  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1157 
	`Çs_št_İ”_¡©e_»gi¡”_cb
(
Çs_pÜt_upd©e_vÏn_İ”_¡©e_cb
);

1158 
	`Çs_Ïg_İ”_¡©e_»gi¡”_cb
(
Çs_Ïg_upd©e_vÏn_İ”_¡©e_cb
);

1160 
ıs_­i_ev’t_»g_t
 
»g
;

1161 
ıs_­i_key_t
 
key
;

1163 
	`mem£t
(&
»g
, 0, (
ıs_­i_ev’t_»g_t
));

1165 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
key
,

1166 
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_OBJ
,

1167 
ıs_­i_qu®if›r_OBSERVED
)) {

1168 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VLAN-INIT", "Cannot create‡ key for interfaceƒvent");

1169  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1172 
»g
.
objeùs
 = &
key
;

1173 
»g
.
numb”_of_objeùs
 = 1;

1175 ià(
	`ıs_­i_ev’t_th»ad_»g
(&
»g
, 
Çs_vÏn_if_£t_hªdËr
, 
NULL
)

1176 !ğ
ıs_­i_»t_code_OK
) {

1177 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VLAN-INIT", "Cannot„egister interface operationƒvent");

1178  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1181 
ıs_­i_»gi¡¿tiÚ_funùiÚs_t
 
f
;

1182 
	`mem£t
(&
f
,0,(f));

1184 
buff
[
CPS_API_KEY_STR_MAX
];

1185 
	`mem£t
(
buff
,0,(buff));

1188 ià(
	`ıs_­i_İ”©iÚ_subsy¡em_š™
(&
Çs_if_glob®_hªdË
,
NUM_INT_CPS_API_THREAD
)!=
ıs_­i_»t_code_OK
) {

1189  
	`STD_ERR
(
CPSNAS
,
FAIL
,0);

1192 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
f
.
key
,
DELL_BASE_IF_CMN_IF_INTERFACES_OBJ
,

1193 
ıs_­i_qu®if›r_TARGET
)) {

1194 
	`EV_LOGGING
(
INTERFACE
,
ERR
,"NAS-VLAN","Could‚otranslate %do key %s",

1195 ()(
DELL_BASE_IF_CMN_IF_INTERFACES_OBJ
),

1196 
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

1197  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1200 
f
.
hªdË
 = 
Çs_if_glob®_hªdË
;

1201 
f
.
_wr™e_funùiÚ
 = 
Çs_if_hªdË_glob®_£t
;

1203 ià(
	`ıs_­i_»gi¡”
(&
f
)!=
ıs_­i_»t_code_OK
) {

1204  
	`STD_ERR
(
INTERFACE
,
FAIL
,0);

1207  
STD_ERR_OK
;

1208 
	}
}

1210 
t_¡d_”rÜ
 
	$Çs_ıs_add_pÜt_to_os
(
h®_ifšdex_t
 
br_šdex
, 
h®_vÏn_id_t
 
vÏn_id
,

1211 
Çs_pÜt_mode_t
 
pÜt_mode
, 
h®_ifšdex_t
 
pÜt_idx
,
ušt32_t
 
mtu
,

1212 
BASE_IF_MODE_t
 
vÏn_mode
)

1214 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`_lg
(&
_vÏn_mode_mtx
);

1215 if(
_sÿËd_vÏn
 && 
vÏn_mode
 !ğ
BASE_IF_MODE_MODE_L3
){

1216  
STD_ERR_OK
;

1219 
h®_ifšdex_t
 
vÏn_šdex
 = 0;

1220 
buff
[
MAX_CPS_MSG_BUFF
];

1221 
ıs_­i_objeù_t
 
Çme_obj
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

1223 
	`ıs_­i_objeù_©Œ_add_u32
(
Çme_obj
,
DELL_BASE_IF_CMN_IF_INTERFACES_INTERFACE_IF_INDEX
, 
br_šdex
);

1224 
	`ıs_­i_objeù_©Œ_add_u32
(
Çme_obj
,
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
, 
vÏn_id
);

1225 if(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

1226 
	`ıs_­i_objeù_©Œ_add_u32
(
Çme_obj
,
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
, 
pÜt_idx
);

1227 if(
mtu
è
	`ıs_­i_objeù_©Œ_add_u32
(
Çme_obj
,
DELL_IF_IF_INTERFACES_INTERFACE_MTU
,mtu);

1230 
	`ıs_­i_objeù_©Œ_add_u32
(
Çme_obj
,
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
, 
pÜt_idx
);

1233 ià(
	`Çs_os_add_pÜt_to_vÏn
(
Çme_obj
, &
vÏn_šdex
è!ğ
STD_ERR_OK
) {

1234 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1235 "E¼Ü‡ddšg…Üˆ%dØvÏÀšhK”Ãl", 
pÜt_idx
);

1236  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

1239  
STD_ERR_OK
;

1240 
	}
}

1242 
t_¡d_”rÜ
 
	$Çs_ıs_add_pÜt_to_vÏn
(
Çs_bridge_t
 *
p_bridge
, 
h®_ifšdex_t
 
pÜt_idx
, 
Çs_pÜt_mode_t
 
pÜt_mode
)

1244 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
;

1245 
h®_vÏn_id_t
 
vÏn_id
 = 0;

1246 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

1248 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

1253 
vÏn_id
 = 
p_bridge
->vlan_id;

1254 
if_ma¡”_šfo_t
 
ma¡”_šfo
 = { 
Çs_št_ty³_VLAN
, 
pÜt_mode
, 
p_bridge
->
ifšdex
};

1255 
BASE_IF_MODE_t
 
štf_mode
 = 
	`Çs_štf_g‘_mode
(
pÜt_idx
);

1258 if(
	`Çs_ıs_add_pÜt_to_os
(
p_bridge
->
ifšdex
,…_bridge->
vÏn_id
, 
pÜt_mode
,

1259 
pÜt_idx
, 
p_bridge
->
mtu
,p_bridge->
mode
è!ğ
STD_ERR_OK
) {

1260 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1261 "E¼Ü in£¹šg index %d iÀVÏÀ%dØOS", 
pÜt_idx
, 
p_bridge
->
vÏn_id
);

1262 
rc
 = (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

1265 if(!
	`Çs_štf_add_ma¡”
(
pÜt_idx
, 
ma¡”_šfo
)){

1266 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN","Failedo‡dd master for vlan memeber…ort");

1268 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
pÜt_idx
);

1270 ià(
Ãw_mode
 !ğ
štf_mode
) {

1271 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
pÜt_idx
, 
Ãw_mode
è=ğ
çl£
) {

1272 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN", "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
pÜt_idx
);

1277 
boŞ
 
ü—‹_æag
 = 
çl£
;

1279 
p_lšk_node
 = 
	`Çs_ü—‹_vÏn_pÜt_node
(
p_bridge
, 
pÜt_idx
,

1280 
pÜt_mode
, &
ü—‹_æag
);

1282 ià((
p_lšk_node
 !ğ
NULL
è&& (!
	`Çs_is_nÚ_Åu_phy_pÜt
(
pÜt_idx
))) {

1283 if((
rc
 = 
	`Çs_add_Ü_d–_pÜt_to_vÏn
(
p_lšk_node
->
ndi_pÜt
.
Åu_id
, 
vÏn_id
,

1284 &(
p_lšk_node
->
ndi_pÜt
), 
pÜt_mode
, 
Œue
, 
pÜt_idx
)è!ğ
STD_ERR_OK
) {

1285 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1287 
p_lšk_node
->
ndi_pÜt
.
Åu_id
,…_lšk_node->ndi_pÜt.
Åu_pÜt
);

1288 
	`Çs_ıs_d–_pÜt_äom_os
(
vÏn_id
, 
pÜt_idx
, 
pÜt_mode
,
p_bridge
->
mode
);

1289  
rc
;

1293 if(
pÜt_mode
 =ğ
NAS_PORT_UNTAGGED
) {

1294 if((
rc
 = 
	`ndi_£t_pÜt_vid
(
p_lšk_node
->
ndi_pÜt
.
Åu_id
,

1295 
p_lšk_node
->
ndi_pÜt
.
Åu_pÜt
, 
vÏn_id
)è!ğ
STD_ERR_OK
) {

1296 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1298 
p_lšk_node
->
ndi_pÜt
.
Åu_id
,…_lšk_node->ndi_pÜt.
Åu_pÜt
,

1299 
vÏn_id
);

1300 
	`Çs_ıs_d–_pÜt_äom_os
(
vÏn_id
, 
pÜt_idx
, 
pÜt_mode
,
p_bridge
->
mode
);

1301  
rc
;

1307 ià(
p_lšk_node
 =ğ
NULL
) {

1308 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1309 "E¼Ü in£¹šg index %d iÀli¡", 
pÜt_idx
);

1310 
rc
 = (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

1314  
rc
;

1315 
	}
}

1318 
t_¡d_”rÜ
 
	$Çs_ıs_d–_pÜt_äom_os
(
h®_vÏn_id_t
 
vÏn_id
, 
h®_ifšdex_t
 
pÜt_šdex
,

1319 
Çs_pÜt_mode_t
 
pÜt_mode
, 
BASE_IF_MODE_t
 
vÏn_mode
)

1321 
¡d_mu‹x_sim¶e_lock_gu¬d
 
	`_lg
(&
_vÏn_mode_mtx
);

1322 if(
_sÿËd_vÏn
 && 
vÏn_mode
 !ğ
BASE_IF_MODE_MODE_L3
){

1323  
STD_ERR_OK
;

1326 
buff
[
MAX_CPS_MSG_BUFF
];

1328 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

1330 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
, 
vÏn_id
);

1332 ià(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

1333 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
, 
pÜt_šdex
);

1336 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
DELL_IF_IF_INTERFACES_INTERFACE_UNTAGGED_PORTS
, 
pÜt_šdex
);

1339 ià(
	`Çs_os_d–_pÜt_äom_vÏn
(
obj
è!ğ
STD_ERR_OK
) {

1340 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1341 "E¼Ü d–‘šg iÁ”çû %d from OS", 
pÜt_šdex
);

1344  
STD_ERR_OK
;

1345 
	}
}

1347 
t_¡d_”rÜ
 
	$Çs_ıs_d–_pÜt_äom_vÏn
(
Çs_bridge_t
 *
p_bridge
, 
Çs_li¡_node_t
 *
p_lšk_node
, 
Çs_pÜt_mode_t
 
pÜt_mode
)

1349 
Çs_li¡_t
 *
p_li¡
 = 
NULL
;

1351 ià(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

1352 
p_li¡
 = &
p_bridge
->
gged_li¡
;

1355 
p_li¡
 = &
p_bridge
->
uÁagged_li¡
;

1358 
if_ma¡”_šfo_t
 
ma¡”_šfo
 = { 
Çs_št_ty³_VLAN
, 
pÜt_mode
, 
p_bridge
->
ifšdex
};

1359 
BASE_IF_MODE_t
 
štf_mode
 = 
	`Çs_štf_g‘_mode
(
p_lšk_node
->
ifšdex
);

1360 if(!
	`Çs_štf_d–_ma¡”
(
p_lšk_node
->
ifšdex
, 
ma¡”_šfo
)){

1361 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN","Failedo del master for vlan memeber…ort");

1363 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
p_lšk_node
->
ifšdex
);

1364 ià(
Ãw_mode
 !ğ
štf_mode
) {

1365 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
p_lšk_node
->
ifšdex
, 
Ãw_mode
è=ğ
çl£
) {

1366 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN", "Updateo NAS-L3‡bout interface mode change failed(%d)",

1367 
p_lšk_node
->
ifšdex
);

1372 if(!
	`Çs_štf_ş—nup_l2mc_cÚfig
(
p_lšk_node
->
ifšdex
, 
p_bridge
->
vÏn_id
)) {

1373 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1374 "E¼Ü cËªšg L2MC memb”sh fÜ iÁ”çû %d", 
p_lšk_node
->
ifšdex
);

1376 ià(!
	`Çs_is_nÚ_Åu_phy_pÜt
(
p_lšk_node
->
ifšdex
)) {

1378 ià(
	`Çs_add_Ü_d–_pÜt_to_vÏn
(
p_lšk_node
->
ndi_pÜt
.
Åu_id
, 
p_bridge
->
vÏn_id
,

1379 &(
p_lšk_node
->
ndi_pÜt
), 
pÜt_mode
, 
çl£
,…_lšk_node->
ifšdex
)

1380 !ğ
STD_ERR_OK
) {

1381 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1382 "E¼Ü d–‘šg…Üˆ%d w™h mod%d from vÏÀ%d", 
p_lšk_node
->
ifšdex
,

1383 
pÜt_mode
, 
p_bridge
->
vÏn_id
);

1384  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

1388 ià(
	`Çs_ıs_d–_pÜt_äom_os
(
p_bridge
->
vÏn_id
, 
p_lšk_node
->
ifšdex
, 
pÜt_mode
,p_bridge->
mode
è!ğ
STD_ERR_OK
) {

1389 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1390 "E¼Ü d–‘šg iÁ”çû %d from OS", 
p_lšk_node
->
ifšdex
);

1393 
	`Çs_d–‘e_lšk_node
(&
p_li¡
->
pÜt_li¡
, 
p_lšk_node
);

1394 --
p_li¡
->
pÜt_couÁ
;

1396  
STD_ERR_OK
;

1397 
	}
}

1399 
t_¡d_”rÜ
 
	$Çs_ıs_ş—nup_vÏn_li¡s
(
h®_vÏn_id_t
 
vÏn_id
, 
Çs_li¡_t
 *
p_lšk_node_li¡
)

1401 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
, *
‹mp_node
 = NULL;

1402 
buff
[
MAX_CPS_MSG_BUFF
];

1404 
p_lšk_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&
p_lšk_node_li¡
->
pÜt_li¡
);

1405 if(
p_lšk_node
 !ğ
NULL
) {

1406 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

1407 "Found vÏÀštà%d fÜ d–‘iÚ from OS", 
p_lšk_node
->
ifšdex
);

1409 
p_lšk_node
 !ğ
NULL
) {

1410 
‹mp_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_lšk_node_li¡
->
pÜt_li¡
, 
p_lšk_node
);

1412 
ıs_­i_objeù_t
 
vÏn_obj
 = 
	`ıs_­i_objeù_š™
(
buff
, (buff));

1414 
	`ıs_­i_objeù_©Œ_add_u32
(
vÏn_obj
,
DELL_IF_IF_INTERFACES_INTERFACE_TAGGED_PORTS
, 
p_lšk_node
->
ifšdex
);

1415 
	`ıs_­i_objeù_©Œ_add_u32
(
vÏn_obj
,
BASE_IF_VLAN_IF_INTERFACES_INTERFACE_ID
, 
vÏn_id
);

1417 if(
	`Çs_os_d–_vÏn_š‹rçû
(
vÏn_obj
è!ğ
STD_ERR_OK
) {

1418 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1419 "Fau» d–‘šg vÏÀštà%d from OS", 
p_lšk_node
->
ifšdex
);

1421 
p_lšk_node
 = 
‹mp_node
;

1424  
STD_ERR_OK
;

1425 
	}
}

1427 
t_¡d_”rÜ
 
	$Çs_´oûss_ıs_pÜts
(
Çs_bridge_t
 *
p_bridge
, 
Çs_pÜt_mode_t
 
pÜt_mode
,

1428 
Çs_pÜt_li¡_t
 &
pÜt_šdex_li¡
, 
vÏn_rŞl_bk_t
 *
p_rŞl_bk
 )

1430 
Çs_li¡_t
 *
p_li¡
 = 
NULL
;

1431 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
, *
p_‹mp_node
 = NULL;

1432 
h®_ifšdex_t
 
ifšdex
 = 0;

1433 
Çs_št_ty³_t
 
št_ty³
;

1434 
Çs_pÜt_li¡_t
 
publish_li¡
;

1435 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

1437 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

1438 "Proûssšg PÜˆli¡ fÜ chªge fÜ VÏÀ%d", 
p_bridge
->
vÏn_id
);

1440 if(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

1441 
p_li¡
 = &(
p_bridge
->
gged_li¡
);

1444 
p_li¡
 = &(
p_bridge
->
uÁagged_li¡
);

1449 
p_lšk_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&(
p_li¡
->
pÜt_li¡
));

1450 
p_lšk_node
 !ğ
NULL
) {

1451 
ifšdex
 = 
p_lšk_node
->ifindex;

1452 
p_‹mp_node
 = 
p_lšk_node
;

1453 
p_lšk_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_li¡
->
pÜt_li¡
, 
p_‹mp_node
);

1455 ià(
pÜt_šdex_li¡
.
	`fšd
(
ifšdex
è=ğpÜt_šdex_li¡.
	`’d
()){

1456 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

1458 
ifšdex
);

1460 
publish_li¡
.
	`š£¹
(
p_‹mp_node
->
ifšdex
);

1461 ià((
rc
 = 
	`Çs_ıs_d–_pÜt_äom_vÏn
(
p_bridge
, 
p_‹mp_node
, 
pÜt_mode
)è!ğ
STD_ERR_OK
) {

1462 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1463 "E¼Ü d–‘šg…Üˆ%d from Bridg%d iÀOS", 
ifšdex
, 
p_bridge
->ifindex);

1464  
rc
;

1466 
p_rŞl_bk
->
pÜt_d–_li¡
[
ifšdex
] = 
pÜt_mode
;

1471 ià(!
publish_li¡
.
	`em±y
()) {

1472 
	`Çs_publish_vÏn_pÜt_li¡
(
p_bridge
, 
publish_li¡
, 
pÜt_mode
, 
ıs_­i_İ”_DELETE
);

1473 
publish_li¡
.
	`ş—r
();

1476 ià((
rc
 = 
	`Çs_hªdË_Ïg_šdex_š_ıs_£t
(
p_bridge
, 
pÜt_šdex_li¡
, 
pÜt_mode
, 
p_rŞl_bk
)è!ğ
STD_ERR_OK
) {

1477 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan", "nas_handle_lag_index_in_cps_set delete†ag failed for bridge %d ",

1478 
p_bridge
->
ifšdex
);

1479  
rc
;

1484 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

1486 autØ
™
 = 
pÜt_šdex_li¡
.
	`begš
(è; iˆ!ğpÜt_šdex_li¡.
	`’d
() ; ++it) {

1487 
	`Çs_g‘_št_ty³
(*
™
, &
št_ty³
);

1489 if(
št_ty³
 =ğ
Çs_št_ty³_LAG
) {

1490 
Çs_li¡_t
 *
p_Ïg_li¡
;

1491 ià(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

1492 
p_Ïg_li¡
 = &(
p_bridge
->
gged_Ïg
);

1494 
p_Ïg_li¡
 = &(
p_bridge
->
uÁagged_Ïg
);

1496 
p_lšk_node
 = 
	`Çs_g‘_lšk_node
(&(
p_Ïg_li¡
->
pÜt_li¡
), *
™
);

1497 ià(
p_lšk_node
 =ğ
NULL
) {

1498 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

1499 "Reûived LAG %d fÜ‡dd™iÚØVÏÀ%d", *
™
, 
p_bridge
->
vÏn_id
);

1501 ià((
rc
 = 
	`Çs_hªdË_Ïg_add_to_vÏn
(
p_bridge
, *
™
,

1502 
pÜt_mode
, 
Œue
, 
p_rŞl_bk
)è!ğ
STD_ERR_OK
) {

1503  
rc
;

1508 
p_lšk_node
 = 
	`Çs_g‘_lšk_node
(&(
p_li¡
->
pÜt_li¡
), *
™
);

1510 ià(
p_lšk_node
 =ğ
NULL
) {

1511 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

1512 "Reûived‚ew…Üˆ%d iÀbridg%d, VLAN %d", *
™
, 
p_bridge
->
ifšdex
,

1513 
p_bridge
->
vÏn_id
);

1515 ià((
rc
 = 
	`Çs_ıs_add_pÜt_to_vÏn
(
p_bridge
, *
™
, 
pÜt_mode
)è!ğ
STD_ERR_OK
) {

1516 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

1517 "E¼Ü‡ddšg…Üˆ%dØbridg%d iÀvÏn", *
™
, 
p_bridge
->
ifšdex
);

1518  
rc
;

1521 
p_rŞl_bk
->
pÜt_add_li¡
[*(
™
)] = 
pÜt_mode
;

1522 
publish_li¡
.
	`š£¹
(*
™
);

1526 ià(!
publish_li¡
.
	`em±y
()) {

1527 
	`Çs_publish_vÏn_pÜt_li¡
(
p_bridge
, 
publish_li¡
, 
pÜt_mode
, 
ıs_­i_İ”_CREATE
);

1529  
rc
;

1530 
	}
}

	@src/vlan/nas_vlan_lag_api.cpp

22 
	~"¡d_”rÜ_codes.h
"

23 
	~"ev’t_log.h
"

24 
	~"Çs_št_vÏn.h
"

25 
	~"Çs_št_Ïg_­i.h
"

26 
	~"Çs_ndi_vÏn.h
"

27 
	~"Çs_ndi_Ïg.h
"

29 
t_¡d_”rÜ
 
	$Çs_d–‘e_Ïg_äom_vÏn_š_Åu
(
h®_ifšdex_t
 
ifšdex
 ,
h®_vÏn_id_t
 
vid
, 
Çs_pÜt_mode_t
 
pÜt_mode
) {

31 
ndi_obj_id_t
 *
uÁagged_Ïg
 = 
NULL
;

32 
ndi_obj_id_t
 *
gged_Ïg
 = 
NULL
;

33 
size_t
 
g_út
 =0, 
uÁag_út
=0;

34 
ndi_obj_id_t
 
ndi_Ïg_id
;

35 
t_¡d_”rÜ
 
»t
;

37 (
pÜt_mode
 =ğ
NAS_PORT_TAGGED
è? (
gged_Ïg
 = &
ndi_Ïg_id
, 
g_út
=1) :

38 (
uÁagged_Ïg
 = &
ndi_Ïg_id
,
uÁag_út
=1);

41 ià((
»t
 = 
	`Çs_Ïg_g‘_ndi_Ïg_id
 (
ifšdex
, &
ndi_Ïg_id
)è!ğ
STD_ERR_OK
) {

42 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VLAN", "Error finding NDI LAG ID %d %d ",

43 
ifšdex
, 
vid
);

44  
»t
;

46 
»t
 = 
	`ndi_d–_Ïg_äom_vÏn
(0, 
vid
, 
gged_Ïg
, 
g_út
, 
uÁagged_Ïg
, 
uÁag_út
);

47 ià(
»t
 !ğ
STD_ERR_OK
) {

48 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-VLAN", "Çs_d–‘e_Ïg_äom_vÏÀçedØd–‘LAG from vÏÀid <%d>", 
vid
 );

49  
»t
;

51  
STD_ERR_OK
;

52 
	}
}

56 
t_¡d_”rÜ
 
	$Çs_add_Ü_d–_Ïg_š_vÏn
(
h®_ifšdex_t
 
Ïg_šdex
, 
h®_vÏn_id_t
 
vÏn_id
,

57 
Çs_pÜt_mode_t
 
pÜt_mode
, 
boŞ
 
add_æag
, boŞ 
rŞl_bk
)

59 
ndi_obj_id_t
 *
uÁagged_Ïg
 = 
NULL
;

60 
ndi_obj_id_t
 *
gged_Ïg
 = 
NULL
;

61 
ndi_obj_id_t
 
ndi_Ïg_id
;

62 
t_¡d_”rÜ
 
»t
 = 
STD_ERR_OK
;

63 
size_t
 
g_út
 =0, 
uÁag_út
=0;

64 
Çs_bridge_t
 *
vÏn_’Œy
 = 
	`Çs_g‘_bridge_node_äom_vid
(
vÏn_id
);

65 
Çs_Ïg_ma¡”_šfo_t
 *
Çs_Ïg_’Œy
 = 
	`Çs_g‘_Ïg_node
(
Ïg_šdex
);

67 ià(!
vÏn_’Œy
 || !
Çs_Ïg_’Œy
) {

68  (
	`STD_ERR
(
INTERFACE
,
FAIL
, 0));

71 (
pÜt_mode
 =ğ
NAS_PORT_TAGGED
è? (
gged_Ïg
 = &
ndi_Ïg_id
, 
g_út
=1) :

72 (
uÁagged_Ïg
 = &
ndi_Ïg_id
,
uÁag_út
=1);

74 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VLAN",

76 
Ïg_šdex
, 
add_æag
, 
vÏn_id
);

78 ià((
»t
 = 
	`Çs_Ïg_g‘_ndi_Ïg_id
 (
Ïg_šdex
, &
ndi_Ïg_id
)è!ğ
STD_ERR_OK
) {

79 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-VLAN", "Error finding NDI LAG ID %d %d %d",

80 
Ïg_šdex
, 
vÏn_id
, 
add_æag
);

81  
»t
;

84 ià(
add_æag
) {

85 
»t
 = 
	`ndi_add_Ïg_to_vÏn
(0, 
vÏn_id
, 
gged_Ïg
, 
g_út
, 
uÁagged_Ïg
, 
uÁag_út
);

86 ià(
pÜt_mode
 =ğ
NAS_PORT_UNTAGGED
) {

87 
	`ndi_£t_Ïg_pvid
(0, 
ndi_Ïg_id
, 
vÏn_id
);

90 ià(
Çs_Ïg_’Œy
->
İ”_¡©us
) {

91 (
vÏn_’Œy
->
İ”_li¡
)[
Ïg_šdex
] = 
Œue
;

92 
vÏn_’Œy
->
İ”_¡©us
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
;

94 (
vÏn_’Œy
->
İ”_li¡
)[
Ïg_šdex
] = 
Œue
;

96 
	`Çs_upd©e_pÜt_to_vÏns_m­
(
Ïg_šdex
, 
vÏn_’Œy
->
ifšdex
, 
Œue
);

98 
»t
 = 
	`ndi_d–_Ïg_äom_vÏn
(0, 
vÏn_id
, 
gged_Ïg
, 
g_út
, 
uÁagged_Ïg
, 
uÁag_út
);

99 (
vÏn_’Œy
->
İ”_li¡
).
	`”a£
(
Ïg_šdex
);

100 
vÏn_’Œy
->
İ”_¡©us
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_DOWN
;

101 cÚ¡‡utØ&
İ”_¡©us
 : 
vÏn_’Œy
->
İ”_li¡
) {

102 ià(
İ”_¡©us
.
£cÚd
) {

103 
vÏn_’Œy
->
İ”_¡©us
 = 
IF_INTERFACES_STATE_INTERFACE_OPER_STATUS_UP
;

107 
	`Çs_upd©e_pÜt_to_vÏns_m­
(
Ïg_šdex
, 
vÏn_’Œy
->
ifšdex
, 
çl£
);

111  
»t
;

112 
	}
}

118 
t_¡d_”rÜ
 
	$Çs_hªdË_Ïg_add_to_vÏn
(
Çs_bridge_t
 *
p_bridge
, 
h®_ifšdex_t
 
Ïg_šdex
,

119 
Çs_pÜt_mode_t
 
pÜt_mode
, 
boŞ
 
ıs_add
, 
vÏn_rŞl_bk_t
 *
rŞl_bk
) {

121 
boŞ
 
rŞl_bk_sup
 = (
rŞl_bk
==
nuÎ±r
)? 
çl£
:
Œue
;

123 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

124 "Addšg LAG %dØbridg%d iÀOS", 
Ïg_šdex
, 
p_bridge
->
ifšdex
);

126 if(
ıs_add
 =ğ
Œue
) {

128 if(
	`Çs_ıs_add_pÜt_to_os
(
p_bridge
->
ifšdex
,…_bridge->
vÏn_id
, 
pÜt_mode
, 
Ïg_šdex
,

129 
p_bridge
->
mtu
,…_bridge->
mode
è!ğ
STD_ERR_OK
) {

130 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

131 "E¼Ü‡ddšg…Üˆ%dØbridg%d iÀOS", 
Ïg_šdex
, 
p_bridge
->
ifšdex
);

132  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

135 
if_ma¡”_šfo_t
 
ma¡”_šfo
 = { 
Çs_št_ty³_VLAN
, 
pÜt_mode
, 
p_bridge
->
ifšdex
};

136 
BASE_IF_MODE_t
 
štf_mode
 = 
	`Çs_štf_g‘_mode
(
Ïg_šdex
);

137 if(!
	`Çs_štf_add_ma¡”
(
Ïg_šdex
, 
ma¡”_šfo
)){

138 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN","Failedo‡dd master for vlan memeber†ag");

140 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
Ïg_šdex
);

141 ià(
Ãw_mode
 !ğ
štf_mode
) {

142 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
Ïg_šdex
, 
Ãw_mode
è=ğ
çl£
) {

143 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN", "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
Ïg_šdex
);

148 ià(
	`Çs_add_Ü_d–_Ïg_š_vÏn
(
Ïg_šdex
, 
p_bridge
->
vÏn_id
,

149 
pÜt_mode
, 
Œue
, 
rŞl_bk_sup
è!ğ
STD_ERR_OK
) {

151 ià(
rŞl_bk_sup
 =ğ
Œue
) {

152 
	`Çs_ıs_d–_pÜt_äom_os
(
p_bridge
->
vÏn_id
, 
Ïg_šdex
, 
pÜt_mode
,p_bridge->
mode
);

154  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

157 
Çs_li¡_node_t
 *
p_lšk_node
 = (Çs_li¡_node_ˆ*)
	`m®loc
((nas_list_node_t));

158 ià(
p_lšk_node
 !ğ
NULL
) {

159 
	`mem£t
(
p_lšk_node
, 0, (
Çs_li¡_node_t
));

160 
p_lšk_node
->
ifšdex
 = 
Ïg_šdex
;

164 if(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

165 
	`Çs_š£¹_lšk_node
(&
p_bridge
->
gged_Ïg
.
pÜt_li¡
, 
p_lšk_node
);

168 ià((
	`Çs_g‘_lšk_node
(&
p_bridge
->
uÁagged_Ïg
.
pÜt_li¡
, 
Ïg_šdex
)è=ğ
NULL
) {

170 
	`Çs_š£¹_lšk_node
(&
p_bridge
->
uÁagged_Ïg
.
pÜt_li¡
, 
p_lšk_node
);

174 ià(
rŞl_bk_sup
) {

175 
rŞl_bk
->
Ïg_add_li¡
[
Ïg_šdex
] = 
pÜt_mode
;

176 
	`EV_LOGGING
(
INTERFACE
, 
INFO
,"NAS-Vlan",

178 
p_bridge
->
vÏn_id
, 
Ïg_šdex
);

180 
Çs_pÜt_li¡_t
 
publish_li¡
 = {
Ïg_šdex
};

181 
	`Çs_publish_vÏn_pÜt_li¡
(
p_bridge
, 
publish_li¡
, 
pÜt_mode
, 
ıs_­i_İ”_CREATE
);

182  
STD_ERR_OK
;

183 
	}
}

185 
t_¡d_”rÜ
 
	$Çs_hªdË_Ïg_d–_äom_vÏn
(
Çs_bridge_t
 *
p_bridge
, 
h®_ifšdex_t
 
Ïg_šdex
,

186 
Çs_pÜt_mode_t
 
pÜt_mode
, 
boŞ
 
ıs_d–
 ,
vÏn_rŞl_bk_t
 *
rŞl_bk
)

189 
boŞ
 
rŞl_bk_sup
 = (
rŞl_bk
==
nuÎ±r
)? 
çl£
:
Œue
;

192 ià(
	`Çs_add_Ü_d–_Ïg_š_vÏn
(
Ïg_šdex
, 
p_bridge
->
vÏn_id
,

193 
pÜt_mode
, 
çl£
, 
rŞl_bk_sup
è!ğ
STD_ERR_OK
){

194  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

197 
if_ma¡”_šfo_t
 
ma¡”_šfo
 = { 
Çs_št_ty³_VLAN
, 
pÜt_mode
, 
p_bridge
->
ifšdex
};

198 
BASE_IF_MODE_t
 
štf_mode
 = 
	`Çs_štf_g‘_mode
(
Ïg_šdex
);

199 if(!
	`Çs_štf_d–_ma¡”
(
Ïg_šdex
, 
ma¡”_šfo
)){

200 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN","Failedo delete master for vlan memeber†ag");

202 
BASE_IF_MODE_t
 
Ãw_mode
 = 
	`Çs_štf_g‘_mode
(
Ïg_šdex
);

203 ià(
Ãw_mode
 !ğ
štf_mode
) {

204 ià(
	`Çs_štf_hªdË_štf_mode_chªge
(
Ïg_šdex
, 
Ãw_mode
è=ğ
çl£
) {

205 
	`EV_LOGGING
(
INTERFACE
,
DEBUG
,"NAS-VLAN", "Upd©tØNAS-L3‡bouˆš‹rçû modchªgçed(%d)", 
Ïg_šdex
);

211 if(
ıs_d–
 =ğ
Œue
) {

212 if(
	`Çs_ıs_d–_pÜt_äom_os
(
p_bridge
->
vÏn_id
, 
Ïg_šdex
, 
pÜt_mode
,p_bridge->
mode
) !=

213 
STD_ERR_OK
) {

214 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

215 "E¼Ü d–‘šg†ag %d from bridg%d iÀOS", 
Ïg_šdex
, 
p_bridge
->
ifšdex
);

218 ià(
rŞl_bk_sup
) {

219 
	`Çs_add_Ü_d–_Ïg_š_vÏn
(
Ïg_šdex
, 
p_bridge
->
vÏn_id
,

220 
pÜt_mode
, 
Œue
,rue);

222  
	`STD_ERR
(
INTERFACE
,
FAIL
, 0);

226 if(!
	`Çs_štf_ş—nup_l2mc_cÚfig
(
Ïg_šdex
, 
p_bridge
->
vÏn_id
)) {

227 
	`EV_LOGGING
(
INTERFACE
, 
ERR
, "NAS-Vlan",

228 "E¼Ü cËªšg L2MC memb”sh fÜ Lag iÁ”çû %d", 
Ïg_šdex
);

230 if(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

231 
	`Çs_´oûss_Ïg_fÜ_vÏn_d–
(&
p_bridge
->
gged_Ïg
, 
Ïg_šdex
);

234 
	`Çs_´oûss_Ïg_fÜ_vÏn_d–
(&
p_bridge
->
uÁagged_Ïg
, 
Ïg_šdex
);

236 ià(
rŞl_bk
) {

237 
	`EV_LOGGING
(
INTERFACE
, 
INFO
,"NAS-Vlan",

239 
p_bridge
->
vÏn_id
, 
Ïg_šdex
);

241 
rŞl_bk
->
Ïg_d–_li¡
[
Ïg_šdex
] = 
pÜt_mode
;

243 
Çs_pÜt_li¡_t
 
publish_li¡
 = {
Ïg_šdex
};

244 
	`Çs_publish_vÏn_pÜt_li¡
(
p_bridge
, 
publish_li¡
, 
pÜt_mode
, 
ıs_­i_İ”_DELETE
);

245  
STD_ERR_OK
;

246 
	}
}

253 
t_¡d_”rÜ
 
	$Çs_hªdË_Ïg_šdex_š_ıs_£t
(
Çs_bridge_t
 *
p_bridge
, 
Çs_pÜt_li¡_t
 &
pÜt_šdex_li¡
,

254 
Çs_pÜt_mode_t
 
pÜt_mode
, 
vÏn_rŞl_bk_t
 *
rŞl_bk
)

256 
Çs_li¡_t
 *
p_li¡
 = 
NULL
;

257 
Çs_li¡_node_t
 *
p_lšk_node
 = 
NULL
, *
p_‹mp_node
 = NULL;

258 
h®_ifšdex_t
 
ifšdex
 = 0;

259 
t_¡d_”rÜ
 
rc
 = 
STD_ERR_OK
;

261 if(
pÜt_mode
 =ğ
NAS_PORT_TAGGED
) {

262 
p_li¡
 = &(
p_bridge
->
gged_Ïg
);

265 
p_li¡
 = &(
p_bridge
->
uÁagged_Ïg
);

268 
p_lšk_node
 = 
	`Çs_g‘_fœ¡_lšk_node
(&(
p_li¡
->
pÜt_li¡
));

269 
p_lšk_node
 !ğ
NULL
) {

270 
ifšdex
 = 
p_lšk_node
->ifindex;

271 
p_‹mp_node
 = 
p_lšk_node
;

272 
p_lšk_node
 = 
	`Çs_g‘_Ãxt_lšk_node
(&
p_li¡
->
pÜt_li¡
, 
p_‹mp_node
);

274 ià(
pÜt_šdex_li¡
.
	`fšd
(
ifšdex
è=ğpÜt_šdex_li¡.
	`’d
()){

275 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan",

277 
ifšdex
);

279 ià((
rc
 = 
	`Çs_hªdË_Ïg_d–_äom_vÏn
(
p_bridge
, 
ifšdex
,

280 
pÜt_mode
, 
Œue
, 
rŞl_bk
)è!ğ
STD_ERR_OK
 ){

281 
	`EV_LOGGING
(
INTERFACE
, 
INFO
, "NAS-Vlan", "nas_handle_lag_index_in_cps_set:‚as_handle_lag_del_from_vlan failed \n");

282  
rc
;

286  
STD_ERR_OK
;

287 
	}
}

	@src/vrf/nas_vrf_api.cpp

22 
	~"ev’t_log.h
"

23 
	~"Çs_os_l3.h
"

24 
	~"Çs_vrf.h
"

25 
	~"d–l-ba£-š‹rçû-commÚ.h
"

26 
	~"d–l-ba£-commÚ.h
"

27 
	~"›tf-ÃtwÜk-š¡ªû.h
"

28 
	~"vrf-mgmt.h
"

29 
	~"ıs_­i_ev’ts.h
"

30 
	~"ıs_şass_m­.h
"

31 
	~"Çs_sw™ch.h
"

32 
	~"Çs_ndi_rou‹r_š‹rçû.h
"

33 
	~"¡d_uts.h
"

34 
	~"Çs_vrf_uts.h
"

35 
	~"Çs_št_com_uts.h
"

37 
ıs_­i_ev’t_£rviû_hªdË_t
 
	g_hªdË
;

39 
t_¡d_”rÜ
 
	$Çs_vrf_ü—‹_publish_hªdË
() {

40 ià(
	`ıs_­i_ev’t_ş›Á_cÚÃù
(&
_hªdË
è!ğ
ıs_­i_»t_code_OK
) {

41 
	`NAS_VRF_LOG_ERR
("VRF-PUB", "Failedo createhe handle forƒvent…ublish!");

42  
	`STD_ERR
(
ROUTE
,
FAIL
,0);

44  
STD_ERR_OK
;

45 
	}
}

47 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_publish_ev’t
(
ıs_­i_objeù_t
 
msg
) {

48 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

50 
rc
 = 
	`ıs_­i_ev’t_publish
(
_hªdË
,
msg
);

51  
rc
;

52 
	}
}

55 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_g‘_štf_šfo
(
ıs_­i_objeù_li¡_t
 
li¡
, cÚ¡ *
vrf_Çme
,

56 cÚ¡ *
if_Çme
) {

57 
š‹rçû_ù¾_t
 
štf_ù¾
;

59 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

60 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

61 
	`§ã¡ºıy
(
štf_ù¾
.
if_Çme
, (const *)if_name,

62 (
štf_ù¾
.
if_Çme
));

64 ià((
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

65 
	`NAS_VRF_LOG_ERR
("VRF-INTF-GET", "Invalid interface %s interface get failed ",

66 
if_Çme
);

67  
ıs_­i_»t_code_ERR
;

71 ià(
štf_ù¾
.
l3_štf_šfo
.
if_šdex
 != 0) {

72 
h®_vrf_id_t
 
¹_vrf_id
 = 
štf_ù¾
.
l3_štf_šfo
.
vrf_id
;

73 
h®_ifšdex_t
 
¹_if_šdex
 = 
štf_ù¾
.
l3_štf_šfo
.
if_šdex
;

74 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

75 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

76 
štf_ù¾
.
vrf_id
 = 
¹_vrf_id
;

77 
štf_ù¾
.
if_šdex
 = 
¹_if_šdex
;

79 ià((
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

80 
	`NAS_VRF_LOG_ERR
("VRF-INTF-GET", "Invalid interface VRF-id:%d if-index:%d.",

81 
¹_vrf_id
, 
¹_if_šdex
);

82  
ıs_­i_»t_code_ERR
;

86 ià(
vrf_Çme
) {

87 
h®_vrf_id_t
 
vrf_id
 = 0;

88 ià(
	`Çs_g‘_vrf_š‹º®_id_äom_vrf_Çme
(
vrf_Çme
, &
vrf_id
è!ğ
STD_ERR_OK
) {

89 
	`NAS_VRF_LOG_ERR
("VRF-INTF-GET", "Invalid VRF‚ame:%s ",

90 
vrf_Çme
);

91  
ıs_­i_»t_code_ERR
;

94 ià(
štf_ù¾
.
vrf_id
 != vrf_id) {

96  
ıs_­i_»t_code_ERR
;

100 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

101 if(
obj
 =ğ
NULL
){

102 
	`NAS_VRF_LOG_ERR
("VRF-INTF-GET", "Failedo‡llocate memoryo cps object");

103  
ıs_­i_»t_code_ERR
;

106 
ıs_­i_key_t
 
key
;

107 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
key
, 
NI_IF_INTERFACES_INTERFACE_OBJ
,

108 
ıs_­i_qu®if›r_TARGET
);

109 
	`ıs_­i_objeù_£t_key
(
obj
,&
key
);

111 ià(
štf_ù¾
.
vrf_id
 =ğ
NAS_DEFAULT_VRF_ID
) {

112 
	`ıs_­i_objeù_©Œ_add
(
obj
,
NI_IF_INTERFACES_INTERFACE_BIND_NI_NAME
, 
NAS_DEFAULT_VRF_NAME
,

113 
	`¡¾’
(
NAS_DEFAULT_VRF_NAME
)+1);

115 
	`ıs_­i_objeù_©Œ_add
(
obj
,
NI_IF_INTERFACES_INTERFACE_BIND_NI_NAME
, 
štf_ù¾
.
vrf_Çme
,

116 
	`¡¾’
(
štf_ù¾
.
vrf_Çme
)+1);

118 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_NAME
, 
if_Çme
, 
	`¡¾’
(if_name)+1);

120 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
VRF_MGMT_NI_IF_INTERFACES_INTERFACE_IFNAME
, (cÚ¡ *)
štf_ù¾
.
if_Çme
,

121 
	`¡¾’
(
štf_ù¾
.
if_Çme
)+1);

123 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
VRF_MGMT_NI_IF_INTERFACES_INTERFACE_IFINDEX
, 
štf_ù¾
.
if_šdex
);

124 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
VRF_MGMT_NI_IF_INTERFACES_INTERFACE_MAC_ADDR
, (cÚ¡ *)
štf_ù¾
.
mac_addr
,

125 
	`¡¾’
(
štf_ù¾
.
mac_addr
)+1);

127 ià(!
	`ıs_­i_objeù_li¡_­³nd
(
li¡
,
obj
)) {

128 
	`ıs_­i_objeù_d–‘e
(
obj
);

129 
	`NAS_VRF_LOG_ERR
("VRF-INTF-GET", "Objeù‡µ’dØli¡ i çed fÜ %s", 
if_Çme
);

130  
ıs_­i_»t_code_ERR
;

133  
ıs_­i_»t_code_OK
;

134 
	}
}

137 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_g‘_rou‹r_štf_šfo
(
ıs_­i_objeù_li¡_t
 
li¡
, cÚ¡ *
if_Çme
) {

138 
š‹rçû_ù¾_t
 
štf_ù¾
;

140 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

141 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

142 
	`§ã¡ºıy
(
štf_ù¾
.
if_Çme
, (const *)if_name,

143 (
štf_ù¾
.
if_Çme
));

145 ià((
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

146 
	`NAS_VRF_LOG_ERR
("VRF-INTF-GET", "Invalid interface %s interface get failed ",

147 
if_Çme
);

148  
ıs_­i_»t_code_ERR
;

152 ià(
štf_ù¾
.
l3_štf_šfo
.
if_šdex
 != 0) {

153 
h®_vrf_id_t
 
¹_vrf_id
 = 
štf_ù¾
.
l3_štf_šfo
.
vrf_id
;

154 
h®_ifšdex_t
 
¹_if_šdex
 = 
štf_ù¾
.
l3_štf_šfo
.
if_šdex
;

155 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

156 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

157 
štf_ù¾
.
vrf_id
 = 
¹_vrf_id
;

158 
štf_ù¾
.
if_šdex
 = 
¹_if_šdex
;

160 ià((
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

161 
	`NAS_VRF_LOG_ERR
("VRF-INTF-GET", "Invalid interface VRF-id:%d if-index:%d.",

162 
¹_vrf_id
, 
¹_if_šdex
);

163  
ıs_­i_»t_code_ERR
;

167 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

168 if(
obj
 =ğ
NULL
){

169 
	`NAS_VRF_LOG_ERR
("VRF-INTF-GET", "Failedo‡llocate memoryo cps object");

170  
ıs_­i_»t_code_ERR
;

173 
ıs_­i_key_t
 
key
;

174 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
key
, 
VRF_MGMT_ROUTER_INTF_ENTRY_OBJ
,

175 
ıs_­i_qu®if›r_TARGET
);

176 
	`ıs_­i_objeù_£t_key
(
obj
,&
key
);

187 
	`ıs_­i_objeù_©Œ_add
(
obj
,
VRF_MGMT_ROUTER_INTF_ENTRY_NAME
, 
if_Çme
, 
	`¡¾’
(if_name)+1);

189 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
VRF_MGMT_ROUTER_INTF_ENTRY_IFNAME
, (cÚ¡ *)
štf_ù¾
.
if_Çme
,

190 
	`¡¾’
(
štf_ù¾
.
if_Çme
)+1);

192 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
, 
VRF_MGMT_ROUTER_INTF_ENTRY_IFINDEX
, 
štf_ù¾
.
if_šdex
);

194 ià(!
	`ıs_­i_objeù_li¡_­³nd
(
li¡
,
obj
)) {

195 
	`ıs_­i_objeù_d–‘e
(
obj
);

196 
	`NAS_VRF_LOG_ERR
("VRF-INTF-GET", "Objeù‡µ’dØli¡ i çed fÜ %s", 
if_Çme
);

197  
ıs_­i_»t_code_ERR
;

200  
ıs_­i_»t_code_OK
;

201 
	}
}

206 
boŞ
 
	$Çs_vrf_upd©e_vrf_id
(cÚ¡ *
vrf_Çme
, 
boŞ
 
is_add
) {

207 
t_¡d_”rÜ
 
rc
;

209 
Çs_vrf_ù¾_t
 
vrf_šfo
;

210 
	`mem£t
(&
vrf_šfo
, 0, (vrf_info));

212 ià(
is_add
) {

213 
ndi_vr_’Œy_t
 
vr_’Œy
;

215 
	`mem£t
 (&
vr_’Œy
, 0,  (
ndi_vr_’Œy_t
));

217 
	`Çs_sw™ch_wa™_fÜ_sys_ba£_mac
(&
vr_’Œy
.
¤c_mac
);

222 
vr_’Œy
.
æags
 = 
NDI_VR_ATTR_SRC_MAC_ADDRESS
;

224 ià((
rc
 = 
	`ndi_rou‹_vr_ü—‹
(&
vr_’Œy
, &
vrf_šfo
.
vrf_id
))!ğ
STD_ERR_OK
) {

225 
	`NAS_VRF_LOG_ERR
("VRF-ID", "VRF oid c»©iÚ faed fÜ VRF:%s", 
vrf_Çme
);

226  
çl£
;

229 
Çs_obj_id_t
 
ndi_vr_id
 = 0;

230 ià(
	`Çs_g‘_vrf_obj_id_äom_vrf_Çme
(
vrf_Çme
, &
ndi_vr_id
è=ğ
STD_ERR_OK
) {

231 ià((
rc
 = 
	`ndi_rou‹_vr_d–‘e
(0, 
ndi_vr_id
))!ğ
STD_ERR_OK
) {

232 
	`NAS_VRF_LOG_ERR
("VRF-ID", "VRF oid d–‘iÚ faed fÜ VRF:% VRFF id 0x%lx", 
vrf_Çme
, 
ndi_vr_id
);

233  
çl£
;

235 
	`NAS_VRF_LOG_INFO
("VRF-ID", "VRF oid d–‘iÚ sucûssfuÈfÜ VRF:% id 0x%lx", 
vrf_Çme
, 
ndi_vr_id
);

239 
	`§ã¡ºıy
(
vrf_šfo
.
vrf_Çme
, vrf_name, (vrf_info.vrf_name));

240 ià(
	`Çs_upd©e_vrf_šfo
((
is_add
 ? 
NAS_VRF_OP_ADD
 : 
NAS_VRF_OP_DEL
), &
vrf_šfo
è!ğ
STD_ERR_OK
) {

241 
	`NAS_VRF_LOG_ERR
("VRF-ID-GET", "VRF oid upd©çed fÜ VRF:% is_add:%d", 
vrf_Çme
, 
is_add
);

242  
çl£
;

244  
Œue
;

245 
	}
}

247 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_´oûss_ıs_vrf_msg
(
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
, 
size_t
 
ix
) {

249 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

250 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

252 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

254 
ıs_­i_objeù_t
 
şÚed
 = 
	`ıs_­i_objeù_ü—‹
();

255 ià(!
şÚed
) {

256 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "CPS mallocƒrror");

257  
ıs_­i_»t_code_ERR
;

259 
	`ıs_­i_objeù_şÚe
(
şÚed
,
obj
);

260 
	`ıs_­i_objeù_li¡_­³nd
(
·¿m
->
´ev
,
şÚed
);

262 cÚ¡ *
vrf_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_g‘_d©a
(
obj
,

263 
NI_NETWORK_INSTANCES_NETWORK_INSTANCE_NAME
);

264 ià(
vrf_Çme
 =ğ
nuÎ±r
) {

265 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "VRF‚ame is‚ot…resent");

266  
ıs_­i_»t_code_ERR
;

269 ià(
	`¡¾’
(
vrf_Çme
è> 
NAS_VRF_NAME_SZ
) {

270 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "Error - VRF‚ame:%s is morehanhe‡llowed†ength:%d",

271 
vrf_Çme
, 
NAS_VRF_NAME_SZ
);

272  
ıs_­i_»t_code_ERR
;

275 ià(
	`¡ºcmp
(
vrf_Çme
, 
NAS_DEFAULT_VRF_NAME
, (NAS_DEFAULT_VRF_NAME)) == 0) {

276 
	`NAS_VRF_LOG_INFO
("NAS-RT-CPS-SET", "DeçuÉ VRF‚ame:% İ:%d", 
vrf_Çme
, 
İ
);

277  
ıs_­i_»t_code_OK
;

279 ià(
İ
 =ğ
ıs_­i_İ”_CREATE
) {

280 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS-SET", "In VRF CREATE ");

282 ià(
	`¡ºcmp
(
vrf_Çme
, 
NAS_MGMT_VRF_NAME
, (
NAS_DEFAULT_VRF_NAME
)) != 0) {

283 ià(
	`Çs_vrf_upd©e_vrf_id
(
vrf_Çme
, 
Œue
è=ğ
çl£
) {

284 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "VRF id hªdlšg faed fÜ VRF:%s!", 
vrf_Çme
);

285  
ıs_­i_»t_code_ERR
;

288 if(
	`Çs_os_add_vrf
(
obj
è!ğ
STD_ERR_OK
){

289 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "OS VRF‡dd faed fÜ VRF:%s", 
vrf_Çme
);

290 
rc
 = 
ıs_­i_»t_code_ERR
;

292 } ià(
İ
 =ğ
ıs_­i_İ”_SET
) {

293 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS-SET", "In VRF SET");

294 if(
	`Çs_os_£t_vrf
(
obj
è!ğ
STD_ERR_OK
){

295 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "OS VRF update failed");

296 
rc
 = 
ıs_­i_»t_code_ERR
;

298 } ià(
İ
 =ğ
ıs_­i_İ”_DELETE
) {

299 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS-SET", "In VRF del ");

300 if(
	`Çs_os_d–_vrf
(
obj
è!ğ
STD_ERR_OK
){

301 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "OS VRF del failed");

302 
rc
 = 
ıs_­i_»t_code_ERR
;

305 ià(
	`¡ºcmp
(
vrf_Çme
, 
NAS_MGMT_VRF_NAME
, (
NAS_DEFAULT_VRF_NAME
)) != 0) {

306 ià(
	`Çs_vrf_upd©e_vrf_id
(
vrf_Çme
, 
çl£
) == false) {

307 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "VRF id d–‘çed fÜ VRF:%s!", 
vrf_Çme
);

308  
ıs_­i_»t_code_ERR
;

313 ià(
rc
 =ğ
ıs_­i_»t_code_OK
) {

314 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
obj
),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_OBSERVED
);

315 ià(
	`Çs_vrf_publish_ev’t
(
obj
è!ğ
ıs_­i_»t_code_OK
) {

316 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "VRF…ublish failed!");

318 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
obj
),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_TARGET
);

320  
rc
;

321 
	}
}

324 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_´oûss_ıs_vrf_štf_msg
(
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
, 
size_t
 
ix
) {

326 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

327 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

329 ià(
obj
 =ğ
NULL
) {

330 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS","Route VRF Intf object is‚ot…resent");

331  
ıs_­i_»t_code_ERR
;

334 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

336 
ıs_­i_objeù_t
 
şÚed
 = 
	`ıs_­i_objeù_ü—‹
();

337 ià(!
şÚed
) {

338 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "CPS mallocƒrror");

339  
ıs_­i_»t_code_ERR
;

341 
	`ıs_­i_objeù_şÚe
(
şÚed
,
obj
);

342 
	`ıs_­i_objeù_li¡_­³nd
(
·¿m
->
´ev
,
şÚed
);

344 cÚ¡ *
vrf_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_g‘_d©a
(
obj
,

345 
NI_IF_INTERFACES_INTERFACE_BIND_NI_NAME
);

346 cÚ¡ *
if_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_g‘_d©a
(
obj
,

347 
IF_INTERFACES_INTERFACE_NAME
);

348 ià((
vrf_Çme
 =ğ
nuÎ±r
è|| (
if_Çme
 ==‚ullptr)) {

349 
	`NAS_VRF_LOG_ERR
("INTF-VRF-RPC","VRF or Interface‚ot…resent");

350  
ıs_­i_»t_code_ERR
;

353 ià(
	`¡¾’
(
vrf_Çme
è> 
NAS_VRF_NAME_SZ
) {

354 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "Error - VRF‚ame:%s is morehanhe‡llowed†ength:%d if-name:%s",

355 
vrf_Çme
, 
NAS_VRF_NAME_SZ
, 
if_Çme
);

356  
ıs_­i_»t_code_ERR
;

359 ià(
	`¡ºcmp
(
vrf_Çme
, 
NAS_MGMT_VRF_NAME
, (NAS_MGMT_VRF_NAME)) != 0) {

360 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS","Invalid object usage for‚on-mgmt VRF configuration!");

361  
ıs_­i_»t_code_ERR
;

363 ià(
İ
 =ğ
ıs_­i_İ”_CREATE
) {

364 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS-SET", "In VRF Intf CREATE ");

365 if(
	`Çs_os_bšd_if_Çme_to_mgmt_vrf
(
obj
è!ğ
STD_ERR_OK
){

366 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS-SET", "OS VRF‡dd failed");

367 
rc
 = 
ıs_­i_»t_code_ERR
;

369 
	`NAS_VRF_LOG_INFO
("NAS-RT-CPS-SET", "OS IÁf:% assocŸ‹d w™h VRF sucûssful", 
if_Çme
);

370 } ià(
İ
 =ğ
ıs_­i_İ”_DELETE
) {

371 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS-SET", "In VRF intf del ");

372 if(
	`Çs_os_unbšd_if_Çme_äom_mgmt_vrf
(
obj
è!ğ
STD_ERR_OK
){

373 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS-SET", "OS VRF del failed");

374 
rc
 = 
ıs_­i_»t_code_ERR
;

376 
	`NAS_VRF_LOG_INFO
("NAS-RT-CPS-SET", "OS IÁf:% di§ssocŸ‹d w™h VRF sucûssful", 
if_Çme
);

379 ià(
rc
 =ğ
ıs_­i_»t_code_OK
) {

380 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
obj
),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_OBSERVED
);

381 ià(
	`Çs_vrf_publish_ev’t
(
obj
è!ğ
ıs_­i_»t_code_OK
) {

382 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "VRF interface…ublish failed!");

384 
	`ıs_­i_key_£t
(
	`ıs_­i_objeù_key
(
obj
),
CPS_OBJ_KEY_INST_POS
,
ıs_­i_qu®if›r_TARGET
);

387  
rc
;

388 
	}
}

390 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_publish_štf_bšd
(
ıs_­i_objeù_t
 
vrf_štf_obj
, cÚ¡ *
vrf_Çme
,

391 cÚ¡ *
if_Çme
, 
ušt32_t
 
İ
) {

392 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_ü—‹
();

393 if(
obj
 =ğ
NULL
){

394 
	`NAS_VRF_LOG_ERR
("VRF-INTF-PUB", "Failedo‡llocate memoryo cps object");

395  
ıs_­i_»t_code_ERR
;

398 
ıs_­i_objeù_gu¬d
 
	`obj_g
 (
obj
);

399 
ıs_­i_key_t
 
key
;

400 
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
key
, 
NI_IF_INTERFACES_INTERFACE_OBJ
,

401 
ıs_­i_qu®if›r_OBSERVED
);

402 
ıs_­i_İ”©iÚ_ty³s_t
 
İ”
 = 
ıs_­i_İ”_CREATE
;

403 ià(
İ
 =ğ
BASE_CMN_OPERATION_TYPE_DELETE
) {

404 
İ”
 = 
ıs_­i_İ”_DELETE
;

406 
	`ıs_­i_objeù_£t_ty³_İ”©iÚ
(&
key
,
İ”
);

407 
	`ıs_­i_objeù_£t_key
(
obj
,&
key
);

409 
	`ıs_­i_objeù_©Œ_add
(
obj
,
NI_IF_INTERFACES_INTERFACE_BIND_NI_NAME
, 
vrf_Çme
, 
	`¡¾’
(vrf_name)+1);

410 
	`ıs_­i_objeù_©Œ_add
(
obj
,
IF_INTERFACES_INTERFACE_NAME
, 
if_Çme
, 
	`¡¾’
(if_name)+1);

412 ià(
İ
 !ğ
BASE_CMN_OPERATION_TYPE_DELETE
) {

413 
ıs_­i_objeù_©Œ_t
 
if_šdex_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
vrf_štf_obj
, 
VRF_MGMT_INTF_BIND_NI_OUTPUT_IFINDEX
);

414 cÚ¡ *
¹_if_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_g‘_d©a
(
vrf_štf_obj
,

415 
VRF_MGMT_INTF_BIND_NI_OUTPUT_IFNAME
);

416 cÚ¡ *
¹_mac_addr
 = (cÚ¡ *)
	`ıs_­i_objeù_g‘_d©a
(
vrf_štf_obj
,

417 
VRF_MGMT_INTF_BIND_NI_OUTPUT_MAC_ADDR
);

418 ià((
if_šdex_©Œ
 =ğ
nuÎ±r
è|| (
¹_if_Çme
 =ğnuÎ±rè|| (
¹_mac_addr
 ==‚ullptr)) {

419 
	`NAS_VRF_LOG_ERR
("VRF-INTF-PUB", "Router interface information‚ot…resent, VRF…ublish failed!");

420  
ıs_­i_»t_code_ERR
;

422 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
VRF_MGMT_NI_IF_INTERFACES_INTERFACE_IFNAME
, (cÚ¡ *)
¹_if_Çme
,

423 
	`¡¾’
(
¹_if_Çme
)+1);

425 
	`ıs_­i_objeù_©Œ_add_u32
(
obj
,
VRF_MGMT_NI_IF_INTERFACES_INTERFACE_IFINDEX
,

426 
	`ıs_­i_objeù_©Œ_d©a_u32
(
if_šdex_©Œ
));

427 
	`ıs_­i_objeù_©Œ_add
(
obj
, 
VRF_MGMT_NI_IF_INTERFACES_INTERFACE_MAC_ADDR
, (cÚ¡ *)
¹_mac_addr
,

428 
	`¡¾’
(
¹_mac_addr
)+1);

430 ià(
	`Çs_vrf_publish_ev’t
(
obj
è!ğ
ıs_­i_»t_code_OK
) {

431 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "VRF…ublish failed!");

432  
ıs_­i_»t_code_ERR
;

434  
ıs_­i_»t_code_OK
;

435 
	}
}

437 
ıs_­i_»tuº_code_t
 
	$Çs_štf_bšd_vrf_½c_hªdËr
 (*
cÚ‹xt
, 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
, 
size_t
 
ix
) {

438 
š‹rçû_ù¾_t
 
·»Á_štf_ù¾
;

439 
ıs_­i_objeù_t
 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
chªge_li¡
,
ix
);

441 ià(
obj
 =ğ
NULL
) {

442 
	`NAS_VRF_LOG_ERR
("INTF-VRF-RPC","Route VRF Intf object is‚ot…resent");

443  
ıs_­i_»t_code_ERR
;

446 
ıs_­i_İ”©iÚ_ty³s_t
 
İ
 = 
	`ıs_­i_objeù_ty³_İ”©iÚ
(
	`ıs_­i_objeù_key
(
obj
));

448 ià(
İ
 !ğ
ıs_­i_İ”_ACTION
) {

449 
	`NAS_VRF_LOG_ERR
("INTF-VRF-RPC","Invalid‡ction for Route VRF Intf RPC");

450  
ıs_­i_»t_code_ERR
;

452 cÚ¡ *
vrf_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_g‘_d©a
(
obj
,

453 
VRF_MGMT_INTF_BIND_NI_INPUT_NI_NAME
);

454 cÚ¡ *
if_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_g‘_d©a
(
obj
,

455 
VRF_MGMT_INTF_BIND_NI_INPUT_INTERFACE
);

456 ià((
vrf_Çme
 =ğ
nuÎ±r
è|| (
if_Çme
 ==‚ullptr)) {

457 
	`NAS_VRF_LOG_ERR
("INTF-VRF-RPC","VRF or Interface‚ot…resent");

458  
ıs_­i_»t_code_ERR
;

460 ià(
	`¡¾’
(
vrf_Çme
è> 
NAS_VRF_NAME_SZ
) {

461 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS-SET", "Error - VRF‚ame:%s is morehanhe‡llowed†ength:%d if-name:%s",

462 
vrf_Çme
, 
NAS_VRF_NAME_SZ
, 
if_Çme
);

463  
ıs_­i_»t_code_ERR
;

466 
ıs_­i_objeù_©Œ_t
 
İ_©Œ
 = 
	`ıs_­i_objeù_©Œ_g‘
(
obj
, 
VRF_MGMT_INTF_BIND_NI_INPUT_OPERATION
);

467 ià(
İ_©Œ
 =ğ
nuÎ±r
) {

468 
	`NAS_VRF_LOG_ERR
("INTF-VRF-RPC","O³¿tiÚ i nÙ…»£Á iÀthVRF% IÁf:% RPC", 
vrf_Çme
, 
if_Çme
);

469  
ıs_­i_»t_code_ERR
;

471 
ušt32_t
 
İ”
 = 
	`ıs_­i_objeù_©Œ_d©a_u32
(
İ_©Œ
);

473 ià(
İ”
 =ğ
BASE_CMN_OPERATION_TYPE_DELETE
) {

474 ià(
	`¡ºcmp
(
vrf_Çme
, 
NAS_DEFAULT_VRF_NAME
, (NAS_DEFAULT_VRF_NAME)) == 0) {

477 
	`NAS_VRF_LOG_INFO
("INTF-VRF-RPC", "DeçuÉ VRF:% IÁf:% di§ssocŸ‹d!", 
vrf_Çme
, 
if_Çme
);

478 
	`Çs_vrf_publish_štf_bšd
(
obj
, 
vrf_Çme
, 
if_Çme
, 
İ”
);

479  
ıs_­i_»t_code_OK
;

481 
	`NAS_VRF_LOG_DEBUG
("INTF-VRF-RPC", "In VRF intf del ");

482 
	`mem£t
(&
·»Á_štf_ù¾
, 0, (parent_intf_ctrl));

483 
·»Á_štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

484 
	`§ã¡ºıy
(
·»Á_štf_ù¾
.
if_Çme
, if_Çme, 
HAL_IF_NAME_SZ
);

486 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
·»Á_štf_ù¾
è!ğ
STD_ERR_OK
) {

487 
	`NAS_VRF_LOG_INFO
("INTF-VRF-RPC", "VRF:% IÁf:% dÛ nÙƒxi¡!", 
vrf_Çme
, 
if_Çme
);

488 
	`Çs_vrf_publish_štf_bšd
(
obj
, 
vrf_Çme
, 
if_Çme
, 
İ”
);

489  
ıs_­i_»t_code_OK
;

492 ià(
·»Á_štf_ù¾
.
l3_štf_šfo
.
if_šdex
 == 0) {

493 
	`NAS_VRF_LOG_ERR
("INTF-VRF-RPC", "Router VRF:%s intf‚ot…resent on Intf:%s ",

494 
vrf_Çme
, 
if_Çme
);

495  
ıs_­i_»t_code_ERR
;

497 
š‹rçû_ù¾_t
 
štf_ù¾
;

498 
	`mem£t
(&
štf_ù¾
, 0, (
š‹rçû_ù¾_t
));

499 
štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF
;

500 
štf_ù¾
.
vrf_id
 = 
·»Á_štf_ù¾
.
l3_štf_šfo
.vrf_id;

501 
štf_ù¾
.
if_šdex
 = 
·»Á_štf_ù¾
.
l3_štf_šfo
.if_index;

503 ià((
	`dn_h®_g‘_š‹rçû_šfo
(&
štf_ù¾
)è!ğ
STD_ERR_OK
) {

504 
	`NAS_VRF_LOG_ERR
("INTF-VRF-RPC", "VRF:%d Intf:%d does‚otƒxist!",

505 
štf_ù¾
.
vrf_id
, iÁf_ù¾.
if_šdex
);

506  
ıs_­i_»t_code_ERR
;

513 
	`Çs_štf_hªdË_štf_mode_chªge
(
štf_ù¾
.
if_Çme
, 
BASE_IF_MODE_MODE_L2
);

514 if(
	`Çs_os_unbšd_if_Çme_äom_vrf
(
obj
è!ğ
STD_ERR_OK
){

515 
	`NAS_VRF_LOG_DEBUG
("INTF-VRF-RPC", "OS VRF del failed");

516  
ıs_­i_»t_code_ERR
;

518 
	`Çs_štf_hªdË_štf_mode_chªge
(
if_Çme
, 
BASE_IF_MODE_MODE_L3
);

519 
	`NAS_VRF_LOG_INFO
("INTF-VRF-RPC", "OS VRF:%s Parent Intf:%s„t-intf VRF-id:%d intf:%s(%d)"

520 " di§ssocŸ‹d w™h VRF sucûssful", 
vrf_Çme
,

521 
if_Çme
, 
štf_ù¾
.
vrf_id
, iÁf_ù¾.if_Çme, iÁf_ù¾.
if_šdex
);

523 
	`mem£t
(&
·»Á_štf_ù¾
, 0, (parent_intf_ctrl));

524 
·»Á_štf_ù¾
.
q_ty³
 = 
HAL_INTF_INFO_FROM_IF_NAME
;

525 
	`§ã¡ºıy
(
·»Á_štf_ù¾
.
if_Çme
, if_Çme, 
HAL_IF_NAME_SZ
);

527 ià(
	`dn_h®_g‘_š‹rçû_šfo
(&
·»Á_štf_ù¾
è!ğ
STD_ERR_OK
) {

528 
	`NAS_VRF_LOG_INFO
("INTF-VRF-RPC", "VRF:% IÁf:% dÛ nÙƒxi¡!", 
vrf_Çme
, 
if_Çme
);

529  
ıs_­i_»t_code_ERR
;

532 ià((
·»Á_štf_ù¾
.
l3_štf_šfo
.
if_šdex
 !ğ0è&& (·»Á_štf_ù¾.l3_štf_šfo.
vrf_id
)) {

533 
	`NAS_VRF_LOG_ERR
("INTF-VRF-RPC", "Router intf:%s (router intf:%d) is‡lready‡ssociated with VRF-id:%d ",

534 
if_Çme
, 
·»Á_štf_ù¾
.
l3_štf_šfo
.
if_šdex
,

535 
·»Á_štf_ù¾
.
l3_štf_šfo
.
vrf_id
);

536  
ıs_­i_»t_code_ERR
;

539 if(
	`Çs_os_bšd_if_Çme_to_vrf
(
obj
è!ğ
STD_ERR_OK
){

540 
	`NAS_VRF_LOG_DEBUG
("INTF-VRF-RPC", "OS VRF iÁàadd faed fÜ VRF:% štf:%s", 
vrf_Çme
, 
if_Çme
);

541  
ıs_­i_»t_code_ERR
;

543 ià(
	`¡ºcmp
(
vrf_Çme
, 
NAS_DEFAULT_VRF_NAME
, (NAS_DEFAULT_VRF_NAME)) == 0) {

546 
	`NAS_VRF_LOG_INFO
("INTF-VRF-RPC", "DeçuÉ VRF:% IÁf:% assocŸ‹d!", 
vrf_Çme
, 
if_Çme
);

547 
	`Çs_vrf_publish_štf_bšd
(
obj
, 
vrf_Çme
, 
if_Çme
, 
İ”
);

548  
ıs_­i_»t_code_OK
;

555 
	`Çs_štf_hªdË_štf_mode_chªge
(
if_Çme
, 
BASE_IF_MODE_MODE_L2
);

556 
	`NAS_VRF_LOG_INFO
("INTF-VRF-RPC", "OS VRF:% IÁf:% assocŸ‹d w™h VRF sucûssful", 
vrf_Çme
, 
if_Çme
);

558 
	`Çs_vrf_publish_štf_bšd
(
obj
, 
vrf_Çme
, 
if_Çme
, 
İ”
);

559  
ıs_­i_»t_code_OK
;

560 
	}
}

	@src/vrf/nas_vrf_cps.cpp

20 
	~"ıs_şass_m­.h
"

21 
	~"ev’t_log.h
"

22 
	~"›tf-ÃtwÜk-š¡ªû.h
"

23 
	~"Çs_vrf.h
"

24 
	~"Çs_vrf_uts.h
"

25 
	~"Çs_vrf_exŠ.h
"

26 
	~"vrf-mgmt.h
"

27 
	#NUM_INT_CPS_API_THREAD
 1

	)

29 
ıs_­i_İ”©iÚ_hªdË_t
 
	gÇs_vrf_hªdË
;

31 
t_¡d_”rÜ
 
Çs_vrf_š™
() {

34 ià(
ıs_­i_İ”©iÚ_subsy¡em_š™
(&
Çs_vrf_hªdË
,
NUM_INT_CPS_API_THREAD
)!=
ıs_­i_»t_code_OK
) {

35  
STD_ERR
(
ROUTE
,
FAIL
,0);

39 ià(
Çs_vrf_ü—‹_publish_hªdË
(è!ğ
STD_ERR_OK
) {

40  
STD_ERR
(
ROUTE
,
FAIL
,0);

44 ià(
Çs_vrf_upd©e_vrf_id
(
NAS_DEFAULT_VRF_NAME
, 
Œue
è=ğ
çl£
) {

45 
NAS_VRF_LOG_ERR
("NAS-RT-CPS", "Default VRF initialisation failed!");

46  
STD_ERR
(
ROUTE
,
FAIL
,0);

48 
NAS_VRF_LOG_INFO
("NAS-RT-CPS", "Default VRF initialisation successful!");

50 ià(
Çs_vrf_objeù_vrf_š™
(
Çs_vrf_hªdË
è!ğ
STD_ERR_OK
) {

51 
NAS_VRF_LOG_ERR
("NAS-VRF", "Failedo initialize VRF handler");

52  
STD_ERR
(
ROUTE
,
FAIL
,0);

55 ià(
Çs_vrf_objeù_vrf_štf_š™
(
Çs_vrf_hªdË
è!ğ
STD_ERR_OK
) {

56 
NAS_VRF_LOG_ERR
("NAS-VRF-INTF", "Failedo initialize VRF‡nd Intf bind handler");

57  
STD_ERR
(
ROUTE
,
FAIL
,0);

60  
STD_ERR_OK
;

64 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_ıs_vrf_£t_func
(*
ùx
,

65 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,

66 
size_t
 
ix
) {

67 
ıs_­i_objeù_t
 
obj
;

69 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS-SET", "VRF CPS set");

70 if(
·¿m
 =ğ
NULL
){

71 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS", "VRF with‚o…aram: ");

72  
ıs_­i_»t_code_ERR
;

75 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
 (
·¿m
->
chªge_li¡
, 
ix
);

76 ià(
obj
 =ğ
NULL
) {

77 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS", "Missing VRF CPS Object");

78  
ıs_­i_»t_code_ERR
;

81 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

82 
rc
 = 
	`Çs_vrf_´oûss_ıs_vrf_msg
(
·¿m
,
ix
);

84  
rc
;

85 
	}
}

87 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_ıs_vrf_g‘_func
 (*
ùx
,

88 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

89 
size_t
 
ix
) {

90 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "VRF get function");

91  
ıs_­i_»t_code_OK
;

92 
	}
}

94 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_ıs_vrf_rŞlback_func
(* 
ùx
,

95 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
, 
size_t
 
ix
){

97 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "VRF Rollback function");

98  
ıs_­i_»t_code_OK
;

99 
	}
}

101 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_ıs_vrf_štf_£t_func
(*
ùx
,

102 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
,

103 
size_t
 
ix
) {

104 
ıs_­i_objeù_t
 
obj
;

106 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS-SET", "VRF CPS intf");

107 if(
·¿m
 =ğ
NULL
){

108 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS", "VRF Init CPS with‚o…aram: ");

109  
ıs_­i_»t_code_ERR
;

112 
obj
 = 
	`ıs_­i_objeù_li¡_g‘
 (
·¿m
->
chªge_li¡
, 
ix
);

113 ià(
obj
 =ğ
NULL
) {

114 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS", "Missing VRF CPS Object");

115  
ıs_­i_»t_code_ERR
;

118 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

119 
rc
 = 
	`Çs_vrf_´oûss_ıs_vrf_štf_msg
(
·¿m
,
ix
);

121  
rc
;

122 
	}
}

124 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_ıs_vrf_štf_g‘_func
 (*
ùx
,

125 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

126 
size_t
 
ix
) {

127 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "VRF Intf get function");

128 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

130 
ıs_­i_objeù_t
 
ft
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
ix
);

131 ià(
ft
 =ğ
NULL
) {

132 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS","VRF intf object is‚ot…resent");

133  
ıs_­i_»t_code_ERR
;

136 cÚ¡ *
vrf_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_g‘_d©a
(
ft
, 
NI_IF_INTERFACES_INTERFACE_BIND_NI_NAME
);

137 cÚ¡ *
if_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_g‘_d©a
(
ft
, 
IF_INTERFACES_INTERFACE_NAME
);

139 ià(
if_Çme
 =ğ
nuÎ±r
) {

140 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS","No If-name, VRF-Intf get failed!");

141  
ıs_­i_»t_code_ERR
;

144 if((
rc
 = 
	`Çs_vrf_g‘_štf_šfo
(
·¿m
->
li¡
, 
vrf_Çme
, 
if_Çme
)è!ğ
STD_ERR_OK
){

145  (
ıs_­i_»tuº_code_t
)
rc
;

148  
ıs_­i_»t_code_OK
;

149 
	}
}

151 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_ıs_vrf_rou‹r_štf_g‘_func
 (*
ùx
,

152 
ıs_­i_g‘_·¿ms_t
 * 
·¿m
,

153 
size_t
 
ix
) {

154 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "VRF Intf get function");

155 
ıs_­i_»tuº_code_t
 
rc
 = 
ıs_­i_»t_code_OK
;

157 
ıs_­i_objeù_t
 
ft
 = 
	`ıs_­i_objeù_li¡_g‘
(
·¿m
->
f‹rs
,
ix
);

158 ià(
ft
 =ğ
NULL
) {

159 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS","VRF intf object is‚ot…resent");

160  
ıs_­i_»t_code_ERR
;

163 cÚ¡ *
if_Çme
 = (cÚ¡ *)
	`ıs_­i_objeù_g‘_d©a
(
ft
, 
VRF_MGMT_ROUTER_INTF_ENTRY_NAME
);

165 ià(
if_Çme
 =ğ
nuÎ±r
) {

166 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS","No If-name, VRF-Intf get failed!");

167  
ıs_­i_»t_code_ERR
;

170 if((
rc
 = 
	`Çs_vrf_g‘_rou‹r_štf_šfo
(
·¿m
->
li¡
, 
if_Çme
)è!ğ
STD_ERR_OK
){

171  (
ıs_­i_»tuº_code_t
)
rc
;

174  
ıs_­i_»t_code_OK
;

175 
	}
}

178 
ıs_­i_»tuº_code_t
 
	$Çs_vrf_ıs_vrf_štf_rŞlback_func
(* 
ùx
,

179 
ıs_­i_Œª§ùiÚ_·¿ms_t
 * 
·¿m
, 
size_t
 
ix
){

181 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "VRF Intf Rollback function");

182  
ıs_­i_»t_code_OK
;

183 
	}
}

185 
t_¡d_”rÜ
 
	$Çs_vrf_objeù_vrf_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
Çs_vrf_ıs_hªdË
 ) {

187 
ıs_­i_»gi¡¿tiÚ_funùiÚs_t
 
f
;

188 
buff
[
CPS_API_KEY_STR_MAX
];

190 
	`mem£t
(&
f
,0,(f));

192 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "VRF CPS Initialization");

194 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
f
.
key
,
NI_NETWORK_INSTANCES_OBJ
,
ıs_­i_qu®if›r_TARGET
)) {

195 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS","Could‚otranslate %do key %s",

196 ()(
NI_NETWORK_INSTANCES_OBJ
),
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

197  
	`STD_ERR
(
ROUTE
,
FAIL
,0);

200 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "Registering for %s",

201 
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

203 
f
.
hªdË
 = 
Çs_vrf_ıs_hªdË
;

204 
f
.
_»ad_funùiÚ
 = 
Çs_vrf_ıs_vrf_g‘_func
;

205 
f
.
_wr™e_funùiÚ
 = 
Çs_vrf_ıs_vrf_£t_func
;

206 
f
.
_rŞlback_funùiÚ
 = 
Çs_vrf_ıs_vrf_rŞlback_func
;

208 ià(
	`ıs_­i_»gi¡”
(&
f
)!=
ıs_­i_»t_code_OK
) {

209  
	`STD_ERR
(
ROUTE
,
FAIL
,0);

211  
STD_ERR_OK
;

212 
	}
}

214 
t_¡d_”rÜ
 
	$Çs_vrf_objeù_vrf_štf_š™
(
ıs_­i_İ”©iÚ_hªdË_t
 
Çs_vrf_ıs_hªdË
 ) {

216 
ıs_­i_»gi¡¿tiÚ_funùiÚs_t
 
f
;

217 
buff
[
CPS_API_KEY_STR_MAX
];

219 
	`mem£t
(&
f
,0,(f));

221 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "VRF Intf binding CPS Initialization");

223 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
f
.
key
,
NI_IF_INTERFACES_INTERFACE_OBJ
,
ıs_­i_qu®if›r_TARGET
)) {

224 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS","Could‚otranslate %do key %s",

225 ()(
NI_IF_INTERFACES_INTERFACE_OBJ
),
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

226  
	`STD_ERR
(
ROUTE
,
FAIL
,0);

229 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "Registering for %s",

230 
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

232 
f
.
hªdË
 = 
Çs_vrf_ıs_hªdË
;

233 
f
.
_»ad_funùiÚ
 = 
Çs_vrf_ıs_vrf_štf_g‘_func
;

234 
f
.
_wr™e_funùiÚ
 = 
Çs_vrf_ıs_vrf_štf_£t_func
;

235 
f
.
_rŞlback_funùiÚ
 = 
Çs_vrf_ıs_vrf_štf_rŞlback_func
;

237 ià(
	`ıs_­i_»gi¡”
(&
f
)!=
ıs_­i_»t_code_OK
) {

238  
	`STD_ERR
(
ROUTE
,
FAIL
,0);

241 
	`mem£t
(&
f
,0,(f));

244 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
f
.
key
, 
VRF_MGMT_INTF_BIND_NI_OBJ
,

245 
ıs_­i_qu®if›r_TARGET
)) {

246 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS","Could‚otranslate %do key %s",

247 ()(
VRF_MGMT_INTF_BIND_NI_OBJ
),

248 
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

249  
	`STD_ERR
(
ROUTE
,
FAIL
,0);

252 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "Registering for %s",

253 
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

255 
f
.
hªdË
 = 
Çs_vrf_ıs_hªdË
;

256 
f
.
_wr™e_funùiÚ
 = 
Çs_štf_bšd_vrf_½c_hªdËr
;

258 ià(
	`ıs_­i_»gi¡”
(&
f
)!=
ıs_­i_»t_code_OK
) {

259  
	`STD_ERR
(
ROUTE
,
FAIL
,0);

262 
	`mem£t
(&
f
,0,(f));

264 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "VRF„outer Intf binding CPS Initialization");

266 ià(!
	`ıs_­i_key_äom_©Œ_w™h_qu®
(&
f
.
key
,
VRF_MGMT_ROUTER_INTF_ENTRY_OBJ
,
ıs_­i_qu®if›r_TARGET
)) {

267 
	`NAS_VRF_LOG_ERR
("NAS-RT-CPS","Could‚otranslate„outer intf obj %do key %s",

268 ()(
VRF_MGMT_ROUTER_INTF_ENTRY_OBJ
),
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

269  
	`STD_ERR
(
ROUTE
,
FAIL
,0);

272 
	`NAS_VRF_LOG_DEBUG
("NAS-RT-CPS", "Registering for %s",

273 
	`ıs_­i_key_´št
(&
f
.
key
,
buff
,(buff)-1));

275 
f
.
hªdË
 = 
Çs_vrf_ıs_hªdË
;

276 
f
.
_»ad_funùiÚ
 = 
Çs_vrf_ıs_vrf_rou‹r_štf_g‘_func
;

278 ià(
	`ıs_­i_»gi¡”
(&
f
)!=
ıs_­i_»t_code_OK
) {

279  
	`STD_ERR
(
ROUTE
,
FAIL
,0);

282  
STD_ERR_OK
;

283 
	}
}

	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


26 #iâdef 
__Ãed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


35 
	~<b™s/”ºo.h
>

36 #undeà
__Ãed_Em©h


38 #ifdef 
_ERRNO_H


45 #iâdef 
”ºo


46 
”ºo
;

49 #ifdeà
__USE_GNU


54 *
´og¿m_švoÿtiÚ_Çme
, *
´og¿m_švoÿtiÚ_shÜt_Çme
;

58 
	g__END_DECLS


66 #ià
defšed
 
__USE_GNU
 || defšed 
__Ãed_”rÜ_t


67 #iâdeà
__”rÜ_t_defšed


68 
	t”rÜ_t
;

69 
	#__”rÜ_t_defšed
 1

	)

71 #undeà
__Ãed_”rÜ_t


	@/usr/include/fcntl.h

22 #iâdef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

35 
	~<b™s/fú.h
>

39 #ifdeà
__O_TMPFILE


40 
	#__OPEN_NEEDS_MODE
(
oæag
) \

41 (((
oæag
è& 
O_CREAT
è!ğ0 || ((oæagè& 
__O_TMPFILE
è=ğ__O_TMPFILE)

	)

43 
	#__OPEN_NEEDS_MODE
(
oæag
è(((oæagè& 
O_CREAT
è!ğ0)

	)

49 #iâdeà
__mode_t_defšed


50 
__mode_t
 
	tmode_t
;

51 
	#__mode_t_defšed


	)

54 #iâdeà
__off_t_defšed


55 #iâdeà
__USE_FILE_OFFSET64


56 
__off_t
 
	toff_t
;

58 
__off64_t
 
	toff_t
;

60 
	#__off_t_defšed


	)

63 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defšed


	)

68 #iâdeà
__pid_t_defšed


69 
__pid_t
 
	tpid_t
;

70 
	#__pid_t_defšed


	)

74 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


75 
	#__Ãed_time¥ec


	)

76 
	~<time.h
>

77 
	~<b™s/¡©.h
>

79 
	#S_IFMT
 
__S_IFMT


	)

80 
	#S_IFDIR
 
__S_IFDIR


	)

81 
	#S_IFCHR
 
__S_IFCHR


	)

82 
	#S_IFBLK
 
__S_IFBLK


	)

83 
	#S_IFREG
 
__S_IFREG


	)

84 #ifdeà
__S_IFIFO


85 
	#S_IFIFO
 
__S_IFIFO


	)

87 #ifdeà
__S_IFLNK


88 
	#S_IFLNK
 
__S_IFLNK


	)

90 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
è&& defšed 
__S_IFSOCK


91 
	#S_IFSOCK
 
__S_IFSOCK


	)

96 
	#S_ISUID
 
__S_ISUID


	)

97 
	#S_ISGID
 
__S_ISGID


	)

99 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


101 
	#S_ISVTX
 
__S_ISVTX


	)

104 
	#S_IRUSR
 
__S_IREAD


	)

105 
	#S_IWUSR
 
__S_IWRITE


	)

106 
	#S_IXUSR
 
__S_IEXEC


	)

108 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

110 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

111 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

112 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

114 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

116 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

117 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

118 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

120 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

123 #ifdef 
__USE_MISC


124 #iâdeà
R_OK


127 
	#R_OK
 4

	)

128 
	#W_OK
 2

	)

129 
	#X_OK
 1

	)

130 
	#F_OK
 0

	)

135 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


136 
	#SEEK_SET
 0

	)

137 
	#SEEK_CUR
 1

	)

138 
	#SEEK_END
 2

	)

146 
fú
 (
__fd
, 
__cmd
, ...);

155 #iâdeà
__USE_FILE_OFFSET64


156 
	$İ’
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

158 #ifdeà
__REDIRECT


159 
	`__REDIRECT
 (
İ’
, (cÚ¡ *
__fe
, 
__oæag
, ...), 
İ’64
)

160 
	`__nÚnuÎ
 ((1));

162 
	#İ’
 
İ’64


	)

165 #ifdeà
__USE_LARGEFILE64


166 
	$İ’64
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

169 #ifdeà
__USE_ATFILE


179 #iâdeà
__USE_FILE_OFFSET64


180 
	$İ’©
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

181 
	`__nÚnuÎ
 ((2));

183 #ifdeà
__REDIRECT


184 
	`__REDIRECT
 (
İ’©
, (
__fd
, cÚ¡ *
__fe
, 
__oæag
,

185 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

187 
	#İ’©
 
İ’©64


	)

190 #ifdeà
__USE_LARGEFILE64


191 
	$İ’©64
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

192 
	`__nÚnuÎ
 ((2));

201 #iâdeà
__USE_FILE_OFFSET64


202 
	$ü—t
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

204 #ifdeà
__REDIRECT


205 
	`__REDIRECT
 (
ü—t
, (cÚ¡ *
__fe
, 
mode_t
 
__mode
),

206 
ü—t64
è
	`__nÚnuÎ
 ((1));

208 
	#ü—t
 
ü—t64


	)

211 #ifdeà
__USE_LARGEFILE64


212 
	$ü—t64
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

215 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

216 && !
defšed
 
__USE_POSIX
))

225 
	#F_ULOCK
 0

	)

226 
	#F_LOCK
 1

	)

227 
	#F_TLOCK
 2

	)

228 
	#F_TEST
 3

	)

230 #iâdeà
__USE_FILE_OFFSET64


231 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Ën
);

233 #ifdeà
__REDIRECT


234 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

236 
	#lockf
 
lockf64


	)

239 #ifdeà
__USE_LARGEFILE64


240 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Ën
);

244 #ifdeà
__USE_XOPEN2K


247 #iâdeà
__USE_FILE_OFFSET64


248 
	$posix_çdvi£
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
,

249 
__advi£
è
__THROW
;

251 #ifdeà
__REDIRECT_NTH


252 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

253 
__off64_t
 
__Ën
, 
__advi£
),

254 
posix_çdvi£64
);

256 
	#posix_çdvi£
 
posix_çdvi£64


	)

259 #ifdeà
__USE_LARGEFILE64


260 
	$posix_çdvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
,

261 
__advi£
è
__THROW
;

269 #iâdeà
__USE_FILE_OFFSET64


270 
	`posix_çÎoÿ‹
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
);

272 #ifdeà
__REDIRECT


273 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

274 
__off64_t
 
__Ën
),

275 
posix_çÎoÿ‹64
);

277 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

280 #ifdeà
__USE_LARGEFILE64


281 
	`posix_çÎoÿ‹64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
);

287 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
 \

288 && 
defšed
 
__va_¬g_·ck_Ën


289 
	~<b™s/fú2.h
>

292 
__END_DECLS


	@/usr/include/inttypes.h

22 #iâdeà
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<¡dšt.h
>

30 #iâdeà
____gwch¬_t_defšed


31 #ifdeà
__ılu¥lus


32 
	#__gwch¬_t
 
wch¬_t


	)

33 #–ià
defšed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

36 
	#__Ãed_wch¬_t


	)

37 
	~<¡ddef.h
>

38 
wch¬_t
 
	t__gwch¬_t
;

40 
	#____gwch¬_t_defšed
 1

	)

43 #ià
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Î"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #ià
__WORDSIZE
 == 64

273 
	mquÙ
;

274 
	m»m
;

275 } 
	timaxdiv_t
;

282 
__ex‹nsiÚ__
 
	mquÙ
;

283 
__ex‹nsiÚ__
 
	m»m
;

284 } 
	timaxdiv_t
;

290 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

294 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

297 
štmax_t
 
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

298 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

301 
uštmax_t
 
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

302 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

305 
štmax_t
 
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

306 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

307 
__THROW
;

310 
uštmax_t
 
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

311 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

312 
__THROW
;

314 #ifdeà
__USE_EXTERN_INLINES


316 #ià
__WORDSIZE
 == 64

318 
	$__¡¹Ş_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

319 **
__»¡riù
 
__’d±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

323 
__ex‹º_šlše
 
štmax_t


324 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

325 
ba£
))

327  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

328 
	}
}

330 
	$__¡¹oul_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 ** 
__»¡riù
 
__’d±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

335 
__ex‹º_šlše
 
uštmax_t


336 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

337 
ba£
))

339  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc¡Ş_š‹º®
 (cÚ¡ 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

343 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

347 
__ex‹º_šlše
 
štmax_t


348 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

349 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

351  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc¡oul_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

355 
__»¡riù
 
__ÅŒ
,

356 
__gwch¬_t
 **

357 
__»¡riù
 
__’d±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

361 
__ex‹º_šlše
 
uštmax_t


362 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

363 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

365  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

366 
	}
}

370 
__ex‹nsiÚ__


371 
	$__¡¹Şl_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

372 **
__»¡riù
 
__’d±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

376 
__ex‹º_šlše
 
štmax_t


377 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

378 
ba£
))

380  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

381 
	}
}

383 
__ex‹nsiÚ__


384 
	$__¡¹ouÎ_š‹º®
 (const *

385 
__»¡riù
 
__ÅŒ
,

387 
__»¡riù
 
__’d±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

392 
__ex‹º_šlše
 
uštmax_t


393 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

394 
ba£
))

396  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

397 
	}
}

399 
__ex‹nsiÚ__


400 
	$__wc¡Şl_š‹º®
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

401 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

405 
__ex‹º_šlše
 
štmax_t


406 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

407 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

409  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

410 
	}
}

413 
__ex‹nsiÚ__


414 
	$__wc¡ouÎ_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

415 
__»¡riù
 
__ÅŒ
,

416 
__gwch¬_t
 **

417 
__»¡riù
 
__’d±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

422 
__ex‹º_šlše
 
uštmax_t


423 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

424 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

426  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	~<ã©u»s.h
>

31 
	#MB_LEN_MAX
 16

	)

36 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

41 #iâdeà
_LIMITS_H


42 
	#_LIMITS_H
 1

	)

44 
	~<b™s/wÜdsize.h
>

53 
	#CHAR_BIT
 8

	)

56 
	#SCHAR_MIN
 (-128)

	)

57 
	#SCHAR_MAX
 127

	)

60 
	#UCHAR_MAX
 255

	)

63 #ifdeà
__CHAR_UNSIGNED__


64 
	#CHAR_MIN
 0

	)

65 
	#CHAR_MAX
 
UCHAR_MAX


	)

67 
	#CHAR_MIN
 
SCHAR_MIN


	)

68 
	#CHAR_MAX
 
SCHAR_MAX


	)

72 
	#SHRT_MIN
 (-32768)

	)

73 
	#SHRT_MAX
 32767

	)

76 
	#USHRT_MAX
 65535

	)

79 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

80 
	#INT_MAX
 2147483647

	)

83 
	#UINT_MAX
 4294967295U

	)

86 #ià
__WORDSIZE
 == 64

87 
	#LONG_MAX
 9223372036854775807L

	)

89 
	#LONG_MAX
 2147483647L

	)

91 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

94 #ià
__WORDSIZE
 == 64

95 
	#ULONG_MAX
 18446744073709551615UL

	)

97 
	#ULONG_MAX
 4294967295UL

	)

100 #ifdeà
__USE_ISOC99


103 
	#LLONG_MAX
 9223372036854775807LL

	)

104 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

107 
	#ULLONG_MAX
 18446744073709551615ULL

	)

121 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


123 #šşude_Ãxˆ<
lim™s
.
h
>

129 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


130 #iâdeà
LLONG_MIN


131 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

133 #iâdeà
LLONG_MAX


134 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

136 #iâdeà
ULLONG_MAX


137 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

141 #ifdef 
__USE_POSIX


143 
	~<b™s/posix1_lim.h
>

146 #ifdef 
__USE_POSIX2


147 
	~<b™s/posix2_lim.h
>

150 #ifdef 
__USE_XOPEN


151 
	~<b™s/xİ’_lim.h
>

	@/usr/include/linux/if.h

19 #iâdeà
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	~<lšux/libc-com·t.h
>

23 
	~<lšux/ty³s.h
>

24 
	~<lšux/sock‘.h
>

27 #ià
__UAPI_DEF_IF_IFNAMSIZ


28 
	#IFNAMSIZ
 16

	)

30 
	#IFALIASZ
 256

	)

31 
	~<lšux/hdlc/ioùl.h
>

34 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 != 0 && \

35 
	g__UAPI_DEF_IF_NET_DEVICE_FLAGS
 != 0

76 
	eÃt_deviû_æags
 {

78 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS


79 
IFF_UP
 = 1<<0,

80 
	mIFF_BROADCAST
 = 1<<1,

81 
	mIFF_DEBUG
 = 1<<2,

82 
	mIFF_LOOPBACK
 = 1<<3,

83 
	mIFF_POINTOPOINT
 = 1<<4,

84 
	mIFF_NOTRAILERS
 = 1<<5,

85 
	mIFF_RUNNING
 = 1<<6,

86 
	mIFF_NOARP
 = 1<<7,

87 
	mIFF_PROMISC
 = 1<<8,

88 
	mIFF_ALLMULTI
 = 1<<9,

89 
	mIFF_MASTER
 = 1<<10,

90 
	mIFF_SLAVE
 = 1<<11,

91 
	mIFF_MULTICAST
 = 1<<12,

92 
	mIFF_PORTSEL
 = 1<<13,

93 
	mIFF_AUTOMEDIA
 = 1<<14,

94 
	mIFF_DYNAMIC
 = 1<<15,

96 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


97 
	mIFF_LOWER_UP
 = 1<<16,

98 
	mIFF_DORMANT
 = 1<<17,

99 
	mIFF_ECHO
 = 1<<18,

105 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS


106 
	#IFF_UP
 
IFF_UP


	)

107 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

108 
	#IFF_DEBUG
 
IFF_DEBUG


	)

109 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

110 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

111 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

112 
	#IFF_RUNNING
 
IFF_RUNNING


	)

113 
	#IFF_NOARP
 
IFF_NOARP


	)

114 
	#IFF_PROMISC
 
IFF_PROMISC


	)

115 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

116 
	#IFF_MASTER
 
IFF_MASTER


	)

117 
	#IFF_SLAVE
 
IFF_SLAVE


	)

118 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

119 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

120 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

121 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

124 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


125 
	#IFF_LOWER_UP
 
IFF_LOWER_UP


	)

126 
	#IFF_DORMANT
 
IFF_DORMANT


	)

127 
	#IFF_ECHO
 
IFF_ECHO


	)

130 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

131 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

133 
	#IF_GET_IFACE
 0x0001

	)

134 
	#IF_GET_PROTO
 0x0002

	)

137 
	#IF_IFACE_V35
 0x1000

	)

138 
	#IF_IFACE_V24
 0x1001

	)

139 
	#IF_IFACE_X21
 0x1002

	)

140 
	#IF_IFACE_T1
 0x1003

	)

141 
	#IF_IFACE_E1
 0x1004

	)

142 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

143 
	#IF_IFACE_X21D
 0x1006

	)

146 
	#IF_PROTO_HDLC
 0x2000

	)

147 
	#IF_PROTO_PPP
 0x2001

	)

148 
	#IF_PROTO_CISCO
 0x2002

	)

149 
	#IF_PROTO_FR
 0x2003

	)

150 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

151 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

152 
	#IF_PROTO_X25
 0x2006

	)

153 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

154 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

155 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

156 
	#IF_PROTO_FR_PVC
 0x200A

	)

157 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

158 
	#IF_PROTO_RAW
 0x200C

	)

162 
	mIF_OPER_UNKNOWN
,

163 
	mIF_OPER_NOTPRESENT
,

164 
	mIF_OPER_DOWN
,

165 
	mIF_OPER_LOWERLAYERDOWN
,

166 
	mIF_OPER_TESTING
,

167 
	mIF_OPER_DORMANT
,

168 
	mIF_OPER_UP
,

173 
	mIF_LINK_MODE_DEFAULT
,

174 
	mIF_LINK_MODE_DORMANT
,

188 #ià
__UAPI_DEF_IF_IFMAP


189 
	sifm­
 {

190 
	mmem_¡¬t
;

191 
	mmem_’d
;

192 
	mba£_addr
;

193 
	mœq
;

194 
	mdma
;

195 
	mpÜt
;

200 
	sif_£‰šgs
 {

201 
	mty³
;

202 
	msize
;

205 
¿w_hdlc_´Ùo
 *
	m¿w_hdlc
;

206 
cisco_´Ùo
 *
	mcisco
;

207 
ä_´Ùo
 *
	mä
;

208 
ä_´Ùo_pvc
 *
	mä_pvc
;

209 
ä_´Ùo_pvc_šfo
 *
	mä_pvc_šfo
;

212 
sync_£rŸl_£‰šgs
 *
	msync
;

213 
‹1_£‰šgs
 *
	m‹1
;

214 } 
	mifs_ifsu
;

225 #ià
__UAPI_DEF_IF_IFREQ


226 
	siäeq
 {

227 
	#IFHWADDRLEN
 6

	)

230 
	miän_Çme
[
IFNAMSIZ
];

231 } 
	miä_iän
;

234 
sockaddr
 
	miäu_addr
;

235 
sockaddr
 
	miäu_d¡addr
;

236 
sockaddr
 
	miäu_brßdaddr
;

237 
sockaddr
 
	miäu_Ãtmask
;

238 
sockaddr
 
	miäu_hwaddr
;

239 
	miäu_æags
;

240 
	miäu_iv®ue
;

241 
	miäu_mtu
;

242 
ifm­
 
	miäu_m­
;

243 
	miäu_¦ave
[
IFNAMSIZ
];

244 
	miäu_ÃwÇme
[
IFNAMSIZ
];

245 * 
	miäu_d©a
;

246 
if_£‰šgs
 
	miäu_£‰šgs
;

247 } 
	miä_iäu
;

251 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

252 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

253 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

254 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

255 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

256 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

257 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

258 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

259 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

260 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

261 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

262 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

263 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

264 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

265 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

266 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

267 
	#iä_£‰šgs
 
iä_iäu
.
iäu_£‰šgs


	)

277 #ià
__UAPI_DEF_IF_IFCONF


278 
	sifcÚf
 {

279 
	mifc_Ën
;

281 *
	mifcu_buf
;

282 
iäeq
 *
	mifcu_»q
;

283 } 
	mifc_ifcu
;

287 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

288 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

	@/usr/include/linux/if_tun.h

16 #iâdeà
__IF_TUN_H


17 
	#__IF_TUN_H


	)

19 
	~<lšux/ty³s.h
>

20 
	~<lšux/if_‘h”.h
>

21 
	~<lšux/f‹r.h
>

24 
	#TUN_READQ_SIZE
 500

	)

26 
	#TUN_TUN_DEV
 
IFF_TUN


	)

27 
	#TUN_TAP_DEV
 
IFF_TAP


	)

28 
	#TUN_TYPE_MASK
 0x000f

	)

31 
	#TUNSETNOCSUM
 
	`_IOW
('T', 200, )

	)

32 
	#TUNSETDEBUG
 
	`_IOW
('T', 201, )

	)

33 
	#TUNSETIFF
 
	`_IOW
('T', 202, )

	)

34 
	#TUNSETPERSIST
 
	`_IOW
('T', 203, )

	)

35 
	#TUNSETOWNER
 
	`_IOW
('T', 204, )

	)

36 
	#TUNSETLINK
 
	`_IOW
('T', 205, )

	)

37 
	#TUNSETGROUP
 
	`_IOW
('T', 206, )

	)

38 
	#TUNGETFEATURES
 
	`_IOR
('T', 207, )

	)

39 
	#TUNSETOFFLOAD
 
	`_IOW
('T', 208, )

	)

40 
	#TUNSETTXFILTER
 
	`_IOW
('T', 209, )

	)

41 
	#TUNGETIFF
 
	`_IOR
('T', 210, )

	)

42 
	#TUNGETSNDBUF
 
	`_IOR
('T', 211, )

	)

43 
	#TUNSETSNDBUF
 
	`_IOW
('T', 212, )

	)

44 
	#TUNATTACHFILTER
 
	`_IOW
('T', 213, 
sock_årog
)

	)

45 
	#TUNDETACHFILTER
 
	`_IOW
('T', 214, 
sock_årog
)

	)

46 
	#TUNGETVNETHDRSZ
 
	`_IOR
('T', 215, )

	)

47 
	#TUNSETVNETHDRSZ
 
	`_IOW
('T', 216, )

	)

48 
	#TUNSETQUEUE
 
	`_IOW
('T', 217, )

	)

49 
	#TUNSETIFINDEX
 
	`_IOW
('T', 218, )

	)

50 
	#TUNGETFILTER
 
	`_IOR
('T', 219, 
sock_årog
)

	)

51 
	#TUNSETVNETLE
 
	`_IOW
('T', 220, )

	)

52 
	#TUNGETVNETLE
 
	`_IOR
('T', 221, )

	)

57 
	#TUNSETVNETBE
 
	`_IOW
('T', 222, )

	)

58 
	#TUNGETVNETBE
 
	`_IOR
('T', 223, )

	)

61 
	#IFF_TUN
 0x0001

	)

62 
	#IFF_TAP
 0x0002

	)

63 
	#IFF_NO_PI
 0x1000

	)

65 
	#IFF_ONE_QUEUE
 0x2000

	)

66 
	#IFF_VNET_HDR
 0x4000

	)

67 
	#IFF_TUN_EXCL
 0x8000

	)

68 
	#IFF_MULTI_QUEUE
 0x0100

	)

69 
	#IFF_ATTACH_QUEUE
 0x0200

	)

70 
	#IFF_DETACH_QUEUE
 0x0400

	)

72 
	#IFF_PERSIST
 0x0800

	)

73 
	#IFF_NOFILTER
 0x1000

	)

76 
	#TUN_TX_TIMESTAMP
 1

	)

79 
	#TUN_F_CSUM
 0x01

	)

80 
	#TUN_F_TSO4
 0x02

	)

81 
	#TUN_F_TSO6
 0x04

	)

82 
	#TUN_F_TSO_ECN
 0x08

	)

83 
	#TUN_F_UFO
 0x10

	)

86 
	#TUN_PKT_STRIP
 0x0001

	)

87 
	stun_pi
 {

88 
__u16
 
	mæags
;

89 
__be16
 
	m´Ùo
;

100 
	#TUN_FLT_ALLMULTI
 0x0001

	)

101 
	stun_f‹r
 {

102 
__u16
 
	mæags
;

103 
__u16
 
	mcouÁ
;

104 
__u8
 
	maddr
[0][
ETH_ALEN
];

	@/usr/include/net/if.h

19 #iâdeà
_NET_IF_H


20 
	#_NET_IF_H
 1

	)

22 
	~<ã©u»s.h
>

24 #ifdeà
__USE_MISC


25 
	~<sys/ty³s.h
>

26 
	~<sys/sock‘.h
>

31 
	#IF_NAMESIZE
 16

	)

33 
	sif_Çmešdex


35 
	mif_šdex
;

36 *
	mif_Çme
;

40 #ifdeà
__USE_MISC


44 
	mIFF_UP
 = 0x1,

45 
	#IFF_UP
 
IFF_UP


	)

46 
	mIFF_BROADCAST
 = 0x2,

47 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

48 
	mIFF_DEBUG
 = 0x4,

49 
	#IFF_DEBUG
 
IFF_DEBUG


	)

50 
	mIFF_LOOPBACK
 = 0x8,

51 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

52 
	mIFF_POINTOPOINT
 = 0x10,

53 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

54 
	mIFF_NOTRAILERS
 = 0x20,

55 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

56 
	mIFF_RUNNING
 = 0x40,

57 
	#IFF_RUNNING
 
IFF_RUNNING


	)

58 
	mIFF_NOARP
 = 0x80,

59 
	#IFF_NOARP
 
IFF_NOARP


	)

60 
	mIFF_PROMISC
 = 0x100,

61 
	#IFF_PROMISC
 
IFF_PROMISC


	)

64 
	mIFF_ALLMULTI
 = 0x200,

65 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

67 
	mIFF_MASTER
 = 0x400,

68 
	#IFF_MASTER
 
IFF_MASTER


	)

69 
	mIFF_SLAVE
 = 0x800,

70 
	#IFF_SLAVE
 
IFF_SLAVE


	)

72 
	mIFF_MULTICAST
 = 0x1000,

73 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

75 
	mIFF_PORTSEL
 = 0x2000,

76 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

77 
	mIFF_AUTOMEDIA
 = 0x4000,

78 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

79 
	mIFF_DYNAMIC
 = 0x8000

80 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

88 
	siçddr


90 
sockaddr
 
	miç_addr
;

93 
sockaddr
 
	mifu_brßdaddr
;

94 
sockaddr
 
	mifu_d¡addr
;

95 } 
	miç_ifu
;

96 
içû
 *
	miç_iå
;

97 
içddr
 *
	miç_Ãxt
;

100 
	#iç_brßdaddr
 
iç_ifu
.
ifu_brßdaddr


	)

101 
	#iç_d¡addr
 
iç_ifu
.
ifu_d¡addr


	)

111 
	sifm­


113 
	mmem_¡¬t
;

114 
	mmem_’d
;

115 
	mba£_addr
;

116 
	mœq
;

117 
	mdma
;

118 
	mpÜt
;

126 
	siäeq


128 
	#IFHWADDRLEN
 6

	)

129 
	#IFNAMSIZ
 
IF_NAMESIZE


	)

132 
	miän_Çme
[
IFNAMSIZ
];

133 } 
	miä_iän
;

137 
sockaddr
 
	miäu_addr
;

138 
sockaddr
 
	miäu_d¡addr
;

139 
sockaddr
 
	miäu_brßdaddr
;

140 
sockaddr
 
	miäu_Ãtmask
;

141 
sockaddr
 
	miäu_hwaddr
;

142 
	miäu_æags
;

143 
	miäu_iv®ue
;

144 
	miäu_mtu
;

145 
ifm­
 
	miäu_m­
;

146 
	miäu_¦ave
[
IFNAMSIZ
];

147 
	miäu_ÃwÇme
[
IFNAMSIZ
];

148 
__ÿddr_t
 
	miäu_d©a
;

149 } 
	miä_iäu
;

151 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

152 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

153 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

154 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

155 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

156 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

157 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

158 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

159 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

160 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

161 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

162 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

163 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

164 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

165 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

166 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

167 
	#_IOT_iäeq
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),16,0,0)

	)

168 
	#_IOT_iäeq_shÜt
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

169 
	#_IOT_iäeq_št
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

176 
	sifcÚf


178 
	mifc_Ën
;

181 
__ÿddr_t
 
	mifcu_buf
;

182 
iäeq
 *
	mifcu_»q
;

183 } 
	mifc_ifcu
;

185 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

186 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

187 
	#_IOT_ifcÚf
 
	`_IOT
(
	`_IOTS
(
ifcÚf
),1,0,0,0,0è

	)

190 
__BEGIN_DECLS


193 
	$if_Çm‘ošdex
 (cÚ¡ *
__iâame
è
__THROW
;

194 *
	$if_šdextÚame
 (
__ifšdex
, *
__iâame
è
__THROW
;

197 
if_Çmešdex
 *
	$if_Çmešdex
 (è
__THROW
;

200 
	$if_ä“Çmešdex
 (
if_Çmešdex
 *
__±r
è
__THROW
;

202 
__END_DECLS


	@/usr/include/pthread.h

18 #iâdeà
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<’dŸn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<b™s/±h»adty³s.h
>

27 
	~<b™s/£tjmp.h
>

28 
	~<b™s/wÜdsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifdeà
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifdeà
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


85 #ifdeà
__PTHREAD_MUTEX_HAVE_PREV


86 
	#PTHREAD_MUTEX_INITIALIZER
 \

87 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

88 #ifdeà
__USE_GNU


89 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

90 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

91 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

92 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

93 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

94 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

98 
	#PTHREAD_MUTEX_INITIALIZER
 \

99 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

100 #ifdeà
__USE_GNU


101 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

102 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

103 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

104 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

105 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

113 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


116 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

117 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

118 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

119 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


125 #iâdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


126 #ià
__WORDSIZE
 == 64

127 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

132 
	#PTHREAD_RWLOCK_INITIALIZER
 \

133 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

134 #ifdeà
__USE_GNU


135 #ifdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


136 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

137 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, \

138 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

140 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


141 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

142 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

143 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

145 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

146 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

147 0 } }

	)

157 
	mPTHREAD_INHERIT_SCHED
,

158 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

159 
	mPTHREAD_EXPLICIT_SCHED


160 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

167 
	mPTHREAD_SCOPE_SYSTEM
,

168 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

169 
	mPTHREAD_SCOPE_PROCESS


170 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

177 
	mPTHREAD_PROCESS_PRIVATE
,

178 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

179 
	mPTHREAD_PROCESS_SHARED


180 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

186 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

190 
	s_±h»ad_ş—nup_bufãr


192 (*
	m__routše
) (*);

193 *
	m__¬g
;

194 
	m__ÿnûÉy³
;

195 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

201 
	mPTHREAD_CANCEL_ENABLE
,

202 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

203 
	mPTHREAD_CANCEL_DISABLE


204 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

208 
	mPTHREAD_CANCEL_DEFERRED
,

209 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

210 
	mPTHREAD_CANCEL_ASYNCHRONOUS


211 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

213 
	#PTHREAD_CANCELED
 ((*è-1)

	)

217 
	#PTHREAD_ONCE_INIT
 0

	)

220 #ifdeà
__USE_XOPEN2K


224 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

228 
__BEGIN_DECLS


233 
	$±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

234 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

235 *(*
__¡¬t_routše
) (*),

236 *
__»¡riù
 
__¬g
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 3));

242 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

250 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

252 #ifdeà
__USE_GNU


255 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

263 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

264 cÚ¡ 
time¥ec
 *
__ab¡ime
);

271 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

275 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

278 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
)

279 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

287 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

290 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

291 
__THROW
 
	`__nÚnuÎ
 ((1));

294 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

295 *
__d‘ach¡©e
)

296 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

299 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

300 
__d‘ach¡©e
)

301 
__THROW
 
	`__nÚnuÎ
 ((1));

305 
	$±h»ad_©Œ_g‘gu¬dsize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

306 
size_t
 *
__gu¬dsize
)

307 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

310 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

311 
size_t
 
__gu¬dsize
)

312 
__THROW
 
	`__nÚnuÎ
 ((1));

316 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

317 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

318 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

321 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

322 cÚ¡ 
sched_·¿m
 *
__»¡riù


323 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

326 
	$±h»ad_©Œ_g‘schedpŞicy
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


327 
__©Œ
, *
__»¡riù
 
__pŞicy
)

328 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

331 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

332 
__THROW
 
	`__nÚnuÎ
 ((1));

335 
	$±h»ad_©Œ_g‘šh”™sched
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


336 
__©Œ
, *
__»¡riù
 
__šh”™
)

337 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

340 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

341 
__šh”™
)

342 
__THROW
 
	`__nÚnuÎ
 ((1));

346 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

347 *
__»¡riù
 
__scİe
)

348 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

351 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

352 
__THROW
 
	`__nÚnuÎ
 ((1));

355 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


356 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

357 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

363 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

364 *
__¡ackaddr
)

365 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

368 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


369 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

370 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

375 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

376 
size_t
 
__¡acksize
)

377 
__THROW
 
	`__nÚnuÎ
 ((1));

379 #ifdeà
__USE_XOPEN2K


381 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

382 **
__»¡riù
 
__¡ackaddr
,

383 
size_t
 *
__»¡riù
 
__¡acksize
)

384 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

389 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

390 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

393 #ifdeà
__USE_GNU


396 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

397 
size_t
 
__ıu£tsize
,

398 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

399 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

403 
	$±h»ad_©Œ_g‘affš™y_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

404 
size_t
 
__ıu£tsize
,

405 
ıu_£t_t
 *
__ıu£t
)

406 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

409 
	$±h»ad_g‘©Œ_deçuÉ_Å
 (
±h»ad_©Œ_t
 *
__©Œ
)

410 
__THROW
 
	`__nÚnuÎ
 ((1));

414 
	$±h»ad_£‰r_deçuÉ_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
)

415 
__THROW
 
	`__nÚnuÎ
 ((1));

420 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

421 
__THROW
 
	`__nÚnuÎ
 ((2));

429 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

430 cÚ¡ 
sched_·¿m
 *
__·¿m
)

431 
__THROW
 
	`__nÚnuÎ
 ((3));

434 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

435 *
__»¡riù
 
__pŞicy
,

436 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

437 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

440 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

441 
__THROW
;

444 #ifdeà
__USE_GNU


446 
	$±h»ad_g‘Çme_Å
 (
±h»ad_t
 
__rg‘_th»ad
, *
__buf
,

447 
size_t
 
__buæ’
)

448 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$±h»ad_£Šame_Å
 (
±h»ad_t
 
__rg‘_th»ad
, cÚ¡ *
__Çme
)

452 
__THROW
 
	`__nÚnuÎ
 ((2));

456 #ifdeà
__USE_UNIX98


458 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

461 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

464 #ifdeà
__USE_GNU


469 
	$±h»ad_y›ld
 (è
__THROW
;

474 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

475 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

476 
__THROW
 
	`__nÚnuÎ
 ((3));

479 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

480 
ıu_£t_t
 *
__ıu£t
)

481 
__THROW
 
	`__nÚnuÎ
 ((3));

494 
	$±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

495 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

506 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

510 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

513 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

518 
	`±h»ad_‹¡ÿnûl
 ();

527 
__jmp_buf
 
__ÿnûl_jmp_buf
;

528 
__mask_was_§ved
;

529 } 
__ÿnûl_jmp_buf
[1];

530 *
__·d
[4];

531 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

534 #iâdeà
__ş—nup_fù_©Œibu‹


535 
	#__ş—nup_fù_©Œibu‹


	)

540 
	s__±h»ad_ş—nup_äame


542 (*
__ÿnûl_routše
) (*);

543 *
__ÿnûl_¬g
;

544 
__do_™
;

545 
__ÿnûl_ty³
;

548 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


549 #ifdeà
__ılu¥lus


551 şas 
	c__±h»ad_ş—nup_şass


553 (*
__ÿnûl_routše
) (*);

554 *
__ÿnûl_¬g
;

555 
__do_™
;

556 
__ÿnûl_ty³
;

558 
public
:

559 
	$__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

560 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

561 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

562 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

563 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

564 &
__ÿnûl_ty³
); 
	}
}

565 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

575 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

577 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

581 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

582 
__şäame
.
	`__£tdo™
 (
execu‹
); \

583 } 0)

	)

585 #ifdeà
__USE_GNU


589 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

591 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

592 
__şäame
.
	`__deãr
 ()

	)

597 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

598 
__şäame
.
	`__»¡Üe
 (); \

599 
__şäame
.
	`__£tdo™
 (
execu‹
); \

600 } 0)

	)

607 
__ex‹º_šlše
 

608 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

610 ià(
__äame
->
__do_™
)

611 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

612 
	}
}

621 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

623 
__±h»ad_ş—nup_äame
 
__şäame
 \

624 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

625 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

626 .
__do_™
 = 1 };

	)

630 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

631 
__şäame
.
__do_™
 = (
execu‹
); \

632 } 0)

	)

634 #ifdeà
__USE_GNU


638 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

640 
__±h»ad_ş—nup_äame
 
__şäame
 \

641 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

642 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

643 .
__do_™
 = 1 }; \

644 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

645 &
__şäame
.
__ÿnûl_ty³
)

	)

650 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

651 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

652 
__şäame
.
__do_™
 = (
execu‹
); \

653 } 0)

	)

664 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

666 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

667 (*
__ÿnûl_routše
è(*èğ(
routše
); \

668 *
__ÿnûl_¬g
 = (
¬g
); \

669 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

670 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

671 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

673 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

674 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

678 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

679 dØ{

	)

680 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

681 
__ş—nup_fù_©Œibu‹
;

685 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

688 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

689 ià(
execu‹
) \

690 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

691 } 0)

	)

692 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

693 
__ş—nup_fù_©Œibu‹
;

695 #ifdeà
__USE_GNU


699 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

701 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

702 (*
__ÿnûl_routše
è(*èğ(
routše
); \

703 *
__ÿnûl_¬g
 = (
¬g
); \

704 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

705 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

706 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

708 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

709 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

713 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

714 dØ{

	)

715 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

716 
__ş—nup_fù_©Œibu‹
;

721 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

724 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

725 ià(
execu‹
) \

726 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

727 
	}
} 0)

	)

728 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

729 
__ş—nup_fù_©Œibu‹
;

733 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

734 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

735 #iâdeà
SHARED


736 
	`__©Œibu‹__
 ((
__w—k__
))

742 
__jmp_buf_g
;

743 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROWNL
;

749 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

750 cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

751 
__THROW
 
	`__nÚnuÎ
 ((1));

754 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

755 
__THROW
 
	`__nÚnuÎ
 ((1));

758 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

759 
__THROWNL
 
	`__nÚnuÎ
 ((1));

762 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

763 
__THROWNL
 
	`__nÚnuÎ
 ((1));

765 #ifdeà
__USE_XOPEN2K


767 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

768 cÚ¡ 
time¥ec
 *
__»¡riù


769 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

773 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

774 
__THROWNL
 
	`__nÚnuÎ
 ((1));

778 
	$±h»ad_mu‹x_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x_t
 *

779 
__»¡riù
 
__mu‹x
,

780 *
__»¡riù
 
__´ioûšg
)

781 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

785 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

786 
__´ioûšg
,

787 *
__»¡riù
 
__Şd_ûšg
)

788 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

791 #ifdeà
__USE_XOPEN2K8


793 
	$±h»ad_mu‹x_cÚsi¡’t
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

794 
__THROW
 
	`__nÚnuÎ
 ((1));

795 #ifdeà
__USE_GNU


796 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

797 
__THROW
 
	`__nÚnuÎ
 ((1));

806 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

807 
__THROW
 
	`__nÚnuÎ
 ((1));

810 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

811 
__THROW
 
	`__nÚnuÎ
 ((1));

814 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

815 
__»¡riù
 
__©Œ
,

816 *
__»¡riù
 
__psh¬ed
)

817 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

820 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

821 
__psh¬ed
)

822 
__THROW
 
	`__nÚnuÎ
 ((1));

824 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


826 
	$±h»ad_mu‹x©Œ_g‘ty³
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


827 
__©Œ
, *
__»¡riù
 
__kšd
)

828 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

833 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

834 
__THROW
 
	`__nÚnuÎ
 ((1));

838 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

839 
__»¡riù
 
__©Œ
,

840 *
__»¡riù
 
__´ÙocŞ
)

841 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

845 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

846 
__´ÙocŞ
)

847 
__THROW
 
	`__nÚnuÎ
 ((1));

850 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

851 
__»¡riù
 
__©Œ
,

852 *
__»¡riù
 
__´ioûšg
)

853 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

856 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

857 
__´ioûšg
)

858 
__THROW
 
	`__nÚnuÎ
 ((1));

860 #ifdeà
__USE_XOPEN2K


862 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

863 *
__robu¡Ãss
)

864 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

865 #ifdeà
__USE_GNU


866 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

867 *
__robu¡Ãss
)

868 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

872 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

873 
__robu¡Ãss
)

874 
__THROW
 
	`__nÚnuÎ
 ((1));

875 #ifdeà
__USE_GNU


876 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

877 
__robu¡Ãss
)

878 
__THROW
 
	`__nÚnuÎ
 ((1));

883 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


888 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

889 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
__»¡riù


890 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

893 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

894 
__THROW
 
	`__nÚnuÎ
 ((1));

897 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

898 
__THROWNL
 
	`__nÚnuÎ
 ((1));

901 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

902 
__THROWNL
 
	`__nÚnuÎ
 ((1));

904 #ifdeà
__USE_XOPEN2K


906 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

907 cÚ¡ 
time¥ec
 *
__»¡riù


908 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

912 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

913 
__THROWNL
 
	`__nÚnuÎ
 ((1));

916 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

917 
__THROWNL
 
	`__nÚnuÎ
 ((1));

919 #ifdeà
__USE_XOPEN2K


921 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

922 cÚ¡ 
time¥ec
 *
__»¡riù


923 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

927 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

928 
__THROWNL
 
	`__nÚnuÎ
 ((1));

934 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

935 
__THROW
 
	`__nÚnuÎ
 ((1));

938 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

939 
__THROW
 
	`__nÚnuÎ
 ((1));

942 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

943 
__»¡riù
 
__©Œ
,

944 *
__»¡riù
 
__psh¬ed
)

945 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

948 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

949 
__psh¬ed
)

950 
__THROW
 
	`__nÚnuÎ
 ((1));

953 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

954 
__»¡riù
 
__©Œ
,

955 *
__»¡riù
 
__´ef
)

956 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

959 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

960 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

968 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

969 cÚ¡ 
±h»ad_cÚd©Œ_t
 *
__»¡riù
 
__cÚd_©Œ
)

970 
__THROW
 
	`__nÚnuÎ
 ((1));

973 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

974 
__THROW
 
	`__nÚnuÎ
 ((1));

977 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

978 
__THROWNL
 
	`__nÚnuÎ
 ((1));

981 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

982 
__THROWNL
 
	`__nÚnuÎ
 ((1));

989 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

990 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

991 
	`__nÚnuÎ
 ((1, 2));

1000 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1001 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

1002 cÚ¡ 
time¥ec
 *
__»¡riù
 
__ab¡ime
)

1003 
	`__nÚnuÎ
 ((1, 2, 3));

1008 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1009 
__THROW
 
	`__nÚnuÎ
 ((1));

1012 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1013 
__THROW
 
	`__nÚnuÎ
 ((1));

1016 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1017 
__»¡riù
 
__©Œ
,

1018 *
__»¡riù
 
__psh¬ed
)

1019 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1022 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1023 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1025 #ifdeà
__USE_XOPEN2K


1027 
	$±h»ad_cÚd©Œ_g‘şock
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1028 
__»¡riù
 
__©Œ
,

1029 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1030 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1033 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1034 
__şockid_t
 
__şock_id
)

1035 
__THROW
 
	`__nÚnuÎ
 ((1));

1039 #ifdeà
__USE_XOPEN2K


1044 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1045 
__THROW
 
	`__nÚnuÎ
 ((1));

1048 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1049 
__THROW
 
	`__nÚnuÎ
 ((1));

1052 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1053 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1056 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1057 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1060 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1061 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1068 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1069 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1070 
__©Œ
, 
__couÁ
)

1071 
__THROW
 
	`__nÚnuÎ
 ((1));

1074 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1075 
__THROW
 
	`__nÚnuÎ
 ((1));

1078 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1079 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1083 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1084 
__THROW
 
	`__nÚnuÎ
 ((1));

1087 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1088 
__THROW
 
	`__nÚnuÎ
 ((1));

1091 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *

1092 
__»¡riù
 
__©Œ
,

1093 *
__»¡riù
 
__psh¬ed
)

1094 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1097 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1098 
__psh¬ed
)

1099 
__THROW
 
	`__nÚnuÎ
 ((1));

1111 
	$±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1112 (*
__de¡r_funùiÚ
) (*))

1113 
__THROW
 
	`__nÚnuÎ
 ((1));

1116 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1119 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1122 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1123 cÚ¡ *
__poš‹r
è
__THROW
 ;

1126 #ifdeà
__USE_XOPEN2K


1128 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1129 
__şockid_t
 *
__şock_id
)

1130 
__THROW
 
	`__nÚnuÎ
 ((2));

1145 
	$±h»ad_©fÜk
 ((*
__´•¬e
) (),

1146 (*
__·»Á
) (),

1147 (*
__chd
è()è
__THROW
;

1150 #ifdeà
__USE_EXTERN_INLINES


1152 
__ex‹º_šlše
 

1153 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1155  
__th»ad1
 =ğ
__th»ad2
;

1156 
	}
}

1159 
	g__END_DECLS


	@/usr/include/signal.h

22 #iâdef 
_SIGNAL_H


24 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	~<b™s/sig£t.h
>

36 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


37 #iâdeà
__sig_©omic_t_defšed


38 
	#__sig_©omic_t_defšed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #undeà
__Ãed_sig_©omic_t


46 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

47 #iâdeà
__sig£t_t_defšed


48 
	#__sig£t_t_defšed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #undeà
__Ãed_sig£t_t


54 #ifdeà
_SIGNAL_H


56 
	~<b™s/ty³s.h
>

57 
	~<b™s/signum.h
>

59 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


60 #iâdeà
__pid_t_defšed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_defšed


	)

64 #ifdeà
__USE_XOPEN


66 #iâdeà
__uid_t_defšed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_defšed


	)

72 #ifdeà
__USE_POSIX199309


74 
	#__Ãed_time¥ec


	)

75 
	~<time.h
>

78 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


80 
	~<b™s/sigšfo.h
>

85 (*
	t__sighªdËr_t
) ();

90 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

91 
__THROW
;

92 #ifdeà
__USE_GNU


93 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifdeà
__USE_MISC


102 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

103 
__THROW
;

106 #ifdeà
__REDIRECT_NTH


107 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

108 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

109 
__sysv_sigÇl
);

111 
	#sigÇl
 
__sysv_sigÇl


	)

114 
__END_NAMESPACE_STD


116 #ifdeà
__USE_XOPEN


119 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

120 
__THROW
;

126 #ifdeà
__USE_POSIX


127 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

130 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


134 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$¿i£
 (
__sig
è
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifdeà
__USE_MISC


144 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

145 
__THROW
;

146 
	$gsigÇl
 (
__sig
è
__THROW
;

149 #ifdeà
__USE_XOPEN2K8


151 
	`psigÇl
 (
__sig
, cÚ¡ *
__s
);

154 
	`psigšfo
 (cÚ¡ 
sigšfo_t
 *
__pšfo
, cÚ¡ *
__s
);

166 #ifdeà
__USE_XOPEN


167 #ifdeà
__GNUC__


168 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

170 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

172 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

177 #ifdeà
__USE_MISC


184 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

187 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

190 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

193 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

197 #ifdeà
__USE_MISC


198 
	#NSIG
 
_NSIG


	)

201 #ifdeà
__USE_GNU


202 
__sighªdËr_t
 
	tsighªdËr_t
;

206 #ifdeà
__USE_MISC


207 
__sighªdËr_t
 
	tsig_t
;

210 #ifdeà
__USE_POSIX


213 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

216 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

219 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

222 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 
	$sigismemb”
 (cÚ¡ 
sig£t_t
 *
__£t
, 
__signo
)

226 
__THROW
 
	`__nÚnuÎ
 ((1));

228 #ifdeà
__USE_GNU


230 
	$sigi£m±y£t
 (cÚ¡ 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

233 
	$sigªd£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

234 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

237 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

238 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

243 
	~<b™s/sigaùiÚ.h
>

246 
	$sig´ocmask
 (
__how
, cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

247 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

254 
	$sigsu¥’d
 (cÚ¡ 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

257 
	$sigaùiÚ
 (
__sig
, cÚ¡ 
sigaùiÚ
 *
__»¡riù
 
__aù
,

258 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

261 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

268 
	$sigwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

269 
	`__nÚnuÎ
 ((1, 2));

271 #ifdeà
__USE_POSIX199309


276 
	$sigwa™šfo
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

277 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

284 
	$sigtimedwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

285 
sigšfo_t
 *
__»¡riù
 
__šfo
,

286 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
)

287 
	`__nÚnuÎ
 ((1));

291 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, cÚ¡ 
sigv®
 
__v®
)

292 
__THROW
;

297 #ifdeà
__USE_MISC


301 cÚ¡ *cÚ¡ 
_sys_sigli¡
[
_NSIG
];

302 cÚ¡ *cÚ¡ 
sys_sigli¡
[
_NSIG
];

306 
	~<b™s/sigcÚ‹xt.h
>

309 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

314 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


315 
	#__Ãed_size_t


	)

316 
	~<¡ddef.h
>

321 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

323 
	~<b™s/sig¡ack.h
>

324 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


326 
	~<sys/ucÚ‹xt.h
>

332 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

333 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

337 
	$sig®t¡ack
 (cÚ¡ 
sig®t¡ack
 *
__»¡riù
 
__ss
,

338 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

342 #ifdeà
__USE_XOPEN_EXTENDED


346 
	$sighŞd
 (
__sig
è
__THROW
;

349 
	$sig»l£
 (
__sig
è
__THROW
;

352 
	$sigignÜe
 (
__sig
è
__THROW
;

355 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

358 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


361 
	~<b™s/±h»adty³s.h
>

362 
	~<b™s/sigth»ad.h
>

369 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

371 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

375 
__END_DECLS


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/wch¬.h
>

27 
	~<b™s/wÜdsize.h
>

34 #iâdeà
__št8_t_defšed


35 
	#__št8_t_defšed


	)

36 sigÃd 
	tšt8_t
;

37 
	tšt16_t
;

38 
	tšt32_t
;

39 #ià
__WORDSIZE
 == 64

40 
	tšt64_t
;

42 
__ex‹nsiÚ__


43 
	tšt64_t
;

48 
	tušt8_t
;

49 
	tušt16_t
;

50 #iâdeà
__ušt32_t_defšed


51 
	tušt32_t
;

52 
	#__ušt32_t_defšed


	)

54 #ià
__WORDSIZE
 == 64

55 
	tušt64_t
;

57 
__ex‹nsiÚ__


58 
	tušt64_t
;

65 sigÃd 
	tšt_Ëa¡8_t
;

66 
	tšt_Ëa¡16_t
;

67 
	tšt_Ëa¡32_t
;

68 #ià
__WORDSIZE
 == 64

69 
	tšt_Ëa¡64_t
;

71 
__ex‹nsiÚ__


72 
	tšt_Ëa¡64_t
;

76 
	tušt_Ëa¡8_t
;

77 
	tušt_Ëa¡16_t
;

78 
	tušt_Ëa¡32_t
;

79 #ià
__WORDSIZE
 == 64

80 
	tušt_Ëa¡64_t
;

82 
__ex‹nsiÚ__


83 
	tušt_Ëa¡64_t
;

90 sigÃd 
	tšt_ç¡8_t
;

91 #ià
__WORDSIZE
 == 64

92 
	tšt_ç¡16_t
;

93 
	tšt_ç¡32_t
;

94 
	tšt_ç¡64_t
;

96 
	tšt_ç¡16_t
;

97 
	tšt_ç¡32_t
;

98 
__ex‹nsiÚ__


99 
	tšt_ç¡64_t
;

103 
	tušt_ç¡8_t
;

104 #ià
__WORDSIZE
 == 64

105 
	tušt_ç¡16_t
;

106 
	tušt_ç¡32_t
;

107 
	tušt_ç¡64_t
;

109 
	tušt_ç¡16_t
;

110 
	tušt_ç¡32_t
;

111 
__ex‹nsiÚ__


112 
	tušt_ç¡64_t
;

117 #ià
__WORDSIZE
 == 64

118 #iâdeà
__šŒ_t_defšed


119 
	tšŒ_t
;

120 
	#__šŒ_t_defšed


	)

122 
	tušŒ_t
;

124 #iâdeà
__šŒ_t_defšed


125 
	tšŒ_t
;

126 
	#__šŒ_t_defšed


	)

128 
	tušŒ_t
;

133 #ià
__WORDSIZE
 == 64

134 
	tštmax_t
;

135 
	tuštmax_t
;

137 
__ex‹nsiÚ__


138 
	tštmax_t
;

139 
__ex‹nsiÚ__


140 
	tuštmax_t
;

144 #ià
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
èø## 
L


	)

146 
	#__UINT64_C
(
c
èø## 
UL


	)

148 
	#__INT64_C
(
c
èø## 
LL


	)

149 
	#__UINT64_C
(
c
èø## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #ià
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #ià
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #ià
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #ià
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #ià
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #ià
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 #ifdeà
__WORDSIZE32_SIZE_ULONG


264 
	#SIZE_MAX
 (4294967295UL)

	)

266 
	#SIZE_MAX
 (4294967295U)

	)

271 #iâdeà
WCHAR_MIN


273 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

274 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

278 
	#WINT_MIN
 (0u)

	)

279 
	#WINT_MAX
 (4294967295u)

	)

282 
	#INT8_C
(
c
è
	)
c

283 
	#INT16_C
(
c
è
	)
c

284 
	#INT32_C
(
c
è
	)
c

285 #ià
__WORDSIZE
 == 64

286 
	#INT64_C
(
c
èø## 
L


	)

288 
	#INT64_C
(
c
èø## 
LL


	)

292 
	#UINT8_C
(
c
è
	)
c

293 
	#UINT16_C
(
c
è
	)
c

294 
	#UINT32_C
(
c
èø## 
U


	)

295 #ià
__WORDSIZE
 == 64

296 
	#UINT64_C
(
c
èø## 
UL


	)

298 
	#UINT64_C
(
c
èø## 
ULL


	)

302 #ià
__WORDSIZE
 == 64

303 
	#INTMAX_C
(
c
èø## 
L


	)

304 
	#UINTMAX_C
(
c
èø## 
UL


	)

306 
	#INTMAX_C
(
c
èø## 
LL


	)

307 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


25 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	#__Ãed_FILE


	)

37 
	#__Ãed___FILE


	)

41 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_POSIX
 \

51 || 
defšed
 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

52 || 
defšed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_defšed
 1

	)

58 #undeà
__Ãed_FILE


61 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_defšed
 1

	)

68 #undeà
__Ãed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


77 #ifdeà
__GNUC__


78 #iâdeà
_VA_LIST_DEFINED


79 
_G_va_li¡
 
	tva_li¡
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<¡d¬g.h
>

87 #ifdeà
__USE_XOPEN2K8


88 #iâdeà
__off_t_defšed


89 #iâdeà
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_defšed


	)

96 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_defšed


	)

101 #iâdeà
__ssize_t_defšed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_defšed


	)

108 
__BEGIN_NAMESPACE_STD


109 #iâdeà
__USE_FILE_OFFSET64


110 
_G_åos_t
 
	tåos_t
;

112 
_G_åos64_t
 
	tåos_t
;

114 
__END_NAMESPACE_STD


115 #ifdeà
__USE_LARGEFILE64


116 
_G_åos64_t
 
	tåos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #iâdeà
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #iâdeà
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifdeà
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


151 
	#P_tmpdœ
 "/tmp"

	)

164 
	~<b™s/¡dio_lim.h
>

168 
_IO_FILE
 *
¡dš
;

169 
_IO_FILE
 *
¡dout
;

170 
_IO_FILE
 *
¡d”r
;

172 
	#¡dš
 
¡dš


	)

173 
	#¡dout
 
¡dout


	)

174 
	#¡d”r
 
¡d”r


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

180 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifdeà
__USE_ATFILE


185 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

186 cÚ¡ *
__Ãw
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #iâdeà
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfe
 (è
__wur
;

197 #ifdeà
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

200 
	#tmpfe
 
tmpfe64


	)

204 #ifdeà
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfe64
 (è
__wur
;

209 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifdeà
__USE_MISC


215 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

219 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


227 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

228 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`fşo£
 (
FILE
 *
__¡»am
);

242 
	`fæush
 (
FILE
 *
__¡»am
);

243 
__END_NAMESPACE_STD


245 #ifdeà
__USE_MISC


252 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

255 #ifdeà
__USE_GNU


262 
	`fşo£®l
 ();

266 
__BEGIN_NAMESPACE_STD


267 #iâdeà
__USE_FILE_OFFSET64


272 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

273 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

278 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

279 cÚ¡ *
__»¡riù
 
__modes
,

280 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

282 #ifdeà
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

284 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

287 cÚ¡ *
__»¡riù
 
__modes
,

288 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

289 
__wur
;

291 
	#fİ’
 
fİ’64


	)

292 
	#äeİ’
 
äeİ’64


	)

295 
__END_NAMESPACE_STD


296 #ifdeà
__USE_LARGEFILE64


297 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

298 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

299 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

300 cÚ¡ *
__»¡riù
 
__modes
,

301 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

313 cÚ¡ *
__»¡riù
 
__modes
,

314 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

317 #ifdeà
__USE_XOPEN2K8


319 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

337 
__modes
, 
size_t
 
__n
è
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_MISC


343 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

344 
size_t
 
__size
è
__THROW
;

347 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

357 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

362 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

364 
	$¥rštf
 (*
__»¡riù
 
__s
,

365 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

371 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

372 
_G_va_li¡
 
__¬g
);

377 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

379 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

380 
_G_va_li¡
 
__¬g
è
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

387 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

388 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

390 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

391 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

392 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifdeà
__USE_GNU


399 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

400 
_G_va_li¡
 
__¬g
)

401 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

402 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

403 cÚ¡ *
__»¡riù
 
__fmt
, ...)

404 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

405 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

406 cÚ¡ *
__»¡riù
 
__fmt
, ...)

407 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

410 #ifdeà
__USE_XOPEN2K8


412 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

413 
_G_va_li¡
 
__¬g
)

414 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

415 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

416 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

426 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

431 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

433 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

434 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

436 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

444 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

445 
__isoc99_fsÿnf
è
__wur
;

446 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

447 
__isoc99_sÿnf
è
__wur
;

448 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

449 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

450 
__isoc99_ssÿnf
);

452 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

454 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

455 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

456 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

457 
	#fsÿnf
 
__isoc99_fsÿnf


	)

458 
	#sÿnf
 
__isoc99_sÿnf


	)

459 
	#ssÿnf
 
__isoc99_ssÿnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

472 
_G_va_li¡
 
__¬g
)

473 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

479 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

480 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

483 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

484 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

485 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

487 #ià!
defšed
 
__USE_GNU
 \

488 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

489 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

490 #ifdeà
__REDIRECT


494 
	`__REDIRECT
 (
vfsÿnf
,

495 (
FILE
 *
__»¡riù
 
__s
,

496 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

497 
__isoc99_vfsÿnf
)

498 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

499 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

500 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

501 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

502 
	`__REDIRECT_NTH
 (
vssÿnf
,

503 (cÚ¡ *
__»¡riù
 
__s
,

504 cÚ¡ *
__»¡riù
 
__fÜm©
,

505 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

506 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

508 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

509 cÚ¡ *
__»¡riù
 
__fÜm©
,

510 
_G_va_li¡
 
__¬g
è
__wur
;

511 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

512 
_G_va_li¡
 
__¬g
è
__wur
;

513 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

514 cÚ¡ *
__»¡riù
 
__fÜm©
,

515 
_G_va_li¡
 
__¬g
è
__THROW
;

516 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

517 
	#vsÿnf
 
__isoc99_vsÿnf


	)

518 
	#vssÿnf
 
__isoc99_vssÿnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fg‘c
 (
FILE
 *
__¡»am
);

532 
	`g‘c
 (
FILE
 *
__¡»am
);

538 
	`g‘ch¬
 ();

539 
__END_NAMESPACE_STD


543 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

545 #ifdeà
__USE_POSIX


550 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

551 
	`g‘ch¬_uÆocked
 ();

554 #ifdeà
__USE_MISC


561 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

565 
__BEGIN_NAMESPACE_STD


573 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

574 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

580 
	`putch¬
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

587 #ifdeà
__USE_MISC


594 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

597 #ifdeà
__USE_POSIX


602 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

603 
	`putch¬_uÆocked
 (
__c
);

607 #ià
defšed
 
__USE_MISC
 \

608 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

610 
	`g‘w
 (
FILE
 *
__¡»am
);

613 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

623 
__wur
;

625 #ià!
defšed
 
__USE_ISOC11
 \

626 || (
defšed
 
__ılu¥lus
 && __cplusplus <= 201103L)

638 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

640 
__END_NAMESPACE_STD


642 #ifdeà
__USE_GNU


649 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

650 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

666 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

667 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

668 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

669 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

670 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

678 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

679 
size_t
 *
__»¡riù
 
__n
,

680 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

695 
	`puts
 (cÚ¡ *
__s
);

702 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

709 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

715 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

716 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifdeà
__USE_GNU


726 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

727 
FILE
 *
__»¡riù
 
__¡»am
);

730 #ifdeà
__USE_MISC


737 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

739 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

740 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

754 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

759 
	`»wšd
 (
FILE
 *
__¡»am
);

760 
__END_NAMESPACE_STD


767 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


768 #iâdeà
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

778 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

780 #ifdeà
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#á–lo
 
á–lo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #iâdeà
__USE_FILE_OFFSET64


798 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

803 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

805 #ifdeà
__REDIRECT


806 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

807 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

808 
	`__REDIRECT
 (
f£os
,

809 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

811 
	#fg‘pos
 
fg‘pos64


	)

812 
	#f£os
 
f£os64


	)

815 
__END_NAMESPACE_STD


817 #ifdeà
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

819 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

820 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

821 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

828 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

830 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifdeà
__USE_MISC


835 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

836 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

837 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`³¼Ü
 (cÚ¡ *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<b™s/sys_”¾i¡.h
>

856 #ifdef 
__USE_POSIX


858 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

861 #ifdeà
__USE_MISC


863 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

867 #ifdeà
__USE_POSIX2


872 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

878 
	`pşo£
 (
FILE
 *
__¡»am
);

882 #ifdef 
__USE_POSIX


884 *
	$ù”mid
 (*
__s
è
__THROW
;

888 #ifdeà
__USE_XOPEN


890 *
	`cu£rid
 (*
__s
);

894 #ifdef 
__USE_GNU


895 
ob¡ack
;

898 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

899 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

900 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

901 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

902 cÚ¡ *
__»¡riù
 
__fÜm©
,

903 
_G_va_li¡
 
__¬gs
)

904 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

908 #ifdeà
__USE_POSIX


912 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

916 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

919 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

922 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


926 
	#__Ãed_g‘İt


	)

927 
	~<g‘İt.h
>

932 #ifdeà
__USE_EXTERN_INLINES


933 
	~<b™s/¡dio.h
>

935 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


936 
	~<b™s/¡dio2.h
>

938 #ifdeà
__LDBL_COMPAT


939 
	~<b™s/¡dio-ldbl.h
>

942 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

34 
	g__BEGIN_DECLS


36 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


37 
	#_STDLIB_H
 1

	)

39 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


41 
	~<b™s/wa™æags.h
>

42 
	~<b™s/wa™¡©us.h
>

44 #ifdeà
__USE_MISC


49 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


50 
	#__WAIT_INT
(
¡©us
) \

51 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

52 { .
__š
 = (
¡©us
è}).
__i
))

	)

54 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

62 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
wa™
 *
	m__u±r
;

70 *
	m__Œ
;

71 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

85 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

86 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

87 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

88 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

89 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

90 #ifdeà
__WIFCONTINUED


91 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquÙ
;

100 
	m»m
;

101 } 
	tdiv_t
;

104 #iâdeà
__ldiv_t_defšed


107 
	mquÙ
;

108 
	m»m
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_defšed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


115 
__BEGIN_NAMESPACE_C99


117 
__ex‹nsiÚ__
 struct

119 
	mquÙ
;

120 
	m»m
;

121 } 
	tÎdiv_t
;

122 
	#__Îdiv_t_defšed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

139 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (cÚ¡ *
__ÅŒ
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

147 
	$©oi
 (cÚ¡ *
__ÅŒ
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

150 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

152 
__END_NAMESPACE_STD


154 #ifdeà
__USE_ISOC99


155 
__BEGIN_NAMESPACE_C99


157 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

158 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

173 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

175 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

176 **
__»¡riù
 
__’d±r
)

177 
__THROW
 
	`__nÚnuÎ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

184 **
__»¡riù
 
__’d±r
, 
__ba£
)

185 
__THROW
 
	`__nÚnuÎ
 ((1));

187 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_MISC


194 
__ex‹nsiÚ__


195 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

196 **
__»¡riù
 
__’d±r
, 
__ba£
)

197 
__THROW
 
	`__nÚnuÎ
 ((1));

199 
__ex‹nsiÚ__


200 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

205 #ifdeà
__USE_ISOC99


206 
__BEGIN_NAMESPACE_C99


208 
__ex‹nsiÚ__


209 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

210 **
__»¡riù
 
__’d±r
, 
__ba£
)

211 
__THROW
 
	`__nÚnuÎ
 ((1));

213 
__ex‹nsiÚ__


214 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

215 **
__»¡riù
 
__’d±r
, 
__ba£
)

216 
__THROW
 
	`__nÚnuÎ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifdeà
__USE_GNU


235 
	~<xloÿË.h
>

239 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

240 **
__»¡riù
 
__’d±r
, 
__ba£
,

241 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

243 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

244 **
__»¡riù
 
__’d±r
,

245 
__ba£
, 
__loÿË_t
 
__loc
)

246 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

248 
__ex‹nsiÚ__


249 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

250 **
__»¡riù
 
__’d±r
, 
__ba£
,

251 
__loÿË_t
 
__loc
)

252 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

254 
__ex‹nsiÚ__


255 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

256 **
__»¡riù
 
__’d±r
,

257 
__ba£
, 
__loÿË_t
 
__loc
)

258 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

260 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

261 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

262 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

264 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

265 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

266 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

268 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

269 **
__»¡riù
 
__’d±r
,

270 
__loÿË_t
 
__loc
)

271 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

275 #ifdeà
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__ex‹º_šlše
 

278 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

280  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

281 
	}
}

282 
__ex‹º_šlše
 

283 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

285  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #ifdeà
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

292 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

294  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

308 
	$a64l
 (cÚ¡ *
__s
)

309 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

313 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


314 
	~<sys/ty³s.h
>

321 
	$¿ndom
 (è
__THROW
;

324 
	$¤ªdom
 (
__£ed
è
__THROW
;

330 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

331 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

335 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

338 #ifdeà
__USE_MISC


343 
	s¿ndom_d©a


345 
št32_t
 *
åŒ
;

346 
št32_t
 *
½Œ
;

347 
št32_t
 *
¡©e
;

348 
¿nd_ty³
;

349 
¿nd_deg
;

350 
¿nd_£p
;

351 
št32_t
 *
’d_±r
;

354 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

355 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

357 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

360 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

361 
size_t
 
__¡©–’
,

362 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

363 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

365 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

366 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

367 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$¿nd
 (è
__THROW
;

376 
	$¤ªd
 (
__£ed
è
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifdeà
__USE_POSIX


381 
	$¿nd_r
 (*
__£ed
è
__THROW
;

385 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


389 
	$d¿nd48
 (è
__THROW
;

390 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

393 
	$Ìªd48
 (è
__THROW
;

394 
	$Äªd48
 (
__xsubi
[3])

395 
__THROW
 
	`__nÚnuÎ
 ((1));

398 
	$m¿nd48
 (è
__THROW
;

399 
	$j¿nd48
 (
__xsubi
[3])

400 
__THROW
 
	`__nÚnuÎ
 ((1));

403 
	$¤ªd48
 (
__£edv®
è
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__nÚnuÎ
 ((1));

406 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

408 #ifdeà
__USE_MISC


412 
	sd¿nd48_d©a


414 
__x
[3];

415 
__Şd_x
[3];

416 
__c
;

417 
__š™
;

418 
__ex‹nsiÚ__
 
__a
;

423 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

424 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

425 
	$”ªd48_r
 (
__xsubi
[3],

426 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

427 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

431 *
__»¡riù
 
__»suÉ
)

432 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

433 
	$Äªd48_r
 (
__xsubi
[3],

434 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

435 *
__»¡riù
 
__»suÉ
)

436 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

439 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

442 
	$j¿nd48_r
 (
__xsubi
[3],

443 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

444 *
__»¡riù
 
__»suÉ
)

445 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

448 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$lcÚg48_r
 (
__·¿m
[7],

455 
d¿nd48_d©a
 *
__bufãr
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

462 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


463 
	#__m®loc_ªd_ÿÎoc_defšed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

468 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

469 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

483 
	$ä“
 (*
__±r
è
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$cä“
 (*
__±r
è
__THROW
;

491 #ifdeà
__USE_MISC


492 
	~<®loÿ.h
>

495 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

496 || 
defšed
 
__USE_MISC


498 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

501 #ifdeà
__USE_XOPEN2K


503 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

504 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

507 #ifdeà
__USE_ISOC11


509 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

510 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

519 
	$©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

521 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


523 #ifdeà
__ılu¥lus


524 "C++" 
	$©_quick_ex™
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

527 
	$©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	$Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

536 
__THROW
 
	`__nÚnuÎ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

545 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


549 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

551 
__END_NAMESPACE_STD


553 #ifdeà
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

565 
__END_NAMESPACE_STD


567 #ifdeà
__USE_GNU


570 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

571 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

574 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


578 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

581 #ifdeà
__USE_XOPEN2K


584 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

585 
__THROW
 
	`__nÚnuÎ
 ((2));

588 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$ş—»nv
 (è
__THROW
;

599 #ià
defšed
 
__USE_MISC
 \

600 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

606 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

609 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


618 #iâdeà
__USE_FILE_OFFSET64


619 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

621 #ifdeà
__REDIRECT


622 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

623 
	`__nÚnuÎ
 ((1)è
__wur
;

625 
	#mk¡emp
 
mk¡emp64


	)

628 #ifdeà
__USE_LARGEFILE64


629 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

633 #ifdeà
__USE_MISC


640 #iâdeà
__USE_FILE_OFFSET64


641 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

643 #ifdeà
__REDIRECT


644 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

645 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

647 
	#mk¡emps
 
mk¡emps64


	)

650 #ifdeà
__USE_LARGEFILE64


651 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

652 
	`__nÚnuÎ
 ((1)è
__wur
;

656 #ifdeà
__USE_XOPEN2K8


662 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

665 #ifdeà
__USE_GNU


672 #iâdeà
__USE_FILE_OFFSET64


673 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

675 #ifdeà
__REDIRECT


676 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

677 
	`__nÚnuÎ
 ((1)è
__wur
;

679 
	#mko¡emp
 
mko¡emp64


	)

682 #ifdeà
__USE_LARGEFILE64


683 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

692 #iâdeà
__USE_FILE_OFFSET64


693 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

694 
	`__nÚnuÎ
 ((1)è
__wur
;

696 #ifdeà
__REDIRECT


697 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

698 
__æags
), 
mko¡emps64
)

699 
	`__nÚnuÎ
 ((1)è
__wur
;

701 
	#mko¡emps
 
mko¡emps64


	)

704 #ifdeà
__USE_LARGEFILE64


705 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

706 
	`__nÚnuÎ
 ((1)è
__wur
;

711 
__BEGIN_NAMESPACE_STD


716 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

717 
__END_NAMESPACE_STD


720 #ifdef 
__USE_GNU


723 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

724 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

727 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


733 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

734 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

739 #iâdeà
__COMPAR_FN_T


740 
	#__COMPAR_FN_T


	)

741 (*
	t__com·r_â_t
) (const *, const *);

743 #ifdef 
__USE_GNU


744 
__com·r_â_t
 
	tcom·risÚ_â_t
;

747 #ifdeà
__USE_GNU


748 (*
	t__com·r_d_â_t
) (const *, const *, *);

751 
__BEGIN_NAMESPACE_STD


754 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

755 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

756 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

758 #ifdeà
__USE_EXTERN_INLINES


759 
	~<b™s/¡dlib-b£¬ch.h
>

764 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

765 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

766 #ifdeà
__USE_GNU


767 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

768 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

769 
	`__nÚnuÎ
 ((1, 4));

774 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

775 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

776 
__END_NAMESPACE_STD


778 #ifdeà
__USE_ISOC99


779 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

780 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

784 
__BEGIN_NAMESPACE_STD


788 
div_t
 
	$div
 (
__num”
, 
__d’om
)

789 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

790 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

791 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

792 
__END_NAMESPACE_STD


794 #ifdeà
__USE_ISOC99


795 
__BEGIN_NAMESPACE_C99


796 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

797 
__d’om
)

798 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

799 
__END_NAMESPACE_C99


803 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

804 || 
defšed
 
__USE_MISC


811 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

812 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

817 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

818 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

823 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

824 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

827 #ifdeà
__USE_MISC


829 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

830 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

831 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

832 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

833 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

834 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

835 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

836 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

841 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

842 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

843 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

844 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

845 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

846 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

848 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

849 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

850 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

851 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

852 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

853 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

854 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

855 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

859 
__BEGIN_NAMESPACE_STD


862 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

865 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

866 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

869 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

873 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

874 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

876 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

877 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

878 
__THROW
;

879 
__END_NAMESPACE_STD


882 #ifdeà
__USE_MISC


887 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

891 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


898 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

899 *cÚ¡ *
__»¡riù
 
__tok’s
,

900 **
__»¡riù
 
__v®u•
)

901 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

905 #ifdeà
__USE_XOPEN


907 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

913 #ifdeà
__USE_XOPEN2KXSI


915 
	$posix_İ’±
 (
__oæag
è
__wur
;

918 #ifdeà
__USE_XOPEN


923 
	$g¿Á±
 (
__fd
è
__THROW
;

927 
	$uÆock±
 (
__fd
è
__THROW
;

932 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

935 #ifdeà
__USE_GNU


939 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

940 
__THROW
 
	`__nÚnuÎ
 ((2));

943 
	`g‘±
 ();

946 #ifdeà
__USE_MISC


950 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

951 
__THROW
 
	`__nÚnuÎ
 ((1));

954 
	~<b™s/¡dlib-æßt.h
>

957 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


958 
	~<b™s/¡dlib.h
>

960 #ifdeà
__LDBL_COMPAT


961 
	~<b™s/¡dlib-ldbl.h
>

965 #undeà
__Ãed_m®loc_ªd_ÿÎoc


967 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


30 
	#__Ãed_size_t


	)

31 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

35 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

36 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

40 
__BEGIN_NAMESPACE_STD


42 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

43 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

46 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

47 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

48 
__END_NAMESPACE_STD


53 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


54 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

60 
__BEGIN_NAMESPACE_STD


62 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

65 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

66 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

69 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


72 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

74 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

77 #ifdeà
__OPTIMIZE__


78 
__ex‹º_®ways_šlše
 *

79 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


81  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

84 
__ex‹º_®ways_šlše
 const *

85 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


87  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

90 
	}
}

92 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

93 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

95 
__END_NAMESPACE_STD


97 #ifdeà
__USE_GNU


100 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


101 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

102 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

103 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

106 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

107 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

111 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


112 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

113 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

114 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

117 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

123 
__BEGIN_NAMESPACE_STD


125 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

126 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

128 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

129 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

133 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

134 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

136 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

137 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

140 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

141 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

143 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

144 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

147 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

150 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

151 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
 
	`__nÚnuÎ
 ((2));

153 
__END_NAMESPACE_STD


155 #ifdeà
__USE_XOPEN2K8


159 
	~<xloÿË.h
>

162 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

163 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

165 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

166 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

169 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


171 *
	$¡rdup
 (cÚ¡ *
__s
)

172 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

178 #ià
defšed
 
__USE_XOPEN2K8


179 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

180 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

183 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


185 
	#¡rdu·
(
s
) \

186 (
__ex‹nsiÚ__
 \

188 cÚ¡ *
__Şd
 = (
s
); \

189 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

190 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

191 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

192 
	}
}))

	)

195 
	#¡ºdu·
(
s
, 
n
) \

196 (
__ex‹nsiÚ__
 \

198 cÚ¡ *
__Şd
 = (
s
); \

199 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

200 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

201 
__Ãw
[
__Ën
] = '\0'; \

202 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

203 }))

	)

206 
	g__BEGIN_NAMESPACE_STD


208 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


211 *
¡rchr
 (*
__s
, 
__c
)

212 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

213 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

214 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

216 #ifdeà
__OPTIMIZE__


217 
__ex‹º_®ways_šlše
 *

218 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


220  
__butš_¡rchr
 (
__s
, 
__c
);

223 
__ex‹º_®ways_šlše
 const *

224 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


226  
__butš_¡rchr
 (
__s
, 
__c
);

231 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

232 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

235 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


238 *
	`¡¼chr
 (*
__s
, 
__c
)

239 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

240 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

241 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

243 #ifdeà
__OPTIMIZE__


244 
__ex‹º_®ways_šlše
 *

245 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


247  
	`__butš_¡¼chr
 (
__s
, 
__c
);

250 
__ex‹º_®ways_šlše
 const *

251 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


253  
	`__butš_¡¼chr
 (
__s
, 
__c
);

256 
	}
}

258 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

259 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

261 
__END_NAMESPACE_STD


263 #ifdeà
__USE_GNU


266 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


267 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

268 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

269 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

270 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

272 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

273 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

277 
__BEGIN_NAMESPACE_STD


280 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

281 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

284 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

285 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

287 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


290 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

291 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

292 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

293 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

295 #ifdeà
__OPTIMIZE__


296 
__ex‹º_®ways_šlše
 *

297 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


299  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

302 
__ex‹º_®ways_šlše
 const *

303 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


305  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

308 
	}
}

310 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

311 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

314 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


317 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

318 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

319 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

320 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

322 #ifdeà
__OPTIMIZE__


323 
__ex‹º_®ways_šlše
 *

324 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


326  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

329 
__ex‹º_®ways_šlše
 const *

330 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


332  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

335 
	}
}

337 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

338 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

343 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

344 
__THROW
 
	`__nÚnuÎ
 ((2));

345 
__END_NAMESPACE_STD


349 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

350 cÚ¡ *
__»¡riù
 
__d–im
,

351 **
__»¡riù
 
__§ve_±r
)

352 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

353 #ifdeà
__USE_POSIX


354 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

355 **
__»¡riù
 
__§ve_±r
)

356 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

359 #ifdeà
__USE_GNU


361 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


362 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

363 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

364 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

365 cÚ¡ *
__ÃedË
)

366 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

368 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

369 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 #ifdeà
__USE_GNU


377 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

378 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

379 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

383 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

384 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

385 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

386 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

387 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

388 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

392 
__BEGIN_NAMESPACE_STD


394 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

395 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

396 
__END_NAMESPACE_STD


398 #ifdef 
__USE_XOPEN2K8


401 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

402 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

406 
__BEGIN_NAMESPACE_STD


408 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

409 
__END_NAMESPACE_STD


410 #ifdeà
__USE_XOPEN2K


418 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


421 #ifdeà
__REDIRECT_NTH


422 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

423 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

424 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

426 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

427 
__THROW
 
	`__nÚnuÎ
 ((2));

428 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

433 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

434 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

438 #ifdeà
__USE_XOPEN2K8


440 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

446 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

448 #ifdeà
__USE_MISC


450 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

451 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

457 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

458 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

461 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


464 *
	`šdex
 (*
__s
, 
__c
)

465 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

466 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

467 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

469 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


470 
__ex‹º_®ways_šlše
 *

471 
	`šdex
 (*
__s
, 
__c
è
__THROW


473  
	`__butš_šdex
 (
__s
, 
__c
);

476 
__ex‹º_®ways_šlše
 const *

477 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


479  
	`__butš_šdex
 (
__s
, 
__c
);

482 
	}
}

484 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

485 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

489 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


492 *
	`ršdex
 (*
__s
, 
__c
)

493 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

495 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

497 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


498 
__ex‹º_®ways_šlše
 *

499 
	`ršdex
 (*
__s
, 
__c
è
__THROW


501  
	`__butš_ršdex
 (
__s
, 
__c
);

504 
__ex‹º_®ways_šlše
 const *

505 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


507  
	`__butš_ršdex
 (
__s
, 
__c
);

510 
	}
}

512 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

513 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

518 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

522 #ifdef 
__USE_GNU


523 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

524 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

525 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

530 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

533 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

534 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

537 #ifdef 
__USE_GNU


540 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

541 
__loÿË_t
 
__loc
)

542 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

544 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

545 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

546 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

549 #ifdef 
__USE_MISC


552 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

553 cÚ¡ *
__»¡riù
 
__d–im
)

554 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

557 #ifdef 
__USE_XOPEN2K8


559 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

562 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

563 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

564 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

565 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

570 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

571 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

572 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

573 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

574 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

577 #ifdef 
__USE_GNU


579 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

580 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

583 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

586 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

588 #iâdeà
ba£Çme


593 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


594 "C++" *
	$ba£Çme
 (*
__f’ame
)

595 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

596 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

597 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

599 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

605 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

606 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

607 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


627 
	~<b™s/¡ršg.h
>

630 
	~<b™s/¡ršg2.h
>

633 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


635 
	~<b™s/¡ršg3.h
>

639 #ià
defšed
 
__USE_GNU
 && defšed 
__OPTIMIZE__
 \

640 && 
defšed
 
__ex‹º_®ways_šlše
 && 
	$__GNUC_PREREQ
 (3,2)

641 #ià!
defšed
 
_FORCE_INLINES
 && !defšed 
_HAVE_STRING_ARCH_mempıy


643 #undeà
mempıy


644 #undeà
__mempıy


645 
	#mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy_šlše
 (de¡, src,‚)

	)

646 
	#__mempıy
(
de¡
, 
¤c
, 
n
è
	`__mempıy_šlše
 (de¡, src,‚)

	)

648 
__ex‹º_®ways_šlše
 *

649 
	$__mempıy_šlše
 (*
__»¡riù
 
__de¡
,

650 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

652  (*è
	`memıy
 (
__de¡
, 
__¤c
, 
__n
) + __n;

653 
	}
}

658 
	g__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


24 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

25 ! 
defšed
 
	g__Ãed_time¥ec
)

26 
	#_TIME_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__Ãed_size_t


	)

36 
	#__Ãed_NULL


	)

37 
	~<¡ddef.h
>

41 
	~<b™s/time.h
>

44 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


45 #iâdeà
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

53 
	#__şock_t_defšed
 1

	)

55 
	~<b™s/ty³s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__şock_t
 
	tşock_t
;

60 
	g__END_NAMESPACE_STD


61 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX


62 
	$__USING_NAMESPACE_STD
(
şock_t
)

66 #undeà
__Ãed_şock_t


68 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

69 
	#__time_t_defšed
 1

	)

71 
	~<b™s/ty³s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ifdeà
__USE_POSIX


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #undeà
__Ãed_time_t


84 #ià!
defšed
 
__şockid_t_defšed
 && \

85 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

86 
	#__şockid_t_defšed
 1

	)

88 
	~<b™s/ty³s.h
>

91 
__şockid_t
 
	tşockid_t
;

94 #undeà
__şockid_time_t


96 #ià!
defšed
 
__tim”_t_defšed
 && \

97 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

98 
	#__tim”_t_defšed
 1

	)

100 
	~<b™s/ty³s.h
>

103 
__tim”_t
 
	ttim”_t
;

106 #undeà
__Ãed_tim”_t


109 #ià(!
defšed
 
__time¥ec_defšed
 \

110 && ((
defšed
 
_TIME_H
 \

111 && (
defšed
 
__USE_POSIX199309
 \

112 || 
defšed
 
__USE_ISOC11
)) \

113 || 
defšed
 
__Ãed_time¥ec
))

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_MISC


146 
tm_gmtoff
;

147 cÚ¡ *
tm_zÚe
;

149 
__tm_gmtoff
;

150 cÚ¡ *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 #ifdeà
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
şock_t
 
	$şock
 (è
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

195 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

196 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

199 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

205 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

206 cÚ¡ *
__»¡riù
 
__fÜm©
,

207 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifdeà
__USE_XOPEN


213 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

214 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifdeà
__USE_XOPEN2K8


221 
	~<xloÿË.h
>

223 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

224 cÚ¡ *
__»¡riù
 
__fÜm©
,

225 cÚ¡ 
tm
 *
__»¡riù
 
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

229 #ifdeà
__USE_GNU


230 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

231 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

232 
__loÿË_t
 
__loc
è
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

243 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

244 
__END_NAMESPACE_STD


246 #ifdeà
__USE_POSIX


249 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

250 
tm
 *
__»¡riù
 
__
è
__THROW
;

254 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

255 
tm
 *
__»¡riù
 
__
è
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

264 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

265 
__END_NAMESPACE_STD


267 #ifdeà
__USE_POSIX


272 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

273 *
__»¡riù
 
__buf
è
__THROW
;

276 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

277 *
__»¡riù
 
__buf
è
__THROW
;

282 *
__tzÇme
[2];

283 
__daylight
;

284 
__timezÚe
;

287 #ifdef 
__USE_POSIX


289 *
tzÇme
[2];

293 
	$tz£t
 (è
__THROW
;

296 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


297 
daylight
;

298 
timezÚe
;

301 #ifdeà
__USE_MISC


304 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

310 
	#__i¦—p
(
y—r
) \

311 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

314 #ifdeà
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

322 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

325 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

329 #ifdeà
__USE_POSIX199309


334 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

335 
time¥ec
 *
__»maššg
);

339 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

342 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

345 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

346 
__THROW
;

348 #ifdeà
__USE_XOPEN2K


353 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

354 cÚ¡ 
time¥ec
 *
__»q
,

355 
time¥ec
 *
__»m
);

358 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

363 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

364 
sigev’t
 *
__»¡riù
 
__evp
,

365 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

368 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

371 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

372 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

373 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

376 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

377 
__THROW
;

380 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

384 #ifdeà
__USE_ISOC11


386 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__nÚnuÎ
 ((1));

391 #ifdeà
__USE_XOPEN_EXTENDED


403 
g‘d©e_”r
;

412 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

415 #ifdeà
__USE_GNU


426 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

427 
tm
 *
__»¡riù
 
__»sbuå
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifdeà
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #–ià
defšed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #–ià
defšed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

111 
	#_XOPEN_CRYPT
 1

	)

115 
	#_XOPEN_ENH_I18N
 1

	)

118 
	#_XOPEN_LEGACY
 1

	)

205 
	~<b™s/posix_İt.h
>

208 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


209 
	~<b™s/’vœÚm’ts.h
>

213 
	#STDIN_FILENO
 0

	)

214 
	#STDOUT_FILENO
 1

	)

215 
	#STDERR_FILENO
 2

	)

220 
	~<b™s/ty³s.h
>

222 #iâdef 
__ssize_t_defšed


223 
__ssize_t
 
	tssize_t
;

224 
	#__ssize_t_defšed


	)

227 
	#__Ãed_size_t


	)

228 
	#__Ãed_NULL


	)

229 
	~<¡ddef.h
>

231 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


234 #iâdeà
__gid_t_defšed


235 
__gid_t
 
	tgid_t
;

236 
	#__gid_t_defšed


	)

239 #iâdeà
__uid_t_defšed


240 
__uid_t
 
	tuid_t
;

241 
	#__uid_t_defšed


	)

244 #iâdeà
__off_t_defšed


245 #iâdeà
__USE_FILE_OFFSET64


246 
__off_t
 
	toff_t
;

248 
__off64_t
 
	toff_t
;

250 
	#__off_t_defšed


	)

252 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


253 
__off64_t
 
	toff64_t
;

254 
	#__off64_t_defšed


	)

257 #iâdeà
__u£cÚds_t_defšed


258 
__u£cÚds_t
 
	tu£cÚds_t
;

259 
	#__u£cÚds_t_defšed


	)

262 #iâdeà
__pid_t_defšed


263 
__pid_t
 
	tpid_t
;

264 
	#__pid_t_defšed


	)

268 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


269 #iâdeà
__šŒ_t_defšed


270 
__šŒ_t
 
	tšŒ_t
;

271 
	#__šŒ_t_defšed


	)

275 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


276 #iâdeà
__sockËn_t_defšed


277 
__sockËn_t
 
	tsockËn_t
;

278 
	#__sockËn_t_defšed


	)

284 
	#R_OK
 4

	)

285 
	#W_OK
 2

	)

286 
	#X_OK
 1

	)

287 
	#F_OK
 0

	)

290 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

292 #ifdeà
__USE_GNU


295 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

296 
__THROW
 
	`__nÚnuÎ
 ((1));

299 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

300 
__THROW
 
	`__nÚnuÎ
 ((1));

303 #ifdeà
__USE_ATFILE


307 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

308 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

313 #iâdef 
_STDIO_H


314 
	#SEEK_SET
 0

	)

315 
	#SEEK_CUR
 1

	)

316 
	#SEEK_END
 2

	)

317 #ifdeà
__USE_GNU


318 
	#SEEK_DATA
 3

	)

319 
	#SEEK_HOLE
 4

	)

323 #ià
defšed
 
__USE_MISC
 && !defšed 
L_SET


325 
	#L_SET
 
SEEK_SET


	)

326 
	#L_INCR
 
SEEK_CUR


	)

327 
	#L_XTND
 
SEEK_END


	)

336 #iâdeà
__USE_FILE_OFFSET64


337 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

339 #ifdeà
__REDIRECT_NTH


340 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

341 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

342 
l£ek64
);

344 
	#l£ek
 
l£ek64


	)

347 #ifdeà
__USE_LARGEFILE64


348 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

349 
__THROW
;

356 
	`şo£
 (
__fd
);

363 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

369 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

371 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


372 #iâdeà
__USE_FILE_OFFSET64


379 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

380 
__off_t
 
__off£t
è
__wur
;

387 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

388 
__off_t
 
__off£t
è
__wur
;

390 #ifdeà
__REDIRECT


391 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

392 
__off64_t
 
__off£t
),

393 
´—d64
è
__wur
;

394 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

395 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

396 
pwr™e64
è
__wur
;

398 
	#´—d
 
´—d64


	)

399 
	#pwr™e
 
pwr™e64


	)

403 #ifdeà
__USE_LARGEFILE64


407 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

408 
__off64_t
 
__off£t
è
__wur
;

411 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

412 
__off64_t
 
__off£t
è
__wur
;

420 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

422 #ifdeà
__USE_GNU


425 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

435 
	$®¬m
 (
__£cÚds
è
__THROW
;

447 
	`¦“p
 (
__£cÚds
);

449 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

450 || 
defšed
 
__USE_MISC


455 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

456 
__THROW
;

463 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

472 
	`·u£
 ();

476 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

477 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

479 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


481 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

486 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

487 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

491 #ifdeà
__USE_ATFILE


494 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

495 
__gid_t
 
__group
, 
__æag
)

496 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

500 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

502 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


504 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

514 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

516 #ifdef 
__USE_GNU


520 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

523 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

524 || 
defšed
 
__USE_MISC


528 *
	$g‘wd
 (*
__buf
)

529 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

534 
	$dup
 (
__fd
è
__THROW
 
__wur
;

537 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

539 #ifdeà
__USE_GNU


542 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

546 **
__’vœÚ
;

547 #ifdeà
__USE_GNU


548 **
’vœÚ
;

554 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

555 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

557 #ifdeà
__USE_XOPEN2K8


560 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

561 
__THROW
 
	`__nÚnuÎ
 ((2));

566 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

567 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

571 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

572 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

576 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

577 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

581 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

582 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

588 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

590 #ifdeà
__USE_GNU


593 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

594 *cÚ¡ 
__’vp
[])

595 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

599 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


601 
	$niû
 (
__šc
è
__THROW
 
__wur
;

606 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

612 
	~<b™s/cÚâame.h
>

615 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

616 
__THROW
 
	`__nÚnuÎ
 ((1));

619 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

622 
	$syscÚf
 (
__Çme
è
__THROW
;

624 #ifdef 
__USE_POSIX2


626 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

631 
__pid_t
 
	$g‘pid
 (è
__THROW
;

634 
__pid_t
 
	$g‘µid
 (è
__THROW
;

637 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

640 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

641 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


642 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

649 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

651 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


663 
	$£g½
 (è
__THROW
;

670 
__pid_t
 
	$£tsid
 (è
__THROW
;

672 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


674 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

678 
__uid_t
 
	$g‘uid
 (è
__THROW
;

681 
__uid_t
 
	$g‘euid
 (è
__THROW
;

684 
__gid_t
 
	$g‘gid
 (è
__THROW
;

687 
__gid_t
 
	$g‘egid
 (è
__THROW
;

692 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

694 #ifdef 
__USE_GNU


696 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

703 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

705 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


708 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

711 #ifdeà
__USE_XOPEN2K


713 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

720 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

722 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


725 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

728 #ifdeà
__USE_XOPEN2K


730 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

733 #ifdeà
__USE_GNU


736 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

737 
__THROW
;

741 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

742 
__THROW
;

746 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

747 
__THROW
 
__wur
;

751 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

752 
__THROW
 
__wur
;

759 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

761 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

762 || 
defšed
 
__USE_MISC


767 
__pid_t
 
	$vfÜk
 (è
__THROW
;

773 *
	$‰yÇme
 (
__fd
è
__THROW
;

777 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

778 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

782 
	$i§‰y
 (
__fd
è
__THROW
;

784 #ià
defšed
 
__USE_MISC
 \

785 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

788 
	$‰y¦Ù
 (è
__THROW
;

793 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

794 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

796 #ifdeà
__USE_ATFILE


799 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

800 cÚ¡ *
__to
, 
__æags
)

801 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

804 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


806 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

807 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

812 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

813 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

814 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

817 #ifdeà
__USE_ATFILE


819 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

820 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

823 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

824 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

825 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

829 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

831 #ifdeà
__USE_ATFILE


833 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

834 
__THROW
 
	`__nÚnuÎ
 ((2));

838 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

842 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

845 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

852 *
	`g‘logš
 ();

853 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


860 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

863 #ifdef 
__USE_MISC


865 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

869 #ifdef 
__USE_POSIX2


873 
	#__Ãed_g‘İt


	)

874 
	~<g‘İt.h
>

878 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


882 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

886 #ià
defšed
 
__USE_MISC


889 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

890 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

894 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

900 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

901 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

902 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

903 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

909 
	$vhªgup
 (è
__THROW
;

912 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

920 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

921 
size_t
 
__off£t
, 
__sÿË
)

922 
__THROW
 
	`__nÚnuÎ
 ((1));

928 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

932 *
	$g‘u£rsh–l
 (è
__THROW
;

933 
	$’du£rsh–l
 (è
__THROW
;

934 
	$£tu£rsh–l
 (è
__THROW
;

940 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

944 #ià
defšed
 
__USE_MISC
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

947 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

951 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

959 
	`fsync
 (
__fd
);

962 #ifdeà
__USE_GNU


965 
	$syncfs
 (
__fd
è
__THROW
;

969 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


972 
	`g‘ho¡id
 ();

975 
	$sync
 (è
__THROW
;

978 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K


981 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

986 
	$g‘dbËsize
 (è
__THROW
;

992 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


995 #iâdeà
__USE_FILE_OFFSET64


996 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

997 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

999 #ifdeà
__REDIRECT_NTH


1000 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

1001 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

1002 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1004 
	#Œunÿ‹
 
Œunÿ‹64


	)

1007 #ifdeà
__USE_LARGEFILE64


1008 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1009 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1014 #ià
defšed
 
__USE_POSIX199309
 \

1015 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1018 #iâdeà
__USE_FILE_OFFSET64


1019 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1021 #ifdeà
__REDIRECT_NTH


1022 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1023 
árunÿ‹64
è
__wur
;

1025 
	#árunÿ‹
 
árunÿ‹64


	)

1028 #ifdeà
__USE_LARGEFILE64


1029 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1035 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1036 || 
defšed
 
__USE_MISC


1040 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1046 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1050 #ifdeà
__USE_MISC


1061 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1066 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1078 
	#F_ULOCK
 0

	)

1079 
	#F_LOCK
 1

	)

1080 
	#F_TLOCK
 2

	)

1081 
	#F_TEST
 3

	)

1083 #iâdeà
__USE_FILE_OFFSET64


1084 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1086 #ifdeà
__REDIRECT


1087 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1088 
lockf64
è
__wur
;

1090 
	#lockf
 
lockf64


	)

1093 #ifdeà
__USE_LARGEFILE64


1094 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1099 #ifdeà
__USE_GNU


1104 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1105 (
__ex‹nsiÚ__
 \

1106 ({ 
__»suÉ
; \

1107 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1108 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1109 
__»suÉ
; 
	}
}))

	)

1112 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1115 
fd©async
 (
__fdes
);

1121 #ifdef 
__USE_XOPEN


1123 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1124 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1128 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1129 
__THROW
 
	`__nÚnuÎ
 ((1));

1136 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1137 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1143 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1145 *
	$ù”mid
 (*
__s
è
__THROW
;

1150 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1151 
	~<b™s/uni¡d.h
>

1154 
__END_DECLS


	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_MISC


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_MISC
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

62 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


63 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

64 
	#htŞe16
(
x
è(x)

	)

65 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

66 
	#Ë16toh
(
x
è(x)

	)

68 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

69 
	#htŞe32
(
x
è(x)

	)

70 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

71 
	#Ë32toh
(
x
è(x)

	)

73 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

74 
	#htŞe64
(
x
è(x)

	)

75 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

76 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

97 #undeà
__USE_ISOC11


98 #undeà
__USE_ISOC99


99 #undeà
__USE_ISOC95


100 #undeà
__USE_ISOCXX11


101 #undeà
__USE_POSIX


102 #undeà
__USE_POSIX2


103 #undeà
__USE_POSIX199309


104 #undeà
__USE_POSIX199506


105 #undeà
__USE_XOPEN


106 #undeà
__USE_XOPEN_EXTENDED


107 #undeà
__USE_UNIX98


108 #undeà
__USE_XOPEN2K


109 #undeà
__USE_XOPEN2KXSI


110 #undeà
__USE_XOPEN2K8


111 #undeà
__USE_XOPEN2K8XSI


112 #undeà
__USE_LARGEFILE


113 #undeà
__USE_LARGEFILE64


114 #undeà
__USE_FILE_OFFSET64


115 #undeà
__USE_MISC


116 #undeà
__USE_ATFILE


117 #undeà
__USE_GNU


118 #undeà
__USE_REENTRANT


119 #undeà
__USE_FORTIFY_LEVEL


120 #undeà
__KERNEL_STRICT_NAMES


124 #iâdeà
_LOOSE_KERNEL_NAMES


125 
	#__KERNEL_STRICT_NAMES


	)

135 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

137 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

146 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

147 && !
defšed
 
	g_DEFAULT_SOURCE


152 #undeà
_DEFAULT_SOURCE


153 
	#_DEFAULT_SOURCE
 1

	)

157 #ifdeà
_GNU_SOURCE


158 #undeà
_ISOC95_SOURCE


159 
	#_ISOC95_SOURCE
 1

	)

160 #undeà
_ISOC99_SOURCE


161 
	#_ISOC99_SOURCE
 1

	)

162 #undeà
_ISOC11_SOURCE


163 
	#_ISOC11_SOURCE
 1

	)

164 #undeà
_POSIX_SOURCE


165 
	#_POSIX_SOURCE
 1

	)

166 #undeà
_POSIX_C_SOURCE


167 
	#_POSIX_C_SOURCE
 200809L

	)

168 #undeà
_XOPEN_SOURCE


169 
	#_XOPEN_SOURCE
 700

	)

170 #undeà
_XOPEN_SOURCE_EXTENDED


171 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

172 #undeà
_LARGEFILE64_SOURCE


173 
	#_LARGEFILE64_SOURCE
 1

	)

174 #undeà
_DEFAULT_SOURCE


175 
	#_DEFAULT_SOURCE
 1

	)

176 #undeà
_ATFILE_SOURCE


177 
	#_ATFILE_SOURCE
 1

	)

182 #ià(
defšed
 
_DEFAULT_SOURCE
 \

183 || (!
defšed
 
	g__STRICT_ANSI__
 \

184 && !
defšed
 
	g_ISOC99_SOURCE
 \

185 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

186 && !
defšed
 
	g_XOPEN_SOURCE
))

187 #undeà
_DEFAULT_SOURCE


188 
	#_DEFAULT_SOURCE
 1

	)

192 #ià(
defšed
 
_ISOC11_SOURCE
 \

193 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

194 
	#__USE_ISOC11
 1

	)

198 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

199 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

200 
	#__USE_ISOC99
 1

	)

204 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

205 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

206 
	#__USE_ISOC95
 1

	)

213 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

214 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

215 
	#__USE_ISOCXX11
 1

	)

221 #ifdeà
_DEFAULT_SOURCE


222 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


223 
	#__USE_POSIX_IMPLICITLY
 1

	)

225 #undeà
_POSIX_SOURCE


226 
	#_POSIX_SOURCE
 1

	)

227 #undeà
_POSIX_C_SOURCE


228 
	#_POSIX_C_SOURCE
 200809L

	)

230 #ià((!
defšed
 
__STRICT_ANSI__
 \

231 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

232 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

233 
	#_POSIX_SOURCE
 1

	)

234 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

235 
	#_POSIX_C_SOURCE
 2

	)

236 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

237 
	#_POSIX_C_SOURCE
 199506L

	)

238 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

239 
	#_POSIX_C_SOURCE
 200112L

	)

241 
	#_POSIX_C_SOURCE
 200809L

	)

243 
	#__USE_POSIX_IMPLICITLY
 1

	)

246 #ià(
defšed
 
_POSIX_SOURCE
 \

247 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

248 || 
defšed
 
_XOPEN_SOURCE
)

249 
	#__USE_POSIX
 1

	)

252 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


253 
	#__USE_POSIX2
 1

	)

256 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

257 
	#__USE_POSIX199309
 1

	)

260 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

261 
	#__USE_POSIX199506
 1

	)

264 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

265 
	#__USE_XOPEN2K
 1

	)

266 #undeà
__USE_ISOC95


267 
	#__USE_ISOC95
 1

	)

268 #undeà
__USE_ISOC99


269 
	#__USE_ISOC99
 1

	)

272 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

273 
	#__USE_XOPEN2K8
 1

	)

274 #undeà
_ATFILE_SOURCE


275 
	#_ATFILE_SOURCE
 1

	)

278 #ifdef 
_XOPEN_SOURCE


279 
	#__USE_XOPEN
 1

	)

280 #ià(
_XOPEN_SOURCE
 - 0) >= 500

281 
	#__USE_XOPEN_EXTENDED
 1

	)

282 
	#__USE_UNIX98
 1

	)

283 #undeà
_LARGEFILE_SOURCE


284 
	#_LARGEFILE_SOURCE
 1

	)

285 #ià(
_XOPEN_SOURCE
 - 0) >= 600

286 #ià(
_XOPEN_SOURCE
 - 0) >= 700

287 
	#__USE_XOPEN2K8
 1

	)

288 
	#__USE_XOPEN2K8XSI
 1

	)

290 
	#__USE_XOPEN2K
 1

	)

291 
	#__USE_XOPEN2KXSI
 1

	)

292 #undeà
__USE_ISOC95


293 
	#__USE_ISOC95
 1

	)

294 #undeà
__USE_ISOC99


295 
	#__USE_ISOC99
 1

	)

298 #ifdeà
_XOPEN_SOURCE_EXTENDED


299 
	#__USE_XOPEN_EXTENDED
 1

	)

304 #ifdeà
_LARGEFILE_SOURCE


305 
	#__USE_LARGEFILE
 1

	)

308 #ifdeà
_LARGEFILE64_SOURCE


309 
	#__USE_LARGEFILE64
 1

	)

312 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

313 
	#__USE_FILE_OFFSET64
 1

	)

316 #ià
defšed
 
_DEFAULT_SOURCE


317 
	#__USE_MISC
 1

	)

320 #ifdef 
_ATFILE_SOURCE


321 
	#__USE_ATFILE
 1

	)

324 #ifdef 
_GNU_SOURCE


325 
	#__USE_GNU
 1

	)

328 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


329 
	#__USE_REENTRANT
 1

	)

332 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

333 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

334 #ià
_FORTIFY_SOURCE
 > 1

335 
	#__USE_FORTIFY_LEVEL
 2

	)

337 
	#__USE_FORTIFY_LEVEL
 1

	)

340 
	#__USE_FORTIFY_LEVEL
 0

	)

345 
	~<¡dc-´edef.h
>

353 #undeà
__GNU_LIBRARY__


354 
	#__GNU_LIBRARY__
 6

	)

358 
	#__GLIBC__
 2

	)

359 
	#__GLIBC_MINOR__
 23

	)

361 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

362 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

365 #iâdeà
__ASSEMBLER__


366 #iâdeà
_SYS_CDEFS_H


367 
	~<sys/cdefs.h
>

372 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


373 
	#__USE_LARGEFILE
 1

	)

374 
	#__USE_LARGEFILE64
 1

	)

380 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

381 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

382 && 
defšed
 
	g__ex‹º_šlše


383 
	#__USE_EXTERN_INLINES
 1

	)

391 
	~<gnu/¡ubs.h
>

	@/usr/include/getopt.h

19 #iâdeà
_GETOPT_H


21 #iâdeà
__Ãed_g‘İt


22 
	#_GETOPT_H
 1

	)

32 #ià!
defšed
 
__GNU_LIBRARY__


33 
	~<ùy³.h
>

36 #iâdeà
__THROW


37 #iâdeà
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

40 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__ılu¥lus


57 *
İrg
;

71 
İtšd
;

76 
İ‹¼
;

80 
İtİt
;

82 #iâdeà
__Ãed_g‘İt


104 
	sİtiÚ


106 cÚ¡ *
	gÇme
;

109 
	ghas_¬g
;

110 *
	gæag
;

111 
	gv®
;

116 
	#no_¬gum’t
 0

	)

117 
	#»quœed_¬gum’t
 1

	)

118 
	#İtiÚ®_¬gum’t
 2

	)

146 #ifdeà
__GNU_LIBRARY__


150 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

151 
__THROW
;

153 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

154 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


158 #ifdeà
__REDIRECT


159 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

160 cÚ¡ *
__shÜtİts
),

161 
__posix_g‘İt
);

163 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

164 cÚ¡ *
__shÜtİts
è
__THROW
;

165 
	#g‘İt
 
__posix_g‘İt


	)

169 
g‘İt
 ();

172 #iâdeà
__Ãed_g‘İt


173 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

174 cÚ¡ *
__shÜtİts
,

175 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

176 
__THROW
;

177 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

178 cÚ¡ *
__shÜtİts
,

179 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

180 
__THROW
;

184 #ifdef 
__ılu¥lus


189 #undeà
__Ãed_g‘İt


	@/usr/include/libio.h

28 #iâdeà
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_cÚfig.h
>

33 
	#_IO_åos_t
 
_G_åos_t


	)

34 
	#_IO_åos64_t
 
_G_åos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li¡
 
_G_va_li¡


	)

45 
	#_IO_wšt_t
 
wšt_t


	)

48 
	#__Ãed___va_li¡


	)

49 
	~<¡d¬g.h
>

50 #ifdeà
__GNUC_VA_LIST


51 #undeà
_IO_va_li¡


52 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

55 #iâdeà
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #iâdeà
EOF


62 
	#EOF
 (-1)

	)

64 #iâdeà
NULL


65 #ià
defšed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuÎ
)

	)

69 #ià!
defšed
(
__ılu¥lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifdeà
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifdeà
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifdeà
_IO_MTSAFE_IO


150 
	t_IO_lock_t
;

156 
	s_IO_m¬k”
 {

157 
_IO_m¬k”
 *
	m_Ãxt
;

158 
_IO_FILE
 *
	m_sbuf
;

162 
	m_pos
;

164 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

165 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

166 
	mpublic
:

167 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

168 ~
¡»amm¬k”
();

169 
§všg
(è{  
	m_¥os
 == -2; }

170 
d–
(
¡»amm¬k”
&);

171 
d–
();

176 
	e__codecvt_»suÉ


178 
	m__codecvt_ok
,

179 
	m__codecvt_·¹Ÿl
,

180 
	m__codecvt_”rÜ
,

181 
	m__codecvt_nocÚv


184 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


187 
	s_IO_codecvt


189 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

190 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

191 
	m__mb¡©e_t
 *,

192 cÚ¡ 
	mwch¬_t
 *,

193 cÚ¡ 
	mwch¬_t
 *,

194 cÚ¡ 
	mwch¬_t
 **, *,

196 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

197 
	m__mb¡©e_t
 *, *,

199 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

200 
	m__mb¡©e_t
 *,

202 cÚ¡ **, 
	mwch¬_t
 *,

203 
	mwch¬_t
 *, wchar_t **);

204 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

205 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

206 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

207 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

208 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

210 
_IO_icÚv_t
 
	m__cd_š
;

211 
_IO_icÚv_t
 
	m__cd_out
;

215 
	s_IO_wide_d©a


217 
wch¬_t
 *
	m_IO_»ad_±r
;

218 
wch¬_t
 *
	m_IO_»ad_’d
;

219 
wch¬_t
 *
	m_IO_»ad_ba£
;

220 
wch¬_t
 *
	m_IO_wr™e_ba£
;

221 
wch¬_t
 *
	m_IO_wr™e_±r
;

222 
wch¬_t
 *
	m_IO_wr™e_’d
;

223 
wch¬_t
 *
	m_IO_buf_ba£
;

224 
wch¬_t
 *
	m_IO_buf_’d
;

226 
wch¬_t
 *
	m_IO_§ve_ba£
;

227 
wch¬_t
 *
	m_IO_backup_ba£
;

229 
wch¬_t
 *
	m_IO_§ve_’d
;

231 
__mb¡©e_t
 
	m_IO_¡©e
;

232 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

233 
_IO_codecvt
 
	m_codecvt
;

235 
wch¬_t
 
	m_shÜtbuf
[1];

237 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

241 
	s_IO_FILE
 {

242 
	m_æags
;

243 
	#_IO_fe_æags
 
_æags


	)

247 * 
	m_IO_»ad_±r
;

248 * 
	m_IO_»ad_’d
;

249 * 
	m_IO_»ad_ba£
;

250 * 
	m_IO_wr™e_ba£
;

251 * 
	m_IO_wr™e_±r
;

252 * 
	m_IO_wr™e_’d
;

253 * 
	m_IO_buf_ba£
;

254 * 
	m_IO_buf_’d
;

256 *
	m_IO_§ve_ba£
;

257 *
	m_IO_backup_ba£
;

258 *
	m_IO_§ve_’d
;

260 
_IO_m¬k”
 *
	m_m¬k”s
;

262 
_IO_FILE
 *
	m_chaš
;

264 
	m_f’o
;

266 
	m_blksize
;

268 
	m_æags2
;

270 
_IO_off_t
 
	m_Şd_off£t
;

272 
	#__HAVE_COLUMN


	)

274 
	m_cur_cŞumn
;

275 sigÃd 
	m_vbË_off£t
;

276 
	m_shÜtbuf
[1];

280 
_IO_lock_t
 *
	m_lock
;

281 #ifdeà
_IO_USE_OLD_IO_FILE


284 
	s_IO_FILE_com¶‘e


286 
_IO_FILE
 
	m_fe
;

288 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

289 
_IO_off64_t
 
	m_off£t
;

290 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


292 
_IO_codecvt
 *
	m_codecvt
;

293 
_IO_wide_d©a
 *
	m_wide_d©a
;

294 
_IO_FILE
 *
	m_ä“»s_li¡
;

295 *
	m_ä“»s_buf
;

297 *
	m__·d1
;

298 *
	m__·d2
;

299 *
	m__·d3
;

300 *
	m__·d4
;

302 
size_t
 
	m__·d5
;

303 
	m_mode
;

305 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

309 #iâdeà
__ılu¥lus


310 
_IO_FILE
 
	t_IO_FILE
;

313 
	g_IO_FILE_¶us
;

315 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

316 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

317 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

318 #iâdeà
_LIBC


319 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

320 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

321 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

323 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

324 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

325 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

333 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

341 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, cÚ¡ *
	t__buf
,

342 
	tsize_t
 
	t__n
);

350 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

353 
	t__io_şo£_â
 (*
	t__cook›
);

356 #ifdeà
_GNU_SOURCE


358 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

359 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

360 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

361 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

366 
__io_»ad_â
 *
	m»ad
;

367 
__io_wr™e_â
 *
	mwr™e
;

368 
__io_£ek_â
 *
	m£ek
;

369 
__io_şo£_â
 *
	mşo£
;

370 } 
	t_IO_cook›_io_funùiÚs_t
;

371 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

373 
	g_IO_cook›_fe
;

376 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

377 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

381 #ifdeà
__ılu¥lus


385 
__und”æow
 (
_IO_FILE
 *);

386 
__uæow
 (
_IO_FILE
 *);

387 
__ov”æow
 (
_IO_FILE
 *, );

388 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


389 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

390 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

391 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

394 #ià 
__GNUC__
 >= 3

395 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

397 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

400 
	#_IO_g‘c_uÆocked
(
_å
) \

401 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

402 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

403 
	#_IO_³ekc_uÆocked
(
_å
) \

404 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

405 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

406 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

407 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

408 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

409 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

410 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

412 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


413 
	#_IO_g‘wc_uÆocked
(
_å
) \

414 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

415 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

416 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

417 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

418 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

419 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

420 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

421 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

422 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

423 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

426 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

427 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

429 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

430 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

431 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

432 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

434 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

437 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

438 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

440 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

441 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

442 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

444 #ifdeà
_IO_MTSAFE_IO


445 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

446 
	#_IO_æockfe
(
_å
) \

447 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

448 
	#_IO_fuÆockfe
(
_å
) \

449 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

451 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

452 
	#_IO_æockfe
(
_å
è

	)

453 
	#_IO_fuÆockfe
(
_å
è

	)

454 
	#_IO_árylockfe
(
_å
è

	)

455 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

456 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

459 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

460 
_IO_va_li¡
, *
__»¡riù
);

461 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

462 
_IO_va_li¡
);

463 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

464 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

466 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

467 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

469 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

471 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


472 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

473 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

474 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

475 #ià
__GNUC__
 >= 2

478 #ià
defšed
 
_LIBC
 && defšed 
SHARED


479 
	~<shlib-com·t.h
>

480 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

481 
	#_IO_fwide_maybe_šcom·tibË
 \

482 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

483 cÚ¡ 
_IO_¡dš_u£d
;

484 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

487 #iâdeà
_IO_fwide_maybe_šcom·tibË


488 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

492 
	#_IO_fwide
(
__å
, 
__mode
) \

493 ({ 
__»suÉ
 = (
__mode
); \

494 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

496 ià((
__å
)->
_mode
 == 0) \

498 (
__å
)->
_mode
 = -1; \

499 
__»suÉ
 = (
__å
)->
_mode
; \

501 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

502 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

504 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

505 
__»suÉ
; })

	)

508 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

509 
_IO_va_li¡
, *
__»¡riù
);

510 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

511 
_IO_va_li¡
);

512 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

513 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

516 #ifdeà
__LDBL_COMPAT


517 
	~<b™s/libio-ldbl.h
>

520 #ifdeà
__ılu¥lus


	@/usr/include/linux/filter.h

5 #iâdeà
__LINUX_FILTER_H__


6 
	#__LINUX_FILTER_H__


	)

9 
	~<lšux/ty³s.h
>

10 
	~<lšux/bpf_commÚ.h
>

15 
	#BPF_MAJOR_VERSION
 1

	)

16 
	#BPF_MINOR_VERSION
 1

	)

23 
	ssock_f‹r
 {

24 
__u16
 
	mcode
;

25 
__u8
 
	mjt
;

26 
__u8
 
	mjf
;

27 
__u32
 
	mk
;

30 
	ssock_årog
 {

31 
	mËn
;

32 
sock_f‹r
 *
	mf‹r
;

36 
	#BPF_RVAL
(
code
è((codeè& 0x18)

	)

37 
	#BPF_A
 0x10

	)

40 
	#BPF_MISCOP
(
code
è((codeè& 0xf8)

	)

41 
	#BPF_TAX
 0x00

	)

42 
	#BPF_TXA
 0x80

	)

47 #iâdeà
BPF_STMT


48 
	#BPF_STMT
(
code
, 
k
è{ ()(code), 0, 0, k }

	)

50 #iâdeà
BPF_JUMP


51 
	#BPF_JUMP
(
code
, 
k
, 
jt
, 
jf
è{ ()(code), jt, jf, k }

	)

57 
	#BPF_MEMWORDS
 16

	)

64 
	#SKF_AD_OFF
 (-0x1000)

	)

65 
	#SKF_AD_PROTOCOL
 0

	)

66 
	#SKF_AD_PKTTYPE
 4

	)

67 
	#SKF_AD_IFINDEX
 8

	)

68 
	#SKF_AD_NLATTR
 12

	)

69 
	#SKF_AD_NLATTR_NEST
 16

	)

70 
	#SKF_AD_MARK
 20

	)

71 
	#SKF_AD_QUEUE
 24

	)

72 
	#SKF_AD_HATYPE
 28

	)

73 
	#SKF_AD_RXHASH
 32

	)

74 
	#SKF_AD_CPU
 36

	)

75 
	#SKF_AD_ALU_XOR_X
 40

	)

76 
	#SKF_AD_VLAN_TAG
 44

	)

77 
	#SKF_AD_VLAN_TAG_PRESENT
 48

	)

78 
	#SKF_AD_PAY_OFFSET
 52

	)

79 
	#SKF_AD_RANDOM
 56

	)

80 
	#SKF_AD_VLAN_TPID
 60

	)

81 
	#SKF_AD_MAX
 64

	)

83 
	#SKF_NET_OFF
 (-0x100000)

	)

84 
	#SKF_LL_OFF
 (-0x200000)

	)

86 
	#BPF_NET_OFF
 
SKF_NET_OFF


	)

87 
	#BPF_LL_OFF
 
SKF_LL_OFF


	)

	@/usr/include/linux/hdlc/ioctl.h

1 #iâdeà
__HDLC_IOCTL_H__


2 
	#__HDLC_IOCTL_H__


	)

5 
	#GENERIC_HDLC_VERSION
 4

	)

7 
	#CLOCK_DEFAULT
 0

	)

8 
	#CLOCK_EXT
 1

	)

9 
	#CLOCK_INT
 2

	)

10 
	#CLOCK_TXINT
 3

	)

11 
	#CLOCK_TXFROMRX
 4

	)

14 
	#ENCODING_DEFAULT
 0

	)

15 
	#ENCODING_NRZ
 1

	)

16 
	#ENCODING_NRZI
 2

	)

17 
	#ENCODING_FM_MARK
 3

	)

18 
	#ENCODING_FM_SPACE
 4

	)

19 
	#ENCODING_MANCHESTER
 5

	)

22 
	#PARITY_DEFAULT
 0

	)

23 
	#PARITY_NONE
 1

	)

24 
	#PARITY_CRC16_PR0
 2

	)

25 
	#PARITY_CRC16_PR1
 3

	)

26 
	#PARITY_CRC16_PR0_CCITT
 4

	)

27 
	#PARITY_CRC16_PR1_CCITT
 5

	)

28 
	#PARITY_CRC32_PR0_CCITT
 6

	)

29 
	#PARITY_CRC32_PR1_CCITT
 7

	)

31 
	#LMI_DEFAULT
 0

	)

32 
	#LMI_NONE
 1

	)

33 
	#LMI_ANSI
 2

	)

34 
	#LMI_CCITT
 3

	)

35 
	#LMI_CISCO
 4

	)

37 #iâdeà
__ASSEMBLY__


40 
	mşock_¿‹
;

41 
	mşock_ty³
;

42 
	mloİback
;

43 } 
	tsync_£rŸl_£‰šgs
;

46 
	mşock_¿‹
;

47 
	mşock_ty³
;

48 
	mloİback
;

49 
	m¦Ù_m­
;

50 } 
	t‹1_£‰šgs
;

53 
	m’codšg
;

54 
	m·r™y
;

55 } 
	t¿w_hdlc_´Ùo
;

58 
	mt391
;

59 
	mt392
;

60 
	mn391
;

61 
	mn392
;

62 
	mn393
;

63 
	mlmi
;

64 
	mdû
;

65 } 
	tä_´Ùo
;

68 
	mdlci
;

69 } 
	tä_´Ùo_pvc
;

72 
	mdlci
;

73 
	mma¡”
[
IFNAMSIZ
];

74 }
	tä_´Ùo_pvc_šfo
;

77 
	mš‹rv®
;

78 
	mtimeout
;

79 } 
	tcisco_´Ùo
;

	@/usr/include/linux/if_ether.h

21 #iâdeà
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<lšux/ty³s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_TSN
 0x22F0

	)

46 
	#ETH_P_IP
 0x0800

	)

47 
	#ETH_P_X25
 0x0805

	)

48 
	#ETH_P_ARP
 0x0806

	)

49 
	#ETH_P_BPQ
 0x08FF

	)

50 
	#ETH_P_IEEEPUP
 0x0a00

	)

51 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

52 
	#ETH_P_BATMAN
 0x4305

	)

53 
	#ETH_P_DEC
 0x6000

	)

54 
	#ETH_P_DNA_DL
 0x6001

	)

55 
	#ETH_P_DNA_RC
 0x6002

	)

56 
	#ETH_P_DNA_RT
 0x6003

	)

57 
	#ETH_P_LAT
 0x6004

	)

58 
	#ETH_P_DIAG
 0x6005

	)

59 
	#ETH_P_CUST
 0x6006

	)

60 
	#ETH_P_SCA
 0x6007

	)

61 
	#ETH_P_TEB
 0x6558

	)

62 
	#ETH_P_RARP
 0x8035

	)

63 
	#ETH_P_ATALK
 0x809B

	)

64 
	#ETH_P_AARP
 0x80F3

	)

65 
	#ETH_P_8021Q
 0x8100

	)

66 
	#ETH_P_IPX
 0x8137

	)

67 
	#ETH_P_IPV6
 0x86DD

	)

68 
	#ETH_P_PAUSE
 0x8808

	)

69 
	#ETH_P_SLOW
 0x8809

	)

70 
	#ETH_P_WCCP
 0x883E

	)

72 
	#ETH_P_MPLS_UC
 0x8847

	)

73 
	#ETH_P_MPLS_MC
 0x8848

	)

74 
	#ETH_P_ATMMPOA
 0x884ø

	)

75 
	#ETH_P_PPP_DISC
 0x8863

	)

76 
	#ETH_P_PPP_SES
 0x8864

	)

77 
	#ETH_P_LINK_CTL
 0x886ø

	)

78 
	#ETH_P_ATMFATE
 0x8884

	)

81 
	#ETH_P_PAE
 0x888E

	)

82 
	#ETH_P_AOE
 0x88A2

	)

83 
	#ETH_P_8021AD
 0x88A8

	)

84 
	#ETH_P_802_EX1
 0x88B5

	)

85 
	#ETH_P_TIPC
 0x88CA

	)

86 
	#ETH_P_8021AH
 0x88E7

	)

87 
	#ETH_P_MVRP
 0x88F5

	)

88 
	#ETH_P_1588
 0x88F7

	)

89 
	#ETH_P_PRP
 0x88FB

	)

90 
	#ETH_P_FCOE
 0x8906

	)

91 
	#ETH_P_TDLS
 0x890D

	)

92 
	#ETH_P_FIP
 0x8914

	)

93 
	#ETH_P_80221
 0x8917

	)

94 
	#ETH_P_LOOPBACK
 0x9000

	)

95 
	#ETH_P_QINQ1
 0x9100

	)

96 
	#ETH_P_QINQ2
 0x9200

	)

97 
	#ETH_P_QINQ3
 0x9300

	)

98 
	#ETH_P_EDSA
 0xDADA

	)

99 
	#ETH_P_AF_IUCV
 0xFBFB

	)

101 
	#ETH_P_802_3_MIN
 0x0600

	)

108 
	#ETH_P_802_3
 0x0001

	)

109 
	#ETH_P_AX25
 0x0002

	)

110 
	#ETH_P_ALL
 0x0003

	)

111 
	#ETH_P_802_2
 0x0004

	)

112 
	#ETH_P_SNAP
 0x0005

	)

113 
	#ETH_P_DDCMP
 0x0006

	)

114 
	#ETH_P_WAN_PPP
 0x0007

	)

115 
	#ETH_P_PPP_MP
 0x0008

	)

116 
	#ETH_P_LOCALTALK
 0x0009

	)

117 
	#ETH_P_CAN
 0x000C

	)

118 
	#ETH_P_CANFD
 0x000D

	)

119 
	#ETH_P_PPPTALK
 0x0010

	)

120 
	#ETH_P_TR_802_2
 0x0011

	)

121 
	#ETH_P_MOBITEX
 0x0015

	)

122 
	#ETH_P_CONTROL
 0x0016

	)

123 
	#ETH_P_IRDA
 0x0017

	)

124 
	#ETH_P_ECONET
 0x0018

	)

125 
	#ETH_P_HDLC
 0x0019

	)

126 
	#ETH_P_ARCNET
 0x001A

	)

127 
	#ETH_P_DSA
 0x001B

	)

128 
	#ETH_P_TRAILER
 0x001C

	)

129 
	#ETH_P_PHONET
 0x00F5

	)

130 
	#ETH_P_IEEE802154
 0x00F6

	)

131 
	#ETH_P_CAIF
 0x00F7

	)

132 
	#ETH_P_XDSA
 0x00F8

	)

138 
	s‘hhdr
 {

139 
	mh_de¡
[
ETH_ALEN
];

140 
	mh_sourû
[
ETH_ALEN
];

141 
__be16
 
	mh_´Ùo
;

142 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/libc-compat.h

48 #iâdeà
_LIBC_COMPAT_H


49 
	#_LIBC_COMPAT_H


	)

52 #ià
defšed
(
__GLIBC__
)

55 #ià
defšed
(
_NET_IF_H
è&& defšed(
__USE_MISC
)

60 
	#__UAPI_DEF_IF_IFCONF
 0

	)

61 
	#__UAPI_DEF_IF_IFMAP
 0

	)

62 
	#__UAPI_DEF_IF_IFNAMSIZ
 0

	)

63 
	#__UAPI_DEF_IF_IFREQ
 0

	)

65 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 0

	)

67 #iâdeà
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


68 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

77 
	#__UAPI_DEF_IF_IFCONF
 1

	)

78 
	#__UAPI_DEF_IF_IFMAP
 1

	)

79 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

80 
	#__UAPI_DEF_IF_IFREQ
 1

	)

82 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

84 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

89 #ià
defšed
(
_NETINET_IN_H
)

93 
	#__UAPI_DEF_IN_ADDR
 0

	)

94 
	#__UAPI_DEF_IN_IPPROTO
 0

	)

95 
	#__UAPI_DEF_IN_PKTINFO
 0

	)

96 
	#__UAPI_DEF_IP_MREQ
 0

	)

97 
	#__UAPI_DEF_SOCKADDR_IN
 0

	)

98 
	#__UAPI_DEF_IN_CLASS
 0

	)

100 
	#__UAPI_DEF_IN6_ADDR
 0

	)

105 #ià
defšed
(
__USE_MISC
è|| defšed (
__USE_GNU
)

106 
	#__UAPI_DEF_IN6_ADDR_ALT
 0

	)

108 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

110 
	#__UAPI_DEF_SOCKADDR_IN6
 0

	)

111 
	#__UAPI_DEF_IPV6_MREQ
 0

	)

112 
	#__UAPI_DEF_IPPROTO_V6
 0

	)

113 
	#__UAPI_DEF_IPV6_OPTIONS
 0

	)

114 
	#__UAPI_DEF_IN6_PKTINFO
 0

	)

115 
	#__UAPI_DEF_IP6_MTUINFO
 0

	)

122 
	#__UAPI_DEF_IN_ADDR
 1

	)

123 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

124 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

125 
	#__UAPI_DEF_IP_MREQ
 1

	)

126 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

127 
	#__UAPI_DEF_IN_CLASS
 1

	)

129 
	#__UAPI_DEF_IN6_ADDR
 1

	)

132 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

133 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

134 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

135 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

136 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

137 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

138 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

143 #ià
defšed
(
_SYS_XATTR_H
)

144 
	#__UAPI_DEF_XATTR
 0

	)

146 
	#__UAPI_DEF_XATTR
 1

	)

155 
	#__UAPI_DEF_IF_IFCONF
 1

	)

156 
	#__UAPI_DEF_IF_IFMAP
 1

	)

157 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

158 
	#__UAPI_DEF_IF_IFREQ
 1

	)

160 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

162 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

165 
	#__UAPI_DEF_IN_ADDR
 1

	)

166 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

167 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

168 
	#__UAPI_DEF_IP_MREQ
 1

	)

169 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

170 
	#__UAPI_DEF_IN_CLASS
 1

	)

173 
	#__UAPI_DEF_IN6_ADDR
 1

	)

174 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

175 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

176 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

177 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

178 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

179 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

180 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

183 
	#__UAPI_DEF_XATTR
 1

	)

	@/usr/include/linux/socket.h

1 #iâdeà
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__®ignof__
 (
sockaddr
 *))

	)

11 
	t__k”Ãl_§_çmy_t
;

13 
	s__k”Ãl_sockaddr_¡Üage
 {

14 
__k”Ãl_§_çmy_t
 
	mss_çmy
;

16 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

19 } 
__©Œibu‹__
 ((
®igÃd
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty³s.h
>

6 #iâdeà
__ASSEMBLY__


8 
	~<lšux/posix_ty³s.h
>

16 #ifdeà
__CHECKER__


17 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

19 
	#__b™wi£__


	)

21 #ifdeà
__CHECK_ENDIAN__


22 
	#__b™wi£
 
__b™wi£__


	)

24 
	#__b™wi£


	)

27 
__u16
 
	t__b™wi£
 
	t__Ë16
;

28 
__u16
 
	t__b™wi£
 
	t__be16
;

29 
__u32
 
	t__b™wi£
 
	t__Ë32
;

30 
__u32
 
	t__b™wi£
 
	t__be32
;

31 
__u64
 
	t__b™wi£
 
	t__Ë64
;

32 
__u64
 
	t__b™wi£
 
	t__be64
;

34 
__u16
 
	t__b™wi£
 
	t__sum16
;

35 
__u32
 
	t__b™wi£
 
	t__wsum
;

46 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

47 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

48 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

30 #ifdeà
__USE_XOPEN2K


31 
	#__Ãed_time_t


	)

32 
	#__Ãed_time¥ec


	)

34 
	~<time.h
>

36 #iâdeà
__pid_t_defšed


37 
__pid_t
 
	tpid_t
;

38 
	#__pid_t_defšed


	)

43 
	~<b™s/sched.h
>

45 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

48 
__BEGIN_DECLS


51 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

52 
__THROW
;

55 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

58 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

59 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

62 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

65 
	$sched_y›ld
 (è
__THROW
;

68 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

71 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

74 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

77 #ifdeà
__USE_GNU


79 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

80 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

81 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

82 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

83 
ıu£
)

	)

84 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

87 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

88 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

89 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

90 
ıu£
)

	)

91 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

92 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

94 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

95 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

96 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

97 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

99 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

101 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

103 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

104 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

105 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

106 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

107 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

108 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

109 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

110 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

112 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

113 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

114 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

118 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

119 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

122 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

123 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

126 
__END_DECLS


	@/usr/include/xlocale.h

20 #iâdeà
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

39 } *
	t__loÿË_t
;

42 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

23 
__off_t
 
	m__pos
;

24 
__mb¡©e_t
 
	m__¡©e
;

25 } 
	t_G_åos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb¡©e_t
 
	m__¡©e
;

30 } 
	t_G_åos64_t
;

31 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gcÚv.h
>

35 
__gcÚv_šfo
 
	m__cd
;

38 
__gcÚv_šfo
 
	m__cd
;

39 
__gcÚv_¡•_d©a
 
	m__d©a
;

40 } 
	m__combšed
;

41 } 
	t_G_icÚv_t
;

46 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__exùy³
 (
i§Êum
);

111 
__exùy³
 (
i§Íha
);

112 
__exùy³
 (
isúŒl
);

113 
__exùy³
 (
isdig™
);

114 
__exùy³
 (
i¦ow”
);

115 
__exùy³
 (
isg¿ph
);

116 
__exùy³
 (
i¥ršt
);

117 
__exùy³
 (
i¥unù
);

118 
__exùy³
 (
is¥aû
);

119 
__exùy³
 (
isuµ”
);

120 
__exùy³
 (
isxdig™
);

124 
	$tŞow”
 (
__c
è
__THROW
;

127 
	$touµ”
 (
__c
è
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__exùy³
 (
isbÏnk
);

138 
__END_NAMESPACE_C99


141 #ifdeà
__USE_GNU


143 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

146 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


150 
	$i§scii
 (
__c
è
__THROW
;

154 
	$tßscii
 (
__c
è
__THROW
;

158 
	`__exùy³
 (
_touµ”
);

159 
	`__exùy³
 (
_tŞow”
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

164 (
__ex‹nsiÚ__
 \

165 ({ 
__»s
; \

166 ià( (
c
) > 1) \

168 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

174 
__»s
 = 
f
 
¬gs
; \

177 
__»s
 = (
a
)[(è(
c
)]; \

178 
__»s
; 
	}
}))

	)

180 #ià!
defšed
 
__NO_CTYPE


181 #ifdeà
__isùy³_f


182 
	$__isùy³_f
 (
®num
)

183 
	$__isùy³_f
 (
®pha
)

184 
	$__isùy³_f
 (
úŒl
)

185 
	$__isùy³_f
 (
dig™
)

186 
	$__isùy³_f
 (
low”
)

187 
	$__isùy³_f
 (
g¿ph
)

188 
	$__isùy³_f
 (
´št
)

189 
	$__isùy³_f
 (
punù
)

190 
	$__isùy³_f
 (
¥aû
)

191 
	$__isùy³_f
 (
uµ”
)

192 
	$__isùy³_f
 (
xdig™
)

193 #ifdeà
__USE_ISOC99


194 
	$__isùy³_f
 (
bÏnk
)

196 #–ià
defšed
 
__isùy³


197 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

198 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

199 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

200 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

201 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

202 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

203 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

204 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

205 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

206 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

207 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

208 #ifdeà
__USE_ISOC99


209 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

213 #ifdeà
__USE_EXTERN_INLINES


214 
__ex‹º_šlše
 

215 
	`__NTH
 (
	$tŞow”
 (
__c
))

217  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

218 
	}
}

220 
__ex‹º_šlše
 

221 
__NTH
 (
	$touµ”
 (
__c
))

223  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

224 
	}
}

227 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


228 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

229 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

232 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


233 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

234 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

236 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

237 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

243 #ifdeà
__USE_XOPEN2K8


257 
	~<xloÿË.h
>

261 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

262 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

264 
	#__exùy³_l
(
Çme
) \

265 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

271 
__exùy³_l
 (
i§Êum_l
);

272 
__exùy³_l
 (
i§Íha_l
);

273 
__exùy³_l
 (
isúŒl_l
);

274 
__exùy³_l
 (
isdig™_l
);

275 
__exùy³_l
 (
i¦ow”_l
);

276 
__exùy³_l
 (
isg¿ph_l
);

277 
__exùy³_l
 (
i¥ršt_l
);

278 
__exùy³_l
 (
i¥unù_l
);

279 
__exùy³_l
 (
is¥aû_l
);

280 
__exùy³_l
 (
isuµ”_l
);

281 
__exùy³_l
 (
isxdig™_l
);

283 
__exùy³_l
 (
isbÏnk_l
);

287 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

288 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

291 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

292 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

294 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


295 
	#__tŞow”_l
(
c
, 
loÿË
) \

296 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

297 
	#__touµ”_l
(
c
, 
loÿË
) \

298 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

299 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

300 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

304 #iâdeà
__NO_CTYPE


305 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

306 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

307 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

308 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

309 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

310 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

311 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

312 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

313 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

314 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

315 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

317 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

319 #ifdeà
__USE_MISC


320 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

321 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

324 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

325 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

326 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

327 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

328 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

329 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

330 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

331 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

332 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

333 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

334 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

336 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

338 #ifdeà
__USE_MISC


339 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

340 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/linux/bpf_common.h

1 #iâdeà
__LINUX_BPF_COMMON_H__


2 
	#__LINUX_BPF_COMMON_H__


	)

5 
	#BPF_CLASS
(
code
è((codeè& 0x07)

	)

6 
	#BPF_LD
 0x00

	)

7 
	#BPF_LDX
 0x01

	)

8 
	#BPF_ST
 0x02

	)

9 
	#BPF_STX
 0x03

	)

10 
	#BPF_ALU
 0x04

	)

11 
	#BPF_JMP
 0x05

	)

12 
	#BPF_RET
 0x06

	)

13 
	#BPF_MISC
 0x07

	)

16 
	#BPF_SIZE
(
code
è((codeè& 0x18)

	)

17 
	#BPF_W
 0x00

	)

18 
	#BPF_H
 0x08

	)

19 
	#BPF_B
 0x10

	)

20 
	#BPF_MODE
(
code
è((codeè& 0xe0)

	)

21 
	#BPF_IMM
 0x00

	)

22 
	#BPF_ABS
 0x20

	)

23 
	#BPF_IND
 0x40

	)

24 
	#BPF_MEM
 0x60

	)

25 
	#BPF_LEN
 0x80

	)

26 
	#BPF_MSH
 0xa0

	)

29 
	#BPF_OP
(
code
è((codeè& 0xf0)

	)

30 
	#BPF_ADD
 0x00

	)

31 
	#BPF_SUB
 0x10

	)

32 
	#BPF_MUL
 0x20

	)

33 
	#BPF_DIV
 0x30

	)

34 
	#BPF_OR
 0x40

	)

35 
	#BPF_AND
 0x50

	)

36 
	#BPF_LSH
 0x60

	)

37 
	#BPF_RSH
 0x70

	)

38 
	#BPF_NEG
 0x80

	)

39 
	#BPF_MOD
 0x90

	)

40 
	#BPF_XOR
 0xa0

	)

42 
	#BPF_JA
 0x00

	)

43 
	#BPF_JEQ
 0x10

	)

44 
	#BPF_JGT
 0x20

	)

45 
	#BPF_JGE
 0x30

	)

46 
	#BPF_JSET
 0x40

	)

47 
	#BPF_SRC
(
code
è((codeè& 0x08)

	)

48 
	#BPF_K
 0x00

	)

49 
	#BPF_X
 0x08

	)

51 #iâdeà
BPF_MAXINSNS


52 
	#BPF_MAXINSNS
 4096

	)

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_b™s
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__k”Ãl_fd_£t
;

29 (*
	t__k”Ãl_sighªdËr_t
)();

32 
	t__k”Ãl_key_t
;

33 
	t__k”Ãl_mqd_t
;

35 
	~<asm/posix_ty³s.h
>

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

55 
	#__STDC_ISO_10646__
 201505L

	)

58 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/gconv.h

22 #iâdeà
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	#__Ãed_mb¡©e_t


	)

27 
	#__Ãed_wšt_t


	)

28 
	~<wch¬.h
>

29 
	#__Ãed_size_t


	)

30 
	#__Ãed_wch¬_t


	)

31 
	~<¡ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004,

60 
	m__GCONV_TRANSLIT
 = 0x0008

65 
	g__gcÚv_¡•
;

66 
	g__gcÚv_¡•_d©a
;

67 
	g__gcÚv_lßded_objeù
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 
	s__gcÚv_¡•


86 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

87 cÚ¡ *
__modÇme
;

89 
__couÁ”
;

91 *
__äom_Çme
;

92 *
__to_Çme
;

94 
__gcÚv_fù
 
__fù
;

95 
__gcÚv_btowc_fù
 
__btowc_fù
;

96 
__gcÚv_š™_fù
 
__š™_fù
;

97 
__gcÚv_’d_fù
 
__’d_fù
;

101 
__mš_Ãeded_äom
;

102 
__max_Ãeded_äom
;

103 
__mš_Ãeded_to
;

104 
__max_Ãeded_to
;

107 
__¡©eful
;

109 *
__d©a
;

114 
	s__gcÚv_¡•_d©a


116 *
__outbuf
;

117 *
__outbuãnd
;

121 
__æags
;

125 
__švoÿtiÚ_couÁ”
;

129 
__š‹º®_u£
;

131 
__mb¡©e_t
 *
__¡©•
;

132 
__mb¡©e_t
 
__¡©e
;

138 
	s__gcÚv_šfo


140 
size_t
 
__n¡•s
;

141 
__gcÚv_¡•
 *
__¡•s
;

142 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

143 } *
	t__gcÚv_t
;

146 
	`__gcÚv_Œª¦™”©e
 (
__gcÚv_¡•
 *
¡•
,

147 
__gcÚv_¡•_d©a
 *
¡•_d©a
,

148 cÚ¡ *
šbuf¡¬t
,

149 cÚ¡ **
šbuå
,

150 cÚ¡ *
šbuãnd
,

151 **
outbuf¡¬t
,

152 
size_t
 *
œ»v”sibË
);

	@/usr/include/linux/stddef.h

	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


25 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<ã©u»s.h
>

30 #ifdeà
_WCHAR_H


32 
	#__Ãed___FILE


	)

33 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_FILE


	)

36 
	~<¡dio.h
>

38 
	#__Ãed___va_li¡


	)

39 
	~<¡d¬g.h
>

41 
	~<b™s/wch¬.h
>

44 
	#__Ãed_size_t


	)

45 
	#__Ãed_wch¬_t


	)

46 
	#__Ãed_NULL


	)

48 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


49 #undeà
__Ãed_wšt_t


50 
	#__Ãed_wšt_t


	)

51 
	~<¡ddef.h
>

55 #iâdeà
_WINT_T


60 
	#_WINT_T


	)

61 
	twšt_t
;

65 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
defšed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twšt_t
;

69 
	g__END_NAMESPACE_STD


74 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
____mb¡©e_t_defšed


80 
	#____mb¡©e_t_defšed
 1

	)

84 
	m__couÁ
;

87 #ifdeà
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wšt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__v®ue
;

94 } 
	t__mb¡©e_t
;

96 #undeà
__Ãed_mb¡©e_t


101 #ifdeà
_WCHAR_H


103 #iâdeà
__mb¡©e_t_defšed


104 
__BEGIN_NAMESPACE_C99


106 
__mb¡©e_t
 
	tmb¡©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb¡©e_t_defšed
 1

	)

111 #ifdeà
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

115 #iâdeà
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #iâdeà
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


128 
	~<wùy³.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
)

149 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

152 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

153 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

154 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

157 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

158 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
)

159 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

161 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

162 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

163 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

166 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

167 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

169 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

170 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

171 
__END_NAMESPACE_STD


173 #ifdeà
__USE_XOPEN2K8


175 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

178 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

179 
size_t
 
__n
è
__THROW
;

183 
	~<xloÿË.h
>

185 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

186 
__loÿË_t
 
__loc
è
__THROW
;

188 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

189 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

192 
__BEGIN_NAMESPACE_STD


195 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

199 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

200 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

201 
__END_NAMESPACE_STD


203 #ifdeà
__USE_XOPEN2K8


209 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

210 
__loÿË_t
 
__loc
è
__THROW
;

215 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

216 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

219 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

222 
__BEGIN_NAMESPACE_STD


224 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


225 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

226 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

227 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

228 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

230 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

231 
__THROW
 
__©Œibu‹_pu»__
;

234 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


235 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

236 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

237 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

238 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

240 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

241 
__THROW
 
__©Œibu‹_pu»__
;

243 
__END_NAMESPACE_STD


245 #ifdeà
__USE_GNU


248 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

249 
__THROW
 
__©Œibu‹_pu»__
;

252 
__BEGIN_NAMESPACE_STD


255 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

256 
__THROW
 
__©Œibu‹_pu»__
;

259 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

260 
__THROW
 
__©Œibu‹_pu»__
;

262 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


263 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

264 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

265 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

266 cÚ¡ 
wch¬_t
 *
__acû±
)

267 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

269 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

270 
__THROW
 
__©Œibu‹_pu»__
;

273 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


274 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

275 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

276 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

277 cÚ¡ 
wch¬_t
 *
__ÃedË
)

278 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

280 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

281 
__THROW
 
__©Œibu‹_pu»__
;

285 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

286 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

287 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

290 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

291 
__END_NAMESPACE_STD


293 #ifdeà
__USE_XOPEN


295 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


296 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

297 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

298 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

299 cÚ¡ 
wch¬_t
 *
__ÃedË
)

300 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

302 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

303 
__THROW
 
__©Œibu‹_pu»__
;

307 #ifdeà
__USE_XOPEN2K8


309 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

310 
__THROW
 
__©Œibu‹_pu»__
;

314 
__BEGIN_NAMESPACE_STD


316 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


317 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

319 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

320 
size_t
 
__n
)

321 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

323 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

324 
__THROW
 
__©Œibu‹_pu»__
;

328 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

329 
__THROW
 
__©Œibu‹_pu»__
;

332 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

333 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

337 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

338 
__THROW
;

341 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

342 
__END_NAMESPACE_STD


344 #ifdeà
__USE_GNU


347 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

348 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

349 
__THROW
;

353 
__BEGIN_NAMESPACE_STD


356 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

360 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

364 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

368 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

369 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

370 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

373 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

374 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

377 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

378 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

379 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

380 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

381 
__END_NAMESPACE_STD


383 #ifdeà
__USE_EXTERN_INLINES


389 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

390 
__ex‹º_šlše
 
wšt_t


391 
	`__NTH
 (
	$btowc
 (
__c
))

392 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

393 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

395 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

396 
__ex‹º_šlše
 

397 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

398 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

399 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

401 
__ex‹º_šlše
 
size_t


402 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

403 
mb¡©e_t
 *
__»¡riù
 
__ps
))

404 {  (
__ps
 !ğ
NULL


405 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

408 
__BEGIN_NAMESPACE_STD


411 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

412 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

413 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

417 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

418 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

419 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

420 
__END_NAMESPACE_STD


423 #ifdef 
__USE_XOPEN2K8


426 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

427 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

428 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

432 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

433 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

434 
size_t
 
__nwc
, size_ˆ
__Ën
,

435 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

440 #ifdeà
__USE_XOPEN


442 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

446 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

450 
__BEGIN_NAMESPACE_STD


453 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

454 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

455 
__END_NAMESPACE_STD


457 #ifdeà
__USE_ISOC99


458 
__BEGIN_NAMESPACE_C99


460 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

461 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

462 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

463 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

464 
__END_NAMESPACE_C99


468 
__BEGIN_NAMESPACE_STD


471 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

472 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

476 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

477 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

478 
__THROW
;

479 
__END_NAMESPACE_STD


481 #ifdeà
__USE_ISOC99


482 
__BEGIN_NAMESPACE_C99


485 
__ex‹nsiÚ__


486 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

487 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

488 
__THROW
;

492 
__ex‹nsiÚ__


493 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

494 
wch¬_t
 **
__»¡riù
 
__’d±r
,

495 
__ba£
è
__THROW
;

496 
__END_NAMESPACE_C99


499 #ifdeà
__USE_GNU


502 
__ex‹nsiÚ__


503 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

504 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

505 
__THROW
;

509 
__ex‹nsiÚ__


510 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

511 
wch¬_t
 **
__»¡riù
 
__’d±r
,

512 
__ba£
è
__THROW
;

515 #ifdeà
__USE_GNU


529 
	~<xloÿË.h
>

533 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

534 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

535 
__loÿË_t
 
__loc
è
__THROW
;

537 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

538 
wch¬_t
 **
__»¡riù
 
__’d±r
,

539 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

541 
__ex‹nsiÚ__


542 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

543 
wch¬_t
 **
__»¡riù
 
__’d±r
,

544 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

546 
__ex‹nsiÚ__


547 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

548 
wch¬_t
 **
__»¡riù
 
__’d±r
,

549 
__ba£
, 
__loÿË_t
 
__loc
)

550 
__THROW
;

552 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

553 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

554 
__THROW
;

556 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

557 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

558 
__THROW
;

560 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

561 
wch¬_t
 **
__»¡riù
 
__’d±r
,

562 
__loÿË_t
 
__loc
è
__THROW
;

566 #ifdeà
__USE_XOPEN2K8


569 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

570 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

574 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

575 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

576 
__THROW
;

583 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

586 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


587 
__BEGIN_NAMESPACE_STD


590 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

597 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

598 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

604 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

607 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

608 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

609 
__THROW
 ;

615 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

616 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

617 
__gnuc_va_li¡
 
__¬g
)

623 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

624 
__gnuc_va_li¡
 
__¬g
)

628 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

629 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

630 
__gnuc_va_li¡
 
__¬g
)

631 
__THROW
 ;

638 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

639 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

645 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

648 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

649 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

650 
__THROW
 ;

652 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

653 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

654 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

655 #ifdeà
__REDIRECT


659 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

660 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

661 
__isoc99_fwsÿnf
)

663 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

664 
__isoc99_wsÿnf
)

666 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

667 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

668 ...), 
__isoc99_swsÿnf
)

671 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

672 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

673 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

674 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

675 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

676 
__THROW
;

677 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

678 
	#wsÿnf
 
__isoc99_wsÿnf


	)

679 
	#swsÿnf
 
__isoc99_swsÿnf


	)

683 
__END_NAMESPACE_STD


686 #ifdeà
__USE_ISOC99


687 
__BEGIN_NAMESPACE_C99


692 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

693 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

694 
__gnuc_va_li¡
 
__¬g
)

700 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

701 
__gnuc_va_li¡
 
__¬g
)

704 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

705 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

706 
__gnuc_va_li¡
 
__¬g
)

707 
__THROW
 ;

709 #ià!
defšed
 
__USE_GNU
 \

710 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

711 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

712 #ifdeà
__REDIRECT


713 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

714 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

715 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

717 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

718 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

720 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

721 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

722 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

725 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

726 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

727 
__gnuc_va_li¡
 
__¬g
);

728 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

729 
__gnuc_va_li¡
 
__¬g
);

730 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

731 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

732 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

733 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

734 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

735 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

739 
__END_NAMESPACE_C99


743 
__BEGIN_NAMESPACE_STD


748 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

749 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

755 
wšt_t
 
	`g‘wch¬
 ();

762 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

763 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

769 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

777 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

778 
__FILE
 *
__»¡riù
 
__¡»am
);

784 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

785 
__FILE
 *
__»¡riù
 
__¡»am
);

792 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

793 
__END_NAMESPACE_STD


796 #ifdeà
__USE_GNU


804 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

805 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

813 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

821 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

830 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

831 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

840 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

841 
__FILE
 *
__»¡riù
 
__¡»am
);

849 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

850 
__FILE
 *
__»¡riù
 
__¡»am
);

854 
__BEGIN_NAMESPACE_C99


858 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

859 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

860 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

861 
__END_NAMESPACE_C99


863 #ifdeà
__USE_GNU


864 
	~<xloÿË.h
>

868 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

869 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

870 cÚ¡ 
tm
 *
__»¡riù
 
__
,

871 
__loÿË_t
 
__loc
è
__THROW
;

880 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


881 
	#__Ãed_iswxxx


	)

882 
	~<wùy³.h
>

886 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


887 
	~<b™s/wch¬2.h
>

890 #ifdeà
__LDBL_COMPAT


891 
	~<b™s/wch¬-ldbl.h
>

894 
__END_DECLS


902 #undeà
__Ãed_mb¡©e_t


903 #undeà
__Ãed_wšt_t


	@/usr/include/wctype.h

23 #iâdeà
_WCTYPE_H


25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 #iâdeà
__Ãed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__Ãed_wšt_t


	)

33 
	~<wch¬.h
>

37 #iâdeà
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #undeà
__Ãed_iswxxx


46 #iâdeà
__iswxxx_defšed


47 
	#__iswxxx_defšed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	twùy³_t
;

53 
	g__END_NAMESPACE_C99


55 #iâdeà
_ISwb™


60 
	~<’dŸn.h
>

61 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


62 
	#_ISwb™
(
b™
è(1 << (b™))

	)

64 
	#_ISwb™
(
b™
) \

65 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (è((1UL << (
b™
)è>> 24))))

	)

73 
	m__ISwuµ”
 = 0,

74 
	m__ISwlow”
 = 1,

75 
	m__ISw®pha
 = 2,

76 
	m__ISwdig™
 = 3,

77 
	m__ISwxdig™
 = 4,

78 
	m__ISw¥aû
 = 5,

79 
	m__ISw´št
 = 6,

80 
	m__ISwg¿ph
 = 7,

81 
	m__ISwbÏnk
 = 8,

82 
	m__ISwúŒl
 = 9,

83 
	m__ISwpunù
 = 10,

84 
	m__ISw®num
 = 11,

86 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

87 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

88 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

89 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

90 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

91 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

92 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

93 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

94 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

95 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

96 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

97 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

117 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

120 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

124 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

128 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

133 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

136 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

141 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

146 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

151 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

156 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

161 #ifdeà
__USE_ISOC99


162 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

171 
wùy³_t
 
	$wùy³
 (cÚ¡ *
__´İ”ty
è
__THROW
;

175 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 cÚ¡ 
	t__št32_t
 *
	twù¿ns_t
;

187 
__END_NAMESPACE_C99


188 #ifdeà
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

197 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifdeà
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
wù¿ns_t
 
	$wù¿ns
 (cÚ¡ *
__´İ”ty
è
__THROW
;

221 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifdeà
__USE_XOPEN2K8


226 
	~<xloÿË.h
>

230 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

236 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

239 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

243 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

247 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

252 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

255 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

260 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

265 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

270 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

275 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

280 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

284 
wùy³_t
 
	$wùy³_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

285 
__THROW
;

289 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

290 
__THROW
;

298 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

301 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

305 
wù¿ns_t
 
	$wù¿ns_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

306 
__THROW
;

309 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

310 
__loÿË_t
 
__loÿË
è
__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
108
2993
inc/opx/hal_interface.h
inc/opx/hal_interface_common.h
inc/opx/hal_interface_defaults.h
inc/opx/interface_obj.h
inc/opx/nas_fc_stats.h
inc/opx/nas_int_base_if.h
inc/opx/nas_int_bridge.h
inc/opx/nas_int_com_utils.h
inc/opx/nas_int_filter_class.h
inc/opx/nas_int_lag.h
inc/opx/nas_int_lag_api.h
inc/opx/nas_int_lag_cps.h
inc/opx/nas_int_list.h
inc/opx/nas_int_logical.h
inc/opx/nas_int_physical_cps.h
inc/opx/nas_int_port.h
inc/opx/nas_int_utils.h
inc/opx/nas_int_vlan.h
inc/opx/nas_interface_fc.h
inc/opx/nas_packet_filter.h
inc/opx/nas_packet_meta.h
inc/opx/nas_stats.h
inc/opx/nas_vrf.h
inc/opx/nas_vrf_extn.h
inc/opx/plugins/interface_object_cache.h
inc/opx/plugins/interface_plugin_front_panel_port.h
inc/opx/plugins/interface_plugin_linux.h
inc/opx/plugins/interface_plugins.h
inc/opx/plugins/interface_utils.h
inc/opx/swp_util_tap.h
src/lag/nas_int_lag.c
src/lag/nas_int_lag_api.cpp
src/lag/nas_int_lag_cps.cpp
src/nas_int_base_if.cpp
src/nas_int_com_utils.cpp
src/nas_int_common_obj.cpp
src/nas_int_ev_handlers.cpp
src/nas_int_list.c
src/nas_int_main.cpp
src/packet/nas_packet_filter.cpp
src/packet/nas_packet_meta.c
src/packet/packet_io.c
src/port/hal_int_utils.c
src/port/nas_fc_intf.cpp
src/port/nas_int_logical_cps.cpp
src/port/nas_int_physical_cps.cpp
src/port/nas_int_port.cpp
src/stats/nas_stats_eee_cps.cpp
src/stats/nas_stats_fc_if_cps.cpp
src/stats/nas_stats_if_cps.cpp
src/stats/nas_stats_utils.c
src/stats/nas_stats_vlan_cps.cpp
src/swp_util_tap.c
src/unit_test/interface_file_reader_unit_test.c
src/unit_test/nas_int_lag_unittest.cpp
src/unit_test/nas_int_loopback_unittest.cpp
src/unit_test/nas_int_media_unittest.cpp
src/unit_test/nas_int_phy_unittest.cpp
src/unit_test/nas_int_rpc_unittest.cpp
src/unit_test/nas_int_vlan_filter_unittest.cpp
src/unit_test/nas_int_vlan_unittest.cpp
src/unit_test/nas_pkt_meta_rcv_ut.cpp
src/unit_test/nas_pkt_meta_send_ut.cpp
src/unit_test/nas_stats_ut.cpp
src/unit_test/tap_main.c
src/vlan/nas_int_bridge.cpp
src/vlan/nas_int_vlan.cpp
src/vlan/nas_vlan_cps.cpp
src/vlan/nas_vlan_lag_api.cpp
src/vrf/nas_vrf_api.cpp
src/vrf/nas_vrf_cps.cpp
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/inttypes.h
/usr/include/limits.h
/usr/include/linux/if.h
/usr/include/linux/if_tun.h
/usr/include/net/if.h
/usr/include/pthread.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/endian.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/libio.h
/usr/include/linux/filter.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/if_ether.h
/usr/include/linux/libc-compat.h
/usr/include/linux/socket.h
/usr/include/linux/types.h
/usr/include/sched.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/ctype.h
/usr/include/linux/bpf_common.h
/usr/include/linux/posix_types.h
/usr/include/stdc-predef.h
/usr/include/gconv.h
/usr/include/linux/stddef.h
/usr/include/wchar.h
/usr/include/wctype.h
